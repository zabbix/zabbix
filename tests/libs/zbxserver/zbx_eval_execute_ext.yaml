---
test case: Expression 'forty_two()'
in:
  rules: [ZBX_EVAL_PARSE_FUNCTION]
  expression: 'forty_two()'
  callbacks:
  - name: forty_two
    args_num: 0
    error: 'forced function error'
out:
  result: FAIL
---
test case: Expression 'forty_two()'
in:
  rules: [ZBX_EVAL_PARSE_FUNCTION]
  expression: 'forty_two()'
  callbacks:
  - name: forty_two
    args_num: 0
    retval: 42s
out:
  result: SUCCEED
  value: 42
---
test case: Expression 'sum(hist(/host/key,1h))'
in:
  rules: [ZBX_EVAL_PARSE_FUNCTION,ZBX_EVAL_PARSE_ITEM_QUERY]
  expression: 'sum(hist(/host/key,1h))'
  callbacks:
  - name: hist
    args_num: 2
    retval: [1, 2, 3]
out:
  result: SUCCEED
  value: 6
---
test case: Expression 'sum(hist(/host/key,1h),0)'
in:
  rules: [ZBX_EVAL_PARSE_FUNCTION,ZBX_EVAL_PARSE_ITEM_QUERY]
  expression: 'sum(hist(/host/key,1h),0)'
  callbacks:
  - name: hist
    args_num: 2
    retval: [1, 2, 3]
out:
  result: FAIL
---
test case: Expression 'min(err(), 1) or 1'
in:
  rules: [ZBX_EVAL_PARSE_FUNCTION,ZBX_EVAL_PROCESS_ERROR]
  expression: 'min(err(), 1) or 1'
  callbacks:
  - name: err
    args_num: 0
    reterr: 'forced return error'
out:
  result: SUCCEED
  value: 1
---
test case: Expression 'min(err(), 1) or 1'
in:
  rules: [ZBX_EVAL_PARSE_FUNCTION]
  expression: 'min(err(), 1) or 1'
  callbacks:
  - name: err
    args_num: 0
    reterr: 'forced return error'
out:
  result: FAIL
---
test case: Expression 'min(1, 2, err()) and 0'
in:
  rules: [ZBX_EVAL_PARSE_FUNCTION,ZBX_EVAL_PROCESS_ERROR]
  expression: 'min(1, 2, err()) and 0'
  callbacks:
  - name: err
    args_num: 0
    reterr: 'forced return error'
out:
  result: SUCCEED
  value: 0
---
test case: Expression 'min(1, 2, err()) and 0'
in:
  rules: [ZBX_EVAL_PARSE_FUNCTION]
  expression: 'min(1, 2, err()) and 0'
  callbacks:
  - name: err
    args_num: 0
    reterr: 'forced return error'
out:
  result: FAIL
---
test case: Expression 'sum(hist(/host/key,1h))'
in:
  rules: [ZBX_EVAL_PARSE_FUNCTION,ZBX_EVAL_PARSE_ITEM_QUERY]
  expression: 'sum(hist(/host/key,1h))'
  callbacks:
  - name: hist
    args_num: 2
    retval: []
out:
  result: FAIL
...

