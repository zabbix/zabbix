<?php declare(strict_types=1);
/*
** Zabbix
** Copyright (C) 2001-2021 Zabbix SIA
**
** This program is free software; you can redistribute it and/or modify
** it under the terms of the GNU General Public License as published by
** the Free Software Foundation; either version 2 of the License, or
** (at your option) any later version.
**
** This program is distributed in the hope that it will be useful,
** but WITHOUT ANY WARRANTY; without even the implied warranty of
** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
** GNU General Public License for more details.
**
** You should have received a copy of the GNU General Public License
** along with this program; if not, write to the Free Software
** Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
**/

use PHPUnit\Framework\TestCase;

class CTriggerExpressionTest extends TestCase {

	public static function provider() {
		return [
			['', null, false],
			['+', null, false],
			['1+1', null, true],
			['abc', null, false],
			['{#LLD}', null, false, ['lldmacros' => false]],
			['{#LLD}', null, true, ['lldmacros' => true]],
			['{#LLD}', null, true],

			['.5', null, true],
			['5.', null, true],
			['..5', null, false],
			['5..', null, false],

			['1', null, true],
			['1s', null, true],
			['1m', null, true],
			['1h', null, true],
			['1d', null, true],
			['1w', null, true],
			['1K', null, true],
			['1M', null, true],
			['1G', null, true],
			['1T', null, true],
			['1.5', null, true],
			['1.5s', null, true],
			['1.5m', null, true],
			['1.5h', null, true],
			['1.5d', null, true],
			['1.5w', null, true],
			['1.5K', null, true],
			['1.5M', null, true],
			['1.5G', null, true],
			['1.5T', null, true],
			['-1.5', null, true],
			['-1.5s', null, true],
			['-1.5m', null, true],
			['-1.5h', null, true],
			['-1.5d', null, true],
			['-1.5w', null, true],
			['-1.5K', null, true],
			['-1.5M', null, true],
			['-1.5G', null, true],
			['-1.5T', null, true],

			['{TRIGGER.VALUE}', null, true],
			['{$USERMACRO}', null, true],
			['{TRIGGER.VALUE}=1', null, true],
			['{$USERMACRO}=1', null, true],

			['(/host)', null, false],
			['(/host/key)', null, false],

			['last(/host/key) and {TRIGGER.VALUE}', null, true],
			['last(/host/key)and {TRIGGER.VALUE}', null, false],
			['last(/host/key) and{TRIGGER.VALUE}', null, false],
			['last(/host/key)and{TRIGGER.VALUE}', null, false],
			['last(/host/key)and+{TRIGGER.VALUE}', null, false],
			['last(/host/key)and-{TRIGGER.VALUE}', null, false],
			['last(/host/key) and + {TRIGGER.VALUE}', null, false],
			['last(/host/key) and - {TRIGGER.VALUE}', null, true],

			['last(/host/key) and {$USERMACRO}', null, true],
			['last(/host/key)and {$USERMACRO}', null, false],
			['last(/host/key) and{$USERMACRO}', null, false],
			['last(/host/key)and{$USERMACRO}', null, false],
			['last(/host/key)and+{$USERMACRO}', null, false],
			['last(/host/key)and-{$USERMACRO}', null, false],
			['last(/host/key) and + {$USERMACRO}', null, false],
			['last(/host/key) and - {$USERMACRO}', null, true],

			// basic "not" support
			['not 1', null, true],
			['not (1)', null, true],
			['not -1', null, true],
			['not (-1)', null, true],
			['not -(1)', null, true],
			['not {TRIGGER.VALUE}', null, true],
			['not ({TRIGGER.VALUE})', null, true],
			['not -{TRIGGER.VALUE}', null, true],
			['not (-{TRIGGER.VALUE})', null, true],
			['not -({TRIGGER.VALUE})', null, true],
			['not {$USERMACRO}', null, true],
			['not ({$USERMACRO})', null, true],
			['not -{$USERMACRO}', null, true],
			['not (-{$USERMACRO})', null, true],
			['not -({$USERMACRO})', null, true],
			['not last(/host/key)', null, true],
			['not (last(/host/key))', null, true],
			['not -last(/host/key)', null, true],
			['not (-last(/host/key))', null, true],
			['not -(last(/host/key))', null, true],

			['not1', null, false],
			['not(1)', null, true],
			['not-1', null, false],
			['not(-1)', null, true],
			['not-(1)', null, false],
			['not{TRIGGER.VALUE}', null, false],
			['not({TRIGGER.VALUE})', null, true],
			['not-{TRIGGER.VALUE}', null, false],
			['not(-{TRIGGER.VALUE})', null, true],
			['not-({TRIGGER.VALUE})', null, false],
			['not{$USERMACRO}', null, false],
			['not({$USERMACRO})', null, true],
			['not-{$USERMACRO}', null, false],
			['not(-{$USERMACRO})', null, true],
			['not-({$USERMACRO})', null, false],
			['not(last(/host/key))', null, true],
			['not(-last(/host/key))', null, true],
			['not-(last(/host/key))', null, false],

			['- not 1', null, false],
			['-not 1', null, false],
			['- not1', null, false],
			['-not1', null, false],
			['1 not 1', null, false],
			['(1) not 1', null, false],
			['1not1', null, false],
			['(1)not1', null, false],

			// operator cases
			['Not 1', null, false],
			['NOT 1', null, false],
			['1 Or 1', null, false],
			['1 OR 1', null, false],
			['1 And 1', null, false],
			['1 AND 1', null, false],

			['last(/host/key)=00', null, true],
			['last(/host/key)=0 0', null, false],
			['last(/host/key)=0 0=last(/host/key)', null, false],
			['last(/host/key) = 00 = last(/host/key)', null, true],

			['count(/host/key[a,,"b",,[c,d,,"e",],,[f]],1,,"b",3)', null, true],
			['count(/host/key[a,,"b",,[[c,d,,"e"],[]],,[f]],1,,"b",3)', null, false],
			['count(/host/key[a,,"b",,[c,d,,"e",,,[f]],1,,"b",3)', null, false],
			['count(/host/key[a,,"b",,[c,d,,"e",],,f]],1,,"b",3)', null, false],

			['last(/abcdefghijklmnopqrstuvwxyz. _-ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890/key)', null, true],
			['last(/host/abcdefghijklmnopqrstuvwxyz._-ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890)', null, true],
			['abcdefghijklmnopqrstuvwxyz(/host/key)', null, true],

			['last(/host)', null, false],
			['last(/host/,)', null, false],
			['last(/host/;)', null, false],
			['last(/host//)', null, false],
			['last(/host//)', null, false],

			['last(/host/key)', null, true],
			['(last(/host/key))', null, true],
			['(last(/host/key)', null, false],
			['((last(/host/key)', null, false],
			['last((/host/key))=0', null, false],
			['(last(/host/key)=)0', null, false],
			['(last(/host/key))0', null, false],
			['0(=last(/host/key))', null, false],
			['0(last(/host/key))', null, false],
			['( last(/host/key) )', null, true],
			[' ( last(/host/key) ) ', null, true],
			['(( ( last(/host/key) ) ))', null, true],
			[' ( ( ( last(/host/key) ) ) ) ', null, true],
			['((( ( last(/host/key) ) )))', null, true],
			[' ( ( ( ( last(/host/key) ) ) ) ) ', null, true],
			['()0=( last(/host/key) )', null, false],
			['0()=( last(/host/key) )', null, false],
			['0=()=( last(/host/key) )', null, false],
			['0=()( last(/host/key) )', null, false],
			['0=last(/host/key)()', null, false],
			['0=last(/host/key)+()()()()5', null, false],
			['0=last(/host/key)+((((()))))5', null, false],
			['(0)=last(/host/key)', null, true],
			['(0+)=last(/host/key)', null, false],
			['(0=)last(/host/key)', null, false],
			['(-5)=last(/host/key)', null, true],
			['(15 - 5.25 - 1)=last(/host/key)', null, true],
			['last(/host/key) = -5', null, true],
			['last(/0/0,0)=0', null, true],

			['((last(/host/key))=0)', null, true],
			['( ( last(/host/key) ) = 0 )', null, true],
			['((last(/host/key)) * 100) / 95', null, true],
			['((last(/host/key)) * 5.25K) / 95.0', null, true],
			['((last(/host/key)) * 1w) / 1d', null, true],
			['((last(/host/key)) * 1w) / 1Ks', null, false],
			['((last(/host/key)) * 1w) / (1d * (last(/host/key))', null, false],
			['((last(/host/key)) * 1w) / (1d * last(host/key))', null, true],
			['((last(/host/key)) * 1w) / (1d * (last(/host/key)))', null, true],

			['last(/host/key,1) * (-1)', null, true],
			['last(/host/key,1) / (-1)', null, true],
			['last(/host/key,1) + (-1)', null, true],
			['last(/host/key,1) - (-1)', null, true],
			['last(/host/key,1) = (-1)', null, true],
			['last(/host/key,1) <> (-1)', null, true],
			['last(/host/key,1) < (-1)', null, true],
			['last(/host/key,1) > (-1)', null, true],
			['last(/host/key,1) and (-1)', null, true],
			['last(/host/key,1) or (-1)', null, true],

			['last(/host/key,1) * not (-1)', null, true],
			['last(/host/key,1) / not (-1)', null, true],
			['last(/host/key,1) + not (-1)', null, true],
			['last(/host/key,1) - not (-1)', null, true],
			['last(/host/key,1) = not (-1)', null, true],
			['last(/host/key,1) <> not (-1)', null, true],
			['last(/host/key,1) < not (-1)', null, true],
			['last(/host/key,1) > not (-1)', null, true],
			['last(/host/key,1) and not (-1)', null, true],
			['last(/host/key,1) or not (-1)', null, true],

			['last(/host/key,1)* (-1)', null, true],
			['last(/host/key,1)/ (-1)', null, true],
			['last(/host/key,1)+ (-1)', null, true],
			['last(/host/key,1)- (-1)', null, true],
			['last(/host/key,1)= (-1)', null, true],
			['last(/host/key,1)<> (-1)', null, true],
			['last(/host/key,1)< (-1)', null, true],
			['last(/host/key,1)> (-1)', null, true],
			['last(/host/key,1)and (-1)', null, false],
			['last(/host/key,1)or (-1)', null, false],

			['last(/host/key,1)* not (-1)', null, true],
			['last(/host/key,1)/ not (-1)', null, true],
			['last(/host/key,1)+ not (-1)', null, true],
			['last(/host/key,1)- not (-1)', null, true],
			['last(/host/key,1)= not (-1)', null, true],
			['last(/host/key,1)<> not (-1)', null, true],
			['last(/host/key,1)< not (-1)', null, true],
			['last(/host/key,1)> not (-1)', null, true],
			['last(/host/key,1)and not (-1)', null, false],
			['last(/host/key,1)or not (-1)', null, false],

			['last(/host/key,1) *(-1)', null, true],
			['last(/host/key,1) /(-1)', null, true],
			['last(/host/key,1) +(-1)', null, true],
			['last(/host/key,1) -(-1)', null, true],
			['last(/host/key,1) =(-1)', null, true],
			['last(/host/key,1) <>(-1)', null, true],
			['last(/host/key,1) <(-1)', null, true],
			['last(/host/key,1) >(-1)', null, true],
			['last(/host/key,1) and(-1)', null, true],
			['last(/host/key,1) or(-1)', null, true],

			['last(/host/key,1) * not(-1)', null, true],
			['last(/host/key,1) / not(-1)', null, true],
			['last(/host/key,1) + not(-1)', null, true],
			['last(/host/key,1) - not(-1)', null, true],
			['last(/host/key,1) = not(-1)', null, true],
			['last(/host/key,1) <> not(-1)', null, true],
			['last(/host/key,1) < not(-1)', null, true],
			['last(/host/key,1) > not(-1)', null, true],
			['last(/host/key,1) and not(-1)', null, true],
			['last(/host/key,1) or not(-1)', null, true],

			['last(/host/key,1)*(-1)', null, true],
			['last(/host/key,1)/(-1)', null, true],
			['last(/host/key,1)+(-1)', null, true],
			['last(/host/key,1)-(-1)', null, true],
			['last(/host/key,1)=(-1)', null, true],
			['last(/host/key,1)<>(-1)', null, true],
			['last(/host/key,1)<(-1)', null, true],
			['last(/host/key,1)>(-1)', null, true],
			['last(/host/key,1)and(-1)', null, false],
			['last(/host/key,1)or(-1)', null, false],

			['last(/host/key,1)*not(-1)', null, false],
			['last(/host/key,1)/not(-1)', null, false],
			['last(/host/key,1)+not(-1)', null, false],
			['last(/host/key,1)-not(-1)', null, false],
			['last(/host/key,1)=not(-1)', null, false],
			['last(/host/key,1)<>not(-1)', null, false],
			['last(/host/key,1)<not(-1)', null, false],
			['last(/host/key,1)>not(-1)', null, false],
			['last(/host/key,1)andnot(-1)', null, false],
			['last(/host/key,1)ornot(-1)', null, false],

			['last(/host/key,1) * -1', null, true],
			['last(/host/key,1) / -1', null, true],
			['last(/host/key,1) + -1', null, true],
			['last(/host/key,1) - -1', null, true],
			['last(/host/key,1) = -1', null, true],
			['last(/host/key,1) <> -1', null, true],
			['last(/host/key,1) < -1', null, true],
			['last(/host/key,1) > -1', null, true],
			['last(/host/key,1) and -1', null, true],
			['last(/host/key,1) or -1', null, true],

			['last(/host/key,1) * not -1', null, true],
			['last(/host/key,1) / not -1', null, true],
			['last(/host/key,1) + not -1', null, true],
			['last(/host/key,1) - not -1', null, true],
			['last(/host/key,1) = not -1', null, true],
			['last(/host/key,1) <> not -1', null, true],
			['last(/host/key,1) < not -1', null, true],
			['last(/host/key,1) > not -1', null, true],
			['last(/host/key,1) and not -1', null, true],
			['last(/host/key,1) or not -1', null, true],

			['last(/host/key,1)* -1', null, true],
			['last(/host/key,1)/ -1', null, true],
			['last(/host/key,1)+ -1', null, true],
			['last(/host/key,1)- -1', null, true],
			['last(/host/key,1)= -1', null, true],
			['last(/host/key,1)<> -1', null, true],
			['last(/host/key,1)< -1', null, true],
			['last(/host/key,1)> -1', null, true],
			['last(/host/key,1)and -1', null, false],
			['last(/host/key,1)or -1', null, false],

			['last(/host/key,1)* not -1', null, true],
			['last(/host/key,1)/ not -1', null, true],
			['last(/host/key,1)+ not -1', null, true],
			['last(/host/key,1)- not -1', null, true],
			['last(/host/key,1)= not -1', null, true],
			['last(/host/key,1)<> not -1', null, true],
			['last(/host/key,1)< not -1', null, true],
			['last(/host/key,1)> not -1', null, true],
			['last(/host/key,1)and not -1', null, false],
			['last(/host/key,1)or not -1', null, false],

			['last(/host/key,1) *-1', null, true],
			['last(/host/key,1) /-1', null, true],
			['last(/host/key,1) +-1', null, true],
			['last(/host/key,1) --1', null, true],
			['last(/host/key,1) =-1', null, true],
			['last(/host/key,1) <>-1', null, true],
			['last(/host/key,1) <-1', null, true],
			['last(/host/key,1) >-1', null, true],
			['last(/host/key,1) and-1', null, false],
			['last(/host/key,1) or-1', null, false],

			['last(/host/key,1) * not-1', null, false],
			['last(/host/key,1) / not-1', null, false],
			['last(/host/key,1) + not-1', null, false],
			['last(/host/key,1) - not-1', null, false],
			['last(/host/key,1) = not-1', null, false],
			['last(/host/key,1) <> not-1', null, false],
			['last(/host/key,1) < not-1', null, false],
			['last(/host/key,1) > not-1', null, false],
			['last(/host/key,1) and not-1', null, false],
			['last(/host/key,1) or not-1', null, false],

			['last(/host/key,1)*-1', null, true],
			['last(/host/key,1)/-1', null, true],
			['last(/host/key,1)+-1', null, true],
			['last(/host/key,1)--1', null, true],
			['last(/host/key,1)=-1', null, true],
			['last(/host/key,1)<>-1', null, true],
			['last(/host/key,1)<-1', null, true],
			['last(/host/key,1)>-1', null, true],
			['last(/host/key,1)and-1', null, false],
			['last(/host/key,1)or-1', null, false],

			['last(/host/key,1)*not-1', null, false],
			['last(/host/key,1)/not-1', null, false],
			['last(/host/key,1)+not-1', null, false],
			['last(/host/key,1)-not-1', null, false],
			['last(/host/key,1)=not-1', null, false],
			['last(/host/key,1)<>not-1', null, false],
			['last(/host/key,1)<not-1', null, false],
			['last(/host/key,1)>not-1', null, false],
			['last(/host/key,1)andnot-1', null, false],
			['last(/host/key,1)ornot-1', null, false],

			['last(/host/key,1) * (- 1)', null, true],
			['last(/host/key,1) / (- 1)', null, true],
			['last(/host/key,1) + (- 1)', null, true],
			['last(/host/key,1) - (- 1)', null, true],
			['last(/host/key,1) = (- 1)', null, true],
			['last(/host/key,1) <> (- 1)', null, true],
			['last(/host/key,1) < (- 1)', null, true],
			['last(/host/key,1) > (- 1)', null, true],
			['last(/host/key,1) and (- 1)', null, true],
			['last(/host/key,1) or (- 1)', null, true],

			['last(/host/key,1) * not (- 1)', null, true],
			['last(/host/key,1) / not (- 1)', null, true],
			['last(/host/key,1) + not (- 1)', null, true],
			['last(/host/key,1) - not (- 1)', null, true],
			['last(/host/key,1) = not (- 1)', null, true],
			['last(/host/key,1) <> not (- 1)', null, true],
			['last(/host/key,1) < not (- 1)', null, true],
			['last(/host/key,1) > not (- 1)', null, true],
			['last(/host/key,1) and not (- 1)', null, true],
			['last(/host/key,1) or not (- 1)', null, true],

			['last(/host/key,1)* (- 1)', null, true],
			['last(/host/key,1)/ (- 1)', null, true],
			['last(/host/key,1)+ (- 1)', null, true],
			['last(/host/key,1)- (- 1)', null, true],
			['last(/host/key,1)= (- 1)', null, true],
			['last(/host/key,1)<> (- 1)', null, true],
			['last(/host/key,1)< (- 1)', null, true],
			['last(/host/key,1)> (- 1)', null, true],
			['last(/host/key,1)and (- 1)', null, false],
			['last(/host/key,1)or (- 1)', null, false],

			['last(/host/key,1)* not (- 1)', null, true],
			['last(/host/key,1)/ not (- 1)', null, true],
			['last(/host/key,1)+ not (- 1)', null, true],
			['last(/host/key,1)- not (- 1)', null, true],
			['last(/host/key,1)= not (- 1)', null, true],
			['last(/host/key,1)<> not (- 1)', null, true],
			['last(/host/key,1)< not (- 1)', null, true],
			['last(/host/key,1)> not (- 1)', null, true],
			['last(/host/key,1)and not (- 1)', null, false],
			['last(/host/key,1)or not (- 1)', null, false],

			['last(/host/key,1) *(- 1)', null, true],
			['last(/host/key,1) /(- 1)', null, true],
			['last(/host/key,1) +(- 1)', null, true],
			['last(/host/key,1) -(- 1)', null, true],
			['last(/host/key,1) =(- 1)', null, true],
			['last(/host/key,1) <>(- 1)', null, true],
			['last(/host/key,1) <(- 1)', null, true],
			['last(/host/key,1) >(- 1)', null, true],
			['last(/host/key,1) and(- 1)', null, true],
			['last(/host/key,1) or(- 1)', null, true],

			['last(/host/key,1) * not(- 1)', null, true],
			['last(/host/key,1) / not(- 1)', null, true],
			['last(/host/key,1) + not(- 1)', null, true],
			['last(/host/key,1) - not(- 1)', null, true],
			['last(/host/key,1) = not(- 1)', null, true],
			['last(/host/key,1) <> not(- 1)', null, true],
			['last(/host/key,1) < not(- 1)', null, true],
			['last(/host/key,1) > not(- 1)', null, true],
			['last(/host/key,1) and not(- 1)', null, true],
			['last(/host/key,1) or not(- 1)', null, true],

			['last(/host/key,1)*(- 1)', null, true],
			['last(/host/key,1)/(- 1)', null, true],
			['last(/host/key,1)+(- 1)', null, true],
			['last(/host/key,1)-(- 1)', null, true],
			['last(/host/key,1)=(- 1)', null, true],
			['last(/host/key,1)<>(- 1)', null, true],
			['last(/host/key,1)<(- 1)', null, true],
			['last(/host/key,1)>(- 1)', null, true],
			['last(/host/key,1)and(- 1)', null, false],
			['last(/host/key,1)or(- 1)', null, false],

			['last(/host/key,1)*not(- 1)', null, false],
			['last(/host/key,1)/not(- 1)', null, false],
			['last(/host/key,1)+not(- 1)', null, false],
			['last(/host/key,1)-not(- 1)', null, false],
			['last(/host/key,1)=not(- 1)', null, false],
			['last(/host/key,1)<>not(- 1)', null, false],
			['last(/host/key,1)<not(- 1)', null, false],
			['last(/host/key,1)>not(- 1)', null, false],
			['last(/host/key,1)andnot(- 1)', null, false],
			['last(/host/key,1)ornot(- 1)', null, false],

			['last(/host/key,1) * - 1', null, true],
			['last(/host/key,1) / - 1', null, true],
			['last(/host/key,1) + - 1', null, true],
			['last(/host/key,1) - - 1', null, true],
			['last(/host/key,1) = - 1', null, true],
			['last(/host/key,1) <> - 1', null, true],
			['last(/host/key,1) < - 1', null, true],
			['last(/host/key,1) > - 1', null, true],
			['last(/host/key,1) and - 1', null, true],
			['last(/host/key,1) or - 1', null, true],

			['last(/host/key,1) * not - 1', null, true],
			['last(/host/key,1) / not - 1', null, true],
			['last(/host/key,1) + not - 1', null, true],
			['last(/host/key,1) - not - 1', null, true],
			['last(/host/key,1) = not - 1', null, true],
			['last(/host/key,1) <> not - 1', null, true],
			['last(/host/key,1) < not - 1', null, true],
			['last(/host/key,1) > not - 1', null, true],
			['last(/host/key,1) and not - 1', null, true],
			['last(/host/key,1) or not - 1', null, true],

			['last(/host/key,1)* - 1', null, true],
			['last(/host/key,1)/ - 1', null, true],
			['last(/host/key,1)+ - 1', null, true],
			['last(/host/key,1)- - 1', null, true],
			['last(/host/key,1)= - 1', null, true],
			['last(/host/key,1)<> - 1', null, true],
			['last(/host/key,1)< - 1', null, true],
			['last(/host/key,1)> - 1', null, true],
			['last(/host/key,1)and - 1', null, false],
			['last(/host/key,1)or - 1', null, false],

			['last(/host/key,1)* not - 1', null, true],
			['last(/host/key,1)/ not - 1', null, true],
			['last(/host/key,1)+ not - 1', null, true],
			['last(/host/key,1)- not - 1', null, true],
			['last(/host/key,1)= not - 1', null, true],
			['last(/host/key,1)<> not - 1', null, true],
			['last(/host/key,1)< not - 1', null, true],
			['last(/host/key,1)> not - 1', null, true],
			['last(/host/key,1)and not - 1', null, false],
			['last(/host/key,1)or not - 1', null, false],

			['last(/host/key,1) *- 1', null, true],
			['last(/host/key,1) /- 1', null, true],
			['last(/host/key,1) +- 1', null, true],
			['last(/host/key,1) -- 1', null, true],
			['last(/host/key,1) =- 1', null, true],
			['last(/host/key,1) <>- 1', null, true],
			['last(/host/key,1) <- 1', null, true],
			['last(/host/key,1) >- 1', null, true],
			['last(/host/key,1) and- 1', null, false],
			['last(/host/key,1) or- 1', null, false],

			['last(/host/key,1) *not- 1', null, false],
			['last(/host/key,1) /not- 1', null, false],
			['last(/host/key,1) +not- 1', null, false],
			['last(/host/key,1) -not- 1', null, false],
			['last(/host/key,1) =not- 1', null, false],
			['last(/host/key,1) <>not- 1', null, false],
			['last(/host/key,1) <not- 1', null, false],
			['last(/host/key,1) >not- 1', null, false],
			['last(/host/key,1) andnot- 1', null, false],
			['last(/host/key,1) ornot- 1', null, false],

			['last(/host/key,1)*- 1', null, true],
			['last(/host/key,1)/- 1', null, true],
			['last(/host/key,1)+- 1', null, true],
			['last(/host/key,1)-- 1', null, true],
			['last(/host/key,1)=- 1', null, true],
			['last(/host/key,1)<>- 1', null, true],
			['last(/host/key,1)<- 1', null, true],
			['last(/host/key,1)>- 1', null, true],
			['last(/host/key,1)and- 1', null, false],
			['last(/host/key,1)or- 1', null, false],

			['last(/host/key,1)*not- 1', null, false],
			['last(/host/key,1)/not- 1', null, false],
			['last(/host/key,1)+not- 1', null, false],
			['last(/host/key,1)-not- 1', null, false],
			['last(/host/key,1)=not- 1', null, false],
			['last(/host/key,1)<>not- 1', null, false],
			['last(/host/key,1)<not- 1', null, false],
			['last(/host/key,1)>not- 1', null, false],
			['last(/host/key,1)andnot- 1', null, false],
			['last(/host/key,1)ornot- 1', null, false],

			['last(/host/key,1) * (+1)', null, false],
			['last(/host/key,1) / (+1)', null, false],
			['last(/host/key,1) + (+1)', null, false],
			['last(/host/key,1) - (+1)', null, false],
			['last(/host/key,1) = (+1)', null, false],
			['last(/host/key,1) <> (+1)', null, false],
			['last(/host/key,1) < (+1)', null, false],
			['last(/host/key,1) > (+1)', null, false],
			['last(/host/key,1) and (+1)', null, false],
			['last(/host/key,1) or (+1)', null, false],

			['last(/host/key,1) * not (+1)', null, false],
			['last(/host/key,1) / not (+1)', null, false],
			['last(/host/key,1) + not (+1)', null, false],
			['last(/host/key,1) - not (+1)', null, false],
			['last(/host/key,1) = not (+1)', null, false],
			['last(/host/key,1) <> not (+1)', null, false],
			['last(/host/key,1) < not (+1)', null, false],
			['last(/host/key,1) > not (+1)', null, false],
			['last(/host/key,1) and not (+1)', null, false],
			['last(/host/key,1) or not (+1)', null, false],

			['last(/host/key,1)* (+1)', null, false],
			['last(/host/key,1)/ (+1)', null, false],
			['last(/host/key,1)+ (+1)', null, false],
			['last(/host/key,1)- (+1)', null, false],
			['last(/host/key,1)= (+1)', null, false],
			['last(/host/key,1)<> (+1)', null, false],
			['last(/host/key,1)< (+1)', null, false],
			['last(/host/key,1)> (+1)', null, false],
			['last(/host/key,1)and (+1)', null, false],
			['last(/host/key,1)or (+1)', null, false],

			['last(/host/key,1)*not (+1)', null, false],
			['last(/host/key,1)/not (+1)', null, false],
			['last(/host/key,1)+not (+1)', null, false],
			['last(/host/key,1)-not (+1)', null, false],
			['last(/host/key,1)=not (+1)', null, false],
			['last(/host/key,1)<>not (+1)', null, false],
			['last(/host/key,1)<not (+1)', null, false],
			['last(/host/key,1)>not (+1)', null, false],
			['last(/host/key,1)andnot (+1)', null, false],
			['last(/host/key,1)ornot (+1)', null, false],

			['last(/host/key,1) *(+1)', null, false],
			['last(/host/key,1) /(+1)', null, false],
			['last(/host/key,1) +(+1)', null, false],
			['last(/host/key,1) -(+1)', null, false],
			['last(/host/key,1) =(+1)', null, false],
			['last(/host/key,1) <>(+1)', null, false],
			['last(/host/key,1) <(+1)', null, false],
			['last(/host/key,1) >(+1)', null, false],
			['last(/host/key,1) and(+1)', null, false],
			['last(/host/key,1) or(+1)', null, false],

			['last(/host/key,1) * not(+1)', null, false],
			['last(/host/key,1) / not(+1)', null, false],
			['last(/host/key,1) + not(+1)', null, false],
			['last(/host/key,1) - not(+1)', null, false],
			['last(/host/key,1) = not(+1)', null, false],
			['last(/host/key,1) <> not(+1)', null, false],
			['last(/host/key,1) < not(+1)', null, false],
			['last(/host/key,1) > not(+1)', null, false],
			['last(/host/key,1) and not(+1)', null, false],
			['last(/host/key,1) or not(+1)', null, false],

			['last(/host/key,1)*(+1)', null, false],
			['last(/host/key,1)/(+1)', null, false],
			['last(/host/key,1)+(+1)', null, false],
			['last(/host/key,1)-(+1)', null, false],
			['last(/host/key,1)=(+1)', null, false],
			['last(/host/key,1)<>(+1)', null, false],
			['last(/host/key,1)<(+1)', null, false],
			['last(/host/key,1)>(+1)', null, false],
			['last(/host/key,1)and(+1)', null, false],
			['last(/host/key,1)or(+1)', null, false],

			['last(/host/key,1)*not(+1)', null, false],
			['last(/host/key,1)/not(+1)', null, false],
			['last(/host/key,1)+not(+1)', null, false],
			['last(/host/key,1)-not(+1)', null, false],
			['last(/host/key,1)=not(+1)', null, false],
			['last(/host/key,1)<>not(+1)', null, false],
			['last(/host/key,1)<not(+1)', null, false],
			['last(/host/key,1)>not(+1)', null, false],
			['last(/host/key,1)andnot(+1)', null, false],
			['last(/host/key,1)ornot(+1)', null, false],

			['last(/host/key,1) * +1', null, false],
			['last(/host/key,1) / +1', null, false],
			['last(/host/key,1) + +1', null, false],
			['last(/host/key,1) - +1', null, false],
			['last(/host/key,1) = +1', null, false],
			['last(/host/key,1) <> +1', null, false],
			['last(/host/key,1) < +1', null, false],
			['last(/host/key,1) > +1', null, false],
			['last(/host/key,1) and +1', null, false],
			['last(/host/key,1) or +1', null, false],

			['last(/host/key,1) * not +1', null, false],
			['last(/host/key,1) / not +1', null, false],
			['last(/host/key,1) + not +1', null, false],
			['last(/host/key,1) - not +1', null, false],
			['last(/host/key,1) = not +1', null, false],
			['last(/host/key,1) <> not +1', null, false],
			['last(/host/key,1) < not +1', null, false],
			['last(/host/key,1) > not +1', null, false],
			['last(/host/key,1) and not +1', null, false],
			['last(/host/key,1) or not +1', null, false],

			['last(/host/key,1)* +1', null, false],
			['last(/host/key,1)/ +1', null, false],
			['last(/host/key,1)+ +1', null, false],
			['last(/host/key,1)- +1', null, false],
			['last(/host/key,1)= +1', null, false],
			['last(/host/key,1)<> +1', null, false],
			['last(/host/key,1)< +1', null, false],
			['last(/host/key,1)> +1', null, false],
			['last(/host/key,1)and +1', null, false],
			['last(/host/key,1)or +1', null, false],

			['last(/host/key,1)* not +1', null, false],
			['last(/host/key,1)/ not +1', null, false],
			['last(/host/key,1)+ not +1', null, false],
			['last(/host/key,1)- not +1', null, false],
			['last(/host/key,1)= not +1', null, false],
			['last(/host/key,1)<> not +1', null, false],
			['last(/host/key,1)< not +1', null, false],
			['last(/host/key,1)> not +1', null, false],
			['last(/host/key,1)and not +1', null, false],
			['last(/host/key,1)or not +1', null, false],

			['last(/host/key,1) *+1', null, false],
			['last(/host/key,1) /+1', null, false],
			['last(/host/key,1) ++1', null, false],
			['last(/host/key,1) -+1', null, false],
			['last(/host/key,1) =+1', null, false],
			['last(/host/key,1) <>+1', null, false],
			['last(/host/key,1) <+1', null, false],
			['last(/host/key,1) >+1', null, false],
			['last(/host/key,1) and+1', null, false],
			['last(/host/key,1) or+1', null, false],

			['last(/host/key,1) *not+1', null, false],
			['last(/host/key,1) /not+1', null, false],
			['last(/host/key,1) +not+1', null, false],
			['last(/host/key,1) -not+1', null, false],
			['last(/host/key,1) =not+1', null, false],
			['last(/host/key,1) <>not+1', null, false],
			['last(/host/key,1) <not+1', null, false],
			['last(/host/key,1) >not+1', null, false],
			['last(/host/key,1) andnot+1', null, false],
			['last(/host/key,1) ornot+1', null, false],

			['last(/host/key,1)*+1', null, false],
			['last(/host/key,1)/+1', null, false],
			['last(/host/key,1)++1', null, false],
			['last(/host/key,1)-+1', null, false],
			['last(/host/key,1)=+1', null, false],
			['last(/host/key,1)<>+1', null, false],
			['last(/host/key,1)<+1', null, false],
			['last(/host/key,1)>+1', null, false],
			['last(/host/key,1)and+1', null, false],
			['last(/host/key,1)or+1', null, false],

			['last(/host/key,1)*not+1', null, false],
			['last(/host/key,1)/not+1', null, false],
			['last(/host/key,1)+not+1', null, false],
			['last(/host/key,1)-not+1', null, false],
			['last(/host/key,1)=not+1', null, false],
			['last(/host/key,1)<>not+1', null, false],
			['last(/host/key,1)<not+1', null, false],
			['last(/host/key,1)>not+1', null, false],
			['last(/host/key,1)andnot+1', null, false],
			['last(/host/key,1)ornot+1', null, false],

			['last(/host/key,1) * (+ 1)', null, false],
			['last(/host/key,1) / (+ 1)', null, false],
			['last(/host/key,1) + (+ 1)', null, false],
			['last(/host/key,1) - (+ 1)', null, false],
			['last(/host/key,1) = (+ 1)', null, false],
			['last(/host/key,1) <> (+ 1)', null, false],
			['last(/host/key,1) < (+ 1)', null, false],
			['last(/host/key,1) > (+ 1)', null, false],
			['last(/host/key,1) and (+ 1)', null, false],
			['last(/host/key,1) or (+ 1)', null, false],

			['last(/host/key,1) * not (+ 1)', null, false],
			['last(/host/key,1) / not (+ 1)', null, false],
			['last(/host/key,1) + not (+ 1)', null, false],
			['last(/host/key,1) - not (+ 1)', null, false],
			['last(/host/key,1) = not (+ 1)', null, false],
			['last(/host/key,1) <> not (+ 1)', null, false],
			['last(/host/key,1) < not (+ 1)', null, false],
			['last(/host/key,1) > not (+ 1)', null, false],
			['last(/host/key,1) and not (+ 1)', null, false],
			['last(/host/key,1) or not (+ 1)', null, false],

			['last(/host/key,1)* (+ 1)', null, false],
			['last(/host/key,1)/ (+ 1)', null, false],
			['last(/host/key,1)+ (+ 1)', null, false],
			['last(/host/key,1)- (+ 1)', null, false],
			['last(/host/key,1)= (+ 1)', null, false],
			['last(/host/key,1)<> (+ 1)', null, false],
			['last(/host/key,1)< (+ 1)', null, false],
			['last(/host/key,1)> (+ 1)', null, false],
			['last(/host/key,1)and (+ 1)', null, false],
			['last(/host/key,1)or (+ 1)', null, false],

			['last(/host/key,1)* not (+ 1)', null, false],
			['last(/host/key,1)/ not (+ 1)', null, false],
			['last(/host/key,1)+ not (+ 1)', null, false],
			['last(/host/key,1)- not (+ 1)', null, false],
			['last(/host/key,1)= not (+ 1)', null, false],
			['last(/host/key,1)<> not (+ 1)', null, false],
			['last(/host/key,1)< not (+ 1)', null, false],
			['last(/host/key,1)> not (+ 1)', null, false],
			['last(/host/key,1)and not (+ 1)', null, false],
			['last(/host/key,1)or not (+ 1)', null, false],

			['last(/host/key,1) *(+ 1)', null, false],
			['last(/host/key,1) /(+ 1)', null, false],
			['last(/host/key,1) +(+ 1)', null, false],
			['last(/host/key,1) -(+ 1)', null, false],
			['last(/host/key,1) =(+ 1)', null, false],
			['last(/host/key,1) <>(+ 1)', null, false],
			['last(/host/key,1) <(+ 1)', null, false],
			['last(/host/key,1) >(+ 1)', null, false],
			['last(/host/key,1) and(+ 1)', null, false],
			['last(/host/key,1) or(+ 1)', null, false],

			['last(/host/key,1) *not(+ 1)', null, false],
			['last(/host/key,1) /not(+ 1)', null, false],
			['last(/host/key,1) +not(+ 1)', null, false],
			['last(/host/key,1) -not(+ 1)', null, false],
			['last(/host/key,1) =not(+ 1)', null, false],
			['last(/host/key,1) <>not(+ 1)', null, false],
			['last(/host/key,1) <not(+ 1)', null, false],
			['last(/host/key,1) >not(+ 1)', null, false],
			['last(/host/key,1) andnot(+ 1)', null, false],
			['last(/host/key,1) ornot(+ 1)', null, false],

			['last(/host/key,1)*(+ 1)', null, false],
			['last(/host/key,1)/(+ 1)', null, false],
			['last(/host/key,1)+(+ 1)', null, false],
			['last(/host/key,1)-(+ 1)', null, false],
			['last(/host/key,1)=(+ 1)', null, false],
			['last(/host/key,1)<>(+ 1)', null, false],
			['last(/host/key,1)<(+ 1)', null, false],
			['last(/host/key,1)>(+ 1)', null, false],
			['last(/host/key,1)and(+ 1)', null, false],
			['last(/host/key,1)or(+ 1)', null, false],

			['last(/host/key,1)*not(+ 1)', null, false],
			['last(/host/key,1)/not(+ 1)', null, false],
			['last(/host/key,1)+not(+ 1)', null, false],
			['last(/host/key,1)-not(+ 1)', null, false],
			['last(/host/key,1)=not(+ 1)', null, false],
			['last(/host/key,1)<>not(+ 1)', null, false],
			['last(/host/key,1)<not(+ 1)', null, false],
			['last(/host/key,1)>not(+ 1)', null, false],
			['last(/host/key,1)andnot(+ 1)', null, false],
			['last(/host/key,1)ornot(+ 1)', null, false],

			['last(/host/key,1) * + 1', null, false],
			['last(/host/key,1) / + 1', null, false],
			['last(/host/key,1) + + 1', null, false],
			['last(/host/key,1) - + 1', null, false],
			['last(/host/key,1) = + 1', null, false],
			['last(/host/key,1) <> + 1', null, false],
			['last(/host/key,1) < + 1', null, false],
			['last(/host/key,1) > + 1', null, false],
			['last(/host/key,1) and + 1', null, false],
			['last(/host/key,1) or + 1', null, false],

			['last(/host/key,1) * not + 1', null, false],
			['last(/host/key,1) / not + 1', null, false],
			['last(/host/key,1) + not + 1', null, false],
			['last(/host/key,1) - not + 1', null, false],
			['last(/host/key,1) = not + 1', null, false],
			['last(/host/key,1) <> not + 1', null, false],
			['last(/host/key,1) < not + 1', null, false],
			['last(/host/key,1) > not + 1', null, false],
			['last(/host/key,1) and not + 1', null, false],
			['last(/host/key,1) or not + 1', null, false],

			['last(/host/key,1)* + 1', null, false],
			['last(/host/key,1)/ + 1', null, false],
			['last(/host/key,1)+ + 1', null, false],
			['last(/host/key,1)- + 1', null, false],
			['last(/host/key,1)= + 1', null, false],
			['last(/host/key,1)<> + 1', null, false],
			['last(/host/key,1)< + 1', null, false],
			['last(/host/key,1)> + 1', null, false],
			['last(/host/key,1)and + 1', null, false],
			['last(/host/key,1)or + 1', null, false],

			['last(/host/key,1)* not + 1', null, false],
			['last(/host/key,1)/ not + 1', null, false],
			['last(/host/key,1)+ not + 1', null, false],
			['last(/host/key,1)- not + 1', null, false],
			['last(/host/key,1)= not + 1', null, false],
			['last(/host/key,1)<> not + 1', null, false],
			['last(/host/key,1)< not + 1', null, false],
			['last(/host/key,1)> not + 1', null, false],
			['last(/host/key,1)and not + 1', null, false],
			['last(/host/key,1)or not + 1', null, false],

			['last(/host/key,1) *+ 1', null, false],
			['last(/host/key,1) /+ 1', null, false],
			['last(/host/key,1) ++ 1', null, false],
			['last(/host/key,1) -+ 1', null, false],
			['last(/host/key,1) =+ 1', null, false],
			['last(/host/key,1) <>+ 1', null, false],
			['last(/host/key,1) <+ 1', null, false],
			['last(/host/key,1) >+ 1', null, false],
			['last(/host/key,1) and+ 1', null, false],
			['last(/host/key,1) or+ 1', null, false],

			['last(/host/key,1) * not+ 1', null, false],
			['last(/host/key,1) / not+ 1', null, false],
			['last(/host/key,1) + not+ 1', null, false],
			['last(/host/key,1) - not+ 1', null, false],
			['last(/host/key,1) = not+ 1', null, false],
			['last(/host/key,1) <> not+ 1', null, false],
			['last(/host/key,1) < not+ 1', null, false],
			['last(/host/key,1) > not+ 1', null, false],
			['last(/host/key,1) and not+ 1', null, false],
			['last(/host/key,1) or not+ 1', null, false],

			['last(/host/key,1)*+ 1', null, false],
			['last(/host/key,1)/+ 1', null, false],
			['last(/host/key,1)++ 1', null, false],
			['last(/host/key,1)-+ 1', null, false],
			['last(/host/key,1)=+ 1', null, false],
			['last(/host/key,1)<>+ 1', null, false],
			['last(/host/key,1)<+ 1', null, false],
			['last(/host/key,1)>+ 1', null, false],
			['last(/host/key,1)and+ 1', null, false],
			['last(/host/key,1)or+ 1', null, false],

			['last(/host/key,1)*not+ 1', null, false],
			['last(/host/key,1)/not+ 1', null, false],
			['last(/host/key,1)+not+ 1', null, false],
			['last(/host/key,1)-not+ 1', null, false],
			['last(/host/key,1)=not+ 1', null, false],
			['last(/host/key,1)<>not+ 1', null, false],
			['last(/host/key,1)<not+ 1', null, false],
			['last(/host/key,1)>not+ 1', null, false],
			['last(/host/key,1)andnot+ 1', null, false],
			['last(/host/key,1)ornot+ 1', null, false],

			['last(/host/key,1) * (not1)', null, false],
			['last(/host/key,1) / (not1)', null, false],
			['last(/host/key,1) + (not1)', null, false],
			['last(/host/key,1) - (not1)', null, false],
			['last(/host/key,1) = (not1)', null, false],
			['last(/host/key,1) <> (not1)', null, false],
			['last(/host/key,1) < (not1)', null, false],
			['last(/host/key,1) > (not1)', null, false],
			['last(/host/key,1) and (not1)', null, false],
			['last(/host/key,1) or (not1)', null, false],

			['last(/host/key,1) * not (not1)', null, false],
			['last(/host/key,1) / not (not1)', null, false],
			['last(/host/key,1) + not (not1)', null, false],
			['last(/host/key,1) - not (not1)', null, false],
			['last(/host/key,1) = not (not1)', null, false],
			['last(/host/key,1) <> not (not1)', null, false],
			['last(/host/key,1) < not (not1)', null, false],
			['last(/host/key,1) > not (not1)', null, false],
			['last(/host/key,1) and not (not1)', null, false],
			['last(/host/key,1) or not (not1)', null, false],

			['last(/host/key,1)* (not1)', null, false],
			['last(/host/key,1)/ (not1)', null, false],
			['last(/host/key,1)+ (not1)', null, false],
			['last(/host/key,1)- (not1)', null, false],
			['last(/host/key,1)= (not1)', null, false],
			['last(/host/key,1)<> (not1)', null, false],
			['last(/host/key,1)< (not1)', null, false],
			['last(/host/key,1)> (not1)', null, false],
			['last(/host/key,1)and (not1)', null, false],
			['last(/host/key,1)or (not1)', null, false],

			['last(/host/key,1)*not (not1)', null, false],
			['last(/host/key,1)/not (not1)', null, false],
			['last(/host/key,1)+not (not1)', null, false],
			['last(/host/key,1)-not (not1)', null, false],
			['last(/host/key,1)=not (not1)', null, false],
			['last(/host/key,1)<>not (not1)', null, false],
			['last(/host/key,1)<not (not1)', null, false],
			['last(/host/key,1)>not (not1)', null, false],
			['last(/host/key,1)andnot (not1)', null, false],
			['last(/host/key,1)ornot (not1)', null, false],

			['last(/host/key,1) *(not1)', null, false],
			['last(/host/key,1) /(not1)', null, false],
			['last(/host/key,1) +(not1)', null, false],
			['last(/host/key,1) -(not1)', null, false],
			['last(/host/key,1) =(not1)', null, false],
			['last(/host/key,1) <>(not1)', null, false],
			['last(/host/key,1) <(not1)', null, false],
			['last(/host/key,1) >(not1)', null, false],
			['last(/host/key,1) and(not1)', null, false],
			['last(/host/key,1) or(not1)', null, false],

			['last(/host/key,1) * not(not1)', null, false],
			['last(/host/key,1) / not(not1)', null, false],
			['last(/host/key,1) + not(not1)', null, false],
			['last(/host/key,1) - not(not1)', null, false],
			['last(/host/key,1) = not(not1)', null, false],
			['last(/host/key,1) <> not(not1)', null, false],
			['last(/host/key,1) < not(not1)', null, false],
			['last(/host/key,1) > not(not1)', null, false],
			['last(/host/key,1) and not(not1)', null, false],
			['last(/host/key,1) or not(not1)', null, false],

			['last(/host/key,1)*(not1)', null, false],
			['last(/host/key,1)/(not1)', null, false],
			['last(/host/key,1)+(not1)', null, false],
			['last(/host/key,1)-(not1)', null, false],
			['last(/host/key,1)=(not1)', null, false],
			['last(/host/key,1)<>(not1)', null, false],
			['last(/host/key,1)<(not1)', null, false],
			['last(/host/key,1)>(not1)', null, false],
			['last(/host/key,1)and(not1)', null, false],
			['last(/host/key,1)or(not1)', null, false],

			['last(/host/key,1)*not(not1)', null, false],
			['last(/host/key,1)/not(not1)', null, false],
			['last(/host/key,1)+not(not1)', null, false],
			['last(/host/key,1)-not(not1)', null, false],
			['last(/host/key,1)=not(not1)', null, false],
			['last(/host/key,1)<>not(not1)', null, false],
			['last(/host/key,1)<not(not1)', null, false],
			['last(/host/key,1)>not(not1)', null, false],
			['last(/host/key,1)andnot(not1)', null, false],
			['last(/host/key,1)ornot(not1)', null, false],

			['last(/host/key,1) * not1', null, false],
			['last(/host/key,1) / not1', null, false],
			['last(/host/key,1) + not1', null, false],
			['last(/host/key,1) - not1', null, false],
			['last(/host/key,1) = not1', null, false],
			['last(/host/key,1) <> not1', null, false],
			['last(/host/key,1) < not1', null, false],
			['last(/host/key,1) > not1', null, false],
			['last(/host/key,1) and not1', null, false],
			['last(/host/key,1) or not1', null, false],

			['last(/host/key,1) * not not1', null, false],
			['last(/host/key,1) / not not1', null, false],
			['last(/host/key,1) + not not1', null, false],
			['last(/host/key,1) - not not1', null, false],
			['last(/host/key,1) = not not1', null, false],
			['last(/host/key,1) <> not not1', null, false],
			['last(/host/key,1) < not not1', null, false],
			['last(/host/key,1) > not not1', null, false],
			['last(/host/key,1) and not not1', null, false],
			['last(/host/key,1) or not not1', null, false],

			['last(/host/key,1)* not1', null, false],
			['last(/host/key,1)/ not1', null, false],
			['last(/host/key,1)+ not1', null, false],
			['last(/host/key,1)- not1', null, false],
			['last(/host/key,1)= not1', null, false],
			['last(/host/key,1)<> not1', null, false],
			['last(/host/key,1)< not1', null, false],
			['last(/host/key,1)> not1', null, false],
			['last(/host/key,1)and not1', null, false],
			['last(/host/key,1)or not1', null, false],

			['last(/host/key,1)* not not1', null, false],
			['last(/host/key,1)/ not not1', null, false],
			['last(/host/key,1)+ not not1', null, false],
			['last(/host/key,1)- not not1', null, false],
			['last(/host/key,1)= not not1', null, false],
			['last(/host/key,1)<> not not1', null, false],
			['last(/host/key,1)< not not1', null, false],
			['last(/host/key,1)> not not1', null, false],
			['last(/host/key,1)and not not1', null, false],
			['last(/host/key,1)or not not1', null, false],

			['last(/host/key,1) *not1', null, false],
			['last(/host/key,1) /not1', null, false],
			['last(/host/key,1) +not1', null, false],
			['last(/host/key,1) -not1', null, false],
			['last(/host/key,1) =not1', null, false],
			['last(/host/key,1) <>not1', null, false],
			['last(/host/key,1) <not1', null, false],
			['last(/host/key,1) >not1', null, false],
			['last(/host/key,1) andnot1', null, false],
			['last(/host/key,1) ornot1', null, false],

			['last(/host/key,1) *notnot1', null, false],
			['last(/host/key,1) /notnot1', null, false],
			['last(/host/key,1) +notnot1', null, false],
			['last(/host/key,1) -notnot1', null, false],
			['last(/host/key,1) =notnot1', null, false],
			['last(/host/key,1) <>notnot1', null, false],
			['last(/host/key,1) <notnot1', null, false],
			['last(/host/key,1) >notnot1', null, false],
			['last(/host/key,1) andnotnot1', null, false],
			['last(/host/key,1) ornotnot1', null, false],

			['last(/host/key,1)*not1', null, false],
			['last(/host/key,1)/not1', null, false],
			['last(/host/key,1)+not1', null, false],
			['last(/host/key,1)-not1', null, false],
			['last(/host/key,1)=not1', null, false],
			['last(/host/key,1)<>not1', null, false],
			['last(/host/key,1)<not1', null, false],
			['last(/host/key,1)>not1', null, false],
			['last(/host/key,1)andnot1', null, false],
			['last(/host/key,1)ornot1', null, false],

			['last(/host/key,1)*notnot1', null, false],
			['last(/host/key,1)/notnot1', null, false],
			['last(/host/key,1)+notnot1', null, false],
			['last(/host/key,1)-notnot1', null, false],
			['last(/host/key,1)=notnot1', null, false],
			['last(/host/key,1)<>notnot1', null, false],
			['last(/host/key,1)<notnot1', null, false],
			['last(/host/key,1)>notnot1', null, false],
			['last(/host/key,1)andnotnot1', null, false],
			['last(/host/key,1)ornotnot1', null, false],

			['last(/host/key,1) * (not 1)', null, true],
			['last(/host/key,1) / (not 1)', null, true],
			['last(/host/key,1) + (not 1)', null, true],
			['last(/host/key,1) - (not 1)', null, true],
			['last(/host/key,1) = (not 1)', null, true],
			['last(/host/key,1) <> (not 1)', null, true],
			['last(/host/key,1) < (not 1)', null, true],
			['last(/host/key,1) > (not 1)', null, true],
			['last(/host/key,1) and (not 1)', null, true],
			['last(/host/key,1) or (not 1)', null, true],

			['last(/host/key,1) * not (not 1)', null, true],
			['last(/host/key,1) / not (not 1)', null, true],
			['last(/host/key,1) + not (not 1)', null, true],
			['last(/host/key,1) - not (not 1)', null, true],
			['last(/host/key,1) = not (not 1)', null, true],
			['last(/host/key,1) <> not (not 1)', null, true],
			['last(/host/key,1) < not (not 1)', null, true],
			['last(/host/key,1) > not (not 1)', null, true],
			['last(/host/key,1) and not (not 1)', null, true],
			['last(/host/key,1) or not (not 1)', null, true],

			['last(/host/key,1)* (not 1)', null, true],
			['last(/host/key,1)/ (not 1)', null, true],
			['last(/host/key,1)+ (not 1)', null, true],
			['last(/host/key,1)- (not 1)', null, true],
			['last(/host/key,1)= (not 1)', null, true],
			['last(/host/key,1)<> (not 1)', null, true],
			['last(/host/key,1)< (not 1)', null, true],
			['last(/host/key,1)> (not 1)', null, true],
			['last(/host/key,1)and (not 1)', null, false],
			['last(/host/key,1)or (not 1)', null, false],

			['last(/host/key,1)* not (not 1)', null, true],
			['last(/host/key,1)/ not (not 1)', null, true],
			['last(/host/key,1)+ not (not 1)', null, true],
			['last(/host/key,1)- not (not 1)', null, true],
			['last(/host/key,1)= not (not 1)', null, true],
			['last(/host/key,1)<> not (not 1)', null, true],
			['last(/host/key,1)< not (not 1)', null, true],
			['last(/host/key,1)> not (not 1)', null, true],
			['last(/host/key,1)and not (not 1)', null, false],
			['last(/host/key,1)or not (not 1)', null, false],

			['last(/host/key,1) *(not 1)', null, true],
			['last(/host/key,1) /(not 1)', null, true],
			['last(/host/key,1) +(not 1)', null, true],
			['last(/host/key,1) -(not 1)', null, true],
			['last(/host/key,1) =(not 1)', null, true],
			['last(/host/key,1) <>(not 1)', null, true],
			['last(/host/key,1) <(not 1)', null, true],
			['last(/host/key,1) >(not 1)', null, true],
			['last(/host/key,1) and(not 1)', null, true],
			['last(/host/key,1) or(not 1)', null, true],

			['last(/host/key,1) *not(not 1)', null, false],
			['last(/host/key,1) /not(not 1)', null, false],
			['last(/host/key,1) +not(not 1)', null, false],
			['last(/host/key,1) -not(not 1)', null, false],
			['last(/host/key,1) =not(not 1)', null, false],
			['last(/host/key,1) <>not(not 1)', null, false],
			['last(/host/key,1) <not(not 1)', null, false],
			['last(/host/key,1) >not(not 1)', null, false],
			['last(/host/key,1) andnot(not 1)', null, false],
			['last(/host/key,1) ornot(not 1)', null, false],

			['last(/host/key,1)*(not 1)', null, true],
			['last(/host/key,1)/(not 1)', null, true],
			['last(/host/key,1)+(not 1)', null, true],
			['last(/host/key,1)-(not 1)', null, true],
			['last(/host/key,1)=(not 1)', null, true],
			['last(/host/key,1)<>(not 1)', null, true],
			['last(/host/key,1)<(not 1)', null, true],
			['last(/host/key,1)>(not 1)', null, true],
			['last(/host/key,1)and(not 1)', null, false],
			['last(/host/key,1)or(not 1)', null, false],

			['last(/host/key,1)*not(not 1)', null, false],
			['last(/host/key,1)/not(not 1)', null, false],
			['last(/host/key,1)+not(not 1)', null, false],
			['last(/host/key,1)-not(not 1)', null, false],
			['last(/host/key,1)=not(not 1)', null, false],
			['last(/host/key,1)<>not(not 1)', null, false],
			['last(/host/key,1)<not(not 1)', null, false],
			['last(/host/key,1)>not(not 1)', null, false],
			['last(/host/key,1)andnot(not 1)', null, false],
			['last(/host/key,1)ornot(not 1)', null, false],

			['last(/host/key,1) * not 1', null, true],
			['last(/host/key,1) / not 1', null, true],
			['last(/host/key,1) + not 1', null, true],
			['last(/host/key,1) - not 1', null, true],
			['last(/host/key,1) = not 1', null, true],
			['last(/host/key,1) <> not 1', null, true],
			['last(/host/key,1) < not 1', null, true],
			['last(/host/key,1) > not 1', null, true],
			['last(/host/key,1) and not 1', null, true],
			['last(/host/key,1) or not 1', null, true],

			['last(/host/key,1) * not not 1', null, false],
			['last(/host/key,1) / not not 1', null, false],
			['last(/host/key,1) + not not 1', null, false],
			['last(/host/key,1) - not not 1', null, false],
			['last(/host/key,1) = not not 1', null, false],
			['last(/host/key,1) <> not not 1', null, false],
			['last(/host/key,1) < not not 1', null, false],
			['last(/host/key,1) > not not 1', null, false],
			['last(/host/key,1) and not not 1', null, false],
			['last(/host/key,1) or not not 1', null, false],

			['last(/host/key,1)* not 1', null, true],
			['last(/host/key,1)/ not 1', null, true],
			['last(/host/key,1)+ not 1', null, true],
			['last(/host/key,1)- not 1', null, true],
			['last(/host/key,1)= not 1', null, true],
			['last(/host/key,1)<> not 1', null, true],
			['last(/host/key,1)< not 1', null, true],
			['last(/host/key,1)> not 1', null, true],
			['last(/host/key,1)and not 1', null, false],
			['last(/host/key,1)or not 1', null, false],

			['last(/host/key,1)* not not 1', null, false],
			['last(/host/key,1)/ not not 1', null, false],
			['last(/host/key,1)+ not not 1', null, false],
			['last(/host/key,1)- not not 1', null, false],
			['last(/host/key,1)= not not 1', null, false],
			['last(/host/key,1)<> not not 1', null, false],
			['last(/host/key,1)< not not 1', null, false],
			['last(/host/key,1)> not not 1', null, false],
			['last(/host/key,1)and not not 1', null, false],
			['last(/host/key,1)or not not 1', null, false],

			['last(/host/key,1) *not 1', null, false],
			['last(/host/key,1) /not 1', null, false],
			['last(/host/key,1) +not 1', null, false],
			['last(/host/key,1) -not 1', null, false],
			['last(/host/key,1) =not 1', null, false],
			['last(/host/key,1) <>not 1', null, false],
			['last(/host/key,1) <not 1', null, false],
			['last(/host/key,1) >not 1', null, false],
			['last(/host/key,1) andnot 1', null, false],
			['last(/host/key,1) ornot 1', null, false],

			['last(/host/key,1) * notnot 1', null, false],
			['last(/host/key,1) / notnot 1', null, false],
			['last(/host/key,1) + notnot 1', null, false],
			['last(/host/key,1) - notnot 1', null, false],
			['last(/host/key,1) = notnot 1', null, false],
			['last(/host/key,1) <> notnot 1', null, false],
			['last(/host/key,1) < notnot 1', null, false],
			['last(/host/key,1) > notnot 1', null, false],
			['last(/host/key,1) and notnot 1', null, false],
			['last(/host/key,1) or notnot 1', null, false],

			['last(/host/key,1)*not 1', null, false],
			['last(/host/key,1)/not 1', null, false],
			['last(/host/key,1)+not 1', null, false],
			['last(/host/key,1)-not 1', null, false],
			['last(/host/key,1)=not 1', null, false],
			['last(/host/key,1)<>not 1', null, false],
			['last(/host/key,1)<not 1', null, false],
			['last(/host/key,1)>not 1', null, false],
			['last(/host/key,1)andnot 1', null, false],
			['last(/host/key,1)ornot 1', null, false],

			['last(/host/key,1)*notnot 1', null, false],
			['last(/host/key,1)/notnot 1', null, false],
			['last(/host/key,1)+notnot 1', null, false],
			['last(/host/key,1)-notnot 1', null, false],
			['last(/host/key,1)=notnot 1', null, false],
			['last(/host/key,1)<>notnot 1', null, false],
			['last(/host/key,1)<notnot 1', null, false],
			['last(/host/key,1)>notnot 1', null, false],
			['last(/host/key,1)andnotnot 1', null, false],
			['last(/host/key,1)ornotnot 1', null, false],

			['last(/host/key,1) *not 1', null, false],
			['last(/host/key,1) /not 1', null, false],
			['last(/host/key,1) +not 1', null, false],
			['last(/host/key,1) -not 1', null, false],
			['last(/host/key,1) =not 1', null, false],
			['last(/host/key,1) <>not 1', null, false],
			['last(/host/key,1) <not 1', null, false],
			['last(/host/key,1) >not 1', null, false],
			['last(/host/key,1) andnot 1', null, false],
			['last(/host/key,1) ornot 1', null, false],

			['last(/host/key) + 1', null, true],
			['last(/host/key) - 1', null, true],
			['last(/host/key) / 1', null, true],
			['last(/host/key) * 1', null, true],
			['last(/host/key) = 1', null, true],
			['last(/host/key) <> 1', null, true],
			['last(/host/key) and 1', null, true],
			['last(/host/key) or 1', null, true],

			['last(/host/key) + not 1', null, true],
			['last(/host/key) - not 1', null, true],
			['last(/host/key) / not 1', null, true],
			['last(/host/key) * not 1', null, true],
			['last(/host/key) = not 1', null, true],
			['last(/host/key) <> not 1', null, true],
			['last(/host/key) and not 1', null, true],
			['last(/host/key) or not 1', null, true],

			['last(/host/key)+ 1', null, true],
			['last(/host/key)- 1', null, true],
			['last(/host/key)/ 1', null, true],
			['last(/host/key)* 1', null, true],
			['last(/host/key)= 1', null, true],
			['last(/host/key)<> 1', null, true],
			['last(/host/key)and 1', null, false],
			['last(/host/key)or 1', null, false],

			['last(/host/key)+ not 1', null, true],
			['last(/host/key)- not 1', null, true],
			['last(/host/key)/ not 1', null, true],
			['last(/host/key)* not 1', null, true],
			['last(/host/key)= not 1', null, true],
			['last(/host/key)<> not 1', null, true],
			['last(/host/key)and not 1', null, false],
			['last(/host/key)or not 1', null, false],

			['last(/host/key) +1', null, true],
			['last(/host/key) -1', null, true],
			['last(/host/key) /1', null, true],
			['last(/host/key) *1', null, true],
			['last(/host/key) =1', null, true],
			['last(/host/key) <>1', null, true],
			['last(/host/key) and1', null, false],
			['last(/host/key) or1', null, false],

			['last(/host/key) + not1', null, false],
			['last(/host/key) - not1', null, false],
			['last(/host/key) / not1', null, false],
			['last(/host/key) * not1', null, false],
			['last(/host/key) = not1', null, false],
			['last(/host/key) <> not1', null, false],
			['last(/host/key) and not1', null, false],
			['last(/host/key) or not1', null, false],

			['last(/host/key)+1', null, true],
			['last(/host/key)-1', null, true],
			['last(/host/key)/1', null, true],
			['last(/host/key)*1', null, true],
			['last(/host/key)=1', null, true],
			['last(/host/key)<>1', null, true],
			['last(/host/key)and1', null, false],
			['last(/host/key)or1', null, false],

			['last(/host/key)+not1', null, false],
			['last(/host/key)-not1', null, false],
			['last(/host/key)/not1', null, false],
			['last(/host/key)*not1', null, false],
			['last(/host/key)=not1', null, false],
			['last(/host/key)<>not1', null, false],
			['last(/host/key)andnot1', null, false],
			['last(/host/key)ornot1', null, false],

			// unary operators before binary operators
			['last(/host/key) -* 1', null, false],
			['last(/host/key) -- 1', null, true],
			['last(/host/key) -/ 1', null, false],
			['last(/host/key) -* 1', null, false],
			['last(/host/key) -= 1', null, false],
			['last(/host/key) -<> 1', null, false],
			['last(/host/key) -and 1', null, false],
			['last(/host/key) -or 1', null, false],

			['last(/host/key)-* 1', null, false],
			['last(/host/key)-- 1', null, true],
			['last(/host/key)-/ 1', null, false],
			['last(/host/key)-* 1', null, false],
			['last(/host/key)-= 1', null, false],
			['last(/host/key)-<> 1', null, false],
			['last(/host/key)-and 1', null, false],
			['last(/host/key)-or 1', null, false],

			['last(/host/key) -*1', null, false],
			['last(/host/key) --1', null, true],
			['last(/host/key) -/1', null, false],
			['last(/host/key) -*1', null, false],
			['last(/host/key) -=1', null, false],
			['last(/host/key) -<>1', null, false],
			['last(/host/key) -and1', null, false],
			['last(/host/key) -or1', null, false],

			['last(/host/key)-*1', null, false],
			['last(/host/key)--1', null, true],
			['last(/host/key)-/1', null, false],
			['last(/host/key)-*1', null, false],
			['last(/host/key)-=1', null, false],
			['last(/host/key)-<>1', null, false],
			['last(/host/key)-and1', null, false],
			['last(/host/key)-or1', null, false],

			['last(/host/key) not* 1', null, false],
			['last(/host/key) not- 1', null, false],
			['last(/host/key) not/ 1', null, false],
			['last(/host/key) not* 1', null, false],
			['last(/host/key) not= 1', null, false],
			['last(/host/key) not<> 1', null, false],
			['last(/host/key) notand 1', null, false],
			['last(/host/key) notor 1', null, false],

			['last(/host/key)not* 1', null, false],
			['last(/host/key)not- 1', null, false],
			['last(/host/key)not/ 1', null, false],
			['last(/host/key)not* 1', null, false],
			['last(/host/key)not= 1', null, false],
			['last(/host/key)not<> 1', null, false],
			['last(/host/key)notand 1', null, false],
			['last(/host/key)notor 1', null, false],

			['last(/host/key) not*1', null, false],
			['last(/host/key) not-1', null, false],
			['last(/host/key) not/1', null, false],
			['last(/host/key) not*1', null, false],
			['last(/host/key) not=1', null, false],
			['last(/host/key) not<>1', null, false],
			['last(/host/key) notand1', null, false],
			['last(/host/key) notor1', null, false],

			['last(/host/key)-*1', null, false],
			['last(/host/key)--1', null, true],
			['last(/host/key)-/1', null, false],
			['last(/host/key)-*1', null, false],
			['last(/host/key)-=1', null, false],
			['last(/host/key)-<>1', null, false],
			['last(/host/key)-and1', null, false],
			['last(/host/key)-or1', null, false],

			// suffixes
			['last(/host/key)=1K', null, true],
			['last(/host/key)=1M', null, true],
			['last(/host/key)=1G', null, true],
			['last(/host/key)=1T', null, true],
			['last(/host/key)=1s', null, true],
			['last(/host/key)=1m', null, true],
			['last(/host/key)=1h', null, true],
			['last(/host/key)=1d', null, true],
			['last(/host/key)=1w', null, true],

			['last(/host/key)=1.56K', null, true],
			['last(/host/key)=1.56M', null, true],
			['last(/host/key)=1.56G', null, true],
			['last(/host/key)=1.56T', null, true],
			['last(/host/key)=1.56s', null, true],
			['last(/host/key)=1.56m', null, true],
			['last(/host/key)=1.56h', null, true],
			['last(/host/key)=1.56d', null, true],
			['last(/host/key)=1.56w', null, true],

			// text operators after suffixes
			['last(/host/key)=1K and 1', null, true],
			['last(/host/key)=1M and 1', null, true],
			['last(/host/key)=1G and 1', null, true],
			['last(/host/key)=1T and 1', null, true],
			['last(/host/key)=1s and 1', null, true],
			['last(/host/key)=1m and 1', null, true],
			['last(/host/key)=1h and 1', null, true],
			['last(/host/key)=1d and 1', null, true],
			['last(/host/key)=1w and 1', null, true],

			['last(/host/key)=1Kand 1', null, false],
			['last(/host/key)=1Mand 1', null, false],
			['last(/host/key)=1Gand 1', null, false],
			['last(/host/key)=1Tand 1', null, false],
			['last(/host/key)=1sand 1', null, false],
			['last(/host/key)=1mand 1', null, false],
			['last(/host/key)=1hand 1', null, false],
			['last(/host/key)=1dand 1', null, false],
			['last(/host/key)=1wand 1', null, false],

			['last(/host/key)=1.56K and 1', null, true],
			['last(/host/key)=1.56M and 1', null, true],
			['last(/host/key)=1.56G and 1', null, true],
			['last(/host/key)=1.56T and 1', null, true],
			['last(/host/key)=1.56s and 1', null, true],
			['last(/host/key)=1.56m and 1', null, true],
			['last(/host/key)=1.56h and 1', null, true],
			['last(/host/key)=1.56d and 1', null, true],
			['last(/host/key)=1.56w and 1', null, true],

			['last(/host/key)=1.56Kand 1', null, false],
			['last(/host/key)=1.56Mand 1', null, false],
			['last(/host/key)=1.56Gand 1', null, false],
			['last(/host/key)=1.56Tand 1', null, false],
			['last(/host/key)=1.56sand 1', null, false],
			['last(/host/key)=1.56mand 1', null, false],
			['last(/host/key)=1.56hand 1', null, false],
			['last(/host/key)=1.56dand 1', null, false],
			['last(/host/key)=1.56wand 1', null, false],

			['last(/host/key)=1K or 1', null, true],
			['last(/host/key)=1M or 1', null, true],
			['last(/host/key)=1G or 1', null, true],
			['last(/host/key)=1T or 1', null, true],
			['last(/host/key)=1s or 1', null, true],
			['last(/host/key)=1m or 1', null, true],
			['last(/host/key)=1h or 1', null, true],
			['last(/host/key)=1d or 1', null, true],
			['last(/host/key)=1w or 1', null, true],

			['last(/host/key)=1Kor 1', null, false],
			['last(/host/key)=1Mor 1', null, false],
			['last(/host/key)=1Gor 1', null, false],
			['last(/host/key)=1Tor 1', null, false],
			['last(/host/key)=1sor 1', null, false],
			['last(/host/key)=1mor 1', null, false],
			['last(/host/key)=1hor 1', null, false],
			['last(/host/key)=1dor 1', null, false],
			['last(/host/key)=1wor 1', null, false],

			['last(/host/key)=1.56K or 1', null, true],
			['last(/host/key)=1.56M or 1', null, true],
			['last(/host/key)=1.56G or 1', null, true],
			['last(/host/key)=1.56T or 1', null, true],
			['last(/host/key)=1.56s or 1', null, true],
			['last(/host/key)=1.56m or 1', null, true],
			['last(/host/key)=1.56h or 1', null, true],
			['last(/host/key)=1.56d or 1', null, true],
			['last(/host/key)=1.56w or 1', null, true],

			['last(/host/key)=1.56Kor 1', null, false],
			['last(/host/key)=1.56Mor 1', null, false],
			['last(/host/key)=1.56Gor 1', null, false],
			['last(/host/key)=1.56Tor 1', null, false],
			['last(/host/key)=1.56sor 1', null, false],
			['last(/host/key)=1.56mor 1', null, false],
			['last(/host/key)=1.56hor 1', null, false],
			['last(/host/key)=1.56dor 1', null, false],
			['last(/host/key)=1.56wor 1', null, false],

			['last(/host/key) + 1.173640', null, true],
			['last(/host/key) - 1.173640', null, true],
			['last(/host/key) / 1.173640', null, true],
			['last(/host/key) * 1.173640', null, true],
			['last(/host/key) = 1.173640', null, true],
			['last(/host/key) <> 1.173640', null, true],
			['last(/host/key) and 1.173640', null, true],
			['last(/host/key) or 1.173640', null, true],

			['last(/host/key)+ 1.173640', null, true],
			['last(/host/key)- 1.173640', null, true],
			['last(/host/key)/ 1.173640', null, true],
			['last(/host/key)* 1.173640', null, true],
			['last(/host/key)= 1.173640', null, true],
			['last(/host/key)<> 1.173640', null, true],
			['last(/host/key)and 1.173640', null, false],
			['last(/host/key)or 1.173640', null, false],

			['last(/host/key) +1.173640', null, true],
			['last(/host/key) -1.173640', null, true],
			['last(/host/key) /1.173640', null, true],
			['last(/host/key) *1.173640', null, true],
			['last(/host/key) =1.173640', null, true],
			['last(/host/key) <>1.173640', null, true],
			['last(/host/key) and1.173640', null, false],
			['last(/host/key) or1.173640', null, false],

			['last(/host/key)+1.173640', null, true],
			['last(/host/key)-1.173640', null, true],
			['last(/host/key)/1.173640', null, true],
			['last(/host/key)*1.173640', null, true],
			['last(/host/key)=1.173640', null, true],
			['last(/host/key)<>1.173640', null, true],
			['last(/host/key)and1.173640', null, false],
			['last(/host/key)or1.173640', null, false],

			['last(/host/key) + 1 or last(/host/key)', null, true],
			['last(/host/key) - 1 and last(/host/key)', null, true],
			['last(/host/key) / 1 <> last(/host/key)', null, true],
			['last(/host/key) * 1 = last(/host/key)', null, true],
			['last(/host/key) = 1 * last(/host/key)', null, true],
			['last(/host/key) <> 1 / last(/host/key)', null, true],
			['last(/host/key) and 1 - last(/host/key)', null, true],
			['last(/host/key) or 1 + last(/host/key)', null, true],

			['last(/host/key) + not 1 or last(/host/key)', null, true],
			['last(/host/key) - not 1 and last(/host/key)', null, true],
			['last(/host/key) / not 1 <> last(/host/key)', null, true],
			['last(/host/key) * not 1 = last(/host/key)', null, true],
			['last(/host/key) = not 1 * last(/host/key)', null, true],
			['last(/host/key) <> not 1 / last(/host/key)', null, true],
			['last(/host/key) and not 1 - last(/host/key)', null, true],
			['last(/host/key) or not 1 + last(/host/key)', null, true],

			['last(/host/key) + 1 or not last(/host/key)', null, true],
			['last(/host/key) - 1 and not last(/host/key)', null, true],
			['last(/host/key) / 1 <> not last(/host/key)', null, true],
			['last(/host/key) * 1 = not last(/host/key)', null, true],
			['last(/host/key) = 1 * not last(/host/key)', null, true],
			['last(/host/key) <> 1 / not last(/host/key)', null, true],
			['last(/host/key) and 1 - not last(/host/key)', null, true],
			['last(/host/key) or 1 + not last(/host/key)', null, true],

			['last(/host/key) -- 1', null, true],
			['last(/host/key) ++ 1', null, false],
			['last(/host/key) // 1', null, false],
			['last(/host/key) ** 1', null, false],
			['last(/host/key) == 1', null, false],
			['last(/host/key) <><> 1', null, false],
			['last(/host/key) andand 1', null, false],
			['last(/host/key) oror 1', null, false],

			['last(/host/key) +', null, false],
			['last(/host/key) -', null, false],
			['last(/host/key) /', null, false],
			['last(/host/key) *', null, false],
			['last(/host/key) =', null, false],
			['last(/host/key) <>', null, false],
			['last(/host/key) and', null, false],
			['last(/host/key) or', null, false],
			['last(/host/key) not', null, false],

			['last(/host/key) + not', null, false],
			['last(/host/key) - not', null, false],
			['last(/host/key) / not', null, false],
			['last(/host/key) * not', null, false],
			['last(/host/key) = not', null, false],
			['last(/host/key) <> not', null, false],
			['last(/host/key) and not', null, false],
			['last(/host/key) or not', null, false],

			['- last(/host/key)', null, true],
			['+ last(/host/key)', null, false],
			['/ last(/host/key)', null, false],
			['* last(/host/key)', null, false],
			['= last(/host/key)', null, false],
			['<> last(/host/key)', null, false],
			['and last(/host/key)', null, false],
			['or last(/host/key)', null, false],

			['not - last(/host/key)', null, true],
			['not + last(/host/key)', null, false],
			['not / last(/host/key)', null, false],
			['not * last(/host/key)', null, false],
			['not = last(/host/key)', null, false],
			['not <> last(/host/key)', null, false],
			['not and last(/host/key)', null, false],
			['not or last(/host/key)', null, false],

			['- not last(/host/key)', null, false],
			['+ not last(/host/key)', null, false],
			['/ not last(/host/key)', null, false],
			['* not last(/host/key)', null, false],
			['= not last(/host/key)', null, false],
			['<> not last(/host/key)', null, false],
			['and not last(/host/key)', null, false],
			['or not last(/host/key)', null, false],

			// abs (expr)
			['abs(last(/host/item,#1)-last(/host/item,#2)) > 0', null, true],

			// avg, min, max, sum (item, period OR expr1, ..., exprN)
			['avg(/host/item,#5) > 0', null, true],
			['avg(/host/item,30s) > 0', null, true],
			['avg(/host/item,10m) > 0', null, true],
			['avg(/host/item,1h) > 0', null, true],
			['avg(/host/item,#5:now-1d) > 0', null, true],
			['avg(/host/item,30m:now-1d) > 0', null, true],
			['avg(/host/item,1h:now/1h) > 0', null, true],
			['min(/host/item,30m) > 0', null, true],
			['max(/host/item,30m) > 0', null, true],
			['sum(/host/item,30m) > 0', null, true],
			['sum(/host/item,60s) > 0', null, true],
			['sum(/host/item,60s:now-3600s) > 0', null, true],
			['sum(/host/item,1m:now-1h) > 0', null, true],

			['min(min(/host/key,1h),min(/host/key,1h),25)', null, true],
			['min(min(/host/key,1h),avg(/host/key,1h),25)', null, true],
			['min(min(/host/key,1h),avg(/host/key,1h)*100,25)', null, true],
			['min(min(/host1/key1,1h),min(/host2/key2,1h))', null, true],

			// band (item, period, mask)
			['band(/host/item,#1,32) > 0', null, true],
			['band(/host/item,#2:now-1h,64) > 0', null, true],

			// count (item, period, <operator>, <pattern>)
			['count(/host/item,#1,"eq","0") > 0', null, true],
			['count(/host/item,5m:now-2h,"regexp","xyz") > 0', null, true],
			['count(/host/item,5m:now-1h,"iregexp","10") > 0', null, true],
			['count(/host/item,5m:now-2d,"gt",100) > 0', null, true],
			['count(/host/item,1m,"band",32) > 0', null, true],

			// date, dateofmonth, dayofweek, now, time ()
			['date() > 0', null, true],
			['dayofmonth() > 0', null, true],
			['dayofweek() > 0', null, true],
			['now() > 0', null, true],
			['time() > 0', null, true],

			// forecast (item, period, time, <fit>, <mode>)
			['forecast(/host/item,#10,100s) > 0', null, true],
			['forecast(/host/item,3600s:now-7200s,600s,"linear","avg") > 0', null, true],
			['forecast(/host/item,30m:now-1d,600s,,"avg") > 0', null, true],

			// fuzzytime (item, period)
			['fuzzytime(/host/item,60s) > 0', null, true],

			// find (item, period, <operator>, <pattern>)
			['find(host/key,#10,"iregexp","^error") > 0', null, true],
			['find(/host/key,60s,"iregexp","^critical") > 0', null, true],
			['find(/host/key,5m,"iregexp","^warning") > 0', null, true],

			// last (item, period)
			['last(/host/key) > 0', null, true],
			['last(/host/key,#5) > 0', null, true],
			['last(/host/key,#10:now-3600s) > 0', null, true],
			['last(/host/key,#1:now-1d) > 0', null, true],
			['last(/host/vfs.fs.size[/,pfree])<10', null, true],
			['last(/host/vfs.fs.size["/var/log",pfree])<10', null, true],

			// length (expr)
			['length(last(/host/key,30m)) > 0', null, true],
			['length(last(/host/key,60s)) > 0', null, true],
			['length(last(/host/key,#10)) > 0', null, true],
			['length(last(/host/key,60s:now-3600s)) > 0', null, true],
			['length(last(/host/key,1m:now-1h)) > 0', null, true],

			// logeventid (item, <pattern>)
			['logeventid(/host/key,"^error") > 0', null, true],

			// logseverity (item)
			['logseverity(/host/key) > 0', null, true],

			// logsource (item, <pattern>)
			['logsource(/host/item,"^system$") > 0', null, true],

			// nodata (item, period)
			['nodata(/host/item,60s) > 0', null, true],
			['nodata(/host/item,5m) > 0', null, true],

			// percentile (item, period, percentage)
			['percentile(/host/key,30m,50) > 0', null, true],
			['percentile(/host/key,60s,60) > 0', null, true],
			['percentile(/host/key,#10,70) > 0', null, true],
			['percentile(/host/key,60s:now-3600s,80) > 0', null, true],
			['percentile(/host/key,1m:now-1h,90) > 0', null, true],

			// timeleft (item, period, time, threshold, <fit>)
			['timeleft(/host/key,#10,100) > 0', null, true],
			['timeleft(/host/key,3600s:now-7200s,600,"linear") > 0', null, true],
			['timeleft(/host/key,30m:now-1d,600) > 0', null, true],

			// trendavg, trendcount, trendmax, trendmin, trendsum (item, period)
			['trendavg(/host/item,1h:now/h-1d) > 0', null, true],
			['trendavg(/host/key,1M:now/M) > 1.2*trendavg(/host/key,1M:now/M-1y)', null, true],
			['trendcount(/host/item,1h:now/h-1d) > 0', null, true],
			['trendmax(/host/item,1h:now/h-1d) > 0', null, true],
			['trendmin(/host/item,1h:now/h-1d) > 0', null, true],
			['trendsum(/host/item,1h:now/h-1d) > 0', null, true],

			['last(/host/key)=0', null, true],
			['count(/host/key,1,)', null, true],
			['count(/host/key, 1,)=0', null, true],
			['count(/host/key,  1,)=0', null, true],
			['count(/host/key,1, )=0', null, true],
			['count(/host/key,1,  )=0', null, true],

			['find(/host/key,,"like",")=0', null, false],
			['find(/host/key,,"like","")=0', null, true],
			['find(/host/key,,"like",""")=0', null, false],
			['find(/host/key,,"like","""")=0', null, false],

			['find(/host/key,,"like", ")=0', null, false],
			['find(/host/key,,"like", "")=0', null, true],
			['find(/host/key,,"like", """)=0', null, false],
			['find(/host/key,,"like", """")=0', null, false],

			['find(/host/key,,"like",  ")=0', null, false],
			['find(/host/key,,"like",  "")=0', null, true],
			['find(/host/key,,"like",  """)=0', null, false],
			['find(/host/key,,"like",  """")=0', null, false],

			['count(/host/key,1,")=0', null, false],
			['count(/host/key,1,"")=0', null, true],
			['count(/host/key,1,""")=0', null, true],
			['count(/host/key,1,"""")=0', null, true],

			['count(/host/key,1, ")=0', null, false],
			['count(/host/key,1, "")=0', null, true],
			['count(/host/key,1, """)=0', null, true],
			['count(/host/key,1, """")=0', null, true],

			['count(/host/key,1,  ")=0', null, false],
			['count(/host/key,1,  "")=0', null, true],
			['count(/host/key,1,  """)=0', null, true],
			['count(/host/key,1,  """")=0', null, true],

			['count(/host/key,1,"",")=0', null, false],
			['count(/host/key,1,"","")=0', null, true],
			['count(/host/key,1,"",""")=0', null, false],
			['count(/host/key,1,"","""")=0', null, false],

			['count(/host/key,1,"", ")=0', null, false],
			['count(/host/key,1,"", "")=0', null, true],
			['count(/host/key,1,"", """)=0', null, false],
			['count(/host/key,1,"", """")=0', null, false],

			['count(/host/key,1,"",  ")=0', null, false],
			['count(/host/key,1,"",  "")=0', null, true],
			['count(/host/key,1,"",  """)=0', null, false],
			['count(/host/key,1,"",  """")=0', null, false],

			['find(/host/key,,"like","\")=0', null, false],
			['find(/host/key,,"like","\"")=0', null, true],
			['find(/host/key,,"like","\\\\"")=0', null, true],
			['find(/host/key,,"like","\")=0', null, false],
			['find(/host/key,,"like","\""")=0', null, false],
			['find(/host/key,,"like","\"""")=0', null, false],

			['find(/host/key,,"like",\")=0', null, true],
			['find(/host/key,,"like",param\")=0', null, true],
			['find(/host/key,,"like",param")=0', null, true],

			['find(/host/key,,"like", \")=0', null, true],
			['find(/host/key,,"like", param\")=0', null, true],
			['find(/host/key,,"like", param")=0', null, true],

			['find(/host/key,,"like",  \")=0', null, true],
			['find(/host/key,,"like",  param\")=0', null, true],
			['find(/host/key,,"like",  param")=0', null, true],

			['find(/host/key,,"like",()=0', null, true],
			['find(/host/key,,"like",param()=0', null, true],

			['find(/host/key,,"like", ()=0', null, true],
			['find(/host/key,,"like", param()=0', null, true],

			['find(/host/key,,"like",  ()=0', null, true],
			['find(/host/key,,"like",  param()=0', null, true],

			['find(/host/key,,"like",))=0', null, true],
			['find(/host/key,,"like",param))=0', null, true],

			['find(/host/key,,"like", ))=0', null, true],
			['find(/host/key,,"like", param))=0', null, true],

			['find(/host/key,,"like",  ))=0', null, true],
			['find(/host/key,,"like",  param))=0', null, true],

			['find(/host/key,,"like","(")=0', null, true],
			['find(/host/key,,"like","param(")=0', null, true],

			['find(/host/key,,"like",")")=0', null, true],
			['find(/host/key,,"like","param)")=0', null, true],

			['find(/host/key,,"like",)=0', null, true],
			['find(/host/key,,"like", )=0', null, true],
			['find(/host/key,,"like"," ")=0', null, true],
			['find(/host/key,,"like",abc)=0', null, true],
			['find(/host/key,,"like",\'abc\')=0', null, true],
			['find(/host/key,,"like","")=0', null, true],

			['last(/host/key,0)=0', null, true],
			['(find(/hostA/keyA,"abc")=0) or (last(/hostB/keyB,123)=0)', null, true],
			['find(/host/key[asd[],aaa()=0', null, true],
			['find(/host/key[asd[,asd[,[]],aaa()=0', null, true],
			['find(/host/key[[],[],[]])', null, true],

			['last(/hostkey,0)=0', null, false],
			['last(host/key,0)=0', null, false],
			['last(/host/key,0)=', null, false],
			['last(/host/key,0)<>0', null, true],

			['(find(/hostA/keyA,"abc")=0) oror (last(/hostB/keyB,123)=0)', null, true],
			[
				'(last(/host1/key1,0)/last(/host2/key2,#5))/10+2*{TRIGGER.VALUE} and {$USERMACRO1}+(-{$USERMACRO2})+'.
					'-{$USERMACRO3}*-12K+12.5m',
				[
					'error' => '',
					'expressions' => [
						0 => [
							'expression' => 'last(/host1/key1,0)',
							'pos'=> 1,
							'host' => 'host1',
							'item' => 'key1',
							'function' => 'last',
							'functionName' => 'last',
							'functionParam' => '/host1/key1,0',
							'functionParamList' => ['/host1/key1', '0']
						],
						1 => [
							'expression' => 'last(/host2/key2,#5)',
							'pos'=> 21,
							'host' => 'host2',
							'item' => 'key2',
							'function' => 'last',
							'functionName' => 'last',
							'functionParam' => '/host2/key2,#5',
							'functionParamList' => ['/host2/key2', '#5']
						]
					]
				],
				true
			],
			['last(/host/key,1.23)', null, true],
			['last(/host/key,1.23s)', null, true],
			['date()', null, true],
			['date(0)', null, true],
			['date(0,)', null, true],
			['dayofweek()', null, true],
			['dayofweek(0)', null, true],
			['dayofweek(0,)', null, true],
			['last(/host/key)', null, true],
			['last(/host/key,0)', null, true],
			['last(/host/key,#123)', null, true],
			[
				'max(/host/key,123)',
				[
					'error' => '',
					'expressions' => [
						0 => [
							'expression' => 'max(/host/key,123)',
							'pos' => 0,
							'host' => 'host',
							'item' => 'key',
							'function' => 'max(123)',
							'functionName' => 'max',
							'functionParam' => '/host/key,123',
							'functionParamList' => ['/host/key,', '123']
						]
					]
				],
				true
			],
			['now()', null, true],
			['now(0)', null, true],
			['now(0,)', null, true],
			['(--({host:key.last(0)}+K))', null, false],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5)+-(-1)+{TRIGGER',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5)+-(-1)+{TRIGGE',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5)+-(-1)+{TRIGG',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5)+-(-1)+{TRIG',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5)+-(-1)+{TRI',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5)+-(-1)+{TR',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5)+-(-1)+{T',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5)+-(-1)+{',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5)+-(-1)+',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5)+-(-1)',
				null,
				true
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5)+-(-1',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5)+-(-',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5)+-(',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5)+-',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5)+',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5)',
				null,
				true
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-5',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4-',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(4',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+(',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)+',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3)',
				null,
				true
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(3',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -(',
				null,
				false
			],
			[
				'func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and -',
				null,
				false
			],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and ', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m and', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m an', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m a ', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m ', null, true],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9m', null, true],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=9', null, true],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8=', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>8', null, true],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<>', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7<', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<7', null, true],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6<', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>6', null, true],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5>', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and 5', null, true],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and ', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 and', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 an', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 a', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4 ', null, true],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or 4', null, true],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or ', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 or', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 o', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3 ', null, true],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+3', null, true],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2+', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-2', null, true],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1-', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/1', null, true],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0/', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*0', null, true],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )*', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" )', null, true],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"" ', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\""', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\"', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4\\', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p4', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "p', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", "', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3", ', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3",', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3"', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p3', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"p', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,"', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ,', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2 ', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p2', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, p', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1, ', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1,', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p1', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], p', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ], ', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ],', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ]', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"" ', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\""', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\"', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4\\', null, false],
			['func(/host/key[p1, p2 ,"p3", "p4', null, false],
			['func(/host/key[p1, p2 ,"p3", "p', null, false],
			['func(/host/key[p1, p2 ,"p3", "', null, false],
			['func(/host/key[p1, p2 ,"p3", ', null, false],
			['func(/host/key[p1, p2 ,"p3",', null, false],
			['func(/host/key[p1, p2 ,"p3"', null, false],
			['func(/host/key[p1, p2 ,"p3', null, false],
			['func(/host/key[p1, p2 ,"p', null, false],
			['func(/host/key[p1, p2 ,"', null, false],
			['func(/host/key[p1, p2 ,', null, false],
			['func(/host/key[p1, p2 ', null, false],
			['func(/host/key[p1, p2', null, false],
			['func(/host/key[p1, p', null, false],
			['func(/host/key[p1, ', null, false],
			['func(/host/key[p1,', null, false],
			['func(/host/key[p1', null, false],
			['func(/host/key[p', null, false],
			['func(/host/key[', null, false],
			['func(/host/key', null, false],
			['func(/host/ke', null, false],
			['func(/host/k', null, false],
			['func(/host/', null, false],
			['func(/host', null, false],
			['func(/hos', null, false],
			['func(/ho', null, false],
			['func(/h', null, false],
			['func(/', null, false],
			['func(', null, false],
			['func', null, false],
			['fun', null, false],
			['fu', null, false],
			['f', null, false],

			// new lines and tabs
			["\rlast(/host/key,1)+1", null, true],
			["\nlast(/host/key,1)+1", null, true],
			["\r\nlast(/host/key,1)+1", null, true],
			["\tlast(/host/key,1)+1", null, true],

			["{\rhost:key.last(1)}+1", null, false],
			["{\nhost:key.last(1)}+1", null, false],
			["{\r\nhost:key.last(1)}+1", null, false],
			["{\thost:key.last(1)}+1", null, false],

			["{host\r:key.last(1)}+1", null, false],
			["{host\n:key.last(1)}+1", null, false],
			["{host\r\n:key.last(1)}+1", null, false],
			["{host\t:key.last(1)}+1", null, false],

			["{host:\rkey.last(1)}+1", null, false],
			["{host:\nkey.last(1)}+1", null, false],
			["{host:\r\nkey.last(1)}+1", null, false],
			["{host:\tkey.last(1)}+1", null, false],

			["{host:key\r.last(1)}+1", null, false],
			["{host:key\n.last(1)}+1", null, false],
			["{host:key\r\n.last(1)}+1", null, false],
			["{host:key\t.last(1)}+1", null, false],

			["{host:key.\rlast(1)}+1", null, false],
			["{host:key.\nlast(1)}+1", null, false],
			["{host:key.\r\nlast(1)}+1", null, false],
			["{host:key.\tlast(1)}+1", null, false],

			["{host:key.last\r(1)}+1", null, false],
			["{host:key.last\n(1)}+1", null, false],
			["{host:key.last\r\n(1)}+1", null, false],
			["{host:key.last\t(1)}+1", null, false],

			["{host:key.last(1)\r}+1", null, false],
			["{host:key.last(1)\n}+1", null, false],
			["{host:key.last(1)\r\n}+1", null, false],
			["{host:key.last(1)\t}+1", null, false],

			["last(/host/key,1)\r+1", null, true],
			["last(/host/key,1)\n+1", null, true],
			["last(/host/key,1)\r\n+1", null, true],
			["last(/host/key,1)\t+1", null, true],

			["last(/host/key,1)+\r1", null, true],
			["last(/host/key,1)+\n1", null, true],
			["last(/host/key,1)+\r\n1", null, true],
			["last(/host/key,1)+\t1", null, true],

			["last(/host/key,1)+1\r", null, true],
			["last(/host/key,1)+1\n", null, true],
			["last(/host/key,1)+1\r\n", null, true],
			["last(/host/key,1)+1\t", null, true],

			["last(/host/key,1)\r\r+\r\r1", null, true],
			["last(/host/key,1)\n\n+\n\n1", null, true],
			["last(/host/key,1)\r\n\r\n+\r\n\r\n1", null, true],
			["last(/host/key,1)\t\t+\t\t1", null, true],

			["last(/host/key,1)\r\t+\r\t1", null, true],
			["last(/host/key,1)\n\t+\n\t1", null, true],
			["last(/host/key,1)\r\n\t+\r\n\t1", null, true],
			["last(/host/key,1)\t\t+\t\t1", null, true],

			["(\rlast(/host/key,1)+1) or 1", null, true],
			["(\nlast(/host/key,1)+1) or 1", null, true],
			["(\r\nlast(/host/key,1)+1) or 1", null, true],
			["(\tlast(/host/key,1)+1) or 1", null, true],

			["(last(/host/key,1)+1\r) or 1", null, true],
			["(last(/host/key,1)+1\n) or 1", null, true],
			["(last(/host/key,1)+1\r\n) or 1", null, true],
			["(last(/host/key,1)+1\t) or 1", null, true],
			["(last(/host/key,1)+1\t) or 1", null, true],

			["last(/host/key,1)\ror not 1", null, true],
			["last(/host/key,1)\nor not 1", null, true],
			["last(/host/key,1)\r\nor not 1", null, true],
			["last(/host/key,1)\tor not 1", null, true],

			["last(/host/key,1) or\rnot 1", null, true],
			["last(/host/key,1) or\nnot 1", null, true],
			["last(/host/key,1) or\r\nnot 1", null, true],
			["last(/host/key,1) or\tnot 1", null, true],

			["last(/host/key,1)\rand not 1", null, true],
			["last(/host/key,1)\nand not 1", null, true],
			["last(/host/key,1)\r\nand not 1", null, true],
			["last(/host/key,1)\tand not 1", null, true],

			["last(/host/key,1) and\rnot 1", null, true],
			["last(/host/key,1) and\nnot 1", null, true],
			["last(/host/key,1) and\r\nnot 1", null, true],
			["last(/host/key,1) and\tnot 1", null, true],

			["last(/host/key,1) and not\r1", null, true],
			["last(/host/key,1) and not\n1", null, true],
			["last(/host/key,1) and not\r\n1", null, true],
			["last(/host/key,1) and not\t1", null, true],

			["count(host/key,1,\"\"\r)=0", null, false],
			["count(host/key,1,\"\"\n)=0", null, false],
			["count(host/key,1,\"\"\r\n)=0", null, false],
			["count(host/key,1,\"\"\t)=0", null, false],

			["count(host/key,1,\"\r\")=0", null, true],
			["count(host/key,1,\"\n\")=0", null, true],
			["count(host/key,1,\"\r\n\")=0", null, true],
			["count(host/key,1,\"\t\")=0", null, true],

			["count(host/key,1,\r\"\")=0", null, true],
			["count(host/key,1,\n\"\")=0", null, true],
			["count(host/key,1,\r\n\"\")=0", null, true],
			["count(host/key,1,\t\"\")=0", null, true],

			["count(host/key,1\r,\"\")=0", null, true],
			["count(host/key,1\n,\"\")=0", null, true],
			["count(host/key,1\r\n,\"\")=0", null, true],
			["count(host/key,1\t,\"\")=0", null, true],

			["count(host/key,\r1,\"\")=0", null, true],
			["count(host/key,\n1,\"\")=0", null, true],
			["count(host/key,\r\n1,\"\")=0", null, true],
			["count(host/key,\t1,\"\")=0", null, true],

			// collapsed trigger expressions
			['func(/host/key)', null, false, ['collapsed_expression' => true]],
			['{123}', null, true, ['collapsed_expression' => true]],
			['{123} = {$MACRO}', null, true, ['collapsed_expression' => true]],
			['{123} = {#MACRO}', null, true, ['collapsed_expression' => true]],
			['{123} = {#MACRO}', null, false, ['collapsed_expression' => true, 'lldmacros' => false]],

			// Compare strings.
			['last(/host/key)=""', null, true],
			['last(/host/key)=" "', null, true],
			['last(/host/key)="\"abc\""', null, true],
			['last(/host/key)="\"a\\bc\""', null, false],
			['last(/host/key)= "\"abc" ', null, true],
			['last(/host/key)="\\\"', null, true], // Actually looks like last(/host/key)="\\"
			['last(/host/key)="\\ \""', null, false],
			['last(/host/key)=" "      ', null, true],
			['"abc"="abc"', null, true],
			['    "abc"  =   "abc"   ', null, true],
			['"abc"="abc"="abc"', null, true],
			['"abc"="abc" and "abc"', null, true],
			['last(/host/key)="\ "', null, false],
			['last(/host/key)="\\', null, false],
			['last(/host/key)="\"', null, false],
			['last(/host/key)=""abc', null, false],
			['last(/host/key)=" "abc', null, false],
			['last(/host/key)="abc\"', null, false],
			['last(/host/key)="\""\"', null, false],
			['last(/host/key)="\\ \"', null, false],
			['last(/host/key)="\\\\\ "', null, false], // Actually looks like last(/host/key)="\\\ "
			['last(/host/key)=" " "', null, false],
			['last(/host/key)="\n"', null, false],
			['"abc"="abc"and"abc"', null, false],
			['"abc"="abc" and abc"', null, false],

			['last(/host1/agent.ping) = 1 or last(/host2/agent.ping) = 1', null, true, ['lldmacros' => false, 'calculated' => true]],
			['last(/host1/agent.version) = "5.0.0" or last(/host2/agent.ping) = 1', null, true, ['lldmacros' => false, 'calculated' => true]]
		];
	}

	/**
	 * @dataProvider provider
	 *
	 * @param string      $expression
	 * @param array|null  $result
	 * @param bool        $rc
	 * @param array       $options
	 * @param bool        $options['lldmacros']
	 * @param bool        $options['collapsed_expression']
	 * @param bool        $options['calculated']
	 * @param bool        $options['host_macro']
	 */
	public function testParseExpression(string $expression, ?array $result, bool $rc, array $options = []) {
		$expression_data = new CTriggerExpression($options);

		if ($expression_data->parse($expression)) {
			$this->assertEquals($rc, true);
			$this->assertEquals($rc, $expression_data->is_valid);

			if (isset($result)) {
				$this->assertEquals($result['error'], $expression_data->error);
				$this->assertEquals($result['expressions'], $expression_data->expressions);
			}
		}
		else {
			$this->assertEquals($rc, false, "\nError with expression $expression: ".$expression_data->error);
		}
	}

	public static function tokens_provider() {
		return [
			[
				'((-12 + {host:item.str()} or {$USERMACRO} and not {TRIGGER.VALUE} or {#LLD} or {{#LLD}.regsub("^([0-9]+)", "{#LLD}: \1")} or 10m))',
				[
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_OPEN_BRACE,
						'value' => '(',
						'data' => null,
						'pos' => 0,
						'length' => 1
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_OPEN_BRACE,
						'value' => '(',
						'data' => null,
						'pos' => 1,
						'length' => 1
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_OPERATOR,
						'value' => '-',
						'data' => null,
						'pos' => 2,
						'length' => 1
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_NUMBER,
						'value' => '12',
						'pos' => 3,
						'length' => 2,
						'data' => [
							'suffix' => null
						]
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_OPERATOR,
						'value' => '+',
						'data' => null,
						'pos' => 6,
						'length' => 1
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_FUNCTION_MACRO,
						'value' => '{host:item.str()}',
						'pos' => 8,
						'length' => 25,
						'data' => [
							'host' => 'host',
							'item' => 'item',
							'function' => 'str()',
							'functionName' => 'str',
							'functionParams' => ['']
						]
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_OPERATOR,
						'value' => 'or',
						'data' => null,
						'pos' => 34,
						'length' => 2
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_USER_MACRO,
						'value' => '{$USERMACRO}',
						'data' => null,
						'pos' => 37,
						'length' => 12
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_OPERATOR,
						'value' => 'and',
						'data' => null,
						'pos' => 50,
						'length' => 3
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_OPERATOR,
						'value' => 'not',
						'data' => null,
						'pos' => 54,
						'length' => 3
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_MACRO,
						'value' => '{TRIGGER.VALUE}',
						'data' => null,
						'pos' => 58,
						'length' => 15
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_OPERATOR,
						'value' => 'or',
						'data' => null,
						'pos' => 74,
						'length' => 2
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_LLD_MACRO,
						'value' => '{#LLD}',
						'data' => null,
						'pos' => 77,
						'length' => 6
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_OPERATOR,
						'value' => 'or',
						'data' => null,
						'pos' => 84,
						'length' => 2
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_LLD_MACRO,
						'value' => '{{#LLD}.regsub("^([0-9]+)", "{#LLD}: \1")}',
						'data' => null,
						'pos' => 87,
						'length' => 42
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_OPERATOR,
						'value' => 'or',
						'data' => null,
						'pos' => 130,
						'length' => 2
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_NUMBER,
						'value' => '10m',
						'pos' => 133,
						'length' => 3,
						'data' => [
							'suffix' => 'm'
						]
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_CLOSE_BRACE,
						'value' => ')',
						'data' => null,
						'pos' => 136,
						'length' => 1
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_CLOSE_BRACE,
						'value' => ')',
						'data' => null,
						'pos' => 137,
						'length' => 1
					]
				]
			],
			[
				'(-1.15w + str(host:item, ) or {$USERMACRO}) or {#LLD}',
				[
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_OPEN_BRACE,
						'value' => '(',
						'data' => null,
						'pos' => 0,
						'length' => 1
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_OPERATOR,
						'value' => '-',
						'data' => null,
						'pos' => 1,
						'length' => 1
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_NUMBER,
						'value' => '1.15w',
						'pos' => 2,
						'length' => 5,
						'data' => [
							'suffix' => 'w'
						]
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_OPERATOR,
						'value' => '+',
						'data' => null,
						'pos' => 8,
						'length' => 1
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_FUNCTION,
						'value' => 'str(host:item, )',
						'pos' => 10,
						'length' => 24,
						'data' => [
							'functionName' => 'str',
							'functionParams' => ['host:item', '']
						]
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_OPERATOR,
						'value' => 'or',
						'data' => null,
						'pos' => 35,
						'length' => 2
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_USER_MACRO,
						'value' => '{$USERMACRO}',
						'data' => null,
						'pos' => 38,
						'length' => 12
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_CLOSE_BRACE,
						'value' => ')',
						'data' => null,
						'pos' => 50,
						'length' => 1
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_OPERATOR,
						'value' => 'or',
						'data' => null,
						'pos' => 52,
						'length' => 2
					],
					[
						'type' => CTriggerExprParserResult::TOKEN_TYPE_LLD_MACRO,
						'value' => '{#LLD}',
						'data' => null,
						'pos' => 55,
						'length' => 6
					]
				],
				['calculated' => true]
			]
		];
	}

	/**
	 * @dataProvider tokens_provider
	 */
	public function testTokens(string $expression, array $tokens, array $options = []) {
		$parser = new CTriggerExpression($options);
		$result = $parser->parse($expression);
		$this->assertTrue($result instanceof CTriggerExprParserResult);
		$this->assertEquals($tokens, $result->getTokens());
	}
}
