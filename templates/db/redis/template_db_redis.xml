<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.2</version>
    <date>2020-10-09T08:18:29Z</date>
    <groups>
        <group>
            <name>Templates/Databases</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Redis</template>
            <name>Redis</name>
            <description>Get Redis metrics from plugin for the New Zabbix Agent (zabbix-agent2).

You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/389050-discussion-thread-for-official-zabbix-template-redis

Template tooling version used: 0.38</description>
            <groups>
                <group>
                    <name>Templates/Databases</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Redis</name>
                </application>
                <application>
                    <name>Zabbix raw items</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Redis: Blocked clients</name>
                    <type>DEPENDENT</type>
                    <key>redis.clients.blocked</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>The number of connections waiting on a blocking call</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Clients.blocked_clients</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Connected clients</name>
                    <type>DEPENDENT</type>
                    <key>redis.clients.connected</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>The number of connected clients</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Clients.connected_clients</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Max input buffer</name>
                    <type>DEPENDENT</type>
                    <key>redis.clients.max_input_buffer</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>The biggest input buffer among current client connections</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                               <parameter>var clients = JSON.parse(value).Clients
return clients.client_recent_max_input_buffer || clients.client_biggest_input_buf</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Max output buffer</name>
                    <type>DEPENDENT</type>
                    <key>redis.clients.max_output_buffer</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>The biggest output buffer among current client connections</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                               <parameter>var clients = JSON.parse(value).Clients
return clients.client_recent_max_output_buffer || clients.client_longest_output_list</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Cluster enabled</name>
                    <type>DEPENDENT</type>
                    <key>redis.cluster.enabled</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Indicate Redis cluster is enabled</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Redis flag</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Cluster.cluster_enabled</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Max clients</name>
                    <type>DEPENDENT</type>
                    <key>redis.config.maxclients</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Max number of connected clients at the same time.
Once the limit is reached Redis will close all the new connections sending an error &quot;max number of clients reached&quot;.</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.maxclients</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                               <parameter>30m</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.config[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Get config</name>
                    <key>redis.config[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    <history>1h</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Zabbix raw items</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                               <parameter>1h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{diff()}=1 and {strlen()}&gt;0</expression>
                            <name>Redis: Configuration has changed</name>
                            <priority>INFO</priority>
                            <description>Redis configuration has changed. Ack to close.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Redis: CPU sys</name>
                    <type>DEPENDENT</type>
                    <key>redis.cpu.sys</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <description>System CPU consumed by the Redis server</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.CPU.used_cpu_sys</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: CPU sys children</name>
                    <type>DEPENDENT</type>
                    <key>redis.cpu.sys_children</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <description>System CPU consumed by the background processes</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.CPU.used_cpu_sys_children</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: CPU user</name>
                    <type>DEPENDENT</type>
                    <key>redis.cpu.user</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <description>User CPU consumed by the Redis server</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.CPU.used_cpu_user</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: CPU user children</name>
                    <type>DEPENDENT</type>
                    <key>redis.cpu.user_children</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <description>User CPU consumed by the background processes</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.CPU.used_cpu_user_children</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Get info</name>
                    <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    <history>1h</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Zabbix raw items</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{nodata(30m)}=1</expression>
                            <name>Redis: Failed to fetch info data (or no data for 30m)</name>
                            <priority>WARNING</priority>
                            <description>Zabbix has not received data for items for the last 30 minutes</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Redis: Service is down</name>
                                    <expression>{Redis:redis.ping[&quot;{$REDIS.CONN.URI}&quot;].last()}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Redis: Memory fragmentation ratio</name>
                    <type>DEPENDENT</type>
                    <key>redis.memory.fragmentation_ratio</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <description>This ratio is an indication of memory mapping efficiency:
  — Value over 1.0 indicate that memory fragmentation is very likely. Consider restarting the Redis server so the operating system can recover fragmented memory, especially with a ratio over 1.5.
  — Value under 1.0 indicate that Redis likely has insufficient memory available. Consider optimizing memory usage or adding more RAM.

Note: If your peak memory usage is much higher than your current memory usage, the memory fragmentation ratio may be unreliable.

https://redis.io/topics/memory-optimization</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Memory.mem_fragmentation_ratio</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{min(15m)}&gt;{$REDIS.MEM.FRAG_RATIO.MAX.WARN}</expression>
                            <name>Redis: Memory fragmentation ratio is too high (over {$REDIS.MEM.FRAG_RATIO.MAX.WARN} in 15m)</name>
                            <priority>WARNING</priority>
                            <description>This ratio is an indication of memory mapping efficiency:
  — Value over 1.0 indicate that memory fragmentation is very likely. Consider restarting the Redis server so the operating system can recover fragmented memory, especially with a ratio over 1.5.
  — Value under 1.0 indicate that Redis likely has insufficient memory available. Consider optimizing memory usage or adding more RAM.

Note: If your peak memory usage is much higher than your current memory usage, the memory fragmentation ratio may be unreliable.

https://redis.io/topics/memory-optimization</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Redis: Memory used</name>
                    <type>DEPENDENT</type>
                    <key>redis.memory.used_memory</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <units>B</units>
                    <description>Total number of bytes allocated by Redis using its allocator</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Memory.used_memory</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Memory used Lua</name>
                    <type>DEPENDENT</type>
                    <key>redis.memory.used_memory_lua</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <units>B</units>
                    <description>Amount of memory used by the Lua engine</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Memory.used_memory_lua</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Memory used peak</name>
                    <type>DEPENDENT</type>
                    <key>redis.memory.used_memory_peak</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <units>B</units>
                    <description>Peak memory consumed by Redis (in bytes)</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Memory.used_memory_peak</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Memory used RSS</name>
                    <type>DEPENDENT</type>
                    <key>redis.memory.used_memory_rss</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <units>B</units>
                    <description>Number of bytes that Redis allocated as seen by the operating system</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Memory.used_memory_rss</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: AOF current rewrite time sec</name>
                    <type>DEPENDENT</type>
                    <key>redis.persistence.aof_current_rewrite_time_sec</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <description>Duration of the on-going AOF rewrite operation if any</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Redis bgsave time</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Persistence.aof_current_rewrite_time_sec</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: AOF enabled</name>
                    <type>DEPENDENT</type>
                    <key>redis.persistence.aof_enabled</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Flag indicating AOF logging is activated</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Redis flag</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Persistence.aof_enabled</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: AOF last bgrewrite status</name>
                    <type>DEPENDENT</type>
                    <key>redis.persistence.aof_last_bgrewrite_status</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Status of the last AOF rewrite operation</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Redis bgwrite status</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Persistence.aof_last_bgrewrite_status</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>BOOL_TO_DECIMAL</type>
                            <parameters/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: AOF last rewrite time sec</name>
                    <type>DEPENDENT</type>
                    <key>redis.persistence.aof_last_rewrite_time_sec</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <description>Duration of the last AOF rewrite</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Redis bgsave time</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Persistence.aof_last_rewrite_time_sec</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: AOF last write status</name>
                    <type>DEPENDENT</type>
                    <key>redis.persistence.aof_last_write_status</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Status of the last write operation to the AOF</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Redis bgwrite status</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Persistence.aof_last_write_status</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>BOOL_TO_DECIMAL</type>
                            <parameters/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>Redis: Last AOF write operation failed</name>
                            <priority>WARNING</priority>
                            <description>Detailed information about persistence: https://redis.io/topics/persistence</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Redis: AOF rewrite in progress</name>
                    <type>DEPENDENT</type>
                    <key>redis.persistence.aof_rewrite_in_progress</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Flag indicating a AOF rewrite operation is on-going</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Persistence.aof_rewrite_in_progress</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: AOF rewrite scheduled</name>
                    <type>DEPENDENT</type>
                    <key>redis.persistence.aof_rewrite_scheduled</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Flag indicating an AOF rewrite operation will be scheduled once the on-going RDB save is complete</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Persistence.aof_rewrite_scheduled</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Dump loading</name>
                    <type>DEPENDENT</type>
                    <key>redis.persistence.loading</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Flag indicating if the load of a dump file is on-going</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Redis flag</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Persistence.loading</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: RDB bgsave in progress</name>
                    <type>DEPENDENT</type>
                    <key>redis.persistence.rdb_bgsave_in_progress</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>&quot;1&quot; if bgsave is in progress and &quot;0&quot; otherwise</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Persistence.rdb_bgsave_in_progress</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: RDB changes since last save</name>
                    <type>DEPENDENT</type>
                    <key>redis.persistence.rdb_changes_since_last_save</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Number of changes since the last background save</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Persistence.rdb_changes_since_last_save</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: RDB current bgsave time sec</name>
                    <type>DEPENDENT</type>
                    <key>redis.persistence.rdb_current_bgsave_time_sec</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <description>Duration of the on-going RDB save operation if any</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Redis bgsave time</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Persistence.rdb_current_bgsave_time_sec</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: RDB last bgsave status</name>
                    <type>DEPENDENT</type>
                    <key>redis.persistence.rdb_last_bgsave_status</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Status of the last RDB save operation</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Redis bgwrite status</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Persistence.rdb_last_bgsave_status</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>BOOL_TO_DECIMAL</type>
                            <parameters/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>Redis: Last RDB save operation failed</name>
                            <priority>WARNING</priority>
                            <description>Detailed information about persistence: https://redis.io/topics/persistence</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Redis: RDB last bgsave time sec</name>
                    <type>DEPENDENT</type>
                    <key>redis.persistence.rdb_last_bgsave_time_sec</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <description>Duration of the last bg_save operation</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Redis bgsave time</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Persistence.rdb_last_bgsave_time_sec</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: RDB last save time</name>
                    <type>DEPENDENT</type>
                    <key>redis.persistence.rdb_last_save_time</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Epoch-based timestamp of last successful RDB save</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Persistence.rdb_last_save_time</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Ping</name>
                    <key>redis.ping[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    <history>7h</history>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Service state</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                               <parameter>10m</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>Redis: Service is down</name>
                            <priority>AVERAGE</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Redis: Connected slaves</name>
                    <type>DEPENDENT</type>
                    <key>redis.replication.connected_slaves</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Number of connected slaves</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Replication.connected_slaves</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{diff()}=1</expression>
                            <recovery_mode>NONE</recovery_mode>
                            <name>Redis: Number of slaves has changed</name>
                            <priority>INFO</priority>
                            <description>Redis number of slaves has changed. Ack to close.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Redis: Master replication offset</name>
                    <type>DEPENDENT</type>
                    <key>redis.replication.master_repl_offset</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <units>B</units>
                    <description>Replication offset reported by the master</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Redis repl offset</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Replication.master_repl_offset</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Replication backlog active</name>
                    <type>DEPENDENT</type>
                    <key>redis.replication.repl_backlog_active</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Flag indicating replication backlog is active</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Redis flag</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Replication.repl_backlog_active</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Replication backlog first byte offset</name>
                    <type>DEPENDENT</type>
                    <key>redis.replication.repl_backlog_first_byte_offset</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <units>B</units>
                    <description>The master offset of the replication backlog buffer</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Replication.repl_backlog_first_byte_offset</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Replication backlog history length</name>
                    <type>DEPENDENT</type>
                    <key>redis.replication.repl_backlog_histlen</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Amount of data in the backlog sync buffer</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Replication.repl_backlog_histlen</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Replication backlog size</name>
                    <type>DEPENDENT</type>
                    <key>redis.replication.repl_backlog_size</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <units>B</units>
                    <description>Total size in bytes of the replication backlog buffer</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Replication.repl_backlog_size</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Replication role</name>
                    <type>DEPENDENT</type>
                    <key>redis.replication.role</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Value is &quot;master&quot; if the instance is replica of no one, or &quot;slave&quot; if the instance is a replica of some master instance. Note that a replica can be master of another replica (chained replication).</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Replication.role</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                               <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{diff()}=1 and {strlen()}&gt;0</expression>
                            <recovery_mode>NONE</recovery_mode>
                            <name>Redis: Replication role has changed (new role: {ITEM.VALUE})</name>
                            <priority>WARNING</priority>
                            <description>Redis replication role has changed. Ack to close.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Redis: Process id</name>
                    <type>DEPENDENT</type>
                    <key>redis.server.process_id</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>PID of the server process</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Server.process_id</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                               <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Redis mode</name>
                    <type>DEPENDENT</type>
                    <key>redis.server.redis_mode</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>The server's mode (&quot;standalone&quot;, &quot;sentinel&quot; or &quot;cluster&quot;)</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Server.redis_mode</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                               <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Redis version</name>
                    <type>DEPENDENT</type>
                    <key>redis.server.redis_version</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Version of the Redis server</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Server.redis_version</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                               <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{diff()}=1 and {strlen()}&gt;0</expression>
                            <name>Redis: Version has changed (new version: {ITEM.VALUE})</name>
                            <priority>INFO</priority>
                            <description>Redis version has changed. Ack to close.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Redis: TCP port</name>
                    <type>DEPENDENT</type>
                    <key>redis.server.tcp_port</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>TCP/IP listen port</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Server.tcp_port</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                               <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Uptime</name>
                    <type>DEPENDENT</type>
                    <key>redis.server.uptime</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <units>s</units>
                    <description>Number of seconds since Redis server start</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Server.uptime_in_seconds</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;10m</expression>
                            <name>Redis: has been restarted (uptime &lt; 10m)</name>
                            <priority>INFO</priority>
                            <description>Uptime is less than 10 minutes</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Redis: Slowlog entries per second</name>
                    <key>redis.slowlog.count[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    <history>7d</history>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <parameters/>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{min(5m)}&gt;{$REDIS.SLOWLOG.COUNT.MAX.WARN}</expression>
                            <name>Redis: Too many entries in the slowlog (over {$REDIS.SLOWLOG.COUNT.MAX.WARN} per second in 5m)</name>
                            <priority>INFO</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Redis: Evicted keys</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.evicted_keys</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Number of evicted keys due to maxmemory limit</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.evicted_keys</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Expired keys</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.expired_keys</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Total number of key expiration events</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.expired_keys</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Instantaneous input bytes per second</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.instantaneous_input.rate</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>Bps</units>
                    <description>The network's read rate per second in KB/sec</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.instantaneous_input_kbps</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                               <parameter>1024</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Instantaneous operations per sec</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.instantaneous_ops.rate</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Number of commands processed per second</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.instantaneous_ops_per_sec</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Instantaneous output bytes per second</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.instantaneous_output.rate</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>Bps</units>
                    <description>The network's write rate per second in KB/sec</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.instantaneous_output_kbps</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                               <parameter>1024</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Keyspace hits</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.keyspace_hits</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Number of successful lookup of keys in the main dictionary</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.keyspace_hits</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Keyspace misses</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.keyspace_misses</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Number of failed lookup of keys in the main dictionary</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.keyspace_misses</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Latest fork usec</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.latest_fork_usec</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <units>s</units>
                    <description>Duration of the latest fork operation in microseconds</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.latest_fork_usec</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                               <parameter>1.0E-5</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Migrate cached sockets</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.migrate_cached_sockets</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>The number of sockets open for MIGRATE purposes</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.migrate_cached_sockets</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Pubsub channels</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.pubsub_channels</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Global number of pub/sub channels with client subscriptions</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.pubsub_channels</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Pubsub patterns</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.pubsub_patterns</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Global number of pub/sub pattern with client subscriptions</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.pubsub_patterns</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Rejected connections</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.rejected_connections</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Number of connections rejected because of maxclients limit</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.rejected_connections</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0</expression>
                            <name>Redis: Connections are rejected</name>
                            <priority>HIGH</priority>
                            <description>The number of connections has reached the value of &quot;maxclients&quot;.

https://redis.io/topics/clients</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Redis: Sync full</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.sync_full</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>The number of full resyncs with replicas</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.sync_full</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Sync partial err</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.sync_partial_err</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>The number of denied partial resync requests</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.sync_partial_err</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Sync partial ok</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.sync_partial_ok</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>The number of accepted partial resync requests</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.sync_partial_ok</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Total commands processed</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.total_commands_processed</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Total number of commands processed by the server</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.total_commands_processed</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Total connections received</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.total_connections_received</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <description>Total number of connections accepted by the server</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.total_connections_received</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Total net input bytes</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.total_net_input_bytes</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <units>B</units>
                    <description>The total number of bytes read from the network</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.total_net_input_bytes</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Redis: Total net output bytes</name>
                    <type>DEPENDENT</type>
                    <key>redis.stats.total_net_output_bytes</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <units>B</units>
                    <description>The total number of bytes written to the network</description>
                    <applications>
                        <application>
                            <name>Redis</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Stats.total_net_output_bytes</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Process metrics discovery</name>
                    <key>proc.num[&quot;{$REDIS.LLD.PROCESS_NAME}&quot;]</key>
                    <delay>1h</delay>
                    <description>Collect metrics by Zabbix agent if it exists</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Redis: CPU utilization</name>
                            <key>proc.cpu.util[&quot;{$REDIS.PROCESS_NAME}{#SINGLETON}&quot;]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>Process CPU utilization percentage.</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory usage (rss)</name>
                            <key>proc.mem[&quot;{$REDIS.PROCESS_NAME}{#SINGLETON}&quot;,,,,rss]</key>
                            <history>7d</history>
                            <units>B</units>
                            <description>Resident set size memory used by process in bytes.</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory usage (vsize)</name>
                            <key>proc.mem[&quot;{$REDIS.PROCESS_NAME}{#SINGLETON}&quot;,,,,vsize]</key>
                            <history>7d</history>
                            <units>B</units>
                            <description>Virtual memory size used by process in bytes.</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Number of processes running</name>
                            <key>proc.num[&quot;{$REDIS.PROCESS_NAME}{#SINGLETON}&quot;]</key>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}=0</expression>
                                    <name>Redis: Process is not running</name>
                                    <priority>HIGH</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Redis: Memory usage{#SINGLETON}</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Redis</host>
                                        <key>proc.mem[&quot;{$REDIS.PROCESS_NAME}{#SINGLETON}&quot;,,,,vsize]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Redis</host>
                                        <key>proc.mem[&quot;{$REDIS.PROCESS_NAME}{#SINGLETON}&quot;,,,,rss]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                               <parameter>return JSON.stringify(value &gt; 0 ? [{'{#SINGLETON}': ''}] : []);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <name>Keyspace discovery</name>
                    <type>DEPENDENT</type>
                    <key>redis.keyspace.discovery</key>
                    <delay>0</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#DB}</macro>
                                <value>{$REDIS.LLD.FILTER.DB.MATCHES}</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#DB}</macro>
                                <value>{$REDIS.LLD.FILTER.DB.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>Individual keyspace metrics</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>DB {#DB}: Average TTL</name>
                            <type>DEPENDENT</type>
                            <key>redis.db.avg_ttl[&quot;{#DB}&quot;]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>s</units>
                            <description>Average TTL</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Redis: DB {#DB}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Keyspace[&quot;{#DB}&quot;].avg_ttl</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                       <parameter>0.001</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>DB {#DB}: Expires</name>
                            <type>DEPENDENT</type>
                            <key>redis.db.expires[&quot;{#DB}&quot;]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Number of keys with an expiration</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Redis: DB {#DB}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Keyspace[&quot;{#DB}&quot;].expires</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>DB {#DB}: Keys</name>
                            <type>DEPENDENT</type>
                            <key>redis.db.keys[&quot;{#DB}&quot;]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Total number of keys</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Redis: DB {#DB}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Keyspace[&quot;{#DB}&quot;].keys</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>DB {#DB}: Keys</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Redis</host>
                                        <key>redis.db.keys[&quot;{#DB}&quot;]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Redis</host>
                                        <key>redis.db.expires[&quot;{#DB}&quot;]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                               <parameter>return JSON.stringify(Object.keys(JSON.parse(value).Keyspace)
  .map(function (v){return {&quot;{#DB}&quot;: v}}));</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <name>Version 4+ metrics discovery</name>
                    <type>DEPENDENT</type>
                    <key>redis.metrics.v4.discovery</key>
                    <delay>0</delay>
                    <description>Additional metrics for versions 4+</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Redis: Active defrag running{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.active_defrag_running[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Flag indicating if active defragmentation is active</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.active_defrag_running</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Lazyfree pending objects{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.lazyfree_pending_objects[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>The number of objects waiting to be freed (as a result of calling UNLINK, or FLUSHDB and FLUSHALL with the ASYNC option)</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.lazyfree_pending_objects</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Max memory{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.maxmemory[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>B</units>
                            <description>Maximum amount of memory allocated to the Redisdb system</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.maxmemory</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Max memory policy{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.maxmemory_policy[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <description>The value of the maxmemory-policy configuration directive</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.maxmemory_policy</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                       <parameter>1d</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Total system memory{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.total_system_memory[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>B</units>
                            <description>The total amount of memory that the Redis host has</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.total_system_memory</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory used dataset{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.used_memory_dataset[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>B</units>
                            <description>The size in bytes of the dataset</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.used_memory_dataset</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory used dataset %{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.used_memory_dataset_perc[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>The percentage of used_memory_dataset out of the net memory usage (used_memory minus used_memory_startup)</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.used_memory_dataset_perc</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>REGEX</type>
                                    <parameters>
                                       <parameter>(.+)%</parameter>
                                       <parameter>\1</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory used overhead{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.used_memory_overhead[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>B</units>
                            <description>The sum in bytes of all overheads that the server allocated for managing its internal data structures</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.used_memory_overhead</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory used peak %{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.used_memory_peak_perc[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>The percentage of used_memory_peak out of used_memory</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.used_memory_peak_perc</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>REGEX</type>
                                    <parameters>
                                       <parameter>(.+)%</parameter>
                                       <parameter>\1</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory used startup{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.used_memory_startup[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>B</units>
                            <description>Initial amount of memory consumed by Redis at startup in bytes</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.used_memory_startup</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: AOF last CoW size{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.persistence.aof_last_cow_size[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>B</units>
                            <description>The size in bytes of copy-on-write allocations during the last AOF rewrite operation</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Persistence.aof_last_cow_size</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: RDB last CoW size{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.persistence.rdb_last_cow_size[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>B</units>
                            <description>The size in bytes of copy-on-write allocations during the last RDB save operation</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Persistence.rdb_last_cow_size</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Replication second offset{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.replication.second_repl_offset[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>B</units>
                            <description>Offset up to which replication IDs are accepted</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>Redis repl offset</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Replication.second_repl_offset</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Executable path{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.server.executable[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <description>The path to the server's executable</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Server.executable</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                       <parameter>1d</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Active defrag hits{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.stats.active_defrag_hits[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Number of value reallocations performed by active the defragmentation process</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Stats.active_defrag_hits</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Active defrag key hits{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.stats.active_defrag_key_hits[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Number of keys that were actively defragmented</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Stats.active_defrag_key_hits</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Active defrag key misses{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.stats.active_defrag_key_misses[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Number of keys that were skipped by the active defragmentation process</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Stats.active_defrag_key_misses</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Active defrag misses{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.stats.active_defrag_misses[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Number of aborted value reallocations started by the active defragmentation process</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Stats.active_defrag_misses</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Expired stale %{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.stats.expired_stale_perc[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Stats.expired_stale_perc</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Expired time cap reached count{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.stats.expired_time_cap_reached_count[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Stats.expired_time_cap_reached_count</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Slave expires tracked keys{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.stats.slave_expires_tracked_keys[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>The number of keys tracked for expiry purposes (applicable only to writable replicas)</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Stats.slave_expires_tracked_keys</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{Redis:redis.memory.maxmemory[{#SINGLETON}].min(5m)}/{Redis:redis.memory.used_memory.last()}*100&gt;{$REDIS.MEM.PUSED.MAX.WARN}</expression>
                            <name>Redis: Memory usage is too high (over {$REDIS.MEM.PUSED.MAX.WARN}% in 5m)</name>
                            <priority>WARNING</priority>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Server.redis_version</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                               <parameter>return JSON.stringify(parseInt(value.split('.')[0]) &gt;= 4 ? [{'{#SINGLETON}': ''}] : []);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <name>Version 5+ metrics discovery</name>
                    <type>DEPENDENT</type>
                    <key>redis.metrics.v5.discovery</key>
                    <delay>0</delay>
                    <description>Additional metrics for versions 5+</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Redis: Allocator active{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.allocator_active[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.allocator_active</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Allocator allocated{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.allocator_allocated[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.allocator_allocated</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Allocator fragmentation bytes{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.allocator_frag_bytes[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.allocator_frag_bytes</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Allocator fragmentation ratio{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.allocator_frag_ratio[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.allocator_frag_ratio</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Allocator resident{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.allocator_resident[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.allocator_resident</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Allocator RSS bytes{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.allocator_rss_bytes[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.allocator_rss_bytes</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Allocator RSS ratio{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.allocator_rss_ratio[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.allocator_rss_ratio</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory fragmentation bytes{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.fragmentation_bytes[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.mem_fragmentation_bytes</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory AOF buffer{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.mem_aof_buffer[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Size of the AOF buffer</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.mem_aof_buffer</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory clients normal{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.mem_clients_normal[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.mem_clients_normal</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory clients slaves{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.mem_clients_slaves[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.mem_clients_slaves</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory not counted for evict{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.not_counted_for_evict[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.mem_not_counted_for_evict</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory number of cached scripts{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.number_of_cached_scripts[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.number_of_cached_scripts</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory replication backlog{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.replication_backlog[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.mem_replication_backlog</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory RSS overhead bytes{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.rss_overhead_bytes[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.rss_overhead_bytes</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory RSS overhead ratio{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.rss_overhead_ratio[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.rss_overhead_ratio</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Memory used scripts{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.memory.used_memory_scripts[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Memory.used_memory_scripts</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                               <parameter>$.Server.redis_version</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                               <parameter>return JSON.stringify(parseInt(value.split('.')[0]) &gt;= 5 ? [{'{#SINGLETON}': ''}] : []);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <name>AOF metrics discovery</name>
                    <type>DEPENDENT</type>
                    <key>redis.persistence.aof.discovery</key>
                    <delay>0</delay>
                    <description>If AOF is activated, additional metrics will be added</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Redis: AOF base size{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.persistence.aof_base_size[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>B</units>
                            <description>AOF file size on latest startup or rewrite</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Persistence.aof_base_size</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: AOF buffer length{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.persistence.aof_buffer_length[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>B</units>
                            <description>Size of the AOF buffer</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Persistence.aof_buffer_length</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: AOF current size{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.persistence.aof_current_size[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>B</units>
                            <description>AOF current file size</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Persistence.aof_current_size</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: AOF delayed fsync{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.persistence.aof_delayed_fsync[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Delayed fsync counter</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Persistence.aof_delayed_fsync</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: AOF pending background I/O fsync{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.persistence.aof_pending_bio_fsync[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Number of fsync pending jobs in background I/O queue</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Persistence.aof_pending_bio_fsync</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: AOF pending rewrite{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.persistence.aof_pending_rewrite[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Flag indicating an AOF rewrite operation will</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>Redis flag</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Persistence.aof_pending_rewrite</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: AOF rewrite buffer length{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.persistence.aof_rewrite_buffer_length[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>B</units>
                            <description>Size of the AOF rewrite buffer</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Persistence.aof_rewrite_buffer_length</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                               <parameter>return JSON.stringify(JSON.parse(value).Persistence.aof_enabled === '1'
  ? [{'{#SINGLETON}': ''}]
  : []);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <name>Replication metrics discovery</name>
                    <type>DEPENDENT</type>
                    <key>redis.replication.master.discovery</key>
                    <delay>0</delay>
                    <description>If the instance is the master and the slaves are connected, additional metrics are provided</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Redis slave {#SLAVE_IP}:{#SLAVE_PORT}: Replication lag in bytes</name>
                            <type>DEPENDENT</type>
                            <key>redis.replication.lag_bytes[&quot;{#SLAVE_IP}:{#SLAVE_PORT}&quot;]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>B</units>
                            <description>Replication lag in bytes</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Redis: Slave {#SLAVE_IP}:{#SLAVE_PORT}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                       <parameter>var repl = JSON.parse(value).Replication;
var res = Object.keys(repl)
    .filter(function (v) {return v.match(/slave\d+/)})
    .filter(function (v) {return (repl[v].ip === &quot;{#SLAVE_IP}&quot; &amp;&amp; repl[v].port === &quot;{#SLAVE_PORT}&quot;)})
    .map(function (v) {return repl[v].offset})[0];

if (res === undefined) {
    throw 'Slave {#SLAVE_IP}:{#SLAVE_PORT} is no longer available.';
}

return res;</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Redis slave {#SLAVE_IP}:{#SLAVE_PORT}: Replication lag bytes</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>BOLD_LINE</drawtype>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Redis</host>
                                        <key>redis.replication.lag_bytes[&quot;{#SLAVE_IP}:{#SLAVE_PORT}&quot;]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                               <parameter>var repl = JSON.parse(value).Replication;
return JSON.stringify(Object.keys(repl)
  .filter(function (v) {return v.match(/slave\d+/)})
  .map(function (v){
    return {&quot;{#SLAVE_IP}&quot;: repl[v].ip, &quot;{#SLAVE_PORT}&quot;: repl[v].port}
  }));</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <name>Slave metrics discovery</name>
                    <type>DEPENDENT</type>
                    <key>redis.replication.slave.discovery</key>
                    <delay>0</delay>
                    <description>If the instance is a replica, additional metrics are provided</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Redis: Master host{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.replication.master_host[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <description>Host or IP address of the master</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Replication.master_host</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                       <parameter>1d</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Master last I/O seconds ago{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.replication.master_last_io_seconds_ago[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>s</units>
                            <description>Number of seconds since the last interaction with master</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Replication.master_last_io_seconds_ago</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min(5m)}&gt;{$REDIS.REPL.LAG.MAX.WARN}</expression>
                                    <name>Redis: Replication lag with master is too high (over {$REDIS.REPL.LAG.MAX.WARN} in 5m)</name>
                                    <priority>WARNING</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Master link status{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.replication.master_link_status[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <description>Status of the link (up/down)</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Replication.master_link_status</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>BOOL_TO_DECIMAL</type>
                                    <parameters/>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Master port{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.replication.master_port[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Master listening TCP port</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Replication.master_port</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                       <parameter>1d</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Master sync in progress{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.replication.master_sync_in_progress[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Indicate the master is syncing to the replica</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Replication.master_sync_in_progress</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Slave priority{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.replication.slave_priority[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>The priority of the instance as a candidate for failover</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Replication.slave_priority</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Slave priority{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.replication.slave_read_only[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <description>Flag indicating if the replica is read-only</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Replication.slave_read_only</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                       <parameter>1d</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Redis: Slave replication offset{#SINGLETON}</name>
                            <type>DEPENDENT</type>
                            <key>redis.replication.slave_repl_offset[{#SINGLETON}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <units>B</units>
                            <description>The replication offset of the replica instance</description>
                            <applications>
                                <application>
                                    <name>Redis</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                       <parameter>$.Replication.slave_repl_offset</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                            </master_item>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Redis: Replication lag time{#SINGLETON}</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>BOLD_LINE</drawtype>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Redis</host>
                                        <key>redis.replication.master_last_io_seconds_ago[{#SINGLETON}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <master_item>
                        <key>redis.info[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                               <parameter>return JSON.stringify(JSON.parse(value).Replication.role === 'slave'
  ? [{'{#SINGLETON}': ''}]
  : []);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$REDIS.CLIENTS.PRC.MAX.WARN}</macro>
                    <value>80</value>
                    <description>Maximum percentage of connected clients</description>
                </macro>
                <macro>
                    <macro>{$REDIS.CONN.URI}</macro>
                    <value>tcp://localhost:6379</value>
                    <description>Connection string in the URI format (password is not used). This param overwrites a value configured in the &quot;Server&quot; option of the configuration file (if it's set), otherwise, the plugin's default value is used: &quot;tcp://localhost:6379&quot;</description>
                </macro>
                <macro>
                    <macro>{$REDIS.LLD.FILTER.DB.MATCHES}</macro>
                    <value>.*</value>
                    <description>Filter of discoverable databases</description>
                </macro>
                <macro>
                    <macro>{$REDIS.LLD.FILTER.DB.NOT_MATCHES}</macro>
                    <value>CHANGE_IF_NEEDED</value>
                    <description>Filter to exclude discovered databases</description>
                </macro>
                <macro>
                    <macro>{$REDIS.LLD.PROCESS_NAME}</macro>
                    <value>redis-server</value>
                    <description>Redis server process name for LLD</description>
                </macro>
                <macro>
                    <macro>{$REDIS.MEM.FRAG_RATIO.MAX.WARN}</macro>
                    <value>1.5</value>
                    <description>Maximum memory fragmentation ratio</description>
                </macro>
                <macro>
                    <macro>{$REDIS.MEM.PUSED.MAX.WARN}</macro>
                    <value>90</value>
                    <description>Maximum percentage of memory used</description>
                </macro>
                <macro>
                    <macro>{$REDIS.PROCESS_NAME}</macro>
                    <value>redis-server</value>
                    <description>Redis server process name</description>
                </macro>
                <macro>
                    <macro>{$REDIS.REPL.LAG.MAX.WARN}</macro>
                    <value>30s</value>
                    <description>Maximum replication lag in seconds</description>
                </macro>
                <macro>
                    <macro>{$REDIS.SLOWLOG.COUNT.MAX.WARN}</macro>
                    <value>1</value>
                    <description>Maximum number of slowlog entries per second</description>
                </macro>
            </macros>
            <dashboards>
                <dashboard>
                    <name>Redis overview</name>
                    <widgets>
                        <widget>
                            <type>GRAPH_CLASSIC</type>
                            <width>12</width>
                            <height>5</height>
                            <fields>
                                <field>
                                    <type>INTEGER</type>
                                    <name>source_type</name>
                                    <value>0</value>
                                </field>
                                <field>
                                    <type>GRAPH</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>Redis: Clients</name>
                                        <host>Redis</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                        <widget>
                            <type>GRAPH_CLASSIC</type>
                            <x>12</x>
                            <width>12</width>
                            <height>5</height>
                            <fields>
                                <field>
                                    <type>INTEGER</type>
                                    <name>source_type</name>
                                    <value>0</value>
                                </field>
                                <field>
                                    <type>GRAPH</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>Redis: Keyspace</name>
                                        <host>Redis</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                        <widget>
                            <type>GRAPH_CLASSIC</type>
                            <y>5</y>
                            <width>12</width>
                            <height>5</height>
                            <fields>
                                <field>
                                    <type>INTEGER</type>
                                    <name>source_type</name>
                                    <value>0</value>
                                </field>
                                <field>
                                    <type>GRAPH</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>Redis: Commands</name>
                                        <host>Redis</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                        <widget>
                            <type>GRAPH_CLASSIC</type>
                            <x>12</x>
                            <y>5</y>
                            <width>12</width>
                            <height>5</height>
                            <fields>
                                <field>
                                    <type>INTEGER</type>
                                    <name>source_type</name>
                                    <value>0</value>
                                </field>
                                <field>
                                    <type>GRAPH</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>Redis: Expired keys</name>
                                        <host>Redis</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                        <widget>
                            <type>GRAPH_CLASSIC</type>
                            <y>10</y>
                            <width>12</width>
                            <height>5</height>
                            <fields>
                                <field>
                                    <type>INTEGER</type>
                                    <name>source_type</name>
                                    <value>0</value>
                                </field>
                                <field>
                                    <type>GRAPH</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>Redis: Persistence</name>
                                        <host>Redis</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                        <widget>
                            <type>GRAPH_CLASSIC</type>
                            <x>12</x>
                            <y>10</y>
                            <width>12</width>
                            <height>5</height>
                            <fields>
                                <field>
                                    <type>INTEGER</type>
                                    <name>source_type</name>
                                    <value>0</value>
                                </field>
                                <field>
                                    <type>GRAPH</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>Redis: Slaves</name>
                                        <host>Redis</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                        <widget>
                            <type>GRAPH_CLASSIC</type>
                            <y>15</y>
                            <width>12</width>
                            <height>5</height>
                            <fields>
                                <field>
                                    <type>INTEGER</type>
                                    <name>source_type</name>
                                    <value>0</value>
                                </field>
                                <field>
                                    <type>GRAPH</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>Redis: Slowlog</name>
                                        <host>Redis</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                        <widget>
                            <type>GRAPH_CLASSIC</type>
                            <x>12</x>
                            <y>15</y>
                            <width>12</width>
                            <height>5</height>
                            <fields>
                                <field>
                                    <type>INTEGER</type>
                                    <name>source_type</name>
                                    <value>0</value>
                                </field>
                                <field>
                                    <type>GRAPH</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>Redis: Uptime</name>
                                        <host>Redis</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                        <widget>
                            <type>GRAPH_PROTOTYPE</type>
                            <y>20</y>
                            <width>12</width>
                            <height>5</height>
                            <fields>
                                <field>
                                    <type>INTEGER</type>
                                    <name>columns</name>
                                    <value>1</value>
                                </field>
                                <field>
                                    <type>INTEGER</type>
                                    <name>rows</name>
                                    <value>1</value>
                                </field>
                                <field>
                                    <type>INTEGER</type>
                                    <name>source_type</name>
                                    <value>2</value>
                                </field>
                                <field>
                                    <type>GRAPH_PROTOTYPE</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>Redis: Replication lag time{#SINGLETON}</name>
                                        <host>Redis</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                    </widgets>
                </dashboard>
                <dashboard>
                    <name>Redis performance</name>
                    <widgets>
                        <widget>
                            <type>GRAPH_CLASSIC</type>
                            <width>12</width>
                            <height>5</height>
                            <fields>
                                <field>
                                    <type>INTEGER</type>
                                    <name>source_type</name>
                                    <value>0</value>
                                </field>
                                <field>
                                    <type>GRAPH</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>Redis: CPU</name>
                                        <host>Redis</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                        <widget>
                            <type>GRAPH_CLASSIC</type>
                            <x>12</x>
                            <width>12</width>
                            <height>5</height>
                            <fields>
                                <field>
                                    <type>INTEGER</type>
                                    <name>source_type</name>
                                    <value>0</value>
                                </field>
                                <field>
                                    <type>GRAPH</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>Redis: Network</name>
                                        <host>Redis</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                        <widget>
                            <type>GRAPH_CLASSIC</type>
                            <y>5</y>
                            <width>12</width>
                            <height>5</height>
                            <fields>
                                <field>
                                    <type>INTEGER</type>
                                    <name>source_type</name>
                                    <value>0</value>
                                </field>
                                <field>
                                    <type>GRAPH</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>Redis: Memory</name>
                                        <host>Redis</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                        <widget>
                            <type>GRAPH_CLASSIC</type>
                            <x>12</x>
                            <y>5</y>
                            <width>12</width>
                            <height>5</height>
                            <fields>
                                <field>
                                    <type>INTEGER</type>
                                    <name>source_type</name>
                                    <value>0</value>
                                </field>
                                <field>
                                    <type>GRAPH</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>Redis: Memory fragmentation</name>
                                        <host>Redis</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                    </widgets>
                </dashboard>
            </dashboards>
        </template>
    </templates>
    <triggers>
        <trigger>
            <expression>{Redis:redis.clients.connected.min(5m)}/{Redis:redis.config.maxclients.last()}*100&gt;{$REDIS.CLIENTS.PRC.MAX.WARN}</expression>
            <name>Redis: Total number of connected clients is too high (over {$REDIS.CLIENTS.PRC.MAX.WARN}% in 5m)</name>
            <priority>WARNING</priority>
            <description>When the number of clients reaches the value of the &quot;maxclients&quot; parameter, new connections will be rejected.

https://redis.io/topics/clients#maximum-number-of-clients</description>
        </trigger>
    </triggers>
    <graphs>
        <graph>
            <name>Redis: Clients</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>1A7C11</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.clients.connected</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>2774A4</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.clients.blocked</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Redis: Commands</name>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.stats.instantaneous_ops.rate</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Redis: CPU</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>1A7C11</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.cpu.sys</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.cpu.sys_children</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>F63100</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.cpu.user</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>A54F10</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.cpu.user_children</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Redis: Expired keys</name>
            <graph_items>
                <graph_item>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>1A7C11</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.stats.expired_keys</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>2774A4</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.stats.evicted_keys</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Redis: Keyspace</name>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.stats.keyspace_hits</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.stats.keyspace_misses</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Redis: Memory</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>1A7C11</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.memory.used_memory</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>2774A4</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.memory.used_memory_rss</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>F63100</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.memory.used_memory_peak</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Redis: Memory fragmentation</name>
            <graph_items>
                <graph_item>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>1A7C11</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.memory.fragmentation_ratio</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Redis: Network</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>1A7C11</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.stats.instantaneous_input.rate</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>2774A4</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.stats.instantaneous_output.rate</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Redis: Persistence</name>
            <graph_items>
                <graph_item>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>1A7C11</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.persistence.rdb_last_bgsave_time_sec</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>BOLD_LINE</drawtype>
                    <color>2774A4</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.persistence.aof_last_rewrite_time_sec</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Redis: Slaves</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>1A7C11</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.replication.connected_slaves</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Redis: Slowlog</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>1A7C11</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.slowlog.count[&quot;{$REDIS.CONN.URI}&quot;]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Redis: Uptime</name>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>Redis</host>
                        <key>redis.server.uptime</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
    <value_maps>
        <value_map>
            <name>Redis bgsave time</name>
            <mappings>
                <mapping>
                    <value>- 1s</value>
                    <newvalue>Inactive</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Redis bgwrite status</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Error</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Ok</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Redis flag</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>No</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Yes</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Redis repl offset</name>
            <mappings>
                <mapping>
                    <value>-1 B</value>
                    <newvalue>Undefined</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Service state</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Down</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Up</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
