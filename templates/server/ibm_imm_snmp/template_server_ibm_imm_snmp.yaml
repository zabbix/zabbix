zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: e960332b3f6c46a1956486d4f3f99fce
      name: 'Templates/Server hardware'
  templates:
    - uuid: c9e1acd3ae4a427ab39724b6bcaf839e
      template: 'IBM IMM by SNMP'
      name: 'IBM IMM by SNMP'
      description: |
        Template Server IBM IMM
        
        MIBs used:
        IMM-MIB
        HOST-RESOURCES-MIB
        SNMPv2-MIB
        
        Known Issues:
        
          Description: Some IMMs (IMM1) do not return disks
          Version: IMM1
          Device: IBM x3250M3
        
          Description: Some IMMs (IMM1) do not return fan status: fanHealthStatus
          Version: IMM1
          Device: IBM x3250M3
        
          Description: IMM1 servers (M2, M3 generations) sysObjectID is NET-SNMP-MIB::netSnmpAgentOIDs.10
          Version: IMM1
          Device: IMM1 servers (M2,M3 generations)
        
          Description: IMM1 servers (M2, M3 generations) only Ambient temperature sensor available
          Version: IMM1
          Device: IMM1 servers (M2,M3 generations)
        
        Generated by official Zabbix template tool "Templator"
      vendor:
        name: Zabbix
        version: 7.0-2
      groups:
        - name: 'Templates/Server hardware'
      items:
        - uuid: 303807b2799f4f7cace3d781e9ed1715
          name: 'ICMP ping'
          type: SIMPLE
          key: icmpping
          description: |
            The host accessibility by ICMP ping.
            
            0 - ICMP ping fails;
            1 - ICMP ping successful.
          valuemap:
            name: 'Service state'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 937225d93eea44b3a8328eee03cf66f0
              expression: 'max(/IBM IMM by SNMP/icmpping,#3)=0'
              name: 'IBM IMM: Unavailable by ICMP ping'
              priority: HIGH
              description: 'Last three attempts returned timeout. Please check device connectivity.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 4af423253e1b4960825b49041d9c8feb
          name: 'ICMP loss'
          type: SIMPLE
          key: icmppingloss
          value_type: FLOAT
          units: '%'
          description: 'The percentage of lost packets.'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: ec37a141b33c46308b8d810069ce9142
              expression: 'min(/IBM IMM by SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/IBM IMM by SNMP/icmppingloss,5m)<100'
              name: 'IBM IMM: High ICMP ping loss'
              opdata: 'Loss: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'ICMP packets loss detected.'
              dependencies:
                - name: 'IBM IMM: Unavailable by ICMP ping'
                  expression: 'max(/IBM IMM by SNMP/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: b1659e3298fb447f8ee93e8bab98a22d
          name: 'ICMP response time'
          type: SIMPLE
          key: icmppingsec
          value_type: FLOAT
          units: s
          description: 'The ICMP ping response time (in seconds).'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 0541700de60549da8439f9b75cf83e7f
              expression: 'avg(/IBM IMM by SNMP/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN}'
              name: 'IBM IMM: High ICMP ping response time'
              opdata: 'Value: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Average ICMP response time is too high.'
              dependencies:
                - name: 'IBM IMM: High ICMP ping loss'
                  expression: 'min(/IBM IMM by SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/IBM IMM by SNMP/icmppingloss,5m)<100'
                - name: 'IBM IMM: Unavailable by ICMP ping'
                  expression: 'max(/IBM IMM by SNMP/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: e0a1cdb1df4d408087a8ed3d473ce1fe
          name: 'SNMP traps (fallback)'
          type: SNMP_TRAP
          key: snmptrap.fallback
          delay: '0'
          value_type: LOG
          trends: '0'
          description: 'The item is used to collect all SNMP traps unmatched by other snmptrap items'
          logtimefmt: 'hh:mm:sszyyyy/MM/dd'
          tags:
            - tag: component
              value: network
        - uuid: 6686560b390540b593a2d3bb3289ea41
          name: 'System contact details'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.4.0]'
          key: 'system.contact[sysContact.0]'
          delay: 15m
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            The textual identification of the contact person for this managed node, together with information on how to contact this person. If no contact information is known, the value is the zero-length string.
          inventory_link: CONTACT
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 905c91ce799849dfb56b800c93849826
          name: 'System description'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.1.0]'
          key: 'system.descr[sysDescr.0]'
          delay: 15m
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            A textual description of the entity. This value should
            include the full name and version identification of the system's hardware type, software operating-system, and
            networking software.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 7075609a2d2545828a93f701d7b02c17
          name: 'Hardware model name'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2.3.51.3.1.5.2.1.5.0]'
          key: system.hw.model
          delay: 1h
          value_type: CHAR
          trends: '0'
          description: 'MIB: IMM-MIB'
          inventory_link: MODEL
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
        - uuid: db393421a28b44148b0a1e1273186900
          name: 'Hardware serial number'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2.3.51.3.1.5.2.1.3.0]'
          key: system.hw.serialnumber
          delay: 1h
          value_type: CHAR
          trends: '0'
          description: |
            MIB: IMM-MIB
            Machine serial number VPD information
          inventory_link: SERIALNO_A
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: b2bf06198d5840c6905ea6cf6d9e443c
              expression: 'last(/IBM IMM by SNMP/system.hw.serialnumber,#1)<>last(/IBM IMM by SNMP/system.hw.serialnumber,#2) and length(last(/IBM IMM by SNMP/system.hw.serialnumber))>0'
              name: 'IBM IMM: Device has been replaced'
              event_name: 'IBM IMM: Device has been replaced (new serial number received)'
              priority: INFO
              description: 'Device serial number has changed. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: 81e5ed7d945d40f780eb9bd872ea1832
          name: 'Uptime (hardware)'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.25.1.1.0]'
          key: 'system.hw.uptime[hrSystemUptime.0]'
          delay: 30s
          trends: '0'
          units: uptime
          description: |
            MIB: HOST-RESOURCES-MIB
            The amount of time since this host was last initialized. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system.
          preprocessing:
            - type: CHECK_NOT_SUPPORTED
              parameters:
                - '-1'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: 589def06a1b74a7f8ada7cc4576aa9eb
          name: 'System location'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.6.0]'
          key: 'system.location[sysLocation.0]'
          delay: 15m
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            Physical location of the node (e.g., `equipment room`, `3rd floor`). If not provided, the value is a zero-length string.
          inventory_link: LOCATION
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 596ce9f7e6b848e4869cd195996c7114
          name: 'System name'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.5.0]'
          key: system.name
          delay: 15m
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name. If the name is unknown, the value is the zero-length string.
          inventory_link: NAME
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 188852025e644d5ab583f9d7a9dea06c
              expression: 'last(/IBM IMM by SNMP/system.name,#1)<>last(/IBM IMM by SNMP/system.name,#2) and length(last(/IBM IMM by SNMP/system.name))>0'
              name: 'IBM IMM: System name has changed'
              event_name: 'IBM IMM: System name has changed (new name: {ITEM.VALUE})'
              priority: INFO
              description: 'The name of the system has changed. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
                - tag: scope
                  value: security
        - uuid: 97cd7cf6a9a545788a2f709bacb925ed
          name: 'Uptime (network)'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.3.0]'
          key: 'system.net.uptime[sysUpTime.0]'
          delay: 30s
          trends: '0'
          units: uptime
          description: |
            MIB: SNMPv2-MIB
            Time (in hundredths of a second) since the network management portion of the system was last re-initialized.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: ad8eada79b464821a14759f32f6d7f2a
          name: 'System object ID'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.2.0]'
          key: 'system.objectid[sysObjectID.0]'
          delay: 15m
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            The vendor's authoritative identification of the network management subsystem contained in the entity. This value is allocated within the SMI enterprises subtree (1.3.6.1.4.1) and provides an easy and unambiguous means for determining`what kind of box' is being managed.  For example, if vendor`Flintstones, Inc.' was assigned the subtree1.3.6.1.4.1.4242, it could assign the identifier 1.3.6.1.4.1.4242.1.1 to its `Fred Router'.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 33572e0e11214d8b8454e6947e0d282d
          name: 'Overall system health status'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2.3.51.3.1.4.1.0]'
          key: 'system.status[systemHealthStat.0]'
          delay: 30s
          trends: '0'
          description: |
            MIB: IMM-MIB
            Indicates status of system health for the system in which the IMM resides. Value of 'nonRecoverable' indicates a severe error has occurred and the system may not be functioning. A value of 'critical' indicates that an error has occurred but the system is currently functioning properly. A value of 'nonCritical' indicates that a condition has occurred that may change the state of the system in the future but currently the system is working properly. A value of 'normal' indicates that the system is operating normally.
          valuemap:
            name: 'IMM-MIB::systemHealthStat'
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: ea8fbc9446d34033b60a8214b8199ea1
              expression: 'count(/IBM IMM by SNMP/system.status[systemHealthStat.0],#1,"eq","{$HEALTH_DISASTER_STATUS}")=1'
              name: 'IBM IMM: System is in unrecoverable state!'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: HIGH
              description: 'Please check the device for faults'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
            - uuid: a76c198aeb7d452a8c710ddde21aa12e
              expression: 'count(/IBM IMM by SNMP/system.status[systemHealthStat.0],#1,"eq","{$HEALTH_CRIT_STATUS}")=1'
              name: 'IBM IMM: System status is in critical state'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: HIGH
              description: 'Please check the device for errors'
              dependencies:
                - name: 'IBM IMM: System is in unrecoverable state!'
                  expression: 'count(/IBM IMM by SNMP/system.status[systemHealthStat.0],#1,"eq","{$HEALTH_DISASTER_STATUS}")=1'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
            - uuid: acd147a3d41b49478410f4d49562cde2
              expression: 'count(/IBM IMM by SNMP/system.status[systemHealthStat.0],#1,"eq","{$HEALTH_WARN_STATUS}")=1'
              name: 'IBM IMM: System status is in warning state'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Please check the device for warnings'
              dependencies:
                - name: 'IBM IMM: System is in unrecoverable state!'
                  expression: 'count(/IBM IMM by SNMP/system.status[systemHealthStat.0],#1,"eq","{$HEALTH_DISASTER_STATUS}")=1'
                - name: 'IBM IMM: System status is in critical state'
                  expression: 'count(/IBM IMM by SNMP/system.status[systemHealthStat.0],#1,"eq","{$HEALTH_CRIT_STATUS}")=1'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: 59d2bec423a84ca186d5785ddea5270b
          name: 'SNMP agent availability'
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          description: |
            Availability of SNMP checks on the host. The value of this item corresponds to availability icons in the host list.
            Possible values:
            0 - not available
            1 - available
            2 - unknown
          valuemap:
            name: zabbix.host.available
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: fbec2f12ac244723bb31dec5efcc6f85
              expression: 'max(/IBM IMM by SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              name: 'IBM IMM: No SNMP data collection'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'SNMP is not available for polling. Please check device connectivity and SNMP settings.'
              dependencies:
                - name: 'IBM IMM: Unavailable by ICMP ping'
                  expression: 'max(/IBM IMM by SNMP/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
      discovery_rules:
        - uuid: c93e3c9379a4434f84334e5989ec2592
          name: 'FAN Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#FAN_DESCR},1.3.6.1.4.1.2.3.51.3.1.3.2.1.2]'
          key: fan.discovery
          delay: 1h
          description: 'IMM-MIB::fanDescr'
          item_prototypes:
            - uuid: 3281ba9d16754ff79a9ed0e2bb328129
              name: '{#FAN_DESCR}: Fan speed, %'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.4.1.2.3.51.3.1.3.2.1.3.{#SNMPINDEX}]'
              key: 'sensor.fan.speed.percentage[fanSpeed.{#SNMPINDEX}]'
              units: '%'
              description: |
                MIB: IMM-MIB
                Fan speed expressed in percent(%) of maximum RPM.
                An octet string expressed as 'ddd% of maximum' where:d is a decimal digit or blank space for a leading zero.
                If the fan is determined not to be running or the fan speed cannot be determined, the string will indicate 'Offline'.
              preprocessing:
                - type: REGEX
                  parameters:
                    - '(\d{1,3}) *%( of maximum)?'
                    - \1
              tags:
                - tag: component
                  value: fan
            - uuid: 6e576c4059c84b6fa80376ee59fd373b
              name: '{#FAN_DESCR}: Fan status'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.4.1.2.3.51.3.1.3.2.1.10.{#SNMPINDEX}]'
              key: 'sensor.fan.status[fanHealthStatus.{#SNMPINDEX}]'
              delay: 3m
              value_type: CHAR
              trends: '0'
              description: |
                MIB: IMM-MIB
                A description of the fan component status.
              tags:
                - tag: component
                  value: fan
              trigger_prototypes:
                - uuid: b2d4ae5922174af6b0ef274accc8ae21
                  expression: 'count(/IBM IMM by SNMP/sensor.fan.status[fanHealthStatus.{#SNMPINDEX}],#1,"ne","{$FAN_OK_STATUS}")=1'
                  name: 'IBM IMM: {#FAN_DESCR}: Fan is not in normal state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: INFO
                  description: 'Please check the fan unit'
                  tags:
                    - tag: scope
                      value: notice
        - uuid: dbf08da1d50c4a919bd2bbb1ee15f77e
          name: 'Physical Disk Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.2.3.51.3.1.12.2.1.1]'
          key: physicalDisk.discovery
          delay: 1h
          item_prototypes:
            - uuid: 08f626e126bf45fa8f978a2324118626
              name: '{#SNMPINDEX}: Physical disk part number'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.4.1.2.3.51.3.1.12.2.1.2.{#SNMPINDEX}]'
              key: 'system.hw.physicaldisk.part_number[diskFruName.{#SNMPINDEX}]'
              delay: 1h
              value_type: CHAR
              trends: '0'
              description: |
                MIB: IMM-MIB
                disk module FRU name.
              tags:
                - tag: component
                  value: disk
                - tag: component
                  value: storage
            - uuid: da7aa00e553c4014a70fe08f5fdb67fd
              name: '{#SNMPINDEX}: Physical disk status'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.4.1.2.3.51.3.1.12.2.1.3.{#SNMPINDEX}]'
              key: 'system.hw.physicaldisk.status[diskHealthStatus.{#SNMPINDEX}]'
              delay: 3m
              value_type: CHAR
              trends: '0'
              description: 'MIB: IMM-MIB'
              tags:
                - tag: component
                  value: disk
                - tag: component
                  value: storage
              trigger_prototypes:
                - uuid: 45eb3fe3369a41b199179e2eca725027
                  expression: 'count(/IBM IMM by SNMP/system.hw.physicaldisk.status[diskHealthStatus.{#SNMPINDEX}],#1,"ne","{$DISK_OK_STATUS}")=1'
                  name: 'IBM IMM: {#SNMPINDEX}: Physical disk is not in OK state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Please check physical disk for warnings or errors'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
        - uuid: e83e43db572d4a25b80629a115214ae8
          name: 'PSU Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#PSU_DESCR},1.3.6.1.4.1.2.3.51.3.1.11.2.1.2]'
          key: psu.discovery
          delay: 1h
          description: 'IMM-MIB::powerFruName'
          item_prototypes:
            - uuid: e8c7e01f5c3f40d29cdaa7506e293c80
              name: '{#PSU_DESCR}: Power supply status'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.4.1.2.3.51.3.1.11.2.1.6.{#SNMPINDEX}]'
              key: 'sensor.psu.status[powerHealthStatus.{#SNMPINDEX}]'
              delay: 3m
              value_type: CHAR
              trends: '0'
              description: |
                MIB: IMM-MIB
                A description of the power module status.
              tags:
                - tag: component
                  value: power
              trigger_prototypes:
                - uuid: 4e7767484cff49b098e73b068ef04160
                  expression: 'count(/IBM IMM by SNMP/sensor.psu.status[powerHealthStatus.{#SNMPINDEX}],#1,"ne","{$PSU_OK_STATUS}")=1'
                  name: 'IBM IMM: {#PSU_DESCR}: Power supply is not in normal state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: INFO
                  description: 'Please check the power supply unit for errors'
                  tags:
                    - tag: scope
                      value: notice
        - uuid: b5ac4b78efca4e8a9d8b2eb875f49c49
          name: 'Temperature Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.2.3.51.3.1.1.2.1.2]'
          key: tempDescr.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#SNMPVALUE}'
                value: '(DIMM|PSU|PCH|RAID|RR|PCI).*'
                formulaid: A
          description: 'Scanning IMM-MIB::tempTable'
          item_prototypes:
            - uuid: 02af08c624bc444aae5d1f1b8f8b5d4a
              name: '{#SNMPVALUE}: Temperature'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.4.1.2.3.51.3.1.1.2.1.3.{#SNMPINDEX}]'
              key: 'sensor.temp.value[tempReading.{#SNMPINDEX}]'
              delay: 3m
              value_type: FLOAT
              units: °C
              description: |
                MIB: IMM-MIB
                Temperature readings of testpoint: {#SNMPVALUE}
              tags:
                - tag: component
                  value: temperature
              trigger_prototypes:
                - uuid: 958eebe18bd94670b2b9029064a84bc9
                  expression: 'avg(/IBM IMM by SNMP/sensor.temp.value[tempReading.{#SNMPINDEX}],5m)>{$TEMP_CRIT:"{#SNMPVALUE}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/IBM IMM by SNMP/sensor.temp.value[tempReading.{#SNMPINDEX}],5m)<{$TEMP_CRIT:"{#SNMPVALUE}"}-3'
                  name: 'IBM IMM: {#SNMPVALUE}: Temperature is above critical threshold'
                  event_name: 'IBM IMM: {#SNMPVALUE}: Temperature is above critical threshold: >{$TEMP_CRIT:"{#SNMPVALUE}"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
                - uuid: ecb8ac5828e44a94a32164dce9811fbc
                  expression: 'avg(/IBM IMM by SNMP/sensor.temp.value[tempReading.{#SNMPINDEX}],5m)>{$TEMP_WARN:"{#SNMPVALUE}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/IBM IMM by SNMP/sensor.temp.value[tempReading.{#SNMPINDEX}],5m)<{$TEMP_WARN:"{#SNMPVALUE}"}-3'
                  name: 'IBM IMM: {#SNMPVALUE}: Temperature is above warning threshold'
                  event_name: 'IBM IMM: {#SNMPVALUE}: Temperature is above warning threshold: >{$TEMP_WARN:"{#SNMPVALUE}"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
                  dependencies:
                    - name: 'IBM IMM: {#SNMPVALUE}: Temperature is above critical threshold'
                      expression: 'avg(/IBM IMM by SNMP/sensor.temp.value[tempReading.{#SNMPINDEX}],5m)>{$TEMP_CRIT:"{#SNMPVALUE}"}'
                      recovery_expression: 'max(/IBM IMM by SNMP/sensor.temp.value[tempReading.{#SNMPINDEX}],5m)<{$TEMP_CRIT:"{#SNMPVALUE}"}-3'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
                - uuid: 8ff82421c9f74d509766e7dc139ab2c8
                  expression: 'avg(/IBM IMM by SNMP/sensor.temp.value[tempReading.{#SNMPINDEX}],5m)<{$TEMP_CRIT_LOW:"{#SNMPVALUE}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'min(/IBM IMM by SNMP/sensor.temp.value[tempReading.{#SNMPINDEX}],5m)>{$TEMP_CRIT_LOW:"{#SNMPVALUE}"}+3'
                  name: 'IBM IMM: {#SNMPVALUE}: Temperature is too low'
                  event_name: 'IBM IMM: {#SNMPVALUE}: Temperature is too low: <{$TEMP_CRIT_LOW:"{#SNMPVALUE}"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
        - uuid: 1e4d30dcff7f48bc872127d11f2e22b8
          name: 'Temperature Discovery Ambient'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.2.3.51.3.1.1.2.1.2]'
          key: tempDescr.discovery.ambient
          delay: 1h
          filter:
            conditions:
              - macro: '{#SNMPVALUE}'
                value: 'Ambient.*'
                formulaid: A
          description: 'Scanning IMM-MIB::tempTable with Ambient filter'
          item_prototypes:
            - uuid: c29ef915c0a6419eabd041ea34775c45
              name: 'Ambient: Temperature'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.4.1.2.3.51.3.1.1.2.1.3.{#SNMPINDEX}]'
              key: 'sensor.temp.value[tempReading.Ambient.{#SNMPINDEX}]'
              delay: 3m
              value_type: FLOAT
              units: °C
              description: |
                MIB: IMM-MIB
                Temperature readings of testpoint: Ambient
              tags:
                - tag: component
                  value: temperature
              trigger_prototypes:
                - uuid: 615967071d6b40f6b02e386c9586a66e
                  expression: 'avg(/IBM IMM by SNMP/sensor.temp.value[tempReading.Ambient.{#SNMPINDEX}],5m)>{$TEMP_CRIT:"Ambient"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/IBM IMM by SNMP/sensor.temp.value[tempReading.Ambient.{#SNMPINDEX}],5m)<{$TEMP_CRIT:"Ambient"}-3'
                  name: 'IBM IMM: Ambient: Temperature is above critical threshold'
                  event_name: 'IBM IMM: Ambient: Temperature is above critical threshold: >{$TEMP_CRIT:"Ambient"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
                - uuid: e6bcdf201e304471aa84cc8d34b290ec
                  expression: 'avg(/IBM IMM by SNMP/sensor.temp.value[tempReading.Ambient.{#SNMPINDEX}],5m)>{$TEMP_WARN:"Ambient"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/IBM IMM by SNMP/sensor.temp.value[tempReading.Ambient.{#SNMPINDEX}],5m)<{$TEMP_WARN:"Ambient"}-3'
                  name: 'IBM IMM: Ambient: Temperature is above warning threshold'
                  event_name: 'IBM IMM: Ambient: Temperature is above warning threshold: >{$TEMP_WARN:"Ambient"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
                  dependencies:
                    - name: 'IBM IMM: Ambient: Temperature is above critical threshold'
                      expression: 'avg(/IBM IMM by SNMP/sensor.temp.value[tempReading.Ambient.{#SNMPINDEX}],5m)>{$TEMP_CRIT:"Ambient"}'
                      recovery_expression: 'max(/IBM IMM by SNMP/sensor.temp.value[tempReading.Ambient.{#SNMPINDEX}],5m)<{$TEMP_CRIT:"Ambient"}-3'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
                - uuid: dd773e52746840e4b6f7517740873102
                  expression: 'avg(/IBM IMM by SNMP/sensor.temp.value[tempReading.Ambient.{#SNMPINDEX}],5m)<{$TEMP_CRIT_LOW:"Ambient"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'min(/IBM IMM by SNMP/sensor.temp.value[tempReading.Ambient.{#SNMPINDEX}],5m)>{$TEMP_CRIT_LOW:"Ambient"}+3'
                  name: 'IBM IMM: Ambient: Temperature is too low'
                  event_name: 'IBM IMM: Ambient: Temperature is too low: <{$TEMP_CRIT_LOW:"Ambient"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
        - uuid: 7eb45db4b05e42d39e0e2cf889dec2b8
          name: 'Temperature Discovery CPU'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.2.3.51.3.1.1.2.1.2]'
          key: tempDescr.discovery.cpu
          delay: 1h
          filter:
            conditions:
              - macro: '{#SNMPVALUE}'
                value: 'CPU [0-9]* Temp'
                formulaid: A
          description: 'Scanning IMM-MIB::tempTable with CPU filter'
          item_prototypes:
            - uuid: 87da5286971d4f6487c3220c85850658
              name: 'CPU: Temperature'
              type: SNMP_AGENT
              snmp_oid: 'get[1.3.6.1.4.1.2.3.51.3.1.1.2.1.3.{#SNMPINDEX}]'
              key: 'sensor.temp.value[tempReading.CPU.{#SNMPINDEX}]'
              delay: 3m
              value_type: FLOAT
              units: °C
              description: |
                MIB: IMM-MIB
                Temperature readings of testpoint: CPU
              tags:
                - tag: component
                  value: temperature
              trigger_prototypes:
                - uuid: e994d3d8398147c49062bc712dc4c204
                  expression: 'avg(/IBM IMM by SNMP/sensor.temp.value[tempReading.CPU.{#SNMPINDEX}],5m)>{$TEMP_CRIT:"CPU"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/IBM IMM by SNMP/sensor.temp.value[tempReading.CPU.{#SNMPINDEX}],5m)<{$TEMP_CRIT:"CPU"}-3'
                  name: 'IBM IMM: CPU: Temperature is above critical threshold'
                  event_name: 'IBM IMM: CPU: Temperature is above critical threshold: >{$TEMP_CRIT:"CPU"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
                - uuid: 3b7396311de1487e90416aa2c42cb03d
                  expression: 'avg(/IBM IMM by SNMP/sensor.temp.value[tempReading.CPU.{#SNMPINDEX}],5m)>{$TEMP_WARN:"CPU"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/IBM IMM by SNMP/sensor.temp.value[tempReading.CPU.{#SNMPINDEX}],5m)<{$TEMP_WARN:"CPU"}-3'
                  name: 'IBM IMM: CPU: Temperature is above warning threshold'
                  event_name: 'IBM IMM: CPU: Temperature is above warning threshold: >{$TEMP_WARN:"CPU"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
                  dependencies:
                    - name: 'IBM IMM: CPU: Temperature is above critical threshold'
                      expression: 'avg(/IBM IMM by SNMP/sensor.temp.value[tempReading.CPU.{#SNMPINDEX}],5m)>{$TEMP_CRIT:"CPU"}'
                      recovery_expression: 'max(/IBM IMM by SNMP/sensor.temp.value[tempReading.CPU.{#SNMPINDEX}],5m)<{$TEMP_CRIT:"CPU"}-3'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
                - uuid: e39d0e009efb4216ac7cbbe544ad4bc0
                  expression: 'avg(/IBM IMM by SNMP/sensor.temp.value[tempReading.CPU.{#SNMPINDEX}],5m)<{$TEMP_CRIT_LOW:"CPU"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'min(/IBM IMM by SNMP/sensor.temp.value[tempReading.CPU.{#SNMPINDEX}],5m)>{$TEMP_CRIT_LOW:"CPU"}+3'
                  name: 'IBM IMM: CPU: Temperature is too low'
                  event_name: 'IBM IMM: CPU: Temperature is too low: <{$TEMP_CRIT_LOW:"CPU"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
      tags:
        - tag: class
          value: hardware
        - tag: target
          value: ibm
        - tag: target
          value: imm
      macros:
        - macro: '{$DISK_OK_STATUS}'
          value: Normal
        - macro: '{$FAN_OK_STATUS}'
          value: Normal
        - macro: '{$HEALTH_CRIT_STATUS}'
          value: '2'
        - macro: '{$HEALTH_DISASTER_STATUS}'
          value: '0'
        - macro: '{$HEALTH_WARN_STATUS}'
          value: '4'
        - macro: '{$ICMP_LOSS_WARN}'
          value: '20'
          description: 'Warning threshold of ICMP packet loss in %.'
        - macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.15'
          description: 'Warning threshold of the average ICMP response time in seconds.'
        - macro: '{$PSU_OK_STATUS}'
          value: Normal
        - macro: '{$SNMP.TIMEOUT}'
          value: 5m
          description: 'Time interval for the SNMP availability trigger.'
        - macro: '{$TEMP_CRIT}'
          value: '60'
        - macro: '{$TEMP_CRIT:"Ambient"}'
          value: '35'
        - macro: '{$TEMP_CRIT_LOW}'
          value: '5'
        - macro: '{$TEMP_WARN}'
          value: '50'
        - macro: '{$TEMP_WARN:"Ambient"}'
          value: '30'
      dashboards:
        - uuid: bb225bac9cfd482198a8bc767744f2f1
          name: 'IBM IMM: Overview'
          pages:
            - name: Temperature
              widgets:
                - type: graphprototype
                  width: '72'
                  height: '4'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: ITEM_PROTOTYPE
                      name: itemid.0
                      value:
                        host: 'IBM IMM by SNMP'
                        key: 'sensor.temp.value[tempReading.{#SNMPINDEX}]'
                    - type: STRING
                      name: reference
                      value: AAAAA
                    - type: INTEGER
                      name: source_type
                      value: '3'
                - type: graphprototype
                  'y': '4'
                  width: '72'
                  height: '4'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: ITEM_PROTOTYPE
                      name: itemid.0
                      value:
                        host: 'IBM IMM by SNMP'
                        key: 'sensor.temp.value[tempReading.Ambient.{#SNMPINDEX}]'
                    - type: STRING
                      name: reference
                      value: AAAAB
                    - type: INTEGER
                      name: source_type
                      value: '3'
                - type: graphprototype
                  'y': '8'
                  width: '72'
                  height: '4'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: ITEM_PROTOTYPE
                      name: itemid.0
                      value:
                        host: 'IBM IMM by SNMP'
                        key: 'sensor.temp.value[tempReading.CPU.{#SNMPINDEX}]'
                    - type: STRING
                      name: reference
                      value: AAAAC
                    - type: INTEGER
                      name: source_type
                      value: '3'
            - name: Fan
              widgets:
                - type: graphprototype
                  width: '72'
                  height: '4'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: ITEM_PROTOTYPE
                      name: itemid.0
                      value:
                        host: 'IBM IMM by SNMP'
                        key: 'sensor.fan.speed.percentage[fanSpeed.{#SNMPINDEX}]'
                    - type: STRING
                      name: reference
                      value: AAAAD
                    - type: INTEGER
                      name: source_type
                      value: '3'
      valuemaps:
        - uuid: 61bded84be1d419083d8bd8a8bd25152
          name: 'IMM-MIB::systemHealthStat'
          mappings:
            - value: '0'
              newvalue: nonRecoverable
            - value: '2'
              newvalue: critical
            - value: '4'
              newvalue: nonCritical
            - value: '255'
              newvalue: normal
        - uuid: 2fa79738fa194e04bfaeee91a2e4396f
          name: 'Service state'
          mappings:
            - value: '0'
              newvalue: Down
            - value: '1'
              newvalue: Up
        - uuid: c446435a96c24db2845ba0651eb44c94
          name: zabbix.host.available
          mappings:
            - value: '0'
              newvalue: 'not available'
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: unknown
  triggers:
    - uuid: 7dd529ec3f1a4a59846a3a76536a7fa0
      expression: '(last(/IBM IMM by SNMP/system.hw.uptime[hrSystemUptime.0])>0 and last(/IBM IMM by SNMP/system.hw.uptime[hrSystemUptime.0])<10m) or (last(/IBM IMM by SNMP/system.hw.uptime[hrSystemUptime.0])=0 and last(/IBM IMM by SNMP/system.net.uptime[sysUpTime.0])<10m)'
      name: 'IBM IMM: Host has been restarted'
      event_name: 'IBM IMM: {HOST.NAME} has been restarted (uptime < 10m)'
      priority: WARNING
      description: 'Uptime is less than 10 minutes.'
      manual_close: 'YES'
      dependencies:
        - name: 'IBM IMM: No SNMP data collection'
          expression: 'max(/IBM IMM by SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
      tags:
        - tag: scope
          value: notice
