zabbix_export:
  version: '8.0'
  template_groups:
    - uuid: e960332b3f6c46a1956486d4f3f99fce
      name: 'Templates/Server hardware'
  templates:
    - uuid: 1e9fe6b88c7542638c0f5d94484858b2
      template: 'DELL PowerEdge R820 by HTTP'
      name: 'DELL PowerEdge R820 by HTTP'
      description: |
        Template for DELL PowerEdge R820 servers with iDRAC 8/9 firmware 4.32 and later and Redfish API enabled.
        
        You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/426752-discussion-thread-for-official-zabbix-dell-templates
        
        Generated by official Zabbix template tool "Templator"
      wizard_ready: 'YES'
      readme: |
        ## Overview
        
        This is a template for monitoring DELL PowerEdge R820 servers with iDRAC 8/9 firmware 4.32 (and later) with Redfish API enabled via Zabbix script items. This template works without any external scripts.
        
        ## Setup
        
        1\. Enable Redfish API in the Dell iDRAC interface of your server.
        
        2\. Create a user for monitoring with read-only permissions in the Dell iDRAC interface.
        
        3\. Create a host for Dell server with iDRAC IP as the Zabbix agent interface.
        
        4\. Link the template to the host.
        
        5\. Customize the values of the `{$DELL.HTTP.API.URL}`, `{$DELL.HTTP.API.USER}`, and `{$DELL.HTTP.API.PASSWORD}` macros.
        
        > NOTE! If you are experiencing timeouts on some of the items that are executing requests, adjust the `{$DELL.HTTP.REQUEST.TIMEOUT}` macro accordingly.
      vendor:
        name: Zabbix
        version: 8.0-2
      groups:
        - name: 'Templates/Server hardware'
      items:
        - uuid: 68a232da5e184d23ac524ee2d424fef7
          name: 'Get array controller resources'
          type: SCRIPT
          key: dell.server.array.resources.get
          history: '0'
          value_type: TEXT
          params: |
            function validateZabbixParams(requiredParams, allParams) {
            	requiredParams.forEach(function (field) {
            		if (typeof allParams !== 'object' || typeof allParams[field] === 'undefined' || allParams[field] === '') {
            			throw 'Required param is not set: ' + field + '.';
            		}
            	});
            }
            
            function Dell(service, action, params) {
            	this.zabbixLogPrefix = '[ DELL ] [ ' + service + ' ] [ ' + action + ' ]';
            	this.request = new HttpRequest();
            
            	this.executeRequest = function (apiPath) {
            		this.request.addHeader('Authorization: Basic ' + btoa(params['user'] + ':' + params['password']));
            
            		if (params['http_proxy']) {
            			this.request.setProxy(params['http_proxy']);
            			Zabbix.log(4, this.zabbixLogPrefix + ' Using http proxy: ' + params['http_proxy']);
            		}
            
            		const response = this.request.get(params['url'] + apiPath);
            
            		this.request.clearHeader();
            
            		if (this.request.getStatus() === parseInt(params['http_status_code'])) {
            			return response;
            		} else {
            			Zabbix.log(3, this.zabbixLogPrefix + ' Unexpected HTTP response code: ' + this.request.getStatus());
            			throw 'Unexpected HTTP response code: ' + this.request.getStatus();
            		}
            	};
            
            	this.extractData = function (data, keys, skipParse) {
            		if (!skipParse) {
            			try {
            				data = JSON.parse(data);
            			} catch (error) {
            				Zabbix.log(3, this.zabbixLogPrefix + ' Could not parse the received JSON object: ' + data);
            				throw 'Could not parse received JSON object. See logs for more information.';
            			}	
            		}
            
            		if (Array.isArray(keys)) {
            			var returnBuffer = {};
            
            			for (keyIdx = 0, keysLength = keys.length; keyIdx < keysLength; keyIdx++) {
            				if (keys[keyIdx]['path'] === '@odata.id') {
            					returnBuffer[keys[keyIdx]['name']] = data[keys[keyIdx]['path']];
            				} else {
            					returnBuffer[keys[keyIdx]['name']] = this.parseJSON(data, keys[keyIdx]['path'].split('.'));
            				}
            			}
            
            			return returnBuffer;
            		} else if (typeof keys === 'object') {
            			return { [keys['name']]: this.parseJSON(data, keys['path'].split('.')) };
            		} else if (typeof keys === 'string') {
            			return this.parseJSON(data, keys.split('.'));
            		} else {
            			throw 'Unexpected key type';
            		}
            	};
            
            	this.parseJSON = function (data, jsonPath) {
            		for (var i = 0, args = jsonPath.length; i < args; i++) {
            			data = data[jsonPath[i]];
            		}
            
            		return data;
            	}
            }
            
            
            const params = JSON.parse(value);
            
            validateZabbixParams(['url', 'user', 'password', 'http_status_code'], params);
            var dell = new Dell('Controller', 'Discovery', params);
            
            const controllers = dell.extractData(dell.executeRequest('/redfish/v1/Systems/System.Embedded.1/Storage?$expand=.($levels=1)'), 'Members');
            
            var arrControllerKeys = [
            	{
            		'name': 'id',
            		'path': 'Id'
            	},
            	{
            		'name': 'name',
            		'path': 'Name'
            	},
            	{
            		'name': 'health',
            		'path': 'Status.Health'
            	},
            	{
            		'name': 'slot',
            		'path': 'Oem.Dell.DellController.PCISlot'
            	}
            ];
            
            var battControllerKeys = [
            	{
            		'name': 'id',
            		'path': 'Oem.Dell.DellControllerBattery.Id'
            	},
            	{
            		'name': 'name',
            		'path': 'Oem.Dell.DellControllerBattery.Name'
            	},
            	{
            		'name': 'status',
            		'path': 'Oem.Dell.DellControllerBattery.PrimaryStatus'
            	}
            ];
            
            if (!Array.isArray(controllers)) {
            	throw 'Unexpected type for controllers.';
            }
            
            var buffer = { 'arrayControllers': [], 'batteryControllers': [] };
            
            controllers.forEach(function (controller) {
            	if (controller['Id'].search('RAID') > -1) {
            		buffer['arrayControllers'].push(dell.extractData(controller, arrControllerKeys, true));
            		buffer['batteryControllers'].push(dell.extractData(controller, battControllerKeys, true));
            	}
            });
            
            return JSON.stringify(buffer);
          description: 'Returns array controller resources.'
          timeout: '{$DELL.HTTP.REQUEST.TIMEOUT}'
          parameters:
            - name: http_proxy
              value: '{$DELL.HTTP.PROXY}'
            - name: http_status_code
              value: '{$DELL.HTTP.RETURN.CODE.OK}'
            - name: password
              value: '{$DELL.HTTP.API.PASSWORD}'
            - name: url
              value: '{$DELL.HTTP.API.URL}'
            - name: user
              value: '{$DELL.HTTP.API.USER}'
          tags:
            - tag: component
              value: raw
        - uuid: 029cf7dfa7734c4a86292d2b3b3b907b
          name: 'Get disks'
          type: SCRIPT
          key: dell.server.disks.get
          delay: 1h
          history: '0'
          value_type: TEXT
          params: |
            function validateZabbixParams(requiredParams, allParams) {
            	requiredParams.forEach(function (field) {
            		if (typeof allParams !== 'object' || typeof allParams[field] === 'undefined' || allParams[field] === '') {
            			throw 'Required param is not set: ' + field + '.';
            		}
            	});
            }
            
            function Dell(service, action, params) {
            	this.zabbixLogPrefix = '[ DELL ] [ ' + service + ' ] [ ' + action + ' ]';
            	this.request = new HttpRequest();
            
            	this.executeRequest = function (apiPath) {
            		this.request.addHeader('Authorization: Basic ' + btoa(params['user'] + ':' + params['password']));
            
            		if (params['http_proxy']) {
            			this.request.setProxy(params['http_proxy']);
            			Zabbix.log(4, this.zabbixLogPrefix + ' Using http proxy: ' + params['http_proxy']);
            		}
            
            		const response = this.request.get(params['url'] + apiPath);
            
            		this.request.clearHeader();
            
            		if (this.request.getStatus() === parseInt(params['http_status_code'])) {
            			return response;
            		} else {
            			Zabbix.log(3, this.zabbixLogPrefix + ' Unexpected HTTP response code: ' + this.request.getStatus());
            			throw 'Unexpected HTTP response code: ' + this.request.getStatus();
            		}
            	};
            
            	this.extractData = function (data, keys, skipParse) {
            		if (!skipParse) {
            			try {
            				data = JSON.parse(data);
            			} catch (error) {
            				Zabbix.log(3, this.zabbixLogPrefix + ' Could not parse the received JSON object: ' + data);
            				throw 'Could not parse received JSON object. See logs for more information.';
            			}	
            		}
            
            		if (Array.isArray(keys)) {
            			var returnBuffer = {};
            
            			for (keyIdx = 0, keysLength = keys.length; keyIdx < keysLength; keyIdx++) {
            				if (keys[keyIdx]['path'] === '@odata.id') {
            					returnBuffer[keys[keyIdx]['name']] = data[keys[keyIdx]['path']];
            				} else {
            					returnBuffer[keys[keyIdx]['name']] = this.parseJSON(data, keys[keyIdx]['path'].split('.'));
            				}
            			}
            
            			return returnBuffer;
            		} else if (typeof keys === 'object') {
            			return { [keys['name']]: this.parseJSON(data, keys['path'].split('.')) };
            		} else if (typeof keys === 'string') {
            			return this.parseJSON(data, keys.split('.'));
            		} else {
            			throw 'Unexpected key type';
            		}
            	};
            
            	this.parseJSON = function (data, jsonPath) {
            		for (var i = 0, args = jsonPath.length; i < args; i++) {
            			data = data[jsonPath[i]];
            		}
            
            		return data;
            	}
            }
            
            
            const params = JSON.parse(value);
            
            validateZabbixParams(['url', 'user', 'password', 'http_status_code'], params);
            var dell = new Dell('Disk', 'Discovery', params);
            
            const disks = dell.extractData(dell.executeRequest('/redfish/v1/Systems/System.Embedded.1/Storage'), 'Members');
            
            var keys = [
            	{
            		'name': 'path',
            		'path': '@odata.id'
            	},
            	{
            		'name': 'name',
            		'path': 'Name'
            	}
            ];
            
            if (!Array.isArray(disks)) {
            	throw 'Unexpected type for disks.';
            }
            
            var buffer = { 'physicalDisks': [], 'virtualDisks': [] };
            
            disks.forEach(function (disk) {
            	var requests = [{ 'usage': 'physicalDisks', 'path': '', 'target': 'Drives' }, { 'usage': 'virtualDisks', 'path': '/Volumes', 'target': 'Members' }];
            
            	requests.forEach(function (request) {
            		const disks = dell.extractData(dell.executeRequest(disk['@odata.id'] + request['path']), request['target']);
            
            		if (!Array.isArray(disks) || disks.length <= 0) {
            			return;
            		}
            
            		disks.forEach(function (drive) {
            			buffer[request['usage']].push(dell.extractData(dell.executeRequest(drive['@odata.id']), keys));
            		});
            	});
            });
            
            return JSON.stringify(buffer);
          description: 'Returns storage resources.'
          timeout: '{$DELL.HTTP.REQUEST.TIMEOUT}'
          parameters:
            - name: http_proxy
              value: '{$DELL.HTTP.PROXY}'
            - name: http_status_code
              value: '{$DELL.HTTP.RETURN.CODE.OK}'
            - name: password
              value: '{$DELL.HTTP.API.PASSWORD}'
            - name: url
              value: '{$DELL.HTTP.API.URL}'
            - name: user
              value: '{$DELL.HTTP.API.USER}'
          tags:
            - tag: component
              value: raw
        - uuid: f6ecf0d86c9f4464a83f1b6dd5a8e070
          name: 'Firmware version'
          type: DEPENDENT
          key: dell.server.hw.firmware
          value_type: CHAR
          description: 'This attribute defines the firmware version of a remote access card.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.firmware
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
          master_item:
            key: dell.server.system.get
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 16d23330f3274801b7ad216aae251587
              expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.hw.firmware,#1)<>last(/DELL PowerEdge R820 by HTTP/dell.server.hw.firmware,#2) and length(last(/DELL PowerEdge R820 by HTTP/dell.server.hw.firmware))>0'
              name: 'Dell R820: Firmware has changed'
              opdata: 'Current value: {ITEM.LASTVALUE1}'
              priority: INFO
              description: 'The firmware version has changed. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: 9d5f0c838c7540ce815d21cd227894b1
          name: 'Hardware model name'
          type: DEPENDENT
          key: dell.server.hw.model
          value_type: CHAR
          description: 'This attribute defines the model name of the system.'
          inventory_link: MODEL
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.model
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
          master_item:
            key: dell.server.system.get
          tags:
            - tag: component
              value: system
        - uuid: 6e7cbcd6ae3e40b39784142f3a10ede8
          name: 'Hardware serial number'
          type: DEPENDENT
          key: dell.server.hw.serialnumber
          value_type: CHAR
          description: 'This attribute defines the service tag of the system.'
          inventory_link: SERIALNO_A
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.serialnumber
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
          master_item:
            key: dell.server.system.get
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 0ace6d0242b647519ddc539e990e2b75
              expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.hw.serialnumber,#1)<>last(/DELL PowerEdge R820 by HTTP/dell.server.hw.serialnumber,#2) and length(last(/DELL PowerEdge R820 by HTTP/dell.server.hw.serialnumber))>0'
              name: 'Dell R820: Device has been replaced'
              event_name: 'Dell R820: Device has been replaced (new serial number received)'
              priority: INFO
              description: 'The device serial number has changed. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: 2bade51081c74bfdbb282713a50dbf68
          name: 'Get network interfaces'
          type: SCRIPT
          key: dell.server.net.iface.get
          delay: 1h
          history: '0'
          value_type: TEXT
          params: |
            function validateZabbixParams(requiredParams, allParams) {
            	requiredParams.forEach(function (field) {
            		if (typeof allParams !== 'object' || typeof allParams[field] === 'undefined' || allParams[field] === '') {
            			throw 'Required param is not set: ' + field + '.';
            		}
            	});
            }
            
            function Dell(service, action, params) {
            	this.zabbixLogPrefix = '[ DELL ] [ ' + service + ' ] [ ' + action + ' ]';
            	this.request = new HttpRequest();
            
            	this.executeRequest = function (apiPath) {
            		this.request.addHeader('Authorization: Basic ' + btoa(params['user'] + ':' + params['password']));
            
            		if (params['http_proxy']) {
            			this.request.setProxy(params['http_proxy']);
            			Zabbix.log(4, this.zabbixLogPrefix + ' Using http proxy: ' + params['http_proxy']);
            		}
            
            		const response = this.request.get(params['url'] + apiPath);
            
            		this.request.clearHeader();
            
            		if (this.request.getStatus() === parseInt(params['http_status_code'])) {
            			return response;
            		} else {
            			Zabbix.log(3, this.zabbixLogPrefix + ' Unexpected HTTP response code: ' + this.request.getStatus());
            			throw 'Unexpected HTTP response code: ' + this.request.getStatus();
            		}
            	};
            
            	this.extractData = function (data, keys, skipParse) {
            		if (!skipParse) {
            			try {
            				data = JSON.parse(data);
            			} catch (error) {
            				Zabbix.log(3, this.zabbixLogPrefix + ' Could not parse the received JSON object: ' + data);
            				throw 'Could not parse received JSON object. See logs for more information.';
            			}	
            		}
            
            		if (Array.isArray(keys)) {
            			var returnBuffer = {};
            
            			for (keyIdx = 0, keysLength = keys.length; keyIdx < keysLength; keyIdx++) {
            				if (keys[keyIdx]['path'] === '@odata.id') {
            					returnBuffer[keys[keyIdx]['name']] = data[keys[keyIdx]['path']];
            				} else {
            					returnBuffer[keys[keyIdx]['name']] = this.parseJSON(data, keys[keyIdx]['path'].split('.'));
            				}
            			}
            
            			return returnBuffer;
            		} else if (typeof keys === 'object') {
            			return { [keys['name']]: this.parseJSON(data, keys['path'].split('.')) };
            		} else if (typeof keys === 'string') {
            			return this.parseJSON(data, keys.split('.'));
            		} else {
            			throw 'Unexpected key type';
            		}
            	};
            
            	this.parseJSON = function (data, jsonPath) {
            		for (var i = 0, args = jsonPath.length; i < args; i++) {
            			data = data[jsonPath[i]];
            		}
            
            		return data;
            	}
            }
            
            
            const params = JSON.parse(value);
            
            validateZabbixParams(['url', 'user', 'password', 'http_status_code'], params);
            var dell = new Dell('Network Interface', 'Discovery', params);
            
            const netAdapters = dell.extractData(dell.executeRequest('/redfish/v1/Chassis/System.Embedded.1/NetworkAdapters'), 'Members');
            
            var keys = [
            	{
            		'name': 'path',
            		'path': '@odata.id'
            	},
            	{
            		'name': 'id',
            		'path': 'Id'
            	}
            ];
            
            if (!Array.isArray(netAdapters)) {
            	throw 'Unexpected type for network adapters.';
            }
            
            var buffer = [];
            
            netAdapters.forEach(function (netAdapter) {
            	const netPorts = dell.extractData(dell.executeRequest(netAdapter["@odata.id"] + '/NetworkPorts'), 'Members');
            
            	if (!Array.isArray(netPorts)) {
            		return;
            	}
            
            	netPorts.forEach(function (netPort) {
            		buffer.push(dell.extractData(dell.executeRequest(netPort["@odata.id"]), keys));
            	})
            });
            
            return JSON.stringify(buffer);
          description: 'Returns network interfaces.'
          timeout: '{$DELL.HTTP.REQUEST.TIMEOUT}'
          parameters:
            - name: http_proxy
              value: '{$DELL.HTTP.PROXY}'
            - name: http_status_code
              value: '{$DELL.HTTP.RETURN.CODE.OK}'
            - name: password
              value: '{$DELL.HTTP.API.PASSWORD}'
            - name: url
              value: '{$DELL.HTTP.API.URL}'
            - name: user
              value: '{$DELL.HTTP.API.USER}'
          tags:
            - tag: component
              value: raw
        - uuid: f455a0b7c198414db84fb679fba47330
          name: 'Get sensors'
          type: SCRIPT
          key: dell.server.sensors.get
          history: '0'
          value_type: TEXT
          params: |
            function validateZabbixParams(requiredParams, allParams) {
            	requiredParams.forEach(function (field) {
            		if (typeof allParams !== 'object' || typeof allParams[field] === 'undefined' || allParams[field] === '') {
            			throw 'Required param is not set: ' + field + '.';
            		}
            	});
            }
            
            function Dell(service, action, params) {
            	this.zabbixLogPrefix = '[ DELL ] [ ' + service + ' ] [ ' + action + ' ]';
            	this.request = new HttpRequest();
            
            	this.executeRequest = function (apiPath) {
            		this.request.addHeader('Authorization: Basic ' + btoa(params['user'] + ':' + params['password']));
            
            		if (params['http_proxy']) {
            			this.request.setProxy(params['http_proxy']);
            			Zabbix.log(4, this.zabbixLogPrefix + ' Using http proxy: ' + params['http_proxy']);
            		}
            
            		const response = this.request.get(params['url'] + apiPath);
            
            		this.request.clearHeader();
            
            		if (this.request.getStatus() === parseInt(params['http_status_code'])) {
            			return response;
            		} else {
            			Zabbix.log(3, this.zabbixLogPrefix + ' Unexpected HTTP response code: ' + this.request.getStatus());
            			throw 'Unexpected HTTP response code: ' + this.request.getStatus();
            		}
            	};
            
            	this.extractData = function (data, keys, skipParse) {
            		if (!skipParse) {
            			try {
            				data = JSON.parse(data);
            			} catch (error) {
            				Zabbix.log(3, this.zabbixLogPrefix + ' Could not parse the received JSON object: ' + data);
            				throw 'Could not parse received JSON object. See logs for more information.';
            			}	
            		}
            
            		if (Array.isArray(keys)) {
            			var returnBuffer = {};
            
            			for (keyIdx = 0, keysLength = keys.length; keyIdx < keysLength; keyIdx++) {
            				if (keys[keyIdx]['path'] === '@odata.id') {
            					returnBuffer[keys[keyIdx]['name']] = data[keys[keyIdx]['path']];
            				} else {
            					returnBuffer[keys[keyIdx]['name']] = this.parseJSON(data, keys[keyIdx]['path'].split('.'));
            				}
            			}
            
            			return returnBuffer;
            		} else if (typeof keys === 'object') {
            			return { [keys['name']]: this.parseJSON(data, keys['path'].split('.')) };
            		} else if (typeof keys === 'string') {
            			return this.parseJSON(data, keys.split('.'));
            		} else {
            			throw 'Unexpected key type';
            		}
            	};
            
            	this.parseJSON = function (data, jsonPath) {
            		for (var i = 0, args = jsonPath.length; i < args; i++) {
            			data = data[jsonPath[i]];
            		}
            
            		return data;
            	}
            }
            
            function formatPSU(psuObj) {
            	var foundPowerSupplies = [],
            		buffer = [];
            
            	psuObj.forEach(function (obj) {
            		const psuName = obj['name'].split(' ')[0];
            
            		if (foundPowerSupplies.indexOf(psuName) === -1) {
            			foundPowerSupplies.push(psuName);
            			buffer.push({
            				'name': psuName,
            				[obj['type'].toLowerCase()]: {'reading': obj['reading'], 'health': obj['health']}
            			});
            		} else {
            			buffer.forEach(function (bufferObj) {
            
            				if (bufferObj['name'] === psuName) {
            					bufferObj[obj['type'].toLowerCase()] = {'reading': obj['reading'], 'health': obj['health']};
            
            					return;
            				}
            			});
            		}
            	})
            	return buffer;
            };
            
            function formatTemp(tempObj) {
            	tempObj.forEach(function (obj) {
            		obj.name = obj.name.split(' ').slice(0, -1).join(' ');
            	});
            
            	return tempObj;
            }
            
            function formatSysBoard(sysObj) {
            	const remove = ['System', 'Board', 'Usage'];
            
            	sysObj.forEach(function (obj) {
            		var buffer = [];
            
            		obj['name'].split(' ').forEach(function (word) {
            			var match = false;
            
            			remove.forEach(function (removeWord) {
            				if (removeWord === word) {
            					match = true;
            				}
            			});
            
            			if (!match) {
            				buffer.push(word);
            			}
            		});
            
            		if (buffer.length > 0) {
            			obj['name'] = buffer.join(' ');
            		}
            	});
            
            	return sysObj;
            }
            
            
            const params = JSON.parse(value);
            
            validateZabbixParams(['url', 'user', 'password', 'http_status_code'], params);
            var dell = new Dell('Sensor', 'Discovery', params);
            
            const sensors = dell.extractData(dell.executeRequest('/redfish/v1/Chassis/System.Embedded.1/Sensors?$expand=.($levels=1)'), 'Members');
            
            if (!Array.isArray(sensors)) {
            	throw 'Unexpected type for sensors.';
            }
            
            const keys = [
            	{
            		'name': 'id',
            		'path': 'Id'
            	},
            	{
            		'name': 'name',
            		'path': 'Name'
            	},
            	{
            		'name': 'context',
            		'path': 'PhysicalContext'
            	},
            	{
            		'name': 'reading',
            		'path': 'Reading'
            	},
            	{
            		'name': 'type',
            		'path': 'ReadingType'
            	},
            	{
            		'name': 'health',
            		'path': 'Status.Health'
            	}
            ];
            
            var buffer = { 'fan': [], 'psu': [], 'temperature': [], 'sysBoard': [] };
            
            sensors.forEach(function (sensor) {
            	if (sensor['Name'].substring(0, 2) === 'PS' && sensor['PhysicalContext'] === 'PowerSupply') {
            		buffer['psu'].push(dell.extractData(sensor, keys, true));
            	} else if (sensor['ReadingType'] === 'Temperature') {
            		buffer['temperature'].push(dell.extractData(sensor, keys, true));
            	} else if (sensor['Name'].includes('Fan') && sensor['ReadingType'] === 'Rotational') {
            		buffer['fan'].push(dell.extractData(sensor, keys, true));
            	} else if (sensor['Name'].includes('System Board') && sensor['ReadingType'] === 'Percent') {
            		buffer['sysBoard'].push(dell.extractData(sensor, keys, true));
            	}
            });
            
            buffer['psu'] = formatPSU(buffer['psu']);
            buffer['temperature'] = formatTemp(buffer['temperature']);
            buffer['sysBoard'] = formatSysBoard(buffer['sysBoard']);
            
            return JSON.stringify(buffer);
          description: 'Returns sensors.'
          timeout: '{$DELL.HTTP.REQUEST.TIMEOUT}'
          parameters:
            - name: http_proxy
              value: '{$DELL.HTTP.PROXY}'
            - name: http_status_code
              value: '{$DELL.HTTP.RETURN.CODE.OK}'
            - name: password
              value: '{$DELL.HTTP.API.PASSWORD}'
            - name: url
              value: '{$DELL.HTTP.API.URL}'
            - name: user
              value: '{$DELL.HTTP.API.USER}'
          tags:
            - tag: component
              value: raw
        - uuid: e1dd57a6fb9f4b47aa715d68aaac7e63
          name: 'Overall system health status'
          type: DEPENDENT
          key: dell.server.status
          trends: '0'
          description: 'This attribute defines the overall rollup status of all the components in the system monitored by the remote access card. Includes system, storage, IO devices, iDRAC, CPU, memory, etc.'
          valuemap:
            name: 'Redfish status health'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.status
            - type: JAVASCRIPT
              parameters:
                - |
                  const idx = {
                  	'OK': 1,
                  	'Warning': 2,
                  	'Critical': 3,
                  };
                  
                  return typeof idx[value] === 'undefined' ? 0 : idx[value];
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
          master_item:
            key: dell.server.system.get
          tags:
            - tag: component
              value: health
            - tag: component
              value: system
          triggers:
            - uuid: df55250997fd474e8323ccf7438354f8
              expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.status,)=3'
              name: 'Dell R820: Server is in a critical state'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: 'Please check the device for faults.'
              tags:
                - tag: scope
                  value: availability
            - uuid: f805d7fdab4842018b68acf3608fbfc4
              expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.status,)=2'
              name: 'Dell R820: Server is in a warning state'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Please check the device for warnings.'
              dependencies:
                - name: 'Dell R820: Server is in a critical state'
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.status,)=3'
              tags:
                - tag: scope
                  value: availability
        - uuid: c25e7040694f4a839b4e32524698c8da
          name: 'Get system'
          type: SCRIPT
          key: dell.server.system.get
          history: '0'
          value_type: TEXT
          params: |
            function validateZabbixParams(requiredParams, allParams) {
            	requiredParams.forEach(function (field) {
            		if (typeof allParams !== 'object' || typeof allParams[field] === 'undefined' || allParams[field] === '') {
            			throw 'Required param is not set: ' + field + '.';
            		}
            	});
            }
            
            function Dell(service, action, params) {
            	this.zabbixLogPrefix = '[ DELL ] [ ' + service + ' ] [ ' + action + ' ]';
            	this.request = new HttpRequest();
            
            	this.executeRequest = function (apiPath) {
            		this.request.addHeader('Authorization: Basic ' + btoa(params['user'] + ':' + params['password']));
            
            		if (params['http_proxy']) {
            			this.request.setProxy(params['http_proxy']);
            			Zabbix.log(4, this.zabbixLogPrefix + ' Using http proxy: ' + params['http_proxy']);
            		}
            
            		const response = this.request.get(params['url'] + apiPath);
            
            		this.request.clearHeader();
            
            		if (this.request.getStatus() === parseInt(params['http_status_code'])) {
            			return response;
            		} else {
            			Zabbix.log(3, this.zabbixLogPrefix + ' Unexpected HTTP response code: ' + this.request.getStatus());
            			throw 'Unexpected HTTP response code: ' + this.request.getStatus();
            		}
            	};
            
            	this.extractData = function (data, keys, skipParse) {
            		if (!skipParse) {
            			try {
            				data = JSON.parse(data);
            			} catch (error) {
            				Zabbix.log(3, this.zabbixLogPrefix + ' Could not parse the received JSON object: ' + data);
            				throw 'Could not parse received JSON object. See logs for more information.';
            			}	
            		}
            
            		if (Array.isArray(keys)) {
            			var returnBuffer = {};
            
            			for (keyIdx = 0, keysLength = keys.length; keyIdx < keysLength; keyIdx++) {
            				if (keys[keyIdx]['path'] === '@odata.id') {
            					returnBuffer[keys[keyIdx]['name']] = data[keys[keyIdx]['path']];
            				} else {
            					returnBuffer[keys[keyIdx]['name']] = this.parseJSON(data, keys[keyIdx]['path'].split('.'));
            				}
            			}
            
            			return returnBuffer;
            		} else if (typeof keys === 'object') {
            			return { [keys['name']]: this.parseJSON(data, keys['path'].split('.')) };
            		} else if (typeof keys === 'string') {
            			return this.parseJSON(data, keys.split('.'));
            		} else {
            			throw 'Unexpected key type';
            		}
            	};
            
            	this.parseJSON = function (data, jsonPath) {
            		for (var i = 0, args = jsonPath.length; i < args; i++) {
            			data = data[jsonPath[i]];
            		}
            
            		return data;
            	}
            }
            
            
            const params = JSON.parse(value);
            
            validateZabbixParams(['url', 'user', 'password', 'http_status_code'], params);
            var dell = new Dell('System', 'Get system metrics', params);
            
            const requests = [
            	{
            		'path': '/redfish/v1/Systems/System.Embedded.1',
            		'keys': [
            			{
            				'name': 'model',
            				'path': 'Model'
            			},
            			{
            				'name': 'serialnumber',
            				'path': 'Oem.Dell.DellSystem.ChassisServiceTag'
            			},
            			{
            				'name': 'status',
            				'path': 'Status.Health'
            			}
            		]
            	},
            	{
            		'path': '/redfish/v1/Managers/iDRAC.Embedded.1',
            		'keys': {
            			'name': 'firmware',
            			'path': 'FirmwareVersion'
            		}
            	}
            ];
            
            var buffer = {};
            
            for (var i = 0, requestsCount = requests.length; i < requestsCount; i++) {
            	Object.assign(buffer, dell.extractData(dell.executeRequest(requests[i].path), requests[i].keys));
            }
            
            return JSON.stringify(buffer);
          description: 'Returns system metrics.'
          timeout: '{$DELL.HTTP.REQUEST.TIMEOUT}'
          parameters:
            - name: http_proxy
              value: '{$DELL.HTTP.PROXY}'
            - name: http_status_code
              value: '{$DELL.HTTP.RETURN.CODE.OK}'
            - name: password
              value: '{$DELL.HTTP.API.PASSWORD}'
            - name: url
              value: '{$DELL.HTTP.API.URL}'
            - name: user
              value: '{$DELL.HTTP.API.USER}'
          tags:
            - tag: component
              value: raw
        - uuid: 6a34296167c4452c8ba7e37798ffd66a
          name: 'CPU utilization, in %'
          type: DEPENDENT
          key: dell.server.util.cpu
          value_type: FLOAT
          units: '%'
          description: 'CPU utilization.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.sysBoard[?(@.id == "SystemBoardCPUUsage")].reading.first()'
          master_item:
            key: dell.server.sensors.get
          tags:
            - tag: component
              value: cpu
          triggers:
            - uuid: 1feff28d5dd74c52a3978645f7cecd62
              expression: 'min(/DELL PowerEdge R820 by HTTP/dell.server.util.cpu,5m)>={$DELL.HTTP.CPU.UTIL.WARN}'
              name: 'Dell R820: CPU utilization is high'
              event_name: 'Dell R820: Current CPU utilization is high (util >= {$DELL.HTTP.CPU.UTIL.WARN}%)'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Current CPU utilization has exceeded `{$DELL.HTTP.CPU.UTIL.WARN}`%.'
              dependencies:
                - name: 'Dell R820: CPU utilization is too high'
                  expression: 'min(/DELL PowerEdge R820 by HTTP/dell.server.util.cpu,5m)>={$DELL.HTTP.CPU.UTIL.HIGH}'
              tags:
                - tag: scope
                  value: capacity
            - uuid: 069d0f8e16a1494d99bd45b96040ef12
              expression: 'min(/DELL PowerEdge R820 by HTTP/dell.server.util.cpu,5m)>={$DELL.HTTP.CPU.UTIL.HIGH}'
              name: 'Dell R820: CPU utilization is too high'
              event_name: 'Dell R820: Current CPU utilization is too high (util >= {$DELL.HTTP.CPU.UTIL.HIGH}%)'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              priority: HIGH
              description: 'Current CPU utilization has exceeded `{$DELL.HTTP.CPU.UTIL.HIGH}`%.'
              tags:
                - tag: scope
                  value: capacity
        - uuid: 401471d2ffa140b09c66c7e1b0ae8be0
          name: 'IO utilization, in %'
          type: DEPENDENT
          key: dell.server.util.io
          value_type: FLOAT
          units: '%'
          description: 'IO utilization.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.sysBoard[?(@.id == "SystemBoardIOUsage")].reading.first()'
          master_item:
            key: dell.server.sensors.get
          tags:
            - tag: component
              value: io
          triggers:
            - uuid: 0646200e61a7469c95471af24ddba10c
              expression: 'min(/DELL PowerEdge R820 by HTTP/dell.server.util.io,5m)>={$DELL.HTTP.IO.UTIL.WARN}'
              name: 'Dell R820: IO utilization is high'
              event_name: 'Dell R820: Current IO utilization is high (util >= {$DELL.HTTP.IO.UTIL.WARN}%)'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Current IO utilization has exceeded `{$DELL.HTTP.IO.UTIL.WARN}`%.'
              dependencies:
                - name: 'Dell R820: IO utilization is too high'
                  expression: 'min(/DELL PowerEdge R820 by HTTP/dell.server.util.io,5m)>={$DELL.HTTP.IO.UTIL.HIGH}'
              tags:
                - tag: scope
                  value: capacity
            - uuid: f99ead65893143c39f0ebe9c1038524d
              expression: 'min(/DELL PowerEdge R820 by HTTP/dell.server.util.io,5m)>={$DELL.HTTP.IO.UTIL.HIGH}'
              name: 'Dell R820: IO utilization is too high'
              event_name: 'Dell R820: Current IO utilization is too high (util >= {$DELL.HTTP.IO.UTIL.HIGH}%)'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              priority: HIGH
              description: 'Current IO utilization has exceeded `{$DELL.HTTP.IO.UTIL.HIGH}`%.'
              tags:
                - tag: scope
                  value: capacity
        - uuid: f09f4be3c7f24504b1593eed456056c0
          name: 'Memory utilization, in %'
          type: DEPENDENT
          key: dell.server.util.mem
          value_type: FLOAT
          units: '%'
          description: 'Memory utilization.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.sysBoard[?(@.id == "SystemBoardMEMUsage")].reading.first()'
          master_item:
            key: dell.server.sensors.get
          tags:
            - tag: component
              value: memory
          triggers:
            - uuid: cd8f662e308f4c0ea7382962a0889812
              expression: 'min(/DELL PowerEdge R820 by HTTP/dell.server.util.mem,5m)>={$DELL.HTTP.MEM.UTIL.WARN}'
              name: 'Dell R820: Memory utilization is high'
              event_name: 'Dell R820: Current memory utilization is high (util >= {$DELL.HTTP.MEM.UTIL.WARN}%)'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Current memory utilization has exceeded `{$DELL.HTTP.MEM.UTIL.WARN}`%.'
              dependencies:
                - name: 'Dell R820: Memory utilization is too high'
                  expression: 'min(/DELL PowerEdge R820 by HTTP/dell.server.util.mem,5m)>={$DELL.HTTP.MEM.UTIL.HIGH}'
              tags:
                - tag: scope
                  value: capacity
            - uuid: 606b2c5625d844bb8a5641e351ab30fc
              expression: 'min(/DELL PowerEdge R820 by HTTP/dell.server.util.mem,5m)>={$DELL.HTTP.MEM.UTIL.HIGH}'
              name: 'Dell R820: Memory utilization is too high'
              event_name: 'Dell R820: Current memory utilization is too high (util >= {$DELL.HTTP.MEM.UTIL.HIGH}%)'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              priority: HIGH
              description: 'Current memory utilization has exceeded `{$DELL.HTTP.MEM.UTIL.HIGH}`%.'
              tags:
                - tag: scope
                  value: capacity
        - uuid: 611a0be2fb08420ebadeadebe81ebc12
          name: 'SYS utilization, in %'
          type: DEPENDENT
          key: dell.server.util.sys
          value_type: FLOAT
          units: '%'
          description: 'SYS utilization.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.sysBoard[?(@.id == "SystemBoardSYSUsage")].reading.first()'
          master_item:
            key: dell.server.sensors.get
          tags:
            - tag: component
              value: sys
          triggers:
            - uuid: 71a95d655db24c13b7ed1e89adf7cb43
              expression: 'min(/DELL PowerEdge R820 by HTTP/dell.server.util.sys,5m)>={$DELL.HTTP.SYS.UTIL.WARN}'
              name: 'Dell R820: SYS utilization is high'
              event_name: 'Dell R820: Current SYS utilization is high (util >= {$DELL.HTTP.SYS.UTIL.WARN}%)'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Current SYS utilization has exceeded `{$DELL.HTTP.SYS.UTIL.WARN}`%.'
              dependencies:
                - name: 'Dell R820: IO utilization is too high'
                  expression: 'min(/DELL PowerEdge R820 by HTTP/dell.server.util.io,5m)>={$DELL.HTTP.IO.UTIL.HIGH}'
              tags:
                - tag: scope
                  value: capacity
            - uuid: c3bfbc51feb54025a32d0a7e43cf9a7c
              expression: 'min(/DELL PowerEdge R820 by HTTP/dell.server.util.sys,5m)>={$DELL.HTTP.SYS.UTIL.HIGH}'
              name: 'Dell R820: SYS utilization is too high'
              event_name: 'Dell R820: Current SYS utilization is too high (util >= {$DELL.HTTP.SYS.UTIL.HIGH}%)'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              priority: HIGH
              description: 'Current SYS utilization has exceeded `{$DELL.HTTP.SYS.UTIL.HIGH}`%.'
              tags:
                - tag: scope
                  value: capacity
        - uuid: 881a8358b3a049cb9516ec8f2ee20b69
          name: 'Redfish API status'
          type: SIMPLE
          key: 'net.tcp.service[https]'
          description: |
            Availability of Redfish API on the server.
            Possible values:
              0 - Unavailable
              1 - Available
          valuemap:
            name: 'Redfish API availability'
          tags:
            - tag: component
              value: health
            - tag: component
              value: system
          triggers:
            - uuid: f60ee17e012e4db39d3b2a008cf86653
              expression: 'last(/DELL PowerEdge R820 by HTTP/net.tcp.service[https])=0'
              name: 'Dell R820: Redfish API service is unavailable'
              priority: HIGH
              description: 'The service is unavailable or does not accept TCP connections.'
              tags:
                - tag: scope
                  value: availability
      discovery_rules:
        - uuid: 380d000cd61742a0a95b2fdec94a39ee
          name: 'Array controller discovery'
          type: DEPENDENT
          key: dell.server.array.discovery
          description: 'Discovery of disk array controllers.'
          item_prototypes:
            - uuid: fbc7a12767e54476b5eb16ac5986d5ba
              name: 'Controller [{#CNTLR_NAME}]: Status'
              type: DEPENDENT
              key: 'dell.server.array.status[{#ID}]'
              description: 'The status of the job. Possible values: OK, Warning, Critical.'
              valuemap:
                name: 'Redfish status health'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.arrayControllers[?(@.id == "{#ID}")].health.first()'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = {
                      	'OK': 1,
                      	'Warning': 2,
                      	'Critical': 3,
                      };
                      
                      return typeof idx[value] === 'undefined' ? 0 : idx[value];
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: dell.server.array.resources.get
              tags:
                - tag: component
                  value: diskarray
                - tag: component
                  value: storage
              trigger_prototypes:
                - uuid: c3af9f97c0434999a9bd3fa94c4d3d2f
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.array.status[{#ID}],)=3'
                  name: 'Dell R820: Controller [{#CNTLR_NAME}]: Critical state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Please check the device for faults.'
                  tags:
                    - tag: scope
                      value: availability
                - uuid: d94ba5b002f54ff0ad1e0e148f83991b
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.array.status[{#ID}],)=2'
                  name: 'Dell R820: Controller [{#CNTLR_NAME}]: Warning state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Please check the device for warnings.'
                  dependencies:
                    - name: 'Dell R820: Controller [{#CNTLR_NAME}]: Critical state'
                      expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.array.status[{#ID}],)=3'
                  tags:
                    - tag: scope
                      value: availability
          master_item:
            key: dell.server.array.resources.get
          lld_macro_paths:
            - lld_macro: '{#CNTLR_NAME}'
              path: $.name
            - lld_macro: '{#ID}'
              path: $.id
            - lld_macro: '{#SLOT}'
              path: $.slot
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.arrayControllers
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        - uuid: 71f10dadaef9462caf395fd383b18406
          name: 'Battery discovery'
          type: DEPENDENT
          key: dell.server.controller.battery.discovery
          description: 'Discovery of battery controllers.'
          item_prototypes:
            - uuid: c7a05323c5164204a981f52401e0d11a
              name: 'Battery [{#BATTERY_NAME}]: Status'
              type: DEPENDENT
              key: 'dell.server.controller.battery.status[{#ID}]'
              description: 'The status of the job. Possible values: OK, Warning, Critical.'
              valuemap:
                name: 'Redfish status health'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.batteryControllers[?(@.id == "{#ID}")].status.first()'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = {
                      	'OK': 1,
                      	'Warning': 2,
                      	'Critical': 3,
                      };
                      
                      return typeof idx[value] === 'undefined' ? 0 : idx[value];
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: dell.server.array.resources.get
              tags:
                - tag: component
                  value: battery
                - tag: component
                  value: diskarray
              trigger_prototypes:
                - uuid: d46b6bd00f5748a48c707d3982047b88
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.controller.battery.status[{#ID}],)=3'
                  name: 'Dell R820: Battery [{#BATTERY_NAME}]: Critical state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Please check the device for faults.'
                  tags:
                    - tag: scope
                      value: availability
                - uuid: 0a59fa4da096415db825894138df0025
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.controller.battery.status[{#ID}],)=2'
                  name: 'Dell R820: Battery [{#BATTERY_NAME}]: Warning state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Please check the device for warnings.'
                  dependencies:
                    - name: 'Dell R820: Battery [{#BATTERY_NAME}]: Critical state'
                      expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.controller.battery.status[{#ID}],)=3'
                  tags:
                    - tag: scope
                      value: availability
          master_item:
            key: dell.server.array.resources.get
          lld_macro_paths:
            - lld_macro: '{#BATTERY_NAME}'
              path: $.name
            - lld_macro: '{#ID}'
              path: $.id
            - lld_macro: '{#ODATA}'
              path: $.path
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.batteryControllers
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        - uuid: 2d92d68ee5664fe7b49cd54cba30a83a
          name: 'FAN discovery'
          type: DEPENDENT
          key: dell.server.fan.discovery
          description: 'Discovery of FAN sensors.'
          item_prototypes:
            - uuid: 9f91ed79a8874401acbada3acfd093fc
              name: 'Fan [{#SENSOR_NAME}]: Get sensor'
              type: DEPENDENT
              key: 'dell.server.sensor.fan.get[{#SENSOR_NAME}]'
              history: '0'
              value_type: TEXT
              description: 'Returns the metrics of a sensor.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.fan.[?(@.id == ''{#ID}'')].first()'
              master_item:
                key: dell.server.sensors.get
              tags:
                - tag: component
                  value: fan
                - tag: component
                  value: raw
            - uuid: 3c51a997d60c4a019baa7a38ea84cd78
              name: 'Fan [{#SENSOR_NAME}]: Speed'
              type: DEPENDENT
              key: 'dell.server.sensor.fan.speed[{#SENSOR_NAME}]'
              units: '!rpm'
              description: 'Sensor value.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.reading
              master_item:
                key: 'dell.server.sensor.fan.get[{#SENSOR_NAME}]'
              tags:
                - tag: component
                  value: fan
            - uuid: 66b4d1db39264237ba7c1c87a9b2a28f
              name: 'Fan [{#SENSOR_NAME}]: Status'
              type: DEPENDENT
              key: 'dell.server.sensor.fan.status[{#SENSOR_NAME}]'
              trends: '0'
              description: 'The status of the job. Possible values: OK, Warning, Critical.'
              valuemap:
                name: 'Redfish status health'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.health
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = {
                      	'OK': 1,
                      	'Warning': 2,
                      	'Critical': 3,
                      };
                      
                      return typeof idx[value] === 'undefined' ? 0 : idx[value];
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.sensor.fan.get[{#SENSOR_NAME}]'
              tags:
                - tag: component
                  value: fan
              trigger_prototypes:
                - uuid: 84c7300a4b7b46f2996e053ee52694cd
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.sensor.fan.status[{#SENSOR_NAME}],)=3'
                  name: 'Dell R820: Fan [{#SENSOR_NAME}]: Critical state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Please check the device for faults.'
                  tags:
                    - tag: scope
                      value: availability
                - uuid: 1ee66cb1005b433d89e4c0154d7f0d57
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.sensor.fan.status[{#SENSOR_NAME}],)=2'
                  name: 'Dell R820: Fan [{#SENSOR_NAME}]: Warning state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Please check the device for warnings.'
                  dependencies:
                    - name: 'Dell R820: Fan [{#SENSOR_NAME}]: Critical state'
                      expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.sensor.fan.status[{#SENSOR_NAME}],)=3'
                  tags:
                    - tag: scope
                      value: availability
          graph_prototypes:
            - uuid: 17eb03f7bdb746abb5f395ea4383d669
              name: 'Dell R820: Fan [{#SENSOR_NAME}]: Speed'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'DELL PowerEdge R820 by HTTP'
                    key: 'dell.server.sensor.fan.speed[{#SENSOR_NAME}]'
          master_item:
            key: dell.server.sensors.get
          lld_macro_paths:
            - lld_macro: '{#ID}'
              path: $.id
            - lld_macro: '{#SENSOR_NAME}'
              path: $.name
            - lld_macro: '{#TYPE}'
              path: $.type
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.fan
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        - uuid: 8075955b6a8c4843b038c6a91f792ca5
          name: 'Network interface discovery'
          type: DEPENDENT
          key: dell.server.net.if.discovery
          description: 'Discovery of network interfaces.'
          item_prototypes:
            - uuid: 8c317b576a2246ea9b0f25ca81bdb06b
              name: 'Interface [{#IFNAME}]: Get interface'
              type: SCRIPT
              key: 'dell.server.net.if.get[{#IFNAME}]'
              history: '0'
              value_type: TEXT
              params: |
                function validateZabbixParams(requiredParams, allParams) {
                	requiredParams.forEach(function (field) {
                		if (typeof allParams !== 'object' || typeof allParams[field] === 'undefined' || allParams[field] === '') {
                			throw 'Required param is not set: ' + field + '.';
                		}
                	});
                }
                
                function Dell(service, action, params) {
                	this.zabbixLogPrefix = '[ DELL ] [ ' + service + ' ] [ ' + action + ' ]';
                	this.request = new HttpRequest();
                
                	this.executeRequest = function (apiPath) {
                		this.request.addHeader('Authorization: Basic ' + btoa(params['user'] + ':' + params['password']));
                
                		if (params['http_proxy']) {
                			this.request.setProxy(params['http_proxy']);
                			Zabbix.log(4, this.zabbixLogPrefix + ' Using http proxy: ' + params['http_proxy']);
                		}
                
                		const response = this.request.get(params['url'] + apiPath);
                
                		this.request.clearHeader();
                
                		if (this.request.getStatus() === parseInt(params['http_status_code'])) {
                			return response;
                		} else {
                			Zabbix.log(3, this.zabbixLogPrefix + ' Unexpected HTTP response code: ' + this.request.getStatus());
                			throw 'Unexpected HTTP response code: ' + this.request.getStatus();
                		}
                	};
                
                	this.extractData = function (data, keys, skipParse) {
                		if (!skipParse) {
                			try {
                				data = JSON.parse(data);
                			} catch (error) {
                				Zabbix.log(3, this.zabbixLogPrefix + ' Could not parse the received JSON object: ' + data);
                				throw 'Could not parse received JSON object. See logs for more information.';
                			}	
                		}
                
                		if (Array.isArray(keys)) {
                			var returnBuffer = {};
                
                			for (keyIdx = 0, keysLength = keys.length; keyIdx < keysLength; keyIdx++) {
                				if (keys[keyIdx]['path'] === '@odata.id') {
                					returnBuffer[keys[keyIdx]['name']] = data[keys[keyIdx]['path']];
                				} else {
                					returnBuffer[keys[keyIdx]['name']] = this.parseJSON(data, keys[keyIdx]['path'].split('.'));
                				}
                			}
                
                			return returnBuffer;
                		} else if (typeof keys === 'object') {
                			return { [keys['name']]: this.parseJSON(data, keys['path'].split('.')) };
                		} else if (typeof keys === 'string') {
                			return this.parseJSON(data, keys.split('.'));
                		} else {
                			throw 'Unexpected key type';
                		}
                	};
                
                	this.parseJSON = function (data, jsonPath) {
                		for (var i = 0, args = jsonPath.length; i < args; i++) {
                			data = data[jsonPath[i]];
                		}
                
                		return data;
                	}
                }
                
                
                const params = JSON.parse(value);
                
                validateZabbixParams(['url', 'path', 'user', 'password', 'http_status_code'], params);
                var dell = new Dell('Network Interface', 'Get metrics', params);
                
                const keys = [
                	{
                		'name': 'linkStatus',
                		'path': 'LinkStatus'
                	},
                	{
                		'name': 'health',
                		'path': 'Status.Health'
                	},
                	{
                		'name': 'state',
                		'path': 'Status.State'
                	},
                	{
                		'name': 'linkSpeed',
                		'path': 'CurrentLinkSpeedMbps'
                	}
                ];
                
                return JSON.stringify(dell.extractData(dell.executeRequest(params.path), keys));
              description: 'Returns the metrics of a network interface.'
              timeout: '{$DELL.HTTP.REQUEST.TIMEOUT}'
              parameters:
                - name: http_proxy
                  value: '{$DELL.HTTP.PROXY}'
                - name: http_status_code
                  value: '{$DELL.HTTP.RETURN.CODE.OK}'
                - name: password
                  value: '{$DELL.HTTP.API.PASSWORD}'
                - name: path
                  value: '{#ODATA}'
                - name: url
                  value: '{$DELL.HTTP.API.URL}'
                - name: user
                  value: '{$DELL.HTTP.API.USER}'
              tags:
                - tag: component
                  value: network
                - tag: component
                  value: raw
            - uuid: 7ca5dc897e314299bf61bf73c961ca3a
              name: 'Interface [{#IFNAME}]: Status'
              type: DEPENDENT
              key: 'dell.server.net.if.health[{#IFNAME}]'
              description: 'The status of the job. Possible values: OK, Warning, Critical.'
              valuemap:
                name: 'Redfish status health'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.health
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = {
                      	'OK': 1,
                      	'Warning': 2,
                      	'Critical': 3,
                      };
                      
                      return typeof idx[value] === 'undefined' ? 0 : idx[value];
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.net.if.get[{#IFNAME}]'
              tags:
                - tag: component
                  value: network
              trigger_prototypes:
                - uuid: 8a86d396b76f46bc808d83448dd02cdb
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.net.if.health[{#IFNAME}],)=3'
                  name: 'Dell R820: Interface [{#IFNAME}]: Critical state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Please check the device for faults.'
                  tags:
                    - tag: scope
                      value: availability
                - uuid: 2f68a365826948779303dccd91bf253a
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.net.if.health[{#IFNAME}],)=2'
                  name: 'Dell R820: Interface [{#IFNAME}]: Warning state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Please check the device for warnings.'
                  dependencies:
                    - name: 'Dell R820: Interface [{#IFNAME}]: Critical state'
                      expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.net.if.health[{#IFNAME}],)=3'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 606f493ca932439098ae259d3104548a
              name: 'Interface [{#IFNAME}]: Speed'
              type: DEPENDENT
              key: 'dell.server.net.if.speed[{#IFNAME}]'
              units: bps
              description: 'The network port current link speed.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.linkSpeed
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.net.if.get[{#IFNAME}]'
              tags:
                - tag: component
                  value: network
            - uuid: 288409760c3d4c72bf6219bb05f2fc56
              name: 'Interface [{#IFNAME}]: State'
              type: DEPENDENT
              key: 'dell.server.net.if.state[{#IFNAME}]'
              description: 'The known state of the Resource, for example, Enabled. Possible values: Enabled, Disabled, StandbyOffline, StandbySpare, InTest, Starting, Absent, UnavailableOffline, Deferring, Quiesced, Updating, Qualified.'
              valuemap:
                name: 'Redfish status state'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.state
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = {
                      	'Enabled': 1,
                      	'Disabled': 2,
                      	'Absent': 3,
                      	'Deferring': 4,
                      	'InTest': 5,
                      	'Quiesced': 6,
                      	'StandbyOffline': 7,
                      	'StandbySpare': 8,
                      	'Starting': 9,
                      	'UnavailableOffline': 10,
                      	'Updating': 11
                      };
                      
                      return typeof idx[value] === 'undefined' ? 0 : idx[value];
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.net.if.get[{#IFNAME}]'
              tags:
                - tag: component
                  value: network
            - uuid: dabbf5d3e77b48e08653bc626905479a
              name: 'Interface [{#IFNAME}]: Link status'
              type: DEPENDENT
              key: 'dell.server.net.if.status[{#IFNAME}]'
              description: 'The status of the link between this port and its link partner. Possible values: Down, Up, null.'
              valuemap:
                name: 'Network interface status'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.linkStatus
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = {
                      	'null': 1,
                      	'Down': 2,
                      	'Up': 3,
                      };
                      
                      return typeof idx[value] === 'undefined' ? 0 : idx[value];
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.net.if.get[{#IFNAME}]'
              tags:
                - tag: component
                  value: network
              trigger_prototypes:
                - uuid: 29836643e02f466298f610b4a4a6596c
                  expression: '{$DELL.HTTP.IFCONTROL:"{#IFNAME}"}=1 and (last(/DELL PowerEdge R820 by HTTP/dell.server.net.if.status[{#IFNAME}],)=2 and last(/DELL PowerEdge R820 by HTTP/dell.server.net.if.status[{#IFNAME}],#1)<>last(/DELL PowerEdge R820 by HTTP/dell.server.net.if.status[{#IFNAME}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.net.if.status[{#IFNAME}],)=1 or {$DELL.HTTP.IFCONTROL:"{#IFNAME}"}=0'
                  name: 'Dell R820: Interface [{#IFNAME}]: Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. It can be triggered if the operations status is Down (2).
                    2. `{$DELL.HTTP.IFCONTROL:"{#IFNAME}"}=1` - a user can redefine the context macro to "0", marking this interface as not important. No new trigger will be fired if this interface is Down (2).
                    3. `{TEMPLATE_NAME:METRIC.diff()}=1` - the trigger fires only if the operational status was up to (1) sometime before (so, does not fire for the "eternal off" interfaces.)
                    
                    WARNING: if closed manually - it will not fire again on the next poll because of `.diff`.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
                - uuid: ab33e9a5cd6448eca97119bc6bf1e361
                  expression: '{$DELL.HTTP.IFCONTROL:"{#IFNAME}"}=1 and (last(/DELL PowerEdge R820 by HTTP/dell.server.net.if.status[{#IFNAME}],)<2 and last(/DELL PowerEdge R820 by HTTP/dell.server.net.if.status[{#IFNAME}],#1)<>last(/DELL PowerEdge R820 by HTTP/dell.server.net.if.status[{#IFNAME}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.net.if.status[{#IFNAME}],)>=2 or {$DELL.HTTP.IFCONTROL:"{#IFNAME}"}=0'
                  name: 'Dell R820: Interface [{#IFNAME}]: Link status issue'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. It can be triggered if the operations status is Null (1) or Unknown (0).
                    2. `{$DELL.HTTP.IFCONTROL:"{#IFNAME}"}=1` - a user can redefine the context macro to "0", marking this interface as not important. No new trigger will be fired if this interface is Null (1) or Unknown (0).
                    3. `{TEMPLATE_NAME:METRIC.diff()}=1` - the trigger fires only if the operational status was up to (1) sometime before (so, does not fire for the "eternal off" interfaces.)
                    
                    WARNING: if closed manually - it will not fire again on the next poll because of `.diff`.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
          graph_prototypes:
            - uuid: 04c75b6bfaf14608a0845c313829f08f
              name: 'Dell R820: Interface [{#IFNAME}]: Speed'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'DELL PowerEdge R820 by HTTP'
                    key: 'dell.server.net.if.speed[{#IFNAME}]'
          master_item:
            key: dell.server.net.iface.get
          lld_macro_paths:
            - lld_macro: '{#IFNAME}'
              path: $.id
            - lld_macro: '{#ODATA}'
              path: $.path
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        - uuid: bace8989f0cb4c78ae29e97b3924252f
          name: 'Physical disk discovery'
          type: DEPENDENT
          key: dell.server.physicaldisk.discovery
          description: 'Discovery of physical disks.'
          item_prototypes:
            - uuid: 670b05a9f8e847ea9830d34361c3f0e2
              name: 'Physical disk [{#DISK_NAME}]: Get disk'
              type: SCRIPT
              key: 'dell.server.hw.physicaldisk.get[{#DISK_NAME}]'
              history: '0'
              value_type: TEXT
              params: |
                function validateZabbixParams(requiredParams, allParams) {
                	requiredParams.forEach(function (field) {
                		if (typeof allParams !== 'object' || typeof allParams[field] === 'undefined' || allParams[field] === '') {
                			throw 'Required param is not set: ' + field + '.';
                		}
                	});
                }
                
                function Dell(service, action, params) {
                	this.zabbixLogPrefix = '[ DELL ] [ ' + service + ' ] [ ' + action + ' ]';
                	this.request = new HttpRequest();
                
                	this.executeRequest = function (apiPath) {
                		this.request.addHeader('Authorization: Basic ' + btoa(params['user'] + ':' + params['password']));
                
                		if (params['http_proxy']) {
                			this.request.setProxy(params['http_proxy']);
                			Zabbix.log(4, this.zabbixLogPrefix + ' Using http proxy: ' + params['http_proxy']);
                		}
                
                		const response = this.request.get(params['url'] + apiPath);
                
                		this.request.clearHeader();
                
                		if (this.request.getStatus() === parseInt(params['http_status_code'])) {
                			return response;
                		} else {
                			Zabbix.log(3, this.zabbixLogPrefix + ' Unexpected HTTP response code: ' + this.request.getStatus());
                			throw 'Unexpected HTTP response code: ' + this.request.getStatus();
                		}
                	};
                
                	this.extractData = function (data, keys, skipParse) {
                		if (!skipParse) {
                			try {
                				data = JSON.parse(data);
                			} catch (error) {
                				Zabbix.log(3, this.zabbixLogPrefix + ' Could not parse the received JSON object: ' + data);
                				throw 'Could not parse received JSON object. See logs for more information.';
                			}	
                		}
                
                		if (Array.isArray(keys)) {
                			var returnBuffer = {};
                
                			for (keyIdx = 0, keysLength = keys.length; keyIdx < keysLength; keyIdx++) {
                				if (keys[keyIdx]['path'] === '@odata.id') {
                					returnBuffer[keys[keyIdx]['name']] = data[keys[keyIdx]['path']];
                				} else {
                					returnBuffer[keys[keyIdx]['name']] = this.parseJSON(data, keys[keyIdx]['path'].split('.'));
                				}
                			}
                
                			return returnBuffer;
                		} else if (typeof keys === 'object') {
                			return { [keys['name']]: this.parseJSON(data, keys['path'].split('.')) };
                		} else if (typeof keys === 'string') {
                			return this.parseJSON(data, keys.split('.'));
                		} else {
                			throw 'Unexpected key type';
                		}
                	};
                
                	this.parseJSON = function (data, jsonPath) {
                		for (var i = 0, args = jsonPath.length; i < args; i++) {
                			data = data[jsonPath[i]];
                		}
                
                		return data;
                	}
                }
                
                
                const params = JSON.parse(value);
                
                validateZabbixParams(['url', 'path', 'user', 'password', 'http_status_code'], params);
                var dell = new Dell('Disk', 'Get physical disk metrics', params);
                
                const keys = [
                	{
                		'name': 'health',
                		'path': 'Status.Health'
                	},
                	{
                		'name': 'sn',
                		'path': 'SerialNumber'
                	},
                	{
                		'name': 'model',
                		'path': 'Model'
                	},
                	{
                		'name': 'mediaType',
                		'path': 'MediaType'
                	},
                	{
                		'name': 'capacity',
                		'path': 'CapacityBytes'
                	}
                ];
                
                return JSON.stringify(dell.extractData(dell.executeRequest(params.path), keys));
              description: 'Returns the metrics of a physical disk.'
              timeout: '{$DELL.HTTP.REQUEST.TIMEOUT}'
              parameters:
                - name: http_proxy
                  value: '{$DELL.HTTP.PROXY}'
                - name: http_status_code
                  value: '{$DELL.HTTP.RETURN.CODE.OK}'
                - name: password
                  value: '{$DELL.HTTP.API.PASSWORD}'
                - name: path
                  value: '{#ODATA}'
                - name: url
                  value: '{$DELL.HTTP.API.URL}'
                - name: user
                  value: '{$DELL.HTTP.API.USER}'
              tags:
                - tag: component
                  value: physicaldisk
                - tag: component
                  value: raw
                - tag: component
                  value: storage
            - uuid: b28af532e0ae45f3ad0686d19883de17
              name: 'Physical disk [{#DISK_NAME}]: Media type'
              type: DEPENDENT
              key: 'dell.server.hw.physicaldisk.media_type[{#DISK_NAME}]'
              value_type: CHAR
              description: 'The type of media contained in this drive. Possible values: HDD, SSD, SMR, null.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.mediaType
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.hw.physicaldisk.get[{#DISK_NAME}]'
              tags:
                - tag: component
                  value: physicaldisk
                - tag: component
                  value: storage
            - uuid: da824a525cbe42f99349edaf58152683
              name: 'Physical disk [{#DISK_NAME}]: Model name'
              type: DEPENDENT
              key: 'dell.server.hw.physicaldisk.model[{#DISK_NAME}]'
              value_type: CHAR
              description: 'The model number of the drive.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.model
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.hw.physicaldisk.get[{#DISK_NAME}]'
              tags:
                - tag: component
                  value: physicaldisk
                - tag: component
                  value: storage
            - uuid: 88216fac6b85454ea9090de8b422387b
              name: 'Physical disk [{#DISK_NAME}]: Serial number'
              type: DEPENDENT
              key: 'dell.server.hw.physicaldisk.serialnumber[{#DISK_NAME}]'
              value_type: CHAR
              description: 'The serial number of this drive.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.sn
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.hw.physicaldisk.get[{#DISK_NAME}]'
              tags:
                - tag: component
                  value: physicaldisk
                - tag: component
                  value: storage
              trigger_prototypes:
                - uuid: abc54d3b7d044d7cb58ae291723f7a50
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.hw.physicaldisk.serialnumber[{#DISK_NAME}],#1)<>last(/DELL PowerEdge R820 by HTTP/dell.server.hw.physicaldisk.serialnumber[{#DISK_NAME}],#2) and length(last(/DELL PowerEdge R820 by HTTP/dell.server.hw.physicaldisk.serialnumber[{#DISK_NAME}]))>0'
                  name: 'Dell R820: Physical disk [{#DISK_NAME}] has been replaced'
                  event_name: 'Dell R820: [{#DISK_NAME}] has been replaced (new serial number received)'
                  priority: INFO
                  description: '[{#DISK_NAME}] serial number has changed. Acknowledge to close the problem manually.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: notice
            - uuid: bec5cacf8b964b7bb4f2c1761c1d1fbb
              name: 'Physical disk [{#DISK_NAME}]: Size'
              type: DEPENDENT
              key: 'dell.server.hw.physicaldisk.size[{#DISK_NAME}]'
              trends: '0'
              units: B
              description: 'The size, in bytes, of this drive.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.capacity
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.hw.physicaldisk.get[{#DISK_NAME}]'
              tags:
                - tag: component
                  value: physicaldisk
                - tag: component
                  value: storage
            - uuid: 7fe8e6eccc4f4e76bded3c5f698164f3
              name: 'Physical disk [{#DISK_NAME}]: Status'
              type: DEPENDENT
              key: 'dell.server.hw.physicaldisk.status[{#DISK_NAME}]'
              trends: '0'
              description: 'The status of the job. Possible values: OK, Warning, Critical.'
              valuemap:
                name: 'Redfish status health'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.health
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = {
                      	'OK': 1,
                      	'Warning': 2,
                      	'Critical': 3,
                      };
                      
                      return typeof idx[value] === 'undefined' ? 0 : idx[value];
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.hw.physicaldisk.get[{#DISK_NAME}]'
              tags:
                - tag: component
                  value: physicaldisk
                - tag: component
                  value: storage
              trigger_prototypes:
                - uuid: 4fe34ae6c61a4b18b86a60d6ed309b40
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.hw.physicaldisk.status[{#DISK_NAME}],)=3'
                  name: 'Dell R820: Physical disk [{#DISK_NAME}]: Critical state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Please check the device for faults.'
                  tags:
                    - tag: scope
                      value: availability
                - uuid: fc7eea49256c4b748a22c36c66b00026
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.hw.physicaldisk.status[{#DISK_NAME}],)=2'
                  name: 'Dell R820: Physical disk [{#DISK_NAME}]: Warning state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Please check the device for warnings.'
                  dependencies:
                    - name: 'Dell R820: Physical disk [{#DISK_NAME}]: Critical state'
                      expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.hw.physicaldisk.status[{#DISK_NAME}],)=3'
                  tags:
                    - tag: scope
                      value: availability
          graph_prototypes:
            - uuid: 7f948b79dcd84f9798a77c9643cf87c9
              name: 'Dell R820: Physical disk [{#DISK_NAME}]: Size'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'DELL PowerEdge R820 by HTTP'
                    key: 'dell.server.hw.physicaldisk.size[{#DISK_NAME}]'
          master_item:
            key: dell.server.disks.get
          lld_macro_paths:
            - lld_macro: '{#DISK_NAME}'
              path: $.name
            - lld_macro: '{#ODATA}'
              path: $.path
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.physicalDisks
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        - uuid: 491a0445cf254e94a875546569dc99c8
          name: 'PSU discovery'
          type: DEPENDENT
          key: dell.server.psu.discovery
          description: 'Discovery of PSU sensors.'
          item_prototypes:
            - uuid: a8a9fca249894612a8b07d8ed0129ab0
              name: 'Power supply [{#SENSOR_NAME}]: Current sensor status'
              type: DEPENDENT
              key: 'dell.server.sensor.psu.current.status[{#SENSOR_NAME}]'
              trends: '0'
              description: 'The status of the job. Possible values: OK, Warning, Critical.'
              valuemap:
                name: 'Redfish status health'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.current.health
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = {
                      	'OK': 1,
                      	'Warning': 2,
                      	'Critical': 3,
                      };
                      
                      return typeof idx[value] === 'undefined' ? 0 : idx[value];
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.sensor.psu.get[{#SENSOR_NAME}]'
              tags:
                - tag: component
                  value: psu
              trigger_prototypes:
                - uuid: 4f0515fb0dfd46c7b3685a7b3ecbb81d
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.sensor.psu.current.status[{#SENSOR_NAME}],)=3'
                  name: 'Dell R820: Power supply [{#SENSOR_NAME}]: Current sensor: Critical state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Please check the device for faults.'
                  tags:
                    - tag: scope
                      value: availability
                - uuid: f6fa16c7a2c7455b9acde6539ffec62c
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.sensor.psu.current.status[{#SENSOR_NAME}],)=2'
                  name: 'Dell R820: Power supply [{#SENSOR_NAME}]: Current sensor: Warning state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Please check the device for warnings.'
                  dependencies:
                    - name: 'Dell R820: Power supply [{#SENSOR_NAME}]: Current sensor: Critical state'
                      expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.sensor.psu.current.status[{#SENSOR_NAME}],)=3'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: e3ac9503e64b4c149e1bec0a69101102
              name: 'Power supply [{#SENSOR_NAME}]: Current'
              type: DEPENDENT
              key: 'dell.server.sensor.psu.current[{#SENSOR_NAME}]'
              value_type: FLOAT
              units: A
              description: 'Sensor value.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.current.reading
              master_item:
                key: 'dell.server.sensor.psu.get[{#SENSOR_NAME}]'
              tags:
                - tag: component
                  value: current
                - tag: component
                  value: psu
            - uuid: 2e57438cee814c6dba1fe244e85b50af
              name: 'Power supply [{#SENSOR_NAME}]: Get sensor'
              type: DEPENDENT
              key: 'dell.server.sensor.psu.get[{#SENSOR_NAME}]'
              history: '0'
              value_type: TEXT
              description: 'Returns the metrics of a sensor.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.psu.[?(@.name == ''{#SENSOR_NAME}'')].first()'
              master_item:
                key: dell.server.sensors.get
              tags:
                - tag: component
                  value: psu
                - tag: component
                  value: raw
            - uuid: c733c7f6f35e40618037aa50ba98f294
              name: 'Power supply [{#SENSOR_NAME}]: Voltage sensor status'
              type: DEPENDENT
              key: 'dell.server.sensor.psu.voltage.status[{#SENSOR_NAME}]'
              trends: '0'
              description: 'The status of the job. Possible values: OK, Warning, Critical.'
              valuemap:
                name: 'Redfish status health'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.voltage.health
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = {
                      	'OK': 1,
                      	'Warning': 2,
                      	'Critical': 3,
                      };
                      
                      return typeof idx[value] === 'undefined' ? 0 : idx[value];
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.sensor.psu.get[{#SENSOR_NAME}]'
              tags:
                - tag: component
                  value: psu
              trigger_prototypes:
                - uuid: 1602fd8e39654e5fb06cdf958a47cc7c
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.sensor.psu.voltage.status[{#SENSOR_NAME}],)=3'
                  name: 'Dell R820: Power supply [{#SENSOR_NAME}]: Voltage sensor: Critical state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Please check the device for faults.'
                  tags:
                    - tag: scope
                      value: availability
                - uuid: d7a5a00dc1794dcfbd4dba41cc0ab9e2
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.sensor.psu.voltage.status[{#SENSOR_NAME}],)=2'
                  name: 'Dell R820: Power supply [{#SENSOR_NAME}]: Voltage sensor: Warning state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Please check the device for warnings.'
                  dependencies:
                    - name: 'Dell R820: Power supply [{#SENSOR_NAME}]: Voltage sensor: Critical state'
                      expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.sensor.psu.voltage.status[{#SENSOR_NAME}],)=3'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: beebdfb94e564585a2a031828bc0ad28
              name: 'Power supply [{#SENSOR_NAME}]: Voltage'
              type: DEPENDENT
              key: 'dell.server.sensor.psu.voltage[{#SENSOR_NAME}]'
              value_type: FLOAT
              units: V
              description: 'Sensor value.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.voltage.reading
              master_item:
                key: 'dell.server.sensor.psu.get[{#SENSOR_NAME}]'
              tags:
                - tag: component
                  value: psu
                - tag: component
                  value: voltage
          graph_prototypes:
            - uuid: 79887275746b4d7686e7204e0be5f4e2
              name: 'Dell R820: Power supply [{#SENSOR_NAME}]: Current'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'DELL PowerEdge R820 by HTTP'
                    key: 'dell.server.sensor.psu.current[{#SENSOR_NAME}]'
            - uuid: 0687e35b0de04d9d87ade4b4c9e05ff6
              name: 'Dell R820: Power supply [{#SENSOR_NAME}]: Voltage'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'DELL PowerEdge R820 by HTTP'
                    key: 'dell.server.sensor.psu.voltage[{#SENSOR_NAME}]'
          master_item:
            key: dell.server.sensors.get
          lld_macro_paths:
            - lld_macro: '{#SENSOR_NAME}'
              path: $.name
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.psu
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        - uuid: 12273df317b64c15b62f5e1fe8a11c13
          name: 'Temperature discovery'
          type: DEPENDENT
          key: dell.server.temp.discovery
          description: 'Discovery of temperature sensors.'
          item_prototypes:
            - uuid: c011ede250b34a08ba7b8be1e5116592
              name: 'Probe [{#SENSOR_NAME}]: Get sensor'
              type: DEPENDENT
              key: 'dell.server.sensor.temp.get[{#SENSOR_NAME}]'
              history: '0'
              value_type: TEXT
              description: 'Returns the metrics of a sensor.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.temperature.[?(@.id == ''{#ID}'')].first()'
              master_item:
                key: dell.server.sensors.get
              tags:
                - tag: component
                  value: raw
                - tag: component
                  value: temperature
            - uuid: 2addb92ba4494c5e9372d13123de9b90
              name: 'Probe [{#SENSOR_NAME}]: Status'
              type: DEPENDENT
              key: 'dell.server.sensor.temp.status[{#SENSOR_NAME}]'
              trends: '0'
              description: 'The status of the job. Possible values: OK, Warning, Critical.'
              valuemap:
                name: 'Redfish status health'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.health
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = {
                      	'OK': 1,
                      	'Warning': 2,
                      	'Critical': 3,
                      };
                      
                      return typeof idx[value] === 'undefined' ? 0 : idx[value];
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.sensor.temp.get[{#SENSOR_NAME}]'
              tags:
                - tag: component
                  value: temperature
              trigger_prototypes:
                - uuid: e7cb237f1bdd48dfb1d4dad059a192ab
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.sensor.temp.status[{#SENSOR_NAME}],)=3'
                  name: 'Dell R820: Probe [{#SENSOR_NAME}]: Critical state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Please check the device for faults.'
                  tags:
                    - tag: scope
                      value: availability
                - uuid: 8edc7d146dd3428ea41de5f4c6de3299
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.sensor.temp.status[{#SENSOR_NAME}],)=2'
                  name: 'Dell R820: Probe [{#SENSOR_NAME}]: Warning state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Please check the device for warnings.'
                  dependencies:
                    - name: 'Dell R820: Probe [{#SENSOR_NAME}]: Critical state'
                      expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.sensor.temp.status[{#SENSOR_NAME}],)=3'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: efc408f9598044aa88c70a98b5cc4462
              name: 'Probe [{#SENSOR_NAME}]: Value'
              type: DEPENDENT
              key: 'dell.server.sensor.temp.value[{#SENSOR_NAME}]'
              value_type: FLOAT
              units: C
              description: 'Sensor value.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.reading
              master_item:
                key: 'dell.server.sensor.temp.get[{#SENSOR_NAME}]'
              tags:
                - tag: component
                  value: temperature
          graph_prototypes:
            - uuid: 1575af71deae4faaacf2927b8a06df80
              name: 'Dell R820: Probe [{#SENSOR_NAME}]: Value'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'DELL PowerEdge R820 by HTTP'
                    key: 'dell.server.sensor.temp.value[{#SENSOR_NAME}]'
          master_item:
            key: dell.server.sensors.get
          lld_macro_paths:
            - lld_macro: '{#ID}'
              path: $.id
            - lld_macro: '{#SENSOR_NAME}'
              path: $.name
            - lld_macro: '{#TYPE}'
              path: $.type
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.temperature
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        - uuid: bbc9622129f24600838a85f965bac854
          name: 'Virtual disk discovery'
          type: DEPENDENT
          key: dell.server.virtualdisk.discovery
          description: 'Discovery of virtual disks.'
          item_prototypes:
            - uuid: 7e81a110ef36478b86cec8ff56700755
              name: 'Virtual disk [{#DISK_NAME}]: Get disk'
              type: SCRIPT
              key: 'dell.server.hw.virtualdisk.get[{#DISK_NAME}]'
              history: '0'
              value_type: TEXT
              params: |
                function validateZabbixParams(requiredParams, allParams) {
                	requiredParams.forEach(function (field) {
                		if (typeof allParams !== 'object' || typeof allParams[field] === 'undefined' || allParams[field] === '') {
                			throw 'Required param is not set: ' + field + '.';
                		}
                	});
                }
                
                function Dell(service, action, params) {
                	this.zabbixLogPrefix = '[ DELL ] [ ' + service + ' ] [ ' + action + ' ]';
                	this.request = new HttpRequest();
                
                	this.executeRequest = function (apiPath) {
                		this.request.addHeader('Authorization: Basic ' + btoa(params['user'] + ':' + params['password']));
                
                		if (params['http_proxy']) {
                			this.request.setProxy(params['http_proxy']);
                			Zabbix.log(4, this.zabbixLogPrefix + ' Using http proxy: ' + params['http_proxy']);
                		}
                
                		const response = this.request.get(params['url'] + apiPath);
                
                		this.request.clearHeader();
                
                		if (this.request.getStatus() === parseInt(params['http_status_code'])) {
                			return response;
                		} else {
                			Zabbix.log(3, this.zabbixLogPrefix + ' Unexpected HTTP response code: ' + this.request.getStatus());
                			throw 'Unexpected HTTP response code: ' + this.request.getStatus();
                		}
                	};
                
                	this.extractData = function (data, keys, skipParse) {
                		if (!skipParse) {
                			try {
                				data = JSON.parse(data);
                			} catch (error) {
                				Zabbix.log(3, this.zabbixLogPrefix + ' Could not parse the received JSON object: ' + data);
                				throw 'Could not parse received JSON object. See logs for more information.';
                			}	
                		}
                
                		if (Array.isArray(keys)) {
                			var returnBuffer = {};
                
                			for (keyIdx = 0, keysLength = keys.length; keyIdx < keysLength; keyIdx++) {
                				if (keys[keyIdx]['path'] === '@odata.id') {
                					returnBuffer[keys[keyIdx]['name']] = data[keys[keyIdx]['path']];
                				} else {
                					returnBuffer[keys[keyIdx]['name']] = this.parseJSON(data, keys[keyIdx]['path'].split('.'));
                				}
                			}
                
                			return returnBuffer;
                		} else if (typeof keys === 'object') {
                			return { [keys['name']]: this.parseJSON(data, keys['path'].split('.')) };
                		} else if (typeof keys === 'string') {
                			return this.parseJSON(data, keys.split('.'));
                		} else {
                			throw 'Unexpected key type';
                		}
                	};
                
                	this.parseJSON = function (data, jsonPath) {
                		for (var i = 0, args = jsonPath.length; i < args; i++) {
                			data = data[jsonPath[i]];
                		}
                
                		return data;
                	}
                }
                
                
                const params = JSON.parse(value);
                
                validateZabbixParams(['url', 'path', 'user', 'password', 'http_status_code'], params);
                var dell = new Dell('Disk', 'Get virtual disk metrics', params);
                
                const keys = [
                	{
                		'name': 'health',
                		'path': 'Status.Health'
                	},
                	{
                		'name': 'capacity',
                		'path': 'CapacityBytes'
                	},
                	{
                		'name': 'status',
                		'path': 'Status.State'
                	},
                	{
                		'name': 'raidStatus',
                		'path': 'Oem.Dell.DellVirtualDisk.RaidStatus'
                	},
                	{
                		'name': 'readCachePolicy',
                		'path': 'Oem.Dell.DellVirtualDisk.ReadCachePolicy'
                	},
                	{
                		'name': 'writeCachePolicy',
                		'path': 'Oem.Dell.DellVirtualDisk.WriteCachePolicy'
                	}
                ];
                
                return JSON.stringify(dell.extractData(dell.executeRequest(params.path), keys));
              description: 'Returns the metrics of a virtual disk.'
              timeout: '{$DELL.HTTP.REQUEST.TIMEOUT}'
              parameters:
                - name: http_proxy
                  value: '{$DELL.HTTP.PROXY}'
                - name: http_status_code
                  value: '{$DELL.HTTP.RETURN.CODE.OK}'
                - name: password
                  value: '{$DELL.HTTP.API.PASSWORD}'
                - name: path
                  value: '{#ODATA}'
                - name: url
                  value: '{$DELL.HTTP.API.URL}'
                - name: user
                  value: '{$DELL.HTTP.API.USER}'
              tags:
                - tag: component
                  value: raw
                - tag: component
                  value: virtualdisk
            - uuid: 390e9960559a4b9eb6460e6af7940e7b
              name: 'Virtual disk [{#DISK_NAME}]: RAID status'
              type: DEPENDENT
              key: 'dell.server.hw.virtualdisk.raid_status[{#DISK_NAME}]'
              description: 'This property represents the RAID specific status. Possible values: Blocked, Degraded, Failed, Foreign, Offline, Online, Ready, Unknown, null.'
              valuemap:
                name: 'Virtual disk RAID status'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.raidStatus
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = {
                      	'Blocked': 1,
                      	'Degraded': 2,
                      	'Failed': 3,
                      	'Foreign': 4,
                      	'Offline': 5,
                      	'Unknown': 6,
                      	'null': 7,
                      	'Ready': 8,
                      	'Online': 9,
                      };
                      
                      return typeof idx[value] === 'undefined' ? 0 : idx[value];
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.hw.virtualdisk.get[{#DISK_NAME}]'
              tags:
                - tag: component
                  value: storage
                - tag: component
                  value: virtualdisk
              trigger_prototypes:
                - uuid: 0fb5bb942b2c499ca4a7a14a2f81866f
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.hw.virtualdisk.raid_status[{#DISK_NAME}],)<8'
                  name: 'Dell R820: Virtual disk [{#DISK_NAME}]: RAID status not OK'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Please check the disk for faults.'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: a7cfd4be1b294e79b483735b8352d949
              name: 'Virtual disk [{#DISK_NAME}]: Read policy'
              type: DEPENDENT
              key: 'dell.server.hw.virtualdisk.read_policy[{#DISK_NAME}]'
              description: 'Indicates the read cache policy setting for the Volume. Possible values: ReadAhead, NoReadAhead, AdaptiveReadAhead.'
              valuemap:
                name: 'Virtual disk read policy'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.readCachePolicy
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = {
                      	'NoReadAhead': 1,
                      	'ReadAhead': 2,
                      	'AdaptiveReadAhead': 3,
                      };
                      
                      return typeof idx[value] === 'undefined' ? 0 : idx[value];
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.hw.virtualdisk.get[{#DISK_NAME}]'
              tags:
                - tag: component
                  value: storage
                - tag: component
                  value: virtualdisk
            - uuid: c02af80164794e95816817510097619d
              name: 'Virtual disk [{#DISK_NAME}]: Size'
              type: DEPENDENT
              key: 'dell.server.hw.virtualdisk.size[{#DISK_NAME}]'
              trends: '0'
              units: B
              description: 'The size in bytes of this Volume.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.capacity
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.hw.virtualdisk.get[{#DISK_NAME}]'
              tags:
                - tag: component
                  value: storage
                - tag: component
                  value: virtualdisk
            - uuid: ea61949505a7409a8f4efff97ae67b57
              name: 'Virtual disk [{#DISK_NAME}]: Current state'
              type: DEPENDENT
              key: 'dell.server.hw.virtualdisk.state[{#DISK_NAME}]'
              description: 'The known state of the Resource, for example, Enabled. Possible values: Enabled, Disabled, StandbyOffline, StandbySpare, InTest, Starting, Absent, UnavailableOffline, Deferring, Quiesced, Updating, Qualified.'
              valuemap:
                name: 'Redfish status state'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.status
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = {
                      	'Enabled': 1,
                      	'Disabled': 2,
                      	'Absent': 3,
                      	'Deferring': 4,
                      	'InTest': 5,
                      	'Quiesced': 6,
                      	'StandbyOffline': 7,
                      	'StandbySpare': 8,
                      	'Starting': 9,
                      	'UnavailableOffline': 10,
                      	'Updating': 11
                      };
                      
                      return typeof idx[value] === 'undefined' ? 0 : idx[value];
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.hw.virtualdisk.get[{#DISK_NAME}]'
              tags:
                - tag: component
                  value: storage
                - tag: component
                  value: virtualdisk
            - uuid: 747677c63d7e4cfca3420a14c862d9b1
              name: 'Virtual disk [{#DISK_NAME}]: Status'
              type: DEPENDENT
              key: 'dell.server.hw.virtualdisk.status[{#DISK_NAME}]'
              description: 'The status of the job. Possible values: OK, Warning, Critical.'
              valuemap:
                name: 'Redfish status health'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.health
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = {
                      	'OK': 1,
                      	'Warning': 2,
                      	'Critical': 3,
                      };
                      
                      return typeof idx[value] === 'undefined' ? 0 : idx[value];
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.hw.virtualdisk.get[{#DISK_NAME}]'
              tags:
                - tag: component
                  value: storage
                - tag: component
                  value: virtualdisk
              trigger_prototypes:
                - uuid: f81719285f6f41a19603b1f29439a701
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.hw.virtualdisk.status[{#DISK_NAME}],)=3'
                  name: 'Dell R820: Virtual disk [{#DISK_NAME}]: Critical state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Please check the device for faults.'
                  tags:
                    - tag: scope
                      value: availability
                - uuid: fb620d2cfe0045ee83c57f9699bf25f3
                  expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.hw.virtualdisk.status[{#DISK_NAME}],)=2'
                  name: 'Dell R820: Virtual disk [{#DISK_NAME}]: Warning state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Please check the device for warnings.'
                  dependencies:
                    - name: 'Dell R820: Virtual disk [{#DISK_NAME}]: Critical state'
                      expression: 'last(/DELL PowerEdge R820 by HTTP/dell.server.hw.virtualdisk.status[{#DISK_NAME}],)=3'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: d5e5cf0f065f4f5ba5f0edbf3e222417
              name: 'Virtual disk [{#DISK_NAME}]: Write policy'
              type: DEPENDENT
              key: 'dell.server.hw.virtualdisk.write_policy[{#DISK_NAME}]'
              description: 'Indicates the write cache policy setting for the Volume. Possible values: WriteThrough, WriteBack, ProtectedWriteBack, UnprotectedWriteBack.'
              valuemap:
                name: 'Virtual disk write policy'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.writeCachePolicy
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = {
                      	'WriteThrough': 1,
                      	'WriteBack': 2,
                      	'ProtectedWriteBack': 3,
                      	'UnprotectedWriteBack': 4,
                      };
                      
                      return typeof idx[value] === 'undefined' ? 0 : idx[value];
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 6h
              master_item:
                key: 'dell.server.hw.virtualdisk.get[{#DISK_NAME}]'
              tags:
                - tag: component
                  value: storage
                - tag: component
                  value: virtualdisk
          graph_prototypes:
            - uuid: 759e99496b4644ce9606d4c9cc5f7b16
              name: 'Dell R820: Virtual disk [{#DISK_NAME}]: Size'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'DELL PowerEdge R820 by HTTP'
                    key: 'dell.server.hw.virtualdisk.size[{#DISK_NAME}]'
          master_item:
            key: dell.server.disks.get
          lld_macro_paths:
            - lld_macro: '{#DISK_NAME}'
              path: $.name
            - lld_macro: '{#ODATA}'
              path: $.path
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.virtualDisks
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
      tags:
        - tag: class
          value: hardware
        - tag: subclass
          value: server
        - tag: target
          value: dell
        - tag: target
          value: dellpoweredge
      macros:
        - macro: '{$DELL.HTTP.API.PASSWORD}'
          type: SECRET_TEXT
          description: 'The Dell iDRAC user password.'
          config:
            type: TEXT
            priority: '3'
            label: 'iDRAC password'
            description: 'The Dell iDRAC user password.'
            required: 'YES'
        - macro: '{$DELL.HTTP.API.URL}'
          description: 'The Dell iDRAC Redfish API URL in the format `<scheme>://<host>:<port>`.'
          config:
            type: TEXT
            priority: '1'
            label: 'iDRAC API URL'
            description: 'The Dell iDRAC Redfish API URL in the format `<scheme>://<host>:<port>`.'
            required: 'YES'
        - macro: '{$DELL.HTTP.API.USER}'
          description: 'The Dell iDRAC username.'
          config:
            type: TEXT
            priority: '2'
            label: 'iDRAC username'
            description: 'The Dell iDRAC username.'
            required: 'YES'
        - macro: '{$DELL.HTTP.CPU.UTIL.HIGH}'
          value: '90'
          description: 'Sets the percentage threshold for creating a "high" severity event about CPU utilization.'
          config:
            type: TEXT
            priority: '8'
            section_name: Thresholds
            label: 'CPU usage high (%)'
            description: 'Sets the percentage threshold for creating a "high" severity event about CPU utilization. In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$DELL.HTTP.CPU.UTIL.WARN}'
          value: '75'
          description: 'Sets the percentage threshold for creating a "warning" severity event about CPU utilization.'
          config:
            type: TEXT
            priority: '9'
            section_name: Thresholds
            label: 'CPU usage warning (%)'
            description: 'Sets the percentage threshold for creating a "warning" severity event about CPU utilization. In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$DELL.HTTP.IFCONTROL}'
          value: '1'
          description: 'Link status trigger will be fired only for interfaces that have the context macro equal to "1".'
          config:
            type: TEXT
            priority: '7'
            section_name: Other
            label: 'Link status trigger enabled'
            description: 'Link status trigger will be fired only for interfaces that have the context macro equal to "1".'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$DELL.HTTP.IO.UTIL.HIGH}'
          value: '90'
          description: 'Sets the percentage threshold for creating a "high" severity event about IO utilization.'
          config:
            type: TEXT
            priority: '12'
            section_name: Thresholds
            label: 'IO usage high (%)'
            description: 'Sets the percentage threshold for creating a "high" severity event about IO utilization. In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$DELL.HTTP.IO.UTIL.WARN}'
          value: '75'
          description: 'Sets the percentage threshold for creating a "warning" severity event about IO utilization.'
          config:
            type: TEXT
            priority: '13'
            section_name: Thresholds
            label: 'IO usage warning (%)'
            description: 'Sets the percentage threshold for creating a "warning" severity event about IO utilization. In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$DELL.HTTP.MEM.UTIL.HIGH}'
          value: '90'
          description: 'Sets the percentage threshold for creating a "high" severity event about memory utilization.'
          config:
            type: TEXT
            priority: '10'
            section_name: Thresholds
            label: 'Memory usage high (%)'
            description: 'Sets the percentage threshold for creating a "high" severity event about memory utilization. In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$DELL.HTTP.MEM.UTIL.WARN}'
          value: '75'
          description: 'Sets the percentage threshold for creating a "warning" severity event about memory utilization.'
          config:
            type: TEXT
            priority: '11'
            section_name: Thresholds
            label: 'Memory usage warning (%)'
            description: 'Sets the percentage threshold for creating a "warning" severity event about memory utilization. In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$DELL.HTTP.PROXY}'
          description: 'Set an HTTP proxy for Redfish API requests if needed.'
          config:
            type: TEXT
            priority: '4'
            section_name: Other
            label: 'HTTP proxy'
            description: 'Set an HTTP proxy for Redfish API requests if needed.'
        - macro: '{$DELL.HTTP.REQUEST.TIMEOUT}'
          value: 10s
          description: 'Set the timeout for HTTP requests.'
          config:
            type: TEXT
            priority: '6'
            section_name: Other
            label: 'HTTP timeout'
            description: 'Set the timeout for HTTP requests.'
        - macro: '{$DELL.HTTP.RETURN.CODE.OK}'
          value: '200'
          description: 'Set the HTTP return code that represents an OK response from the API. The default is "200", but can vary, for example, if a proxy is used.'
          config:
            type: TEXT
            priority: '5'
            section_name: Other
            label: 'HTTP OK code'
            description: 'Set the HTTP return code that represents an OK response from the API. The default is "200", but can vary, for example, if a proxy is used.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$DELL.HTTP.SYS.UTIL.HIGH}'
          value: '90'
          description: 'Sets the percentage threshold for creating a "high" severity event about SYS utilization.'
          config:
            type: TEXT
            priority: '14'
            section_name: Thresholds
            label: 'SYS usage high (%)'
            description: 'Sets the percentage threshold for creating a "high" severity event about SYS utilization. In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$DELL.HTTP.SYS.UTIL.WARN}'
          value: '75'
          description: 'Sets the percentage threshold for creating a "warning" severity event about SYS utilization.'
          config:
            type: TEXT
            priority: '15'
            section_name: Thresholds
            label: 'SYS usage warning (%)'
            description: 'Sets the percentage threshold for creating a "warning" severity event about SYS utilization. In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
      dashboards:
        - uuid: a257ca606b194b4d848997f36e39a320
          name: Overview
          pages:
            - name: Overview
              display_period: '30'
              widgets:
                - type: gauge
                  name: 'CPU utilization'
                  width: '18'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: bg_color
                      value: 6C00D9
                    - type: STRING
                      name: description
                      value: CPU
                    - type: STRING
                      name: desc_color
                      value: FFFFFF
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: STRING
                      name: empty_color
                      value: 5000A1
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'DELL PowerEdge R820 by HTTP'
                        key: dell.server.util.cpu
                    - type: INTEGER
                      name: rf_rate
                      value: '30'
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '1'
                    - type: INTEGER
                      name: show.2
                      value: '5'
                    - type: STRING
                      name: units
                      value: '%'
                    - type: INTEGER
                      name: units_bold
                      value: '1'
                    - type: STRING
                      name: units_color
                      value: FFFFFF
                    - type: STRING
                      name: value_arc_color
                      value: FFFFFF
                    - type: INTEGER
                      name: value_arc_size
                      value: '35'
                    - type: INTEGER
                      name: value_bold
                      value: '1'
                    - type: STRING
                      name: value_color
                      value: FFFFFF
                - type: gauge
                  name: 'Memory utilization'
                  'y': '3'
                  width: '18'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: bg_color
                      value: 6C00D9
                    - type: STRING
                      name: description
                      value: MEM
                    - type: STRING
                      name: desc_color
                      value: FFFFFF
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: STRING
                      name: empty_color
                      value: 5000A1
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'DELL PowerEdge R820 by HTTP'
                        key: dell.server.util.mem
                    - type: INTEGER
                      name: rf_rate
                      value: '30'
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '1'
                    - type: INTEGER
                      name: show.2
                      value: '5'
                    - type: STRING
                      name: units
                      value: '%'
                    - type: INTEGER
                      name: units_bold
                      value: '1'
                    - type: STRING
                      name: units_color
                      value: FFFFFF
                    - type: STRING
                      name: value_arc_color
                      value: FFFFFF
                    - type: INTEGER
                      name: value_arc_size
                      value: '35'
                    - type: INTEGER
                      name: value_bold
                      value: '1'
                    - type: STRING
                      name: value_color
                      value: FFFFFF
                - type: gauge
                  name: 'I/O utilization'
                  'y': '6'
                  width: '18'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: bg_color
                      value: 6C00D9
                    - type: STRING
                      name: description
                      value: I/O
                    - type: STRING
                      name: desc_color
                      value: FFFFFF
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: STRING
                      name: empty_color
                      value: 5000A1
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'DELL PowerEdge R820 by HTTP'
                        key: dell.server.util.io
                    - type: INTEGER
                      name: rf_rate
                      value: '30'
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '1'
                    - type: INTEGER
                      name: show.2
                      value: '5'
                    - type: STRING
                      name: units
                      value: '%'
                    - type: INTEGER
                      name: units_bold
                      value: '1'
                    - type: STRING
                      name: units_color
                      value: FFFFFF
                    - type: STRING
                      name: value_arc_color
                      value: FFFFFF
                    - type: INTEGER
                      name: value_arc_size
                      value: '35'
                    - type: INTEGER
                      name: value_bold
                      value: '1'
                    - type: STRING
                      name: value_color
                      value: FFFFFF
                - type: gauge
                  name: 'SYS utilization'
                  'y': '9'
                  width: '18'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: bg_color
                      value: 6C00D9
                    - type: STRING
                      name: description
                      value: SYS
                    - type: STRING
                      name: desc_color
                      value: FFFFFF
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: STRING
                      name: empty_color
                      value: 5000A1
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'DELL PowerEdge R820 by HTTP'
                        key: dell.server.util.sys
                    - type: INTEGER
                      name: rf_rate
                      value: '30'
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '1'
                    - type: INTEGER
                      name: show.2
                      value: '5'
                    - type: STRING
                      name: units
                      value: '%'
                    - type: INTEGER
                      name: units_bold
                      value: '1'
                    - type: STRING
                      name: units_color
                      value: FFFFFF
                    - type: STRING
                      name: value_arc_color
                      value: FFFFFF
                    - type: INTEGER
                      name: value_arc_size
                      value: '35'
                    - type: INTEGER
                      name: value_bold
                      value: '1'
                    - type: STRING
                      name: value_color
                      value: FFFFFF
                - type: item
                  name: 'Redfish API'
                  x: '18'
                  width: '27'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: bg_color
                      value: 2196F3
                    - type: STRING
                      name: description
                      value: 'Redfish API'
                    - type: STRING
                      name: desc_color
                      value: FFFFFF
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'DELL PowerEdge R820 by HTTP'
                        key: 'net.tcp.service[https]'
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '1'
                    - type: STRING
                      name: value_color
                      value: FFFFFF
                    - type: INTEGER
                      name: value_size
                      value: '35'
                - type: item
                  name: 'HW model'
                  x: '18'
                  'y': '3'
                  width: '54'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: bg_color
                      value: 2196F3
                    - type: STRING
                      name: description
                      value: 'HW model'
                    - type: STRING
                      name: desc_color
                      value: FFFFFF
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'DELL PowerEdge R820 by HTTP'
                        key: dell.server.hw.model
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '1'
                    - type: STRING
                      name: value_color
                      value: FFFFFF
                    - type: INTEGER
                      name: value_size
                      value: '35'
                - type: item
                  name: 'Serial number'
                  x: '18'
                  'y': '6'
                  width: '54'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: bg_color
                      value: 2196F3
                    - type: STRING
                      name: description
                      value: 'Serial number'
                    - type: STRING
                      name: desc_color
                      value: FFFFFF
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'DELL PowerEdge R820 by HTTP'
                        key: dell.server.hw.serialnumber
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '1'
                    - type: STRING
                      name: value_color
                      value: FFFFFF
                    - type: INTEGER
                      name: value_size
                      value: '35'
                - type: item
                  name: Firmware
                  x: '18'
                  'y': '9'
                  width: '54'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: bg_color
                      value: 2196F3
                    - type: STRING
                      name: description
                      value: Firmware
                    - type: STRING
                      name: desc_color
                      value: FFFFFF
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'DELL PowerEdge R820 by HTTP'
                        key: dell.server.hw.firmware
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '1'
                    - type: STRING
                      name: value_color
                      value: FFFFFF
                    - type: INTEGER
                      name: value_size
                      value: '35'
                - type: item
                  name: 'System health'
                  x: '45'
                  width: '27'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: bg_color
                      value: 2196F3
                    - type: STRING
                      name: description
                      value: 'System Health'
                    - type: STRING
                      name: desc_color
                      value: FFFFFF
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'DELL PowerEdge R820 by HTTP'
                        key: dell.server.status
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '1'
                    - type: STRING
                      name: value_color
                      value: FFFFFF
                    - type: INTEGER
                      name: value_size
                      value: '35'
            - name: Discoveries
              display_period: '30'
              widgets:
                - type: honeycomb
                  name: 'Interface link'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Interface*Link status'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("\[(.*?)\]", "\1")}'
                    - type: INTEGER
                      name: primary_label_size_type
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAA
                    - type: STRING
                      name: thresholds.0.color
                      value: D3212C
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '2'
                    - type: STRING
                      name: thresholds.1.color
                      value: 069C56
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '3'
                - type: honeycomb
                  name: 'Temperature sensors'
                  'y': '4'
                  width: '72'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Probe*Value'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("\[(.*?)\]", "\1")}'
                    - type: INTEGER
                      name: primary_label_size_type
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAB
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                - type: honeycomb
                  name: 'Physical disks'
                  'y': '8'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Physical disk*Status'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("\[(.*?)\]", "\1")}'
                    - type: INTEGER
                      name: primary_label_size_type
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAC
                    - type: STRING
                      name: thresholds.0.color
                      value: 069C56
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.1.color
                      value: FF681E
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '2'
                    - type: STRING
                      name: thresholds.2.color
                      value: D3212C
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '3'
                - type: honeycomb
                  name: 'Power supplies'
                  'y': '12'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Power supply*Voltage'
                    - type: STRING
                      name: items.1
                      value: 'Power supply*Current'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("\[(.*?)\]", "\1")}'
                    - type: INTEGER
                      name: primary_label_size_type
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAE
                - type: honeycomb
                  name: 'Interface speed'
                  x: '36'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Interface*Speed'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("\[(.*?)\]", "\1")}'
                    - type: INTEGER
                      name: primary_label_size_type
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAABA
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                    - type: STRING
                      name: thresholds.0.color
                      value: D3212C
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: FF681E
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '10000000'
                    - type: STRING
                      name: thresholds.2.color
                      value: FF980E
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '100000000'
                    - type: STRING
                      name: thresholds.3.color
                      value: 069C56
                    - type: STRING
                      name: thresholds.3.threshold
                      value: '1000000000'
                    - type: STRING
                      name: thresholds.4.color
                      value: 2196F3
                    - type: STRING
                      name: thresholds.4.threshold
                      value: '10000000000'
                    - type: STRING
                      name: thresholds.5.color
                      value: 6C00D9
                    - type: STRING
                      name: thresholds.5.threshold
                      value: '25000000000'
                    - type: STRING
                      name: thresholds.6.color
                      value: D900A6
                    - type: STRING
                      name: thresholds.6.threshold
                      value: '40000000000'
                - type: honeycomb
                  name: 'Virtual disks'
                  x: '36'
                  'y': '8'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Virtual disk*: Status'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("\[(.*?)\]", "\1")}'
                    - type: INTEGER
                      name: primary_label_size_type
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAD
                    - type: STRING
                      name: thresholds.0.color
                      value: 069C56
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.1.color
                      value: FF681E
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '2'
                    - type: STRING
                      name: thresholds.2.color
                      value: D3212C
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '3'
                - type: honeycomb
                  name: Fans
                  x: '36'
                  'y': '12'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Probe*Status'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("\[(.*?)\]", "\1")}'
                    - type: INTEGER
                      name: primary_label_size_type
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAF
                    - type: STRING
                      name: thresholds.0.color
                      value: 069C56
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.1.color
                      value: FF681E
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '2'
                    - type: STRING
                      name: thresholds.2.color
                      value: D3212C
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '3'
      valuemaps:
        - uuid: a9fd1db9128d4efca329941ff4f4d41b
          name: 'Network interface status'
          mappings:
            - value: '0'
              newvalue: Unknown
            - value: '1'
              newvalue: 'Null'
            - value: '2'
              newvalue: Down
            - value: '3'
              newvalue: Up
        - uuid: 45c31886b41f4592bb87ffe940ce9fd8
          name: 'Redfish API availability'
          mappings:
            - value: '0'
              newvalue: Unavailable
            - value: '1'
              newvalue: Available
        - uuid: e8d3f0814cad4a2bba79231c1c8c0230
          name: 'Redfish status health'
          mappings:
            - value: '0'
              newvalue: Unknown
            - value: '1'
              newvalue: OK
            - value: '2'
              newvalue: Warning
            - value: '3'
              newvalue: Critical
        - uuid: d18e6f1b160f4ee3851b21cff3309d40
          name: 'Redfish status state'
          mappings:
            - value: '0'
              newvalue: Unknown
            - value: '1'
              newvalue: Enabled
            - value: '2'
              newvalue: Disabled
            - value: '3'
              newvalue: Absent
            - value: '4'
              newvalue: Deferring
            - value: '5'
              newvalue: InTest
            - value: '6'
              newvalue: Quiesced
            - value: '7'
              newvalue: StandbyOffline
            - value: '8'
              newvalue: StandbySpare
            - value: '9'
              newvalue: Starting
            - value: '10'
              newvalue: UnavailableOffline
            - value: '11'
              newvalue: Updating
        - uuid: 82e0dc0cd4714fb1b3894adff630b0d8
          name: 'Virtual disk RAID status'
          mappings:
            - value: '0'
              newvalue: unknown
            - value: '1'
              newvalue: Blocked
            - value: '2'
              newvalue: Degraded
            - value: '3'
              newvalue: Failed
            - value: '4'
              newvalue: Foreign
            - value: '5'
              newvalue: Offline
            - value: '6'
              newvalue: Unknown
            - value: '7'
              newvalue: 'Null'
            - value: '8'
              newvalue: Ready
            - value: '9'
              newvalue: Online
        - uuid: 3c9e776333294c79a975b715fab7a35d
          name: 'Virtual disk read policy'
          mappings:
            - value: '0'
              newvalue: Unknown
            - value: '1'
              newvalue: NoReadAhead
            - value: '2'
              newvalue: ReadAhead
            - value: '3'
              newvalue: AdaptiveReadAhead
        - uuid: 916622b4d50b4304b95888c9fc49149e
          name: 'Virtual disk write policy'
          mappings:
            - value: '0'
              newvalue: Unknown
            - value: '1'
              newvalue: WriteThrough
            - value: '2'
              newvalue: WriteBack
            - value: '3'
              newvalue: ProtectedWriteBack
            - value: '4'
              newvalue: UnprotectedWriteBack
  graphs:
    - uuid: e4b1e16f35f5445dad9d49876c8def60
      name: 'Dell R820: CPU utilization'
      graph_items:
        - color: 199C0D
          item:
            host: 'DELL PowerEdge R820 by HTTP'
            key: dell.server.util.cpu
    - uuid: 81516d7d799044fb83b166ecc7c280f8
      name: 'Dell R820: IO utilization'
      graph_items:
        - color: 199C0D
          item:
            host: 'DELL PowerEdge R820 by HTTP'
            key: dell.server.util.io
    - uuid: c8efb88c2b654975bfba21c5a292ee75
      name: 'Dell R820: Memory utilization'
      graph_items:
        - color: 199C0D
          item:
            host: 'DELL PowerEdge R820 by HTTP'
            key: dell.server.util.mem
    - uuid: 05822555cf8e4f33a559d1973e9776bb
      name: 'Dell R820: SYS utilization'
      graph_items:
        - color: 199C0D
          item:
            host: 'DELL PowerEdge R820 by HTTP'
            key: dell.server.util.sys
