zabbix_export:
  version: '8.0'
  template_groups:
    - uuid: a571c0d144b14fd4a87a9d9b2aa9fcd6
      name: Templates/Applications
  templates:
    - uuid: a0e05ca631034676821b7e0e1ce25488
      template: 'Microsoft Exchange Server 2016 by Zabbix agent active'
      name: 'Microsoft Exchange Server 2016 by Zabbix agent active'
      description: |
        The template to monitor Microsoft Exchange Server 2016 by Zabbix that works without any external scripts.
        The metrics are collected by Zabbix agent active.
        Recommended to use it with "OS Windows by Zabbix agent active" template.
        
        You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/415007-discussion-thread-for-official-zabbix-template-microsoft-exchange
        
        Generated by official Zabbix template tool "Templator"
      wizard_ready: 'YES'
      readme: |
        ## Overview
        
        Official Template for Microsoft Exchange Server 2016.
        
        
        ## Setup
        
        Metrics are collected by Zabbix agent active.
        
        1\. Import the template into Zabbix.
        
        2\. Link the imported template to a host with MS Exchange.
        
        Note that template doesn't provide information about Windows services state. Recommended to use it with "OS Windows by Zabbix agent active" template.
      vendor:
        name: Zabbix
        version: 8.0-1
      groups:
        - name: Templates/Applications
      items:
        - uuid: 5af1c3257c264abda20023eae10b3b86
          name: 'Databases total mounted'
          type: ZABBIX_ACTIVE
          key: 'perf_counter_en["\MSExchange Active Manager(_total)\Database Mounted"]'
          delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
          description: 'Shows the number of active database copies on the server.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          tags:
            - tag: component
              value: application
        - uuid: bb9de29f56124a77a6ac1d3f8cbd72e9
          name: 'ActiveSync: ping command pending'
          type: ZABBIX_ACTIVE
          key: 'perf_counter_en["\MSExchange ActiveSync\Ping Commands Pending", {$MS.EXCHANGE.PERF.INTERVAL}]'
          delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
          value_type: FLOAT
          description: 'Shows the number of ping commands currently pending in the queue.'
          tags:
            - tag: component
              value: application
        - uuid: 038e740be37c40339520b4c4b1b0d18b
          name: 'ActiveSync: requests per second'
          type: ZABBIX_ACTIVE
          key: 'perf_counter_en["\MSExchange ActiveSync\Requests/sec", {$MS.EXCHANGE.PERF.INTERVAL}]'
          delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
          value_type: FLOAT
          description: 'Shows the number of HTTP requests received from the client via ASP.NET per second. Determines the current Exchange ActiveSync request rate. Used only to determine current user load.'
          tags:
            - tag: component
              value: application
        - uuid: 953665dbe8f948ff821333a4d50eada6
          name: 'ActiveSync: sync commands per second'
          type: ZABBIX_ACTIVE
          key: 'perf_counter_en["\MSExchange ActiveSync\Sync Commands/sec", {$MS.EXCHANGE.PERF.INTERVAL}]'
          delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
          value_type: FLOAT
          description: 'Shows the number of sync commands processed per second. Clients use this command to synchronize items within a folder.'
          tags:
            - tag: component
              value: application
        - uuid: c8ed8a7e36c6453183aee1a778a4749a
          name: 'Autodiscover: requests per second'
          type: ZABBIX_ACTIVE
          key: 'perf_counter_en["\MSExchangeAutodiscover\Requests/sec", {$MS.EXCHANGE.PERF.INTERVAL}]'
          delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
          value_type: FLOAT
          description: 'Shows the number of Autodiscover service requests processed each second. Determines current user load.'
          tags:
            - tag: component
              value: application
        - uuid: 2260d98130814d369ac1c90324caaa26
          name: 'Availability Service: availability requests per second'
          type: ZABBIX_ACTIVE
          key: 'perf_counter_en["\MSExchange Availability Service\Availability Requests (sec)", {$MS.EXCHANGE.PERF.INTERVAL}]'
          delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
          value_type: FLOAT
          description: 'Shows the number of requests serviced per second. The request can be only for free/ busy information or include suggestions. One request may contain multiple mailboxes. Determines the rate at which Availability service requests are occurring.'
          tags:
            - tag: component
              value: application
        - uuid: b4336fce2d27450b95de4f1bbbf947f3
          name: 'Outlook Web App: current unique users'
          type: ZABBIX_ACTIVE
          key: 'perf_counter_en["\MSExchange OWA\Current Unique Users", {$MS.EXCHANGE.PERF.INTERVAL}]'
          delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
          value_type: FLOAT
          description: 'Shows the number of unique users currently logged on to Outlook Web App. This value monitors the number of unique active user sessions, so that users are only removed from this counter after they log off or their session times out. Determines current user load.'
          tags:
            - tag: component
              value: application
        - uuid: 14344546f3a748fbb8f78e503e92255f
          name: 'Outlook Web App: requests per second'
          type: ZABBIX_ACTIVE
          key: 'perf_counter_en["\MSExchange OWA\Requests/sec", {$MS.EXCHANGE.PERF.INTERVAL}]'
          delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
          value_type: FLOAT
          description: 'Shows the number of requests handled by Outlook Web App per second. Determines current user load.'
          tags:
            - tag: component
              value: application
        - uuid: e8c8e348c01e48ad92ee02060717e097
          name: 'MSExchangeWS: requests per second'
          type: ZABBIX_ACTIVE
          key: 'perf_counter_en["\MSExchangeWS\Requests/sec", {$MS.EXCHANGE.PERF.INTERVAL}]'
          delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
          value_type: FLOAT
          description: 'Shows the number of requests processed each second. Determines current user load.'
          tags:
            - tag: component
              value: application
        - uuid: b20b5df8198e4cdc8b584061f6815d5d
          name: 'Active agent availability'
          type: INTERNAL
          key: 'zabbix[host,active_agent,available]'
          description: |
            Availability of active checks on the host. The value of this item corresponds to availability icons in the host list.
            Possible values:
            0 - unknown
            1 - available
            2 - not available
          valuemap:
            name: zabbix.host.active_agent.available
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 8f04c3d6b3224382abf7472e8a4e38ba
              expression: 'min(/Microsoft Exchange Server 2016 by Zabbix agent active/zabbix[host,active_agent,available],{$AGENT.TIMEOUT})=2'
              name: 'MS Exchange 2016: Active checks are not available'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: HIGH
              description: 'Active checks are considered unavailable. Agent is not sending heartbeat for prolonged time.'
              tags:
                - tag: scope
                  value: availability
      discovery_rules:
        - uuid: 3b23aa50517a4081b8463f694757cd0c
          name: 'Databases discovery'
          type: ZABBIX_ACTIVE
          key: 'perf_instance.discovery["MSExchange Active Manager"]'
          delay: 1h
          description: 'Discovery of Exchange databases.'
          item_prototypes:
            - uuid: 7e0a5f324690432199728f577dbcc91a
              name: 'Active Manager [{#INSTANCE}]: Database copy role'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchange Active Manager({#INSTANCE})\Database Copy Role Active"]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              description: 'Database copy active or passive role.'
              valuemap:
                name: 'Exchange database copy role'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3h
              tags:
                - tag: component
                  value: application
            - uuid: 947396e622b24e2090a23607ee7a06a4
              name: 'Information Store [{#INSTANCE}]: Page faults per second'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchange Database({#INF.STORE})\Database Page Fault Stalls/sec", {$MS.EXCHANGE.PERF.INTERVAL}]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              description: 'Indicates the rate of page faults that can''t be serviced because there are no pages available for allocation from the database cache. If this counter is above 0, it''s an indication that the MSExchange Database\I/O Database Writes (Attached) Average Latency is too high.'
              tags:
                - tag: component
                  value: application
              trigger_prototypes:
                - uuid: c3540ee98c464c3bbcf680e26ce6165a
                  expression: 'min(/Microsoft Exchange Server 2016 by Zabbix agent active/perf_counter_en["\MSExchange Database({#INF.STORE})\Database Page Fault Stalls/sec", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.DB.FAULTS.TIME})>{$MS.EXCHANGE.DB.FAULTS.WARN}'
                  name: 'MS Exchange 2016: Information Store [{#INSTANCE}]: Page faults is too high'
                  event_name: 'MS Exchange 2016: Information Store [{#INSTANCE}]: Page faults is too high (>{$MS.EXCHANGE.DB.FAULTS.WARN} for {$MS.EXCHANGE.DB.FAULTS.TIME})'
                  priority: AVERAGE
                  description: 'Too much page faults stalls for database "{#INSTANCE}". This counter should be 0 on production servers.'
                  tags:
                    - tag: scope
                      value: notice
            - uuid: 8c1ca3d79ef445668e8a5ba04a278e6f
              name: 'Information Store [{#INSTANCE}]: Log records stalled'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchange Database({#INF.STORE})\Log Record Stalls/sec", {$MS.EXCHANGE.PERF.INTERVAL}]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              description: 'Indicates the number of log records that can''t be added to the log buffers per second because the log buffers are full. The average value should be below 10 per second. Spikes (maximum values) shouldn''t be higher than 100 per second.'
              tags:
                - tag: component
                  value: application
              trigger_prototypes:
                - uuid: 1e1f575f25d74f7480f9812b54ad8f39
                  expression: 'avg(/Microsoft Exchange Server 2016 by Zabbix agent active/perf_counter_en["\MSExchange Database({#INF.STORE})\Log Record Stalls/sec", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.LOG.STALLS.TIME})>{$MS.EXCHANGE.LOG.STALLS.WARN}'
                  name: 'MS Exchange 2016: Information Store [{#INSTANCE}]: Log records stalls is too high'
                  event_name: 'MS Exchange 2016: Information Store [{#INSTANCE}]: Log records stalls is too high (>{$MS.EXCHANGE.LOG.STALLS.WARN} for {$MS.EXCHANGE.LOG.STALLS.TIME})'
                  priority: AVERAGE
                  description: 'Stalled log records too high. The average value should be less than 10 threads waiting.'
                  tags:
                    - tag: scope
                      value: notice
            - uuid: 9173dba68e55434aaa324b3e38ba22bb
              name: 'Information Store [{#INSTANCE}]: Log threads waiting'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchange Database({#INF.STORE})\Log Threads Waiting", {$MS.EXCHANGE.PERF.INTERVAL}]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              description: 'Indicates the number of threads waiting to complete an update of the database by writing their data to the log.'
              tags:
                - tag: component
                  value: application
            - uuid: 9ad96174c29142f6904322d08d76fe8e
              name: 'Database Counters [{#INSTANCE}]: Active database read operations per second'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Attached)/sec", {$MS.EXCHANGE.PERF.INTERVAL}]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              description: 'Shows the number of database read operations.'
              tags:
                - tag: component
                  value: application
            - uuid: 0df865f52f304f97aa01a706e455e153
              name: 'Database Counters [{#INSTANCE}]: Active database read operations latency'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Attached) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              units: s
              description: 'Shows the average length of time per database read operation. Should be less than 20 ms on average.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.001'
              tags:
                - tag: component
                  value: application
              trigger_prototypes:
                - uuid: 85be5ba2d3e847a485c968ac47afc495
                  expression: 'min(/Microsoft Exchange Server 2016 by Zabbix agent active/perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Attached) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.DB.ACTIVE.READ.TIME})>{$MS.EXCHANGE.DB.ACTIVE.READ.WARN}'
                  name: 'MS Exchange 2016: Database Counters [{#INSTANCE}]: Average read time latency is too high'
                  event_name: 'MS Exchange 2016: Database Counters [{#INSTANCE}]: Average read time latency is too high (>{$MS.EXCHANGE.DB.ACTIVE.READ.WARN}s for {$MS.EXCHANGE.DB.ACTIVE.READ.TIME})'
                  priority: WARNING
                  description: 'Should be less than 20ms on average.'
                  tags:
                    - tag: scope
                      value: performance
            - uuid: 8381c3c3971f4b3380cfe5d663e31416
              name: 'Database Counters [{#INSTANCE}]: Passive database read operations latency'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Recovery) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              units: s
              description: 'Shows the average length of time per passive database read operation. Should be less than 200ms on average.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.001'
              tags:
                - tag: component
                  value: application
              trigger_prototypes:
                - uuid: 6a4fe761e26c4b6497106da05dac40fe
                  expression: 'min(/Microsoft Exchange Server 2016 by Zabbix agent active/perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Recovery) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.DB.PASSIVE.READ.TIME})>{$MS.EXCHANGE.DB.PASSIVE.READ.WARN}'
                  name: 'MS Exchange 2016: Database Counters [{#INSTANCE}]: Average read time latency is too high'
                  event_name: 'MS Exchange 2016: Database Counters [{#INSTANCE}]: Average read time latency is too high (>{$MS.EXCHANGE.DB.PASSIVE.READ.WARN}s for {$MS.EXCHANGE.DB.PASSIVE.READ.TIME})'
                  priority: WARNING
                  description: 'Should be less than 200ms on average.'
                  tags:
                    - tag: scope
                      value: performance
            - uuid: defb4f7dfb6f4a97a4928bab82897845
              name: 'Database Counters [{#INSTANCE}]: Active database write operations per second'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Writes (Attached)/sec", {$MS.EXCHANGE.PERF.INTERVAL}]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              description: 'Shows the number of database write operations per second for each attached database instance.'
              tags:
                - tag: component
                  value: application
            - uuid: 9c83e27f56f94bea9e635158037a0c8b
              name: 'Database Counters [{#INSTANCE}]: Active database write operations latency'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Writes (Attached) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              units: s
              description: 'Shows the average length of time per database write operation. Should be less than 50ms on average.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.001'
              tags:
                - tag: component
                  value: application
              trigger_prototypes:
                - uuid: 6feb589776294bf0ab31a55af188f1f6
                  expression: 'min(/Microsoft Exchange Server 2016 by Zabbix agent active/perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Writes (Attached) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.DB.ACTIVE.WRITE.TIME})>{$MS.EXCHANGE.DB.ACTIVE.WRITE.WARN}'
                  name: 'MS Exchange 2016: Database Counters [{#INSTANCE}]: Average write time latency is too high for {$MS.EXCHANGE.DB.ACTIVE.WRITE.TIME}'
                  priority: WARNING
                  description: 'Should be less than 50ms on average.'
                  tags:
                    - tag: scope
                      value: performance
            - uuid: a53596604a4c4a49bd04bfda30064d78
              name: 'Database Counters [{#INSTANCE}]: Passive database write operations latency'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Writes (Recovery) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              units: s
              description: 'Shows the average length of time, in ms, per passive database write operation. Should be less than the read latency for the same instance, as measured by the MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Recovery) Average Latency counter.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.001'
              tags:
                - tag: component
                  value: application
            - uuid: 9ef13ef1197a4ba1abba1591ae588fa8
              name: 'Information Store [{#INSTANCE}]: Active mailboxes count'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchangeIS Store({#INSTANCE})\Active mailboxes"]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              description: 'Number of active mailboxes in this database.'
              tags:
                - tag: component
                  value: application
            - uuid: 0e3dbea7e5694cc48c5216d92db67f7f
              name: 'Information Store [{#INSTANCE}]: Database state'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchangeIS Store({#INSTANCE})\Database State"]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              description: |
                Database state. Possible values:
                0: Database without any copy and dismounted.
                1: Database is a primary database and mounted.
                2: Database is a passive copy and the state is healthy.
              valuemap:
                name: 'Exchange database state'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              tags:
                - tag: component
                  value: application
            - uuid: 4a08076fdfcb4226a122474f5c2e98d9
              name: 'Information Store [{#INSTANCE}]: RPC requests latency'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchangeIS Store({#INSTANCE})\RPC Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              units: s
              description: 'RPC Latency average is the average latency of RPC requests per database. Average is calculated over all RPCs since exrpc32 was loaded. Should be less than 50ms at all times, with spikes less than 100ms.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.001'
              tags:
                - tag: component
                  value: application
              trigger_prototypes:
                - uuid: 42009d7b910743e1803f10b6a918a67b
                  expression: 'min(/Microsoft Exchange Server 2016 by Zabbix agent active/perf_counter_en["\MSExchangeIS Store({#INSTANCE})\RPC Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.RPC.TIME})>{$MS.EXCHANGE.RPC.WARN}'
                  name: 'MS Exchange 2016: Information Store [{#INSTANCE}]: RPC Requests latency is too high'
                  event_name: 'MS Exchange 2016: Information Store [{#INSTANCE}]: RPC Requests latency is too high (>{$MS.EXCHANGE.RPC.WARN}s for {$MS.EXCHANGE.RPC.TIME})'
                  priority: WARNING
                  description: 'Should be less than 50ms at all times, with spikes less than 100ms.'
                  tags:
                    - tag: scope
                      value: performance
            - uuid: c423048154634eb29f4fe56c306f5b04
              name: 'Information Store [{#INSTANCE}]: RPC requests per second'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchangeIS Store({#INSTANCE})\RPC Operations/sec", {$MS.EXCHANGE.PERF.INTERVAL}]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              description: 'Shows the number of RPC operations per second for each database instance.'
              tags:
                - tag: component
                  value: application
            - uuid: 0f4970d43155441ab0f860e4e06328e0
              name: 'Information Store [{#INSTANCE}]: RPC requests total'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchangeIS Store({#INSTANCE})\RPC requests", {$MS.EXCHANGE.PERF.INTERVAL}]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              description: 'Indicates the overall RPC requests currently executing within the information store process. Should be below 70 at all times.'
              tags:
                - tag: component
                  value: application
              trigger_prototypes:
                - uuid: 127241a9e517424687e56eea393b11db
                  expression: 'min(/Microsoft Exchange Server 2016 by Zabbix agent active/perf_counter_en["\MSExchangeIS Store({#INSTANCE})\RPC requests", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.RPC.COUNT.TIME})>{$MS.EXCHANGE.RPC.COUNT.WARN}'
                  name: 'MS Exchange 2016: Information Store [{#INSTANCE}]: RPC Requests total count is too high'
                  event_name: 'MS Exchange 2016: Information Store [{#INSTANCE}]: RPC Requests total count is too high (>{$MS.EXCHANGE.RPC.COUNT.WARN} for {$MS.EXCHANGE.RPC.COUNT.TIME})'
                  priority: WARNING
                  description: 'Should be below 70 at all times.'
                  tags:
                    - tag: scope
                      value: performance
          trigger_prototypes:
            - uuid: 9c9732c8d3314c12aecd268aa445e8bc
              expression: 'avg(/Microsoft Exchange Server 2016 by Zabbix agent active/perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Writes (Recovery) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.DB.PASSIVE.WRITE.TIME})>avg(/Microsoft Exchange Server 2016 by Zabbix agent active/perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Recovery) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.DB.PASSIVE.WRITE.TIME})'
              name: 'MS Exchange 2016: Database Counters [{#INSTANCE}]: Average write time latency is higher than read time latency for {$MS.EXCHANGE.DB.PASSIVE.WRITE.TIME}'
              priority: WARNING
              description: 'Should be less than the read latency for the same instance, as measured by the MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Recovery) Average Latency counter.'
              tags:
                - tag: scope
                  value: performance
          graph_prototypes:
            - uuid: 3749d38f7b7f478486c1181aeabd19c1
              name: 'Database Counters [{#INSTANCE}]: Read and write stats'
              graph_items:
                - color: 199C0D
                  yaxisside: RIGHT
                  item:
                    host: 'Microsoft Exchange Server 2016 by Zabbix agent active'
                    key: 'perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Attached)/sec", {$MS.EXCHANGE.PERF.INTERVAL}]'
                - sortorder: '1'
                  color: F63100
                  yaxisside: RIGHT
                  item:
                    host: 'Microsoft Exchange Server 2016 by Zabbix agent active'
                    key: 'perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Writes (Attached)/sec", {$MS.EXCHANGE.PERF.INTERVAL}]'
                - sortorder: '2'
                  color: 00611C
                  item:
                    host: 'Microsoft Exchange Server 2016 by Zabbix agent active'
                    key: 'perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Attached) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}]'
                - sortorder: '3'
                  color: F7941D
                  item:
                    host: 'Microsoft Exchange Server 2016 by Zabbix agent active'
                    key: 'perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Reads (Recovery) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}]'
                - sortorder: '4'
                  color: FC6EA3
                  item:
                    host: 'Microsoft Exchange Server 2016 by Zabbix agent active'
                    key: 'perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Writes (Attached) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}]'
                - sortorder: '5'
                  color: 6C59DC
                  item:
                    host: 'Microsoft Exchange Server 2016 by Zabbix agent active'
                    key: 'perf_counter_en["\MSExchange Database ==> Instances({#INF.STORE}/_Total)\I/O Database Writes (Recovery) Average Latency", {$MS.EXCHANGE.PERF.INTERVAL}]'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  
                  data.forEach(function(instance) {
                  	if (instance["{#INSTANCE}"] === '_total') {
                  		instance["{#INF.STORE}"] = 'Information Store';
                  	}
                  	else {
                  		instance["{#INF.STORE}"] = 'Information Store - ' + instance["{#INSTANCE}"];
                  	}
                  })
                  
                  return JSON.stringify(data);
        - uuid: c18f965b9ba6419ea578238ebc8168bb
          name: 'LDAP discovery'
          type: ZABBIX_ACTIVE
          key: 'perf_instance_en.discovery["MSExchange ADAccess Domain Controllers"]'
          delay: 1h
          description: 'Discovery of domain controller.'
          item_prototypes:
            - uuid: 577f868ff1e54113b61e8f74a084f611
              name: 'Domain Controller [{#INSTANCE}]: Read time'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchange ADAccess Domain Controllers({#INSTANCE})\LDAP Read Time", {$MS.EXCHANGE.PERF.INTERVAL}]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              units: s
              description: 'Time that it takes to send an LDAP read request to the domain controller in question and get a response. Should ideally be below 50 ms; spikes below 100 ms are acceptable.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.001'
              tags:
                - tag: component
                  value: application
              trigger_prototypes:
                - uuid: 3d49bb3d2bdd45998938e531dbaafd33
                  expression: 'min(/Microsoft Exchange Server 2016 by Zabbix agent active/perf_counter_en["\MSExchange ADAccess Domain Controllers({#INSTANCE})\LDAP Read Time", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.LDAP.TIME})>{$MS.EXCHANGE.LDAP.WARN}'
                  name: 'MS Exchange 2016: Domain Controller [{#INSTANCE}]: LDAP read time is too high'
                  event_name: 'MS Exchange 2016: Domain Controller [{#INSTANCE}]: LDAP read time is too high (>{$MS.EXCHANGE.LDAP.WARN}s for {$MS.EXCHANGE.LDAP.TIME})'
                  priority: AVERAGE
                  description: 'Should be less than 50ms at all times, with spikes less than 100ms.'
                  tags:
                    - tag: scope
                      value: performance
            - uuid: 1c94a8c06c5a4d4894060b68fc44a093
              name: 'Domain Controller [{#INSTANCE}]: Search time'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\MSExchange ADAccess Domain Controllers({#INSTANCE})\LDAP Search Time", {$MS.EXCHANGE.PERF.INTERVAL}]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              units: s
              description: 'Time that it takes to send an LDAP search request and get a response. Should ideally be below 50 ms; spikes below 100 ms are acceptable.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.001'
              tags:
                - tag: component
                  value: application
              trigger_prototypes:
                - uuid: 8415fc742e154f9a9455ac9c0cdc85fd
                  expression: 'min(/Microsoft Exchange Server 2016 by Zabbix agent active/perf_counter_en["\MSExchange ADAccess Domain Controllers({#INSTANCE})\LDAP Search Time", {$MS.EXCHANGE.PERF.INTERVAL}],{$MS.EXCHANGE.LDAP.TIME})>{$MS.EXCHANGE.LDAP.WARN}'
                  name: 'MS Exchange 2016: Domain Controller [{#INSTANCE}]: LDAP search time is too high'
                  event_name: 'MS Exchange 2016: Domain Controller [{#INSTANCE}]: LDAP search time is too high (>{$MS.EXCHANGE.LDAP.WARN}s for {$MS.EXCHANGE.LDAP.TIME})'
                  priority: AVERAGE
                  description: 'Should be less than 50ms at all times, with spikes less than 100ms.'
                  tags:
                    - tag: scope
                      value: performance
          graph_prototypes:
            - uuid: 004b61b0e602483780f7c944219cf110
              name: 'Domain Controller [{#INSTANCE}]: Timings'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'Microsoft Exchange Server 2016 by Zabbix agent active'
                    key: 'perf_counter_en["\MSExchange ADAccess Domain Controllers({#INSTANCE})\LDAP Read Time", {$MS.EXCHANGE.PERF.INTERVAL}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'Microsoft Exchange Server 2016 by Zabbix agent active'
                    key: 'perf_counter_en["\MSExchange ADAccess Domain Controllers({#INSTANCE})\LDAP Search Time", {$MS.EXCHANGE.PERF.INTERVAL}]'
        - uuid: 8749f11f547546ac8bf81478c798186f
          name: 'Web services discovery'
          type: ZABBIX_ACTIVE
          key: 'perf_instance_en.discovery["Web Service"]'
          delay: 1h
          description: 'Discovery of Exchange web services.'
          item_prototypes:
            - uuid: 91f7649f17bf4d7a9ded8bec70ff09e2
              name: 'Web Service [{#INSTANCE}]: Current connections'
              type: ZABBIX_ACTIVE
              key: 'perf_counter_en["\Web Service({#INSTANCE})\Current Connections", {$MS.EXCHANGE.PERF.INTERVAL}]'
              delay: '{$MS.EXCHANGE.PERF.INTERVAL}'
              value_type: FLOAT
              description: 'Shows the current number of connections established to the each Web Service.'
              tags:
                - tag: component
                  value: application
      tags:
        - tag: class
          value: software
        - tag: subclass
          value: communication
        - tag: subclass
          value: messaging
        - tag: target
          value: ms-exchange
      macros:
        - macro: '{$AGENT.TIMEOUT}'
          value: 5m
          description: 'Timeout after which agent is considered unavailable.'
          config:
            type: TEXT
            priority: '19'
            section_name: Other
            label: 'Seconds since the last Zabbix agent seen'
            description: 'Timeout after which agent is considered unavailable.'
        - macro: '{$MS.EXCHANGE.DB.ACTIVE.READ.TIME}'
          value: 5m
          description: 'The time during which the active database read operations latency may exceed the threshold.'
          config:
            type: TEXT
            priority: '6'
            section_name: Thresholds
            label: 'Time allowed above threshold for active DB read latency'
            description: 'The time during which the active database read operations latency may exceed the threshold.'
        - macro: '{$MS.EXCHANGE.DB.ACTIVE.READ.WARN}'
          value: '0.02'
          description: 'Threshold for active database read operations latency trigger.'
          config:
            type: TEXT
            priority: '7'
            section_name: Thresholds
            label: 'Threshold for active DB read latency trigger'
            description: 'Threshold for active database read operations latency trigger.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$MS.EXCHANGE.DB.ACTIVE.WRITE.TIME}'
          value: 10m
          description: 'The time during which the active database write operations latency may exceed the threshold.'
          config:
            type: TEXT
            priority: '8'
            section_name: Thresholds
            label: 'Time allowed above threshold for active DB write latency'
            description: 'The time during which the active database write operations latency may exceed the threshold.'
        - macro: '{$MS.EXCHANGE.DB.ACTIVE.WRITE.WARN}'
          value: '0.05'
          description: 'Threshold for active database write operations latency trigger.'
          config:
            type: TEXT
            priority: '9'
            section_name: Thresholds
            label: 'Threshold for active DB write latency trigger'
            description: 'Threshold for active database write operations latency trigger.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$MS.EXCHANGE.DB.FAULTS.TIME}'
          value: 5m
          description: 'The time during which the database page faults may exceed the threshold.'
          config:
            type: TEXT
            priority: '2'
            section_name: Thresholds
            label: 'Time allowed above threshold for database page faults'
            description: 'The time during which the database page faults may exceed the threshold.'
        - macro: '{$MS.EXCHANGE.DB.FAULTS.WARN}'
          value: '0'
          description: 'Threshold for database page faults trigger.'
          config:
            type: TEXT
            priority: '3'
            section_name: Thresholds
            label: 'Threshold for database page faults trigger'
            description: 'Threshold for database page faults trigger.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$MS.EXCHANGE.DB.PASSIVE.READ.TIME}'
          value: 5m
          description: 'The time during which the passive database read operations latency may exceed the threshold.'
          config:
            type: TEXT
            priority: '10'
            section_name: Thresholds
            label: 'Time allowed above threshold for passive DB read latency'
            description: 'The time during which the passive database read operations latency may exceed the threshold.'
        - macro: '{$MS.EXCHANGE.DB.PASSIVE.READ.WARN}'
          value: '0.2'
          description: 'Threshold for passive database read operations latency trigger.'
          config:
            type: TEXT
            priority: '11'
            section_name: Thresholds
            label: 'Threshold for passive DB read latency trigger'
            description: 'Threshold for passive database read operations latency trigger.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$MS.EXCHANGE.DB.PASSIVE.WRITE.TIME}'
          value: 10m
          description: 'The time during which the passive database write operations latency may exceed the threshold.'
          config:
            type: TEXT
            priority: '12'
            section_name: Thresholds
            label: 'Time allowed above threshold for passive DB write latency'
            description: 'The time during which the passive database write operations latency may exceed the threshold.'
        - macro: '{$MS.EXCHANGE.LDAP.TIME}'
          value: 5m
          description: 'The time during which the LDAP metrics may exceed the threshold.'
          config:
            type: TEXT
            priority: '17'
            section_name: Thresholds
            label: 'Time allowed above threshold for LDAP metrics'
            description: 'The time during which the LDAP metrics may exceed the threshold.'
        - macro: '{$MS.EXCHANGE.LDAP.WARN}'
          value: '0.05'
          description: 'Threshold for LDAP triggers.'
          config:
            type: TEXT
            priority: '18'
            section_name: Thresholds
            label: 'Threshold for LDAP triggers'
            description: 'Threshold for LDAP triggers.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$MS.EXCHANGE.LOG.STALLS.TIME}'
          value: 10m
          description: 'The time during which the log records stalled may exceed the threshold.'
          config:
            type: TEXT
            priority: '4'
            section_name: Thresholds
            label: 'Time allowed above threshold for stalled log records'
            description: 'The time during which the log records stalled may exceed the threshold.'
        - macro: '{$MS.EXCHANGE.LOG.STALLS.WARN}'
          value: '100'
          description: 'Threshold for log records stalled trigger.'
          config:
            type: TEXT
            priority: '5'
            section_name: Thresholds
            label: 'Threshold for stalled log records trigger'
            description: 'Threshold for log records stalled trigger.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$MS.EXCHANGE.PERF.INTERVAL}'
          value: '60'
          description: 'Update interval for perf_counter_en items.'
          config:
            type: TEXT
            priority: '1'
            section_name: Other
            label: 'Update interval for perf_counter_en items'
            description: 'Update interval for perf_counter_en items.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$MS.EXCHANGE.RPC.COUNT.TIME}'
          value: 5m
          description: 'The time during which the RPC total requests may exceed the threshold.'
          config:
            type: TEXT
            priority: '15'
            section_name: Thresholds
            label: 'Time allowed above threshold for total RPC requests'
            description: 'The time during which the RPC total requests may exceed the threshold.'
        - macro: '{$MS.EXCHANGE.RPC.COUNT.WARN}'
          value: '70'
          description: 'Threshold for LDAP triggers.'
          config:
            type: TEXT
            priority: '16'
            section_name: Thresholds
            label: 'Threshold for LDAP triggers'
            description: 'Threshold for LDAP triggers.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$MS.EXCHANGE.RPC.TIME}'
          value: 10m
          description: 'The time during which the RPC requests latency may exceed the threshold.'
          config:
            type: TEXT
            priority: '13'
            section_name: Thresholds
            label: 'Time allowed above threshold for RPC requests latency'
            description: 'The time during which the RPC requests latency may exceed the threshold.'
        - macro: '{$MS.EXCHANGE.RPC.WARN}'
          value: '0.05'
          description: 'Threshold for RPC requests latency trigger.'
          config:
            type: TEXT
            priority: '14'
            section_name: Thresholds
            label: 'Threshold for RPC requests latency trigger'
            description: 'Threshold for RPC requests latency trigger.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
      valuemaps:
        - uuid: 0797c152a163407aa9490a63f80a8fd1
          name: 'Exchange database copy role'
          mappings:
            - value: '0'
              newvalue: Passive
            - value: '1'
              newvalue: Active
        - uuid: a4fac47b56e4470c9c6d435d7eb06845
          name: 'Exchange database state'
          mappings:
            - value: '0'
              newvalue: Dismounted
            - value: '1'
              newvalue: Mounted
            - value: '2'
              newvalue: Healthy
        - uuid: 0407f8e83ce94d9b88db8dab241e44c0
          name: zabbix.host.active_agent.available
          mappings:
            - value: '0'
              newvalue: unknown
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: 'not available'
  graphs:
    - uuid: d1e720c28aba4d48a522d509bdd7d324
      name: 'MS Exchange [Client Access Server]: Request rate'
      graph_items:
        - color: 199C0D
          item:
            host: 'Microsoft Exchange Server 2016 by Zabbix agent active'
            key: 'perf_counter_en["\MSExchange ActiveSync\Requests/sec", {$MS.EXCHANGE.PERF.INTERVAL}]'
        - sortorder: '1'
          color: F63100
          item:
            host: 'Microsoft Exchange Server 2016 by Zabbix agent active'
            key: 'perf_counter_en["\MSExchange Availability Service\Availability Requests (sec)", {$MS.EXCHANGE.PERF.INTERVAL}]'
        - sortorder: '2'
          color: 00611C
          item:
            host: 'Microsoft Exchange Server 2016 by Zabbix agent active'
            key: 'perf_counter_en["\MSExchange OWA\Requests/sec", {$MS.EXCHANGE.PERF.INTERVAL}]'
        - sortorder: '3'
          color: F7941D
          item:
            host: 'Microsoft Exchange Server 2016 by Zabbix agent active'
            key: 'perf_counter_en["\MSExchangeWS\Requests/sec", {$MS.EXCHANGE.PERF.INTERVAL}]'
