zabbix_export:
  version: '8.0'
  template_groups:
    - uuid: a571c0d144b14fd4a87a9d9b2aa9fcd6
      name: Templates/Applications
  templates:
    - uuid: 8cad0f2564694416b60bd8a414948641
      template: 'NGINX Plus by HTTP'
      name: 'NGINX Plus by HTTP'
      description: |
        Get Nginx Plus metrics by HTTP agent.
        Metrics are collected by requests to Nginx Plus API.
        Don't forget to change macros {$NGINX.API.ENDPOINT}.
        
        You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback
        
        Generated by official Zabbix template tool "Templator"
      wizard_ready: 'YES'
      readme: |
        ## Overview
        
        This template is designed for the effortless deployment of Nginx Plus monitoring by Zabbix via HTTP and doesn't require any external scripts.
        
        > The monitoring data of the live activity is generated by the [NGINX Plus API](http://nginx.org/en/docs/http/ngx_http_api_module.html).
        
        ## Setup
        
        1. Enable the NGINX Plus API.
        > Refer to the [vendor documentation](https://www.nginx.com/products/nginx/live-activity-monitoring/).
        2. Set the {$NGINX.API.ENDPOINT} such as `<scheme>://<host>:<port>/<location>/`.
        
        **Note** that depending on the number of zones and upstreams discovery operation may be expensive. 
        Therefore, use the following filters with these host wizard configuration fields:
        
        - `HTTP server zones filter (include)`
        - `HTTP server zones filter (exclude)`
        - `HTTP location zones filter (include)`
        - `HTTP location zones filter (exclude)`
        - `HTTP upstreams filter (include)`
        - `HTTP upstreams filter (exclude)`
        - `Stream server zones filter (include)`
        - `Stream server zones filter (exclude)`
        - `Stream upstreams filter (include)`
        - `Stream upstreams filter (exclude)`
        - `Resolvers filter (include)`
        - `Resolvers filter (exclude)`
      vendor:
        name: Zabbix
        version: 8.0-1
      groups:
        - name: Templates/Applications
      items:
        - uuid: 26c121f9c50a4e90b4502e2bd7f42992
          name: 'Get connections'
          type: HTTP_AGENT
          key: nginx.connections
          history: '0'
          value_type: TEXT
          description: 'Returns the statistics of client connections.'
          url: '{$NGINX.API.ENDPOINT}/6/connections/'
          status_codes: '200,404'
          tags:
            - tag: component
              value: connections
            - tag: component
              value: raw
        - uuid: 1734b26ca856405e8c08f222944cadc3
          name: 'Connections accepted, rate'
          type: DEPENDENT
          key: nginx.connections.accepted.rate
          description: 'The total number of accepted client connections per second.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.accepted
            - type: CHANGE_PER_SECOND
          master_item:
            key: nginx.connections
          tags:
            - tag: component
              value: connections
        - uuid: a0fd403c29e4452a9be0aecb650ab063
          name: 'Connections active'
          type: DEPENDENT
          key: nginx.connections.active
          description: 'The current number of active client connections.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.active
          master_item:
            key: nginx.connections
          tags:
            - tag: component
              value: connections
        - uuid: 06395827019542b7bd381d42beb76b10
          name: 'Connections dropped'
          type: DEPENDENT
          key: nginx.connections.dropped
          description: 'The total number of dropped client connections.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.dropped
          master_item:
            key: nginx.connections
          tags:
            - tag: component
              value: connections
          triggers:
            - uuid: 91c9dab8147a4d0086019119e4e55b5e
              expression: 'min(/NGINX Plus by HTTP/nginx.connections.dropped,5m) > {$NGINX.DROP_RATE.MAX.WARN}'
              name: 'NGINX Plus: High connections drop rate'
              event_name: 'NGINX Plus: High connections drop rate (more than {$NGINX.DROP_RATE.MAX.WARN} for 5m)'
              priority: WARNING
              description: 'The rate of dropped connections is greater than `{$NGINX.DROP_RATE.MAX.WARN}` for the last 5 minutes.'
              tags:
                - tag: scope
                  value: performance
        - uuid: 0c0e5a2ba5f643e09d07e34d724aff9a
          name: 'Connections idle'
          type: DEPENDENT
          key: nginx.connections.idle
          description: 'The current number of idle client connections.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.idle
          master_item:
            key: nginx.connections
          tags:
            - tag: component
              value: connections
        - uuid: 51c50d69acdb451395736902733673fe
          name: 'Get HTTP location zones'
          type: HTTP_AGENT
          key: nginx.http.location_zones
          history: '0'
          value_type: TEXT
          description: 'Returns the status information for each HTTP location zone.'
          url: '{$NGINX.API.ENDPOINT}/6/http/location_zones/'
          status_codes: '200,404'
          tags:
            - tag: component
              value: location_zones
            - tag: component
              value: raw
        - uuid: 5b337c675bc14d9ab3ac6d2cf5b82dce
          name: 'Get HTTP zones'
          type: HTTP_AGENT
          key: nginx.http.server_zones
          history: '0'
          value_type: TEXT
          description: 'Returns the status information for each HTTP server zone.'
          url: '{$NGINX.API.ENDPOINT}/6/http/server_zones/'
          status_codes: '200,404'
          tags:
            - tag: component
              value: raw
            - tag: component
              value: server_zones
        - uuid: 4ec5e9b1d17141f49db5d9bf29134a49
          name: 'Get HTTP upstreams'
          type: HTTP_AGENT
          key: nginx.http.upstreams
          history: '0'
          value_type: TEXT
          description: 'Returns the status of each HTTP upstream server group and its servers.'
          url: '{$NGINX.API.ENDPOINT}/6/http/upstreams/'
          status_codes: '200,404'
          tags:
            - tag: component
              value: raw
            - tag: component
              value: upstreams
        - uuid: d6c37400f8e64d89a698896afa6589de
          name: 'Get info'
          type: HTTP_AGENT
          key: nginx.info
          history: '0'
          value_type: TEXT
          description: 'Return status of the NGINX running instance.'
          url: '{$NGINX.API.ENDPOINT}/6/nginx/'
          status_codes: '200,404'
          tags:
            - tag: component
              value: info
            - tag: component
              value: raw
        - uuid: 178f9f0c2ae74a6bbf1ae6965021ccde
          name: Address
          type: DEPENDENT
          key: nginx.info.address
          value_type: CHAR
          description: 'The address of the server that accepted status request.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.address
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          master_item:
            key: nginx.info
          tags:
            - tag: component
              value: info
        - uuid: 14c417b374ef4674bb374979135f8617
          name: 'Get info error'
          type: DEPENDENT
          key: nginx.info.error
          value_type: CHAR
          description: 'The description of NGINX errors.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.error.text
              error_handler: CUSTOM_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: nginx.info
          tags:
            - tag: component
              value: health
            - tag: component
              value: info
          triggers:
            - uuid: e444c708371748bd831bba6c8d9a92e0
              expression: 'length(last(/NGINX Plus by HTTP/nginx.info.error))>0'
              name: 'NGINX Plus: Server response error'
              event_name: 'NGINX Plus: Server response error (text: {ITEM.VALUE})'
              priority: HIGH
              tags:
                - tag: scope
                  value: availability
        - uuid: 9baff3e318d84cd78c6a8ec6ae294de5
          name: Generation
          type: DEPENDENT
          key: nginx.info.generation
          description: 'The total number of configuration reloads.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.generation
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 30m
          master_item:
            key: nginx.info
          tags:
            - tag: component
              value: info
        - uuid: 1baceaa7af4d45e487a448670e213c94
          name: Uptime
          type: DEPENDENT
          key: nginx.info.uptime
          units: uptime
          description: 'The server uptime.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.load_timestamp
              error_handler: DISCARD_VALUE
            - type: JAVASCRIPT
              parameters:
                - 'return Math.floor((Date.now() - new Date(value)) / 1000);'
          master_item:
            key: nginx.info
          tags:
            - tag: component
              value: info
          triggers:
            - uuid: 396fb4be618e45578566971d5399d611
              expression: 'nodata(/NGINX Plus by HTTP/nginx.info.uptime,30m)=1'
              name: 'NGINX Plus: Failed to fetch info data'
              event_name: 'NGINX Plus: Failed to fetch info data (or no data for 30m)'
              priority: WARNING
              description: 'Zabbix has not received any data for metrics for the last 30 minutes'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: availability
            - uuid: 95622a29bd58444b9f0bd985db99f922
              expression: 'last(/NGINX Plus by HTTP/nginx.info.uptime)<10m'
              name: 'NGINX Plus: Host has been restarted'
              event_name: 'NGINX Plus: {HOST.NAME} has been restarted (uptime < 10m)'
              priority: INFO
              description: 'Uptime is less than 10 minutes.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: 89059effd28641e08e2002c807784bcb
          name: Version
          type: DEPENDENT
          key: nginx.info.version
          value_type: CHAR
          description: 'A version number of NGINX.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.version
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          master_item:
            key: nginx.info
          tags:
            - tag: component
              value: info
          triggers:
            - uuid: a91ff018fe4f4a1495b08adeb2b0005f
              expression: 'last(/NGINX Plus by HTTP/nginx.info.version,#1)<>last(/NGINX Plus by HTTP/nginx.info.version,#2) and length(last(/NGINX Plus by HTTP/nginx.info.version))>0'
              name: 'NGINX Plus: Version has changed'
              event_name: 'NGINX Plus: Version has changed (new version: {ITEM.VALUE})'
              priority: INFO
              description: 'The Nginx version has changed. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: 65377fc7308340348199c4c63720a7e1
          name: 'Get requests'
          type: HTTP_AGENT
          key: nginx.requests
          history: '0'
          value_type: TEXT
          description: 'Returns the status of the client''s HTTP requests.'
          url: '{$NGINX.API.ENDPOINT}/6/http/requests/'
          status_codes: '200,404'
          tags:
            - tag: component
              value: raw
            - tag: component
              value: requests
        - uuid: 630c4f81f9f44397a156e2d4e5d21af8
          name: 'Requests current'
          type: DEPENDENT
          key: nginx.requests.current
          description: 'The current number of client requests.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.current
          master_item:
            key: nginx.requests
          tags:
            - tag: component
              value: requests
        - uuid: 8130bfb659a94641b97a1abcdb9a4f66
          name: 'Requests total, rate'
          type: DEPENDENT
          key: nginx.requests.total.rate
          description: 'The total number of client requests per second.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.total
            - type: CHANGE_PER_SECOND
          master_item:
            key: nginx.requests
          tags:
            - tag: component
              value: requests
        - uuid: 9ea35f4f2ca24187896b7f44fb410d24
          name: 'Get resolvers'
          type: HTTP_AGENT
          key: nginx.resolvers
          history: '0'
          value_type: TEXT
          description: 'Returns the status information for each Resolver zone.'
          url: '{$NGINX.API.ENDPOINT}/6/resolvers/'
          status_codes: '200,404'
          tags:
            - tag: component
              value: raw
            - tag: component
              value: resolvers
        - uuid: e0798bb2d16c418781e19880fd78832c
          name: 'Get SSL'
          type: HTTP_AGENT
          key: nginx.ssl
          history: '0'
          value_type: TEXT
          description: 'Returns the SSL statistics.'
          url: '{$NGINX.API.ENDPOINT}/6/ssl/'
          status_codes: '200,404'
          tags:
            - tag: component
              value: raw
            - tag: component
              value: ssl
        - uuid: 09c7ab8555d046a69a96889185650dfe
          name: 'SSL handshakes, rate'
          type: DEPENDENT
          key: nginx.ssl.handshakes.rate
          description: 'The total number of successful SSL handshakes per second.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.handshakes
            - type: CHANGE_PER_SECOND
          master_item:
            key: nginx.ssl
          tags:
            - tag: component
              value: ssl
        - uuid: 77fcc55ced2045e099b37580f7ef6d5b
          name: 'SSL handshakes failed, rate'
          type: DEPENDENT
          key: nginx.ssl.handshakes_failed.rate
          description: 'The total number of failed SSL handshakes per second.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.handshakes_failed
            - type: CHANGE_PER_SECOND
          master_item:
            key: nginx.ssl
          tags:
            - tag: component
              value: ssl
        - uuid: 98ec8bec834a42caba8d260d939beb0e
          name: 'SSL session reuses, rate'
          type: DEPENDENT
          key: nginx.ssl.session_reuses.rate
          description: 'The total number of session reuses during SSL handshake per second.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.session_reuses
            - type: CHANGE_PER_SECOND
          master_item:
            key: nginx.ssl
          tags:
            - tag: component
              value: ssl
        - uuid: 148a8612964b445ba37e340c9341f49d
          name: 'Get Stream server zones'
          type: HTTP_AGENT
          key: nginx.stream.server_zones
          history: '0'
          value_type: TEXT
          description: 'Returns the status information for each server zone configured in the "stream" directive.'
          url: '{$NGINX.API.ENDPOINT}/6/stream/server_zones/'
          status_codes: '200,404'
          tags:
            - tag: component
              value: raw
            - tag: component
              value: server_zones
        - uuid: c48ca144a8414b2db1c35d518ca5a24f
          name: 'Get Stream upstreams'
          type: HTTP_AGENT
          key: nginx.stream.upstreams
          history: '0'
          value_type: TEXT
          description: 'Returns status of each stream upstream server group and its servers.'
          url: '{$NGINX.API.ENDPOINT}/6/stream/upstreams/'
          status_codes: '200,404'
          tags:
            - tag: component
              value: raw
            - tag: component
              value: upstreams
      discovery_rules:
        - uuid: 33fdb45a55544c628c0106ed193ebc0b
          name: 'HTTP location zones discovery'
          type: DEPENDENT
          key: nginx.http.location_zones.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#NAME}'
                value: '{$NGINX.LLD.FILTER.HTTP.LOCATION.ZONE.MATCHES}'
              - macro: '{#NAME}'
                value: '{$NGINX.LLD.FILTER.HTTP.LOCATION.ZONE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          item_prototypes:
            - uuid: e75bc85680534ec18df16b9e69bc248c
              name: 'HTTP location zone [{#NAME}]: Discarded, rate'
              type: DEPENDENT
              key: 'nginx.http.location_zones.discarded.rate[{#NAME}]'
              description: 'The total number of requests completed without sending a response per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.discarded
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.location_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: location_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 7dc23595142f45e2bd2a40698c21e34d
              name: 'HTTP location zone [{#NAME}]: Raw data'
              type: DEPENDENT
              key: 'nginx.http.location_zones.raw[{#NAME}]'
              history: '0'
              value_type: TEXT
              description: 'The raw data of the location zone with the name `{#NAME}`.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$[''{#NAME}'']'
              master_item:
                key: nginx.http.location_zones
              tags:
                - tag: component
                  value: location_zones
                - tag: component
                  value: raw
                - tag: zone
                  value: '{#NAME}'
            - uuid: 17e01c9171bd493f98b37811dcf49802
              name: 'HTTP location zone [{#NAME}]: Received, rate'
              type: DEPENDENT
              key: 'nginx.http.location_zones.received.rate[{#NAME}]'
              description: 'The total number of bytes received from clients per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.received
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.location_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: location_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: c646c18580ef4b8695cbc03ce0d5122d
              name: 'HTTP location zone [{#NAME}]: Requests, rate'
              type: DEPENDENT
              key: 'nginx.http.location_zones.requests.rate[{#NAME}]'
              description: 'The total number of client requests received from clients per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.requests
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.location_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: location_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 82c9f68d10ec47f1a701eee692e3b9ae
              name: 'HTTP location zone [{#NAME}]: Responses 1xx, rate'
              type: DEPENDENT
              key: 'nginx.http.location_zones.responses.1xx.rate[{#NAME}]'
              description: 'The number of responses with `1xx` status code per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.1xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.location_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: location_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 0cedd14450ba44f0b4c026afabb522a9
              name: 'HTTP location zone [{#NAME}]: Responses 2xx, rate'
              type: DEPENDENT
              key: 'nginx.http.location_zones.responses.2xx.rate[{#NAME}]'
              description: 'The number of responses with `2xx` status code per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.2xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.location_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: location_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 046a2a3b9a644dc1b4a0078b6722c867
              name: 'HTTP location zone [{#NAME}]: Responses 3xx, rate'
              type: DEPENDENT
              key: 'nginx.http.location_zones.responses.3xx.rate[{#NAME}]'
              description: 'The number of responses with `3xx` status code per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.3xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.location_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: location_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 32eb7cb8f04044d6a00ead678ff44a00
              name: 'HTTP location zone [{#NAME}]: Responses 4xx, rate'
              type: DEPENDENT
              key: 'nginx.http.location_zones.responses.4xx.rate[{#NAME}]'
              description: 'The number of responses with `4xx` status code per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.4xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.location_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: location_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: dd5a27eb32da42d7998f89a96e29304f
              name: 'HTTP location zone [{#NAME}]: Responses 5xx, rate'
              type: DEPENDENT
              key: 'nginx.http.location_zones.responses.5xx.rate[{#NAME}]'
              description: 'The number of responses with `5xx` status code per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.5xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.location_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: location_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: b6e3c7f074b54531aa57dce55169aedd
              name: 'HTTP location zone [{#NAME}]: Responses total, rate'
              type: DEPENDENT
              key: 'nginx.http.location_zones.responses.total.rate[{#NAME}]'
              description: 'The total number of responses sent to clients per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.total
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.location_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: location_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 0af45d37b3a24d5491054aa3cf319315
              name: 'HTTP location zone [{#NAME}]: Sent, rate'
              type: DEPENDENT
              key: 'nginx.http.location_zones.sent.rate[{#NAME}]'
              description: 'The total number of bytes sent to clients per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.sent
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.location_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: location_zones
                - tag: zone
                  value: '{#NAME}'
          graph_prototypes:
            - uuid: 85880c097a1c47bfafa35de05304abbc
              name: 'Nginx: HTTP location zone [{#NAME}]: Requests'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.location_zones.requests.rate[{#NAME}]'
            - uuid: 6b05907e4c544986b977a1b496ca92e2
              name: 'Nginx: HTTP location zone [{#NAME}]: Responses'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.location_zones.responses.2xx.rate[{#NAME}]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: F63100
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.location_zones.responses.1xx.rate[{#NAME}]'
                - sortorder: '2'
                  drawtype: GRADIENT_LINE
                  color: 00611C
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.location_zones.responses.3xx.rate[{#NAME}]'
                - sortorder: '3'
                  drawtype: GRADIENT_LINE
                  color: F7941D
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.location_zones.responses.4xx.rate[{#NAME}]'
                - sortorder: '4'
                  drawtype: GRADIENT_LINE
                  color: FC6EA3
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.location_zones.responses.5xx.rate[{#NAME}]'
          master_item:
            key: nginx.http.location_zones
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var output = [];
                  
                  Object.keys(JSON.parse(value)).forEach(function (v) {
                  	output.push({ '{#NAME}': v })
                  });
                  
                  return JSON.stringify(output);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 30m
        - uuid: 85ad3fc40daa45b7a2fe00d570c5626c
          name: 'HTTP server zones discovery'
          type: DEPENDENT
          key: nginx.http.server_zones.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#NAME}'
                value: '{$NGINX.LLD.FILTER.HTTP.ZONE.MATCHES}'
              - macro: '{#NAME}'
                value: '{$NGINX.LLD.FILTER.HTTP.ZONE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          item_prototypes:
            - uuid: 46d056a7870545e49db03b0ec2bd1e9b
              name: 'HTTP server zone [{#NAME}]: Discarded, rate'
              type: DEPENDENT
              key: 'nginx.http.server_zones.discarded.rate[{#NAME}]'
              description: 'The total number of requests completed without sending a response per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.discarded
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: e8dd5302fced4d23ba93656f383222d9
              name: 'HTTP server zone [{#NAME}]: Processing'
              type: DEPENDENT
              key: 'nginx.http.server_zones.processing[{#NAME}]'
              description: 'The number of client requests that are currently being processed.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.processing
              master_item:
                key: 'nginx.http.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: db1046fb656c4ddf8a057cc1d0cb44f6
              name: 'HTTP server zone [{#NAME}]: Raw data'
              type: DEPENDENT
              key: 'nginx.http.server_zones.raw[{#NAME}]'
              history: '0'
              value_type: TEXT
              description: 'The raw data of the HTTP server zone with the name `{#NAME}` .'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$[''{#NAME}'']'
              master_item:
                key: nginx.http.server_zones
              tags:
                - tag: component
                  value: raw
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: edc834403218460b8c7b8b3ca0709a76
              name: 'HTTP server zone [{#NAME}]: Received, rate'
              type: DEPENDENT
              key: 'nginx.http.server_zones.received.rate[{#NAME}]'
              description: 'The total number of bytes received from clients per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.received
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: e33079d5cc684a5687bd7cd10eaec541
              name: 'HTTP server zone [{#NAME}]: Requests, rate'
              type: DEPENDENT
              key: 'nginx.http.server_zones.requests.rate[{#NAME}]'
              description: 'The total number of client requests received from clients per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.requests
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 2b37ee1a3c1243c38534f70acf7a32d9
              name: 'HTTP server zone [{#NAME}]: Responses 1xx, rate'
              type: DEPENDENT
              key: 'nginx.http.server_zones.responses.1xx.rate[{#NAME}]'
              description: 'The number of responses with `1xx` status code per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.1xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 4e127d8bfac940f1b3703053ada05fbd
              name: 'HTTP server zone [{#NAME}]: Responses 2xx, rate'
              type: DEPENDENT
              key: 'nginx.http.server_zones.responses.2xx.rate[{#NAME}]'
              description: 'The number of responses with `2xx` status code per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.2xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 6add98c2b5334160a0e4cc363f53cb7e
              name: 'HTTP server zone [{#NAME}]: Responses 3xx, rate'
              type: DEPENDENT
              key: 'nginx.http.server_zones.responses.3xx.rate[{#NAME}]'
              description: 'The number of responses with `3xx` status code per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.3xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 1f2cd6dcddf948a9bf17f05c68502f46
              name: 'HTTP server zone [{#NAME}]: Responses 4xx, rate'
              type: DEPENDENT
              key: 'nginx.http.server_zones.responses.4xx.rate[{#NAME}]'
              description: 'The number of responses with `4xx` status code per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.4xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: fc6654f2627e47cbbe1a7628c073520a
              name: 'HTTP server zone [{#NAME}]: Responses 5xx, rate'
              type: DEPENDENT
              key: 'nginx.http.server_zones.responses.5xx.rate[{#NAME}]'
              description: 'The number of responses with `5xx` status code per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.5xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: fd81275f0c994a62a9412d595d7d2e8b
              name: 'HTTP server zone [{#NAME}]: Responses total, rate'
              type: DEPENDENT
              key: 'nginx.http.server_zones.responses.total.rate[{#NAME}]'
              description: 'The total number of responses sent to clients per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.total
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 91acfc8de0e64d52820d509ced251e5b
              name: 'HTTP server zone [{#NAME}]: Sent, rate'
              type: DEPENDENT
              key: 'nginx.http.server_zones.sent.rate[{#NAME}]'
              description: 'The total number of bytes sent to clients per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.sent
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
          graph_prototypes:
            - uuid: ba4bc0201f0741078e1512fd79bddf59
              name: 'Nginx: HTTP server zone [{#NAME}]: Requests'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.server_zones.requests.rate[{#NAME}]'
            - uuid: 5870e9a861f046b3946c2464c6c5007d
              name: 'Nginx: HTTP server zone [{#NAME}]: Responses'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.server_zones.responses.2xx.rate[{#NAME}]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: F63100
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.server_zones.responses.1xx.rate[{#NAME}]'
                - sortorder: '2'
                  drawtype: GRADIENT_LINE
                  color: 00611C
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.server_zones.responses.3xx.rate[{#NAME}]'
                - sortorder: '3'
                  drawtype: GRADIENT_LINE
                  color: F7941D
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.server_zones.responses.4xx.rate[{#NAME}]'
                - sortorder: '4'
                  drawtype: GRADIENT_LINE
                  color: FC6EA3
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.server_zones.responses.5xx.rate[{#NAME}]'
          master_item:
            key: nginx.http.server_zones
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var output = [];
                  
                  Object.keys(JSON.parse(value)).forEach(function (v) {
                  	output.push({ '{#NAME}': v })
                  });
                  
                  return JSON.stringify(output);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 30m
        - uuid: 007e9b12e7164f629d90a6f377333dc8
          name: 'HTTP upstream peers discovery'
          type: DEPENDENT
          key: nginx.http.upstream.peers.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#UPSTREAM}'
                value: '{$NGINX.LLD.FILTER.HTTP.UPSTREAM.MATCHES}'
              - macro: '{#UPSTREAM}'
                value: '{$NGINX.LLD.FILTER.HTTP.UPSTREAM.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          item_prototypes:
            - uuid: ad270fab134c44ae83c154670db4d317
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Active'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.active[{#UPSTREAM},{#PEER}]'
              description: 'The current number of active connections.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.active
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: cd7455016ac549598df2551a716545ef
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Fails, rate'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.fails.rate[{#UPSTREAM},{#PEER}]'
              description: 'The total number of unsuccessful attempts to communicate with the server per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.fails
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: b0607f003d7a4713a28f0d75b7933087
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Header time'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.header_time.rate[{#UPSTREAM},{#PEER}]'
              units: '!ms'
              description: 'The average time to get the response header from the server.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.header_time
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 89f89850409a4aff8447b9f7c2839f01
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Health checks, check'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.health_checks.checks[{#UPSTREAM},{#PEER}]'
              description: 'The total number of health check requests made.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.health_checks.checks
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 31292e9dbc8c45dd936ed1e77d44940b
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Health checks, fails'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.health_checks.fails[{#UPSTREAM},{#PEER}]'
              description: 'The number of failed health checks.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.health_checks.fails
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 89c57fb94cab4635b14532961560a8bf
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Health checks, unhealthy'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.health_checks.unhealthy[{#UPSTREAM},{#PEER}]'
              description: 'Displays how many times the server has become `unhealthy` (the state - “unhealthy”.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.health_checks.unhealthy
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 45905cc6029140a39a8c9228d0254063
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Raw data'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              history: '0'
              value_type: TEXT
              description: 'The raw data of the HTTP upstream with the name `[{#UPSTREAM}]`and peer with the name`[{#PEER}]`.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$[''{#UPSTREAM}''].peers[?(@.server == ''{#PEER}'')].first()'
              master_item:
                key: nginx.http.upstreams
              tags:
                - tag: component
                  value: raw
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 8731deb89d1c4fc2bab90aca5802c721
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Received, rate'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.received.rate[{#UPSTREAM},{#PEER}]'
              description: 'The total number of bytes received from this server per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.received
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 3ff18cfb4028421e9af0460aeaa2d6a4
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Requests, rate'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.requests.rate[{#UPSTREAM},{#PEER}]'
              description: 'The total number of client requests forwarded to this server per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.requests
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 6ca38995050e44488df4fde7dc543541
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Responses 1xx, rate'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.responses.1xx.rate[{#UPSTREAM},{#PEER}]'
              description: 'The number of responses with `1xx` status code per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.1xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: e526b61c48eb45568ef92434eee3a2cb
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Responses 2xx, rate'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.responses.2xx.rate[{#UPSTREAM},{#PEER}]'
              description: 'The number of responses with `2xx` status code per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.2xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 7b2851137d77418a8548e92332c66c86
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Responses 3xx, rate'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.responses.3xx.rate[{#UPSTREAM},{#PEER}]'
              description: 'The number of responses with `3xx` status code per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.3xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: cb81f113d289409ca26af48aeb68f8cc
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Responses 4xx, rate'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.responses.4xx.rate[{#UPSTREAM},{#PEER}]'
              description: 'The number of responses with `4xx` status code per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.4xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 172cb81d02f04fd48c7b82d8ae7dac69
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Responses 5xx, rate'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.responses.5xx.rate[{#UPSTREAM},{#PEER}]'
              description: 'The number of responses with `5xx` status code per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.5xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: d587254989c743b4aa9c8043bf18baa5
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Responses total, rate'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.responses.total.rate[{#UPSTREAM},{#PEER}]'
              description: 'The total number of responses obtained from this server.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.total
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 868562df5ab44d3cadeb6fa294b33559
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Response time'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.response_time.rate[{#UPSTREAM},{#PEER}]'
              units: '!ms'
              description: 'The average time to get the full response from the server.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.response_time
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 2a0a36d22acf453e80d79820990db9b8
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Sent, rate'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.sent.rate[{#UPSTREAM},{#PEER}]'
              description: 'The total number of bytes sent to this server per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.sent
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 33eacaa48f974c348e37475341a6c8af
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: State'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.state[{#UPSTREAM},{#PEER}]'
              value_type: CHAR
              description: 'The current state, which may be one of “up”, “draining”, “down”, “unavail”, “checking”, and “unhealthy”.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.state
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3h
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
              trigger_prototypes:
                - uuid: fc6586fe2eef457bac1d71ce0313f95d
                  expression: 'find(/NGINX Plus by HTTP/nginx.http.upstream.peer.state[{#UPSTREAM},{#PEER}],,"like","up")=0 and find(/NGINX Plus by HTTP/nginx.http.upstream.peer.state[{#UPSTREAM},{#PEER}],,"like","down")=0'
                  name: 'NGINX Plus: HTTP upstream server is not in UP or DOWN state.'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  tags:
                    - tag: scope
                      value: availability
            - uuid: e89e6c141217465794febd9131ccafae
              name: 'HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Unavail'
              type: DEPENDENT
              key: 'nginx.http.upstream.peer.unavail.rate[{#UPSTREAM},{#PEER}]'
              description: 'Displays how many times the server has become unavailable for client requests (the state - “unavail”) due to the number of unsuccessful attempts reaching the `max_fails` threshold.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.unavail
              master_item:
                key: 'nginx.http.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
          trigger_prototypes:
            - uuid: e7b4782a796b4710b50a96f3d24c8208
              expression: 'sum(/NGINX Plus by HTTP/nginx.http.upstream.peer.responses.4xx.rate[{#UPSTREAM},{#PEER}],5m) > (sum(/NGINX Plus by HTTP/nginx.http.upstream.peer.responses.total.rate[{#UPSTREAM},{#PEER}],5m)*({$NGINX.HTTP.UPSTREAM.4XX.MAX.WARN}/100))'
              name: 'NGINX Plus: Too many HTTP requests with code 4xx'
              event_name: 'NGINX Plus: Too many HTTP requests with code 4xx (over {$NGINX.HTTP.UPSTREAM.4XX.MAX.WARN}% for 5m)'
              priority: WARNING
              tags:
                - tag: scope
                  value: performance
            - uuid: f542573d149547d3844f635bf2a87120
              expression: 'sum(/NGINX Plus by HTTP/nginx.http.upstream.peer.responses.5xx.rate[{#UPSTREAM},{#PEER}],5m) > (sum(/NGINX Plus by HTTP/nginx.http.upstream.peer.responses.total.rate[{#UPSTREAM},{#PEER}],5m)*({$NGINX.HTTP.UPSTREAM.5XX.MAX.WARN}/100))'
              name: 'NGINX Plus: Too many HTTP requests with code 5xx'
              event_name: 'NGINX Plus: Too many HTTP requests with code 5xx (over {$NGINX.HTTP.UPSTREAM.5XX.MAX.WARN}% for 5m)'
              priority: HIGH
              tags:
                - tag: scope
                  value: performance
          graph_prototypes:
            - uuid: 63582bcbe4c741e88cd64a43ff1b7d9d
              name: 'Nginx: HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Health checks'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.upstream.peer.health_checks.checks[{#UPSTREAM},{#PEER}]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: F63100
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.upstream.peer.health_checks.fails[{#UPSTREAM},{#PEER}]'
                - sortorder: '2'
                  drawtype: GRADIENT_LINE
                  color: 00611C
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.upstream.peer.health_checks.unhealthy[{#UPSTREAM},{#PEER}]'
            - uuid: 49cd8f25969d486ab4482b4986b1815a
              name: 'Nginx: HTTP upstream [{#UPSTREAM}] peer [{#PEER}]: Responses'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.upstream.peer.responses.2xx.rate[{#UPSTREAM},{#PEER}]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: F63100
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.upstream.peer.responses.1xx.rate[{#UPSTREAM},{#PEER}]'
                - sortorder: '2'
                  drawtype: GRADIENT_LINE
                  color: 00611C
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.upstream.peer.responses.3xx.rate[{#UPSTREAM},{#PEER}]'
                - sortorder: '3'
                  drawtype: GRADIENT_LINE
                  color: F7941D
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.upstream.peer.responses.4xx.rate[{#UPSTREAM},{#PEER}]'
                - sortorder: '4'
                  drawtype: GRADIENT_LINE
                  color: FC6EA3
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.http.upstream.peer.responses.5xx.rate[{#UPSTREAM},{#PEER}]'
          master_item:
            key: nginx.http.upstreams
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var input = JSON.parse(value),
                  	output = [];
                  
                  Object.keys(input).forEach(function (upstream) {
                  	input[upstream].peers.forEach(function (peer) {
                  		output.push({ '{#UPSTREAM}': upstream, '{#PEER}': peer.server })
                  	});
                  });
                  
                  return JSON.stringify(output);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 30m
        - uuid: 0cdb09e9004540239fd49eab09e3f324
          name: 'HTTP upstreams discovery'
          type: DEPENDENT
          key: nginx.http.upstreams.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#NAME}'
                value: '{$NGINX.LLD.FILTER.HTTP.UPSTREAM.MATCHES}'
              - macro: '{#NAME}'
                value: '{$NGINX.LLD.FILTER.HTTP.UPSTREAM.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          item_prototypes:
            - uuid: ef9a2a71c3a340c894f82c29503d6b6b
              name: 'HTTP upstream [{#NAME}]: Keepalive'
              type: DEPENDENT
              key: 'nginx.http.upstreams.keepalive[{#NAME}]'
              description: 'The current number of idle keepalive connections.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.keepalive
              master_item:
                key: 'nginx.http.upstreams.raw[{#NAME}]'
              tags:
                - tag: component
                  value: upstreams
                - tag: upstream
                  value: '{#NAME}'
            - uuid: c3e92f3e636c4c45907fecd332eb700f
              name: 'HTTP upstream [{#NAME}]: Raw data'
              type: DEPENDENT
              key: 'nginx.http.upstreams.raw[{#NAME}]'
              history: '0'
              value_type: TEXT
              description: 'The raw data of the HTTP upstream with the name `{#NAME}`.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$[''{#NAME}'']'
              master_item:
                key: nginx.http.upstreams
              tags:
                - tag: component
                  value: raw
                - tag: component
                  value: upstream
                - tag: upstream
                  value: '{#NAME}'
            - uuid: 1a426d42dada4eb082aa4e912ae1256c
              name: 'HTTP upstream [{#NAME}]: Zombies'
              type: DEPENDENT
              key: 'nginx.http.upstreams.zombies[{#NAME}]'
              description: 'The current number of servers removed from the group but still processing active client requests.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.zombies
              master_item:
                key: 'nginx.http.upstreams.raw[{#NAME}]'
              tags:
                - tag: component
                  value: upstreams
                - tag: upstream
                  value: '{#NAME}'
            - uuid: 8aa415f2a55a4e8fb28ea87a8d307bd4
              name: 'HTTP upstream [{#NAME}]: Zone'
              type: DEPENDENT
              key: 'nginx.http.upstreams.zone[{#NAME}]'
              value_type: CHAR
              description: 'The name of the shared memory zone that keeps the group''s configuration and run-time state.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.zone
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3h
              master_item:
                key: 'nginx.http.upstreams.raw[{#NAME}]'
              tags:
                - tag: component
                  value: upstreams
                - tag: upstream
                  value: '{#NAME}'
          master_item:
            key: nginx.http.upstreams
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var output = [];
                  
                  Object.keys(JSON.parse(value)).forEach(function (v) {
                  	output.push({ '{#NAME}': v })
                  });
                  
                  return JSON.stringify(output);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 30m
        - uuid: 1f75b67c7c4044dfa8727cc7363e86d0
          name: 'Resolvers discovery'
          type: DEPENDENT
          key: nginx.resolvers.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#NAME}'
                value: '{$NGINX.LLD.FILTER.RESOLVER.MATCHES}'
              - macro: '{#NAME}'
                value: '{$NGINX.LLD.FILTER.RESOLVER.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          item_prototypes:
            - uuid: f224bd4758e6481cae8779ec28a0ede4
              name: 'Resolver [{#NAME}]: Raw data'
              type: DEPENDENT
              key: 'nginx.resolvers.raw[{#NAME}]'
              history: '0'
              value_type: TEXT
              description: 'The raw data of the `Resolver` with the name `{#NAME}`.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$[''{#NAME}'']'
              master_item:
                key: nginx.resolvers
              tags:
                - tag: component
                  value: raw
                - tag: component
                  value: resolver
                - tag: upstream
                  value: '{#NAME}'
            - uuid: 8fd2a1c5c148423886dccb939ca61b62
              name: 'Resolver [{#NAME}]: Requests addr, rate'
              type: DEPENDENT
              key: 'nginx.resolvers.requests.addr.rate[{#NAME}]'
              description: 'The total number of requests to resolve addresses to names per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.requests.addr
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.resolvers.raw[{#NAME}]'
              tags:
                - tag: component
                  value: resolver
                - tag: resolver
                  value: '{#NAME}'
            - uuid: fb149324f11a4edc9971e9e2572282a6
              name: 'Resolver [{#NAME}]: Requests name, rate'
              type: DEPENDENT
              key: 'nginx.resolvers.requests.name.rate[{#NAME}]'
              description: 'The total number of requests to resolve names to addresses per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.requests.name
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.resolvers.raw[{#NAME}]'
              tags:
                - tag: component
                  value: resolver
                - tag: resolver
                  value: '{#NAME}'
            - uuid: 9ebd08e8b6a3416c940b16a03158bafe
              name: 'Resolver [{#NAME}]: Requests srv, rate'
              type: DEPENDENT
              key: 'nginx.resolvers.requests.srv.rate[{#NAME}]'
              description: 'The total number of requests to resolve SRV records per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.requests.srv
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.resolvers.raw[{#NAME}]'
              tags:
                - tag: component
                  value: resolver
                - tag: resolver
                  value: '{#NAME}'
            - uuid: 8a7db7d9c24f4f88b9ad9dde32b2b2e0
              name: 'Resolver [{#NAME}]: Responses formerr, rate'
              type: DEPENDENT
              key: 'nginx.resolvers.responses.formerr.rate[{#NAME}]'
              description: 'The total number of `FORMERR` (format error) responses per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.formerr
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.resolvers.raw[{#NAME}]'
              tags:
                - tag: component
                  value: resolver
                - tag: resolver
                  value: '{#NAME}'
            - uuid: bf5a55d771724cfeaec90950f653b181
              name: 'Resolver [{#NAME}]: Responses noerror, rate'
              type: DEPENDENT
              key: 'nginx.resolvers.responses.noerror.rate[{#NAME}]'
              description: 'The total number of successful responses per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.noerror
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.resolvers.raw[{#NAME}]'
              tags:
                - tag: component
                  value: resolver
                - tag: resolver
                  value: '{#NAME}'
            - uuid: 46cd31140a3342568c7d7ae0cdae6270
              name: 'Resolver [{#NAME}]: Responses notimp, rate'
              type: DEPENDENT
              key: 'nginx.resolvers.responses.notimp.rate[{#NAME}]'
              description: 'The total number of `NOTIMP` (unimplemented) responses per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.notimp
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.resolvers.raw[{#NAME}]'
              tags:
                - tag: component
                  value: resolver
                - tag: resolver
                  value: '{#NAME}'
            - uuid: b4e002955de844a69a755076993b0577
              name: 'Resolver [{#NAME}]: Responses nxdomain, rate'
              type: DEPENDENT
              key: 'nginx.resolvers.responses.nxdomain.rate[{#NAME}]'
              description: 'The total number of `NXDOMAIN` (host not found) responses per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.nxdomain
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.resolvers.raw[{#NAME}]'
              tags:
                - tag: component
                  value: resolver
                - tag: resolver
                  value: '{#NAME}'
            - uuid: 114f260fc9754e80927494dce51f9e46
              name: 'Resolver [{#NAME}]: Responses refused, rate'
              type: DEPENDENT
              key: 'nginx.resolvers.responses.refused.rate[{#NAME}]'
              description: 'The total number of `REFUSED` (operation refused) responses per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.refused
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.resolvers.raw[{#NAME}]'
              tags:
                - tag: component
                  value: resolver
                - tag: resolver
                  value: '{#NAME}'
            - uuid: 7b4f4f609807407e849525f9f99c0fcc
              name: 'Resolver [{#NAME}]: Responses servfail, rate'
              type: DEPENDENT
              key: 'nginx.resolvers.responses.servfail.rate[{#NAME}]'
              description: 'The total number of `SERVFAIL` (server failure) responses per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.servfail
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.resolvers.raw[{#NAME}]'
              tags:
                - tag: component
                  value: resolver
                - tag: resolver
                  value: '{#NAME}'
            - uuid: 28b11b8bfd6143ada94b041390281a2f
              name: 'Resolver [{#NAME}]: Responses timedout, rate'
              type: DEPENDENT
              key: 'nginx.resolvers.responses.timedout.rate[{#NAME}]'
              description: 'The total number of timed out requests per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.timedout
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.resolvers.raw[{#NAME}]'
              tags:
                - tag: component
                  value: resolver
                - tag: resolver
                  value: '{#NAME}'
            - uuid: b68f19ad119941b58da491d2cd827277
              name: 'Resolver [{#NAME}]: Responses unknown, rate'
              type: DEPENDENT
              key: 'nginx.resolvers.responses.unknown.rate[{#NAME}]'
              description: 'The total number of requests completed with an unknown error per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.responses.unknown
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.resolvers.raw[{#NAME}]'
              tags:
                - tag: component
                  value: resolver
                - tag: resolver
                  value: '{#NAME}'
          graph_prototypes:
            - uuid: 7c91ca5b8477468fa19c56b621e0c32a
              name: 'Nginx: Resolver [{#NAME}]: Requests'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.resolvers.requests.name.rate[{#NAME}]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: F63100
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.resolvers.requests.srv.rate[{#NAME}]'
                - sortorder: '2'
                  drawtype: GRADIENT_LINE
                  color: 00611C
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.resolvers.requests.addr.rate[{#NAME}]'
            - uuid: e3535ce974114e6188752937c1bdb2c7
              name: 'Nginx: Resolver [{#NAME}]: Responses'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.resolvers.responses.noerror.rate[{#NAME}]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: F63100
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.resolvers.responses.formerr.rate[{#NAME}]'
                - sortorder: '2'
                  drawtype: GRADIENT_LINE
                  color: 00611C
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.resolvers.responses.servfail.rate[{#NAME}]'
                - sortorder: '3'
                  drawtype: GRADIENT_LINE
                  color: F7941D
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.resolvers.responses.nxdomain.rate[{#NAME}]'
                - sortorder: '4'
                  drawtype: GRADIENT_LINE
                  color: FC6EA3
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.resolvers.responses.notimp.rate[{#NAME}]'
                - sortorder: '5'
                  drawtype: GRADIENT_LINE
                  color: 6C59DC
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.resolvers.responses.refused.rate[{#NAME}]'
                - sortorder: '6'
                  drawtype: GRADIENT_LINE
                  color: C7A72D
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.resolvers.responses.timedout.rate[{#NAME}]'
                - sortorder: '7'
                  drawtype: GRADIENT_LINE
                  color: BA2A5D
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.resolvers.responses.unknown.rate[{#NAME}]'
          master_item:
            key: nginx.resolvers
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var output = [];
                  
                  Object.keys(JSON.parse(value)).forEach(function (v) {
                  	output.push({ '{#NAME}': v })
                  });
                  
                  return JSON.stringify(output);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 30m
        - uuid: bdc6582408be488997720ef8a4d1108e
          name: 'Stream server zones discovery'
          type: DEPENDENT
          key: nginx.stream.server_zones.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#NAME}'
                value: '{$NGINX.LLD.FILTER.STREAM.ZONE.MATCHES}'
              - macro: '{#NAME}'
                value: '{$NGINX.LLD.FILTER.STREAM.ZONE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          item_prototypes:
            - uuid: e321037e23ff484cb4dc89a8e187919c
              name: 'Stream server zone [{#NAME}]: Connections, rate'
              type: DEPENDENT
              key: 'nginx.stream.server_zones.connections.rate[{#NAME}]'
              description: 'The total number of connections accepted from clients per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.connections
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.stream.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: c9e9d883123842d291c922d5bbcca8f3
              name: 'Stream server zone [{#NAME}]: Discarded, rate'
              type: DEPENDENT
              key: 'nginx.stream.server_zones.discarded.rate[{#NAME}]'
              description: 'The total number of connections completed without creating a session per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.discarded
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.stream.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: f8d16f41fe9e4be685c28bb4acd2187f
              name: 'Stream server zone [{#NAME}]: Processing'
              type: DEPENDENT
              key: 'nginx.stream.server_zones.processing[{#NAME}]'
              description: 'The number of client connections that are currently being processed.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.processing
              master_item:
                key: 'nginx.stream.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: b3387022f2b44650823ce47394723069
              name: 'Stream server zone [{#NAME}]: Raw data'
              type: DEPENDENT
              key: 'nginx.stream.server_zones.raw[{#NAME}]'
              history: '0'
              value_type: TEXT
              description: 'The raw data of server zone with the name `{#NAME}`, configured in the "stream" directive.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$[''{#NAME}'']'
              master_item:
                key: nginx.stream.server_zones
              tags:
                - tag: component
                  value: raw
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 47a9959627e3423e9739b55dac23edd2
              name: 'Stream server zone [{#NAME}]: Received, rate'
              type: DEPENDENT
              key: 'nginx.stream.server_zones.received.rate[{#NAME}]'
              description: 'The total number of bytes received from clients per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.received
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.stream.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 2aafb1ae6ce24f14a3494826d63cfce2
              name: 'Stream server zone [{#NAME}]: Sent, rate'
              type: DEPENDENT
              key: 'nginx.stream.server_zones.sent.rate[{#NAME}]'
              description: 'The total number of bytes sent to clients per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.sent
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.stream.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 7399335b883040c495b5cbfade3e182e
              name: 'Stream server zone [{#NAME}]: Sessions 2xx, rate'
              type: DEPENDENT
              key: 'nginx.stream.server_zones.sessions.2xx.rate[{#NAME}]'
              description: 'The total number of sessions completed with status code `2xx` per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.sessions.2xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.stream.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 5e654682849748bea849db9ab73f7075
              name: 'Stream server zone [{#NAME}]: Sessions 4xx, rate'
              type: DEPENDENT
              key: 'nginx.stream.server_zones.sessions.4xx.rate[{#NAME}]'
              description: 'The total number of sessions completed with status code `4xx` per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.sessions.4xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.stream.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 0cdc4545f6dc4a1e8f247291302824a4
              name: 'Stream server zone [{#NAME}]: Sessions 5xx, rate'
              type: DEPENDENT
              key: 'nginx.stream.server_zones.sessions.5xx.rate[{#NAME}]'
              description: 'The total number of sessions completed with status code `5xx` per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.sessions.5xx
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.stream.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
            - uuid: 30313c91655042b8948422c13fbdfca3
              name: 'Stream server zone [{#NAME}]: Sessions total, rate'
              type: DEPENDENT
              key: 'nginx.stream.server_zones.sessions.total.rate[{#NAME}]'
              description: 'The total number of completed client sessions per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.sessions.total
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.stream.server_zones.raw[{#NAME}]'
              tags:
                - tag: component
                  value: server_zones
                - tag: zone
                  value: '{#NAME}'
          graph_prototypes:
            - uuid: f833112506e941d791057925c58bd1d9
              name: 'Nginx: Stream server zone [{#NAME}]: Sessions'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.stream.server_zones.sessions.2xx.rate[{#NAME}]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: F63100
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.stream.server_zones.sessions.4xx.rate[{#NAME}]'
                - sortorder: '2'
                  drawtype: GRADIENT_LINE
                  color: 00611C
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.stream.server_zones.sessions.5xx.rate[{#NAME}]'
          master_item:
            key: nginx.stream.server_zones
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var output = [];
                  
                  Object.keys(JSON.parse(value)).forEach(function (v) {
                  	output.push({ '{#NAME}': v })
                  });
                  
                  return JSON.stringify(output);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 30m
        - uuid: 435f8bc40dd244aabb7daee4be7d54e5
          name: 'Stream upstream peers discovery'
          type: DEPENDENT
          key: nginx.stream.upstream.peers.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#UPSTREAM}'
                value: '{$NGINX.LLD.FILTER.STREAM.UPSTREAM.MATCHES}'
              - macro: '{#UPSTREAM}'
                value: '{$NGINX.LLD.FILTER.STREAM.UPSTREAM.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          item_prototypes:
            - uuid: 3337df557e734de8b019216c5c06fcea
              name: 'Stream upstream [{#UPSTREAM}] peer [{#PEER}]: Active'
              type: DEPENDENT
              key: 'nginx.stream.upstream.peer.active[{#UPSTREAM},{#PEER}]'
              description: 'The current number of connections.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.active
              master_item:
                key: 'nginx.stream.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 2ae319abd31b40b7a765c300e5dfa954
              name: 'Stream upstream [{#UPSTREAM}] peer [{#PEER}]: Connections'
              type: DEPENDENT
              key: 'nginx.stream.upstream.peer.connections.rate[{#UPSTREAM},{#PEER}]'
              description: 'The total number of client connections forwarded to this server.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.connections
              master_item:
                key: 'nginx.stream.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: f98409ef166b47f3a70d46dffe233166
              name: 'Stream upstream [{#UPSTREAM}] peer [{#PEER}]: Connect time'
              type: DEPENDENT
              key: 'nginx.stream.upstream.peer.connect_time.rate[{#UPSTREAM},{#PEER}]'
              units: '!ms'
              description: 'The average time to connect to the upstream server.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.connect_time
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'nginx.stream.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 0b1000ddc883422cb9fb3382a839c10a
              name: 'Stream upstream [{#UPSTREAM}] peer [{#PEER}]: Fails, rate'
              type: DEPENDENT
              key: 'nginx.stream.upstream.peer.fails.rate[{#UPSTREAM},{#PEER}]'
              description: 'The total number of unsuccessful attempts to communicate with the server per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.fails
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.stream.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 23a02d1c0a63483fb1eb4914a7e48ecf
              name: 'Stream upstream [{#UPSTREAM}] peer [{#PEER}]: First byte time'
              type: DEPENDENT
              key: 'nginx.stream.upstream.peer.first_byte_time.rate[{#UPSTREAM},{#PEER}]'
              units: '!ms'
              description: 'The average time to receive the first byte of data.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.first_byte_time
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'nginx.stream.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: dac0196daad74fc385a336c7dbddbcfd
              name: 'Stream upstream [{#UPSTREAM}] peer [{#PEER}]: Health checks, check'
              type: DEPENDENT
              key: 'nginx.stream.upstream.peer.health_checks.checks[{#UPSTREAM},{#PEER}]'
              description: 'The total number of health check requests made.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.health_checks.checks
              master_item:
                key: 'nginx.stream.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: af2a6991b432439cb4afb071974a05e7
              name: 'Stream upstream [{#UPSTREAM}] peer [{#PEER}]: Health checks, fails'
              type: DEPENDENT
              key: 'nginx.stream.upstream.peer.health_checks.fails[{#UPSTREAM},{#PEER}]'
              description: 'The number of failed health checks.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.health_checks.fails
              master_item:
                key: 'nginx.stream.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 089bbb9c602a4654a3d2c582c643745f
              name: 'Stream upstream [{#UPSTREAM}] peer [{#PEER}]: Health checks, unhealthy'
              type: DEPENDENT
              key: 'nginx.stream.upstream.peer.health_checks.unhealthy[{#UPSTREAM},{#PEER}]'
              description: 'Displays how many times the server has become `unhealthy` (the state - “unhealthy”).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.health_checks.unhealthy
              master_item:
                key: 'nginx.stream.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 4501c6c20ccd4c93a54e0e23b75de76b
              name: 'Stream upstream [{#UPSTREAM}] peer [{#PEER}]: Raw data'
              type: DEPENDENT
              key: 'nginx.stream.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              history: '0'
              value_type: TEXT
              description: 'The raw data of the upstream with the name `[{#UPSTREAM}]`and peer with the name`[{#PEER}]`, configured in the "stream" directive.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$[''{#UPSTREAM}''].peers[?(@.server == ''{#PEER}'')].first()'
              master_item:
                key: nginx.stream.upstreams
              tags:
                - tag: component
                  value: raw
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 12193b1723eb419a9bbcb235c7b45308
              name: 'Stream upstream [{#UPSTREAM}] peer [{#PEER}]: Received, rate'
              type: DEPENDENT
              key: 'nginx.stream.upstream.peer.received.rate[{#UPSTREAM},{#PEER}]'
              description: 'The total number of bytes received from this server per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.received
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.stream.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: bda851b725454395b59988f03c534b3b
              name: 'Stream upstream [{#UPSTREAM}] peer [{#PEER}]: Response time'
              type: DEPENDENT
              key: 'nginx.stream.upstream.peer.response_time.rate[{#UPSTREAM},{#PEER}]'
              units: '!ms'
              description: 'The average time to receive the last byte of data.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.response_time
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'nginx.stream.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: 6ae8685716cf487fa72534a76e4b286a
              name: 'Stream upstream [{#UPSTREAM}] peer [{#PEER}]: Sent, rate'
              type: DEPENDENT
              key: 'nginx.stream.upstream.peer.sent.rate[{#UPSTREAM},{#PEER}]'
              description: 'The total number of bytes sent to this server per second.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.sent
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'nginx.stream.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
            - uuid: ae7b6564244845518816fffc38bbf9aa
              name: 'Stream upstream [{#UPSTREAM}] peer [{#PEER}]: State'
              type: DEPENDENT
              key: 'nginx.stream.upstream.peer.state[{#UPSTREAM},{#PEER}]'
              value_type: CHAR
              description: 'The current state, which may be one of “up”, “draining”, “down”, “unavail”, “checking”, and “unhealthy”.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.state
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3h
              master_item:
                key: 'nginx.stream.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
              trigger_prototypes:
                - uuid: 20ef9b9e953246ef856dd46033595e52
                  expression: 'find(/NGINX Plus by HTTP/nginx.stream.upstream.peer.state[{#UPSTREAM},{#PEER}],,"like","up")=0 and find(/NGINX Plus by HTTP/nginx.stream.upstream.peer.state[{#UPSTREAM},{#PEER}],,"like","down")=0'
                  name: 'NGINX Plus: Stream upstream server is not in UP or DOWN state.'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 732f0ea262454ab3a4cfeb09aea66b9b
              name: 'Stream upstream [{#UPSTREAM}] peer [{#PEER}]: Unavail'
              type: DEPENDENT
              key: 'nginx.stream.upstream.peer.unavail.rate[{#UPSTREAM},{#PEER}]'
              description: 'Displays how many times the server has  become unavailable for client requests (the state - “unavail”) due to the number of unsuccessful attempts reaching the `max_fails` threshold.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.unavail
              master_item:
                key: 'nginx.stream.upstream.peer.raw[{#UPSTREAM},{#PEER}]'
              tags:
                - tag: component
                  value: upstream
                - tag: peer
                  value: '{#PEER}'
                - tag: upstream
                  value: '{#UPSTREAM}'
          graph_prototypes:
            - uuid: abb23d681d0a461db00648b412b176c8
              name: 'Nginx: Stream upstream [{#UPSTREAM}] peer [{#PEER}]: Health checks'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.stream.upstream.peer.health_checks.checks[{#UPSTREAM},{#PEER}]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: F63100
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.stream.upstream.peer.health_checks.fails[{#UPSTREAM},{#PEER}]'
                - sortorder: '2'
                  drawtype: GRADIENT_LINE
                  color: 00611C
                  item:
                    host: 'NGINX Plus by HTTP'
                    key: 'nginx.stream.upstream.peer.health_checks.unhealthy[{#UPSTREAM},{#PEER}]'
          master_item:
            key: nginx.stream.upstreams
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var input = JSON.parse(value),
                  	output = [];
                  
                  Object.keys(input).forEach(function (upstream) {
                  	input[upstream].peers.forEach(function (peer) {
                  		output.push({ '{#UPSTREAM}': upstream, '{#PEER}': peer.server })
                  	});
                  });
                  
                  return JSON.stringify(output);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 30m
        - uuid: 8a8f9d8b47f84bd98a5315ae30944240
          name: 'Stream upstreams discovery'
          type: DEPENDENT
          key: nginx.stream.upstreams.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#NAME}'
                value: '{$NGINX.LLD.FILTER.STREAM.UPSTREAM.MATCHES}'
              - macro: '{#NAME}'
                value: '{$NGINX.LLD.FILTER.STREAM.UPSTREAM.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          item_prototypes:
            - uuid: 17a28cedacaf4a67929982037bf61f59
              name: 'Stream upstream [{#NAME}]: Raw data'
              type: DEPENDENT
              key: 'nginx.stream.upstreams.raw[{#NAME}]'
              history: '0'
              value_type: TEXT
              description: 'The raw data of the upstream with the name `[{#UPSTREAM}]`, configured in the "stream" directive.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$[''{#NAME}'']'
              master_item:
                key: nginx.stream.upstreams
              tags:
                - tag: component
                  value: raw
                - tag: component
                  value: upstreams
                - tag: upstream
                  value: '{#NAME}'
            - uuid: 5537680fbc024713a077932cc55ef3a7
              name: 'Stream upstream [{#NAME}]: Zombies'
              type: DEPENDENT
              key: 'nginx.stream.upstreams.zombies[{#NAME}]'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.zombies
              master_item:
                key: 'nginx.stream.upstreams.raw[{#NAME}]'
              tags:
                - tag: component
                  value: upstreams
                - tag: upstream
                  value: '{#NAME}'
            - uuid: 8c273c10ece545a58e4d34f6d3812fe0
              name: 'Stream upstream [{#NAME}]: Zone'
              type: DEPENDENT
              key: 'nginx.stream.upstreams.zone[{#NAME}]'
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.zone
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3h
              master_item:
                key: 'nginx.stream.upstreams.raw[{#NAME}]'
              tags:
                - tag: component
                  value: upstreams
                - tag: upstream
                  value: '{#NAME}'
          master_item:
            key: nginx.stream.upstreams
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var output = [];
                  
                  Object.keys(JSON.parse(value)).forEach(function (v) {
                  	output.push({ '{#NAME}': v })
                  });
                  
                  return JSON.stringify(output);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 30m
      tags:
        - tag: class
          value: software
        - tag: subclass
          value: webserver
        - tag: target
          value: nginx
      macros:
        - macro: '{$NGINX.API.ENDPOINT}'
          description: 'NGINX Plus API URL in the format `<scheme>://<host>:<port>/<location>/`.'
          config:
            type: TEXT
            priority: '1'
            label: 'API URL'
            description: 'NGINX Plus API URL in the format `<scheme>://<host>:<port>/<location>/`.'
            required: 'YES'
        - macro: '{$NGINX.DROP_RATE.MAX.WARN}'
          value: '1'
          description: 'The critical rate of the dropped connections for a  trigger expression.'
          config:
            type: TEXT
            priority: '14'
            section_name: Thresholds
            label: 'Dropped connections critical rate'
            description: 'The critical rate of the dropped connections for a  trigger expression.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$NGINX.HTTP.UPSTREAM.4XX.MAX.WARN}'
          value: '5'
          description: 'The maximum percentage of errors with the status code `4xx` (for a trigger expression).'
          config:
            type: TEXT
            priority: '15'
            section_name: Thresholds
            label: 'Max errors rate for status code 4xx'
            description: 'The maximum percentage of errors with the status code `4xx` (for a trigger expression).'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$NGINX.HTTP.UPSTREAM.5XX.MAX.WARN}'
          value: '5'
          description: 'The maximum percentage of errors with the status code `5xx` (for a trigger expression).'
          config:
            type: TEXT
            priority: '16'
            section_name: Thresholds
            label: 'Max errors rate for status code 5xx'
            description: 'The maximum percentage of errors with the status code `5xx` (for a trigger expression).'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$NGINX.LLD.FILTER.HTTP.LOCATION.ZONE.MATCHES}'
          value: '.*'
          description: 'The filter to include the necessary discovered HTTP location zones.'
          config:
            type: TEXT
            priority: '4'
            section_name: Filters
            label: 'HTTP location zones filter (include)'
            description: 'The filter to include the necessary discovered HTTP location zones.'
        - macro: '{$NGINX.LLD.FILTER.HTTP.LOCATION.ZONE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The filter to exclude discovered HTTP location zones.'
          config:
            type: TEXT
            priority: '5'
            section_name: Filters
            label: 'HTTP location zones filter (exclude)'
            description: 'The filter to exclude discovered HTTP location zones.'
        - macro: '{$NGINX.LLD.FILTER.HTTP.UPSTREAM.MATCHES}'
          value: '.*'
          description: 'The filter to include the necessary discovered HTTP upstreams.'
          config:
            type: TEXT
            priority: '6'
            section_name: Filters
            label: 'HTTP upstreams filter (include)'
            description: 'The filter to include the necessary discovered HTTP upstreams.'
        - macro: '{$NGINX.LLD.FILTER.HTTP.UPSTREAM.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The filter to exclude discovered HTTP upstreams.'
          config:
            type: TEXT
            priority: '7'
            section_name: Filters
            label: 'HTTP upstreams filter (exclude)'
            description: 'The filter to exclude discovered HTTP upstreams.'
        - macro: '{$NGINX.LLD.FILTER.HTTP.ZONE.MATCHES}'
          value: '.*'
          description: 'The filter to include the necessary discovered HTTP server zones.'
          config:
            type: TEXT
            priority: '2'
            section_name: Filters
            label: 'HTTP server zones filter (include)'
            description: 'The filter to include the necessary discovered HTTP server zones.'
        - macro: '{$NGINX.LLD.FILTER.HTTP.ZONE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The filter to exclude discovered HTTP server zones.'
          config:
            type: TEXT
            priority: '3'
            section_name: Filters
            label: 'HTTP server zones filter (exclude)'
            description: 'The filter to exclude discovered HTTP server zones.'
        - macro: '{$NGINX.LLD.FILTER.RESOLVER.MATCHES}'
          value: '.*'
          description: 'The filter to include the necessary discovered `Resolvers`.'
          config:
            type: TEXT
            priority: '12'
            section_name: Filters
            label: 'Resolvers filter (include)'
            description: 'The filter to include the necessary discovered `Resolvers`.'
        - macro: '{$NGINX.LLD.FILTER.RESOLVER.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The filter to exclude discovered `Resolvers`.'
          config:
            type: TEXT
            priority: '13'
            section_name: Filters
            label: 'Resolvers filter (exclude)'
            description: 'The filter to exclude discovered `Resolvers`.'
        - macro: '{$NGINX.LLD.FILTER.STREAM.UPSTREAM.MATCHES}'
          value: '.*'
          description: 'The filter to include the necessary discovered upstreams of the "stream" directive.'
          config:
            type: TEXT
            priority: '10'
            section_name: Filters
            label: 'Stream upstreams filter (include)'
            description: 'The filter to include the necessary discovered upstreams of the "stream" directive.'
        - macro: '{$NGINX.LLD.FILTER.STREAM.UPSTREAM.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The filter to exclude discovered upstreams of the "stream" directive'
          config:
            type: TEXT
            priority: '11'
            section_name: Filters
            label: 'Stream upstreams filter (exclude)'
            description: 'The filter to exclude discovered upstreams of the "stream" directive'
        - macro: '{$NGINX.LLD.FILTER.STREAM.ZONE.MATCHES}'
          value: '.*'
          description: 'The filter to include discovered server zones of the "stream" directive.'
          config:
            type: TEXT
            priority: '8'
            section_name: Filters
            label: 'Stream server zones filter (include)'
            description: 'The filter to include discovered server zones of the "stream" directive.'
        - macro: '{$NGINX.LLD.FILTER.STREAM.ZONE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The filter to exclude discovered server zones of the "stream" directive.'
          config:
            type: TEXT
            priority: '9'
            section_name: Filters
            label: 'Stream server zones filter (exclude)'
            description: 'The filter to exclude discovered server zones of the "stream" directive.'
      dashboards:
        - uuid: 8096f22c676e43008469b99bc5f81fd6
          name: 'Nginx: Overview'
          pages:
            - name: Main
              widgets:
                - type: graph
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'NGINX Plus by HTTP'
                        name: 'Nginx: Connections'
                    - type: STRING
                      name: reference
                      value: AAAAA
                - type: graph
                  'y': '5'
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'NGINX Plus by HTTP'
                        name: 'Nginx: SSL'
                    - type: STRING
                      name: reference
                      value: AAAAC
                - type: graph
                  x: '36'
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'NGINX Plus by HTTP'
                        name: 'Nginx: Requests'
                    - type: STRING
                      name: reference
                      value: AAAAB
                - type: graph
                  x: '36'
                  'y': '5'
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'NGINX Plus by HTTP'
                        name: 'Nginx: Uptime'
                    - type: STRING
                      name: reference
                      value: AAAAD
  graphs:
    - uuid: a8b239f2f21a471fa3ac6a10a0419e9c
      name: 'Nginx: Connections'
      graph_items:
        - drawtype: GRADIENT_LINE
          color: 199C0D
          item:
            host: 'NGINX Plus by HTTP'
            key: nginx.connections.accepted.rate
        - sortorder: '1'
          drawtype: GRADIENT_LINE
          color: F63100
          item:
            host: 'NGINX Plus by HTTP'
            key: nginx.connections.dropped
        - sortorder: '2'
          drawtype: GRADIENT_LINE
          color: 00611C
          item:
            host: 'NGINX Plus by HTTP'
            key: nginx.connections.active
        - sortorder: '3'
          drawtype: GRADIENT_LINE
          color: F7941D
          item:
            host: 'NGINX Plus by HTTP'
            key: nginx.connections.idle
    - uuid: 4be7153e244b4c28a53c527aa9fd5706
      name: 'Nginx: Requests'
      graph_items:
        - drawtype: GRADIENT_LINE
          color: 199C0D
          item:
            host: 'NGINX Plus by HTTP'
            key: nginx.requests.total.rate
    - uuid: b1c647610c974bc8aad4fb55e1e3c8d3
      name: 'Nginx: SSL'
      graph_items:
        - drawtype: GRADIENT_LINE
          color: 199C0D
          item:
            host: 'NGINX Plus by HTTP'
            key: nginx.ssl.handshakes.rate
        - sortorder: '1'
          drawtype: GRADIENT_LINE
          color: F63100
          item:
            host: 'NGINX Plus by HTTP'
            key: nginx.ssl.handshakes_failed.rate
        - sortorder: '2'
          drawtype: GRADIENT_LINE
          color: 00611C
          item:
            host: 'NGINX Plus by HTTP'
            key: nginx.ssl.session_reuses.rate
    - uuid: b2da29d4951745db8a66a076eb99d0aa
      name: 'Nginx: Uptime'
      graph_items:
        - color: 199C0D
          item:
            host: 'NGINX Plus by HTTP'
            key: nginx.info.uptime
