zabbix_export:
  version: '8.0'
  template_groups:
    - uuid: a571c0d144b14fd4a87a9d9b2aa9fcd6
      name: Templates/Applications
  templates:
    - uuid: 28e31ef9402d4c1ba2fbc730a288d2d8
      template: 'TrueNAS CORE by SNMP'
      name: 'TrueNAS CORE by SNMP'
      description: |
        Template for monitoring TrueNAS CORE by SNMP.
        
        Setup:
        1. Import the template into Zabbix.
        2. Enable SNMP daemon at Services in TrueNAS CORE web interface: https://www.truenas.com/docs/core/uireference/services/snmpscreen/
        3. Link the template to the host.
        
        MIBs used:
        HOST-RESOURCES-MIB
        SNMPv2-MIB
        UCD-DISKIO-MIB
        UCD-SNMP-MIB
        FREENAS-MIB
        
        Generated by official Zabbix template tool "Templator"
      wizard_ready: 'YES'
      readme: |
        ## Overview
        
        Template for monitoring TrueNAS CORE by SNMP.
        
        ## Setup
        
        1. Import the template into Zabbix.
        2. Enable SNMP daemon at Services in TrueNAS CORE web interface: https://www.truenas.com/docs/core/uireference/services/snmpscreen/
        3. Link the template to the host.
      vendor:
        name: Zabbix
        version: 8.0-2
      groups:
        - name: Templates/Applications
      items:
        - uuid: bbebf1aafe8149a7825ffb976d20fd5c
          name: 'ICMP ping'
          type: SIMPLE
          key: icmpping
          description: |
            The host accessibility by ICMP ping.
            
            0 - ICMP ping fails;
            1 - ICMP ping successful.
          valuemap:
            name: 'Service state'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 2cf51ae664644a7f93950c3366d6f6b9
              expression: 'max(/TrueNAS CORE by SNMP/icmpping,#3)=0'
              name: 'TrueNAS CORE: Unavailable by ICMP ping'
              priority: HIGH
              description: 'Last three attempts returned timeout. Please check device connectivity.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 43b3e4ddfeb34a1abba953cd7503ce2c
          name: 'ICMP loss'
          type: SIMPLE
          key: icmppingloss
          value_type: FLOAT
          units: '%'
          description: 'The percentage of lost packets.'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 8593009de6804a56b3523f8ec53b784e
              expression: 'min(/TrueNAS CORE by SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/TrueNAS CORE by SNMP/icmppingloss,5m)<100'
              name: 'TrueNAS CORE: High ICMP ping loss'
              opdata: 'Loss: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'ICMP packets loss detected.'
              dependencies:
                - name: 'TrueNAS CORE: Unavailable by ICMP ping'
                  expression: 'max(/TrueNAS CORE by SNMP/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: 006c38011abf42f69ef5d9238a356faf
          name: 'ICMP response time'
          type: SIMPLE
          key: icmppingsec
          value_type: FLOAT
          units: s
          description: 'The ICMP ping response time (in seconds).'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: d952f59905fb405dbdd807df08ae9a92
              expression: 'avg(/TrueNAS CORE by SNMP/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN}'
              name: 'TrueNAS CORE: High ICMP ping response time'
              opdata: 'Value: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Average ICMP response time is too high.'
              dependencies:
                - name: 'TrueNAS CORE: High ICMP ping loss'
                  expression: 'min(/TrueNAS CORE by SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/TrueNAS CORE by SNMP/icmppingloss,5m)<100'
                - name: 'TrueNAS CORE: Unavailable by ICMP ping'
                  expression: 'max(/TrueNAS CORE by SNMP/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: 4324124b621348e6bf51b808e33089dd
          name: 'TrueNAS CORE: SNMP walk network interfaces'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.2.1.2.2.1.8,1.3.6.1.2.1.2.2.1.7,1.3.6.1.2.1.31.1.1.1.18,1.3.6.1.2.1.31.1.1.1.1,1.3.6.1.2.1.2.2.1.2,1.3.6.1.2.1.2.2.1.3,1.3.6.1.2.1.31.1.1.1.6,1.3.6.1.2.1.31.1.1.1.10,1.3.6.1.2.1.2.2.1.14,1.3.6.1.2.1.2.2.1.20,1.3.6.1.2.1.2.2.1.19,1.3.6.1.2.1.2.2.1.13,1.3.6.1.2.1.31.1.1.1.15]'
          key: net.if.walk
          history: '0'
          value_type: TEXT
          description: 'Discovering interfaces from IF-MIB.'
          tags:
            - tag: component
              value: raw
        - uuid: 12720ac373444e33961d97f9903eac0e
          name: 'SNMP traps (fallback)'
          type: SNMP_TRAP
          key: snmptrap.fallback
          value_type: LOG
          description: 'The item is used to collect all SNMP traps unmatched by other snmptrap items'
          logtimefmt: 'hh:mm:sszyyyy/MM/dd'
          tags:
            - tag: component
              value: network
        - uuid: 0d1336b92a9347d58fab43e008ecc11b
          name: 'System contact details'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.4.0]'
          key: 'system.contact[sysContact.0]'
          delay: 15m
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The textual identification of the contact person for this managed node, together with information on how to contact this person. If no contact information is known, the value is the zero-length string.
          inventory_link: CONTACT
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: b41b8db2212848db83a6a0d9369fecdd
          name: 'Interrupts per second'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2021.11.59.0]'
          key: system.cpu.intr
          value_type: FLOAT
          description: |
            MIB: UCD-SNMP-MIB
            Number of interrupts processed.
          preprocessing:
            - type: CHANGE_PER_SECOND
          tags:
            - tag: component
              value: cpu
        - uuid: 4283476959894b78956973be95d33e72
          name: 'Load average (1m avg)'
          type: DEPENDENT
          key: system.cpu.load.avg1
          value_type: FLOAT
          description: |
            MIB: UCD-SNMP-MIB
            The 1 minute load averages.
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$[?(@.laName == ''Load-1'')].laLoad.first()'
          master_item:
            key: system.cpu.load.walk
          tags:
            - tag: component
              value: cpu
        - uuid: a7885b68d6644a2ab5875e742a7bc06f
          name: 'Load average (5m avg)'
          type: DEPENDENT
          key: system.cpu.load.avg5
          value_type: FLOAT
          description: |
            MIB: UCD-SNMP-MIB
            The 5 minutes load averages.
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$[?(@.laName == ''Load-5'')].laLoad.first()'
          master_item:
            key: system.cpu.load.walk
          tags:
            - tag: component
              value: cpu
        - uuid: 5263b1258bd24219a3f1a7d11012b316
          name: 'Load average (15m avg)'
          type: DEPENDENT
          key: system.cpu.load.avg15
          value_type: FLOAT
          description: |
            MIB: UCD-SNMP-MIB
            The 15 minutes load averages.
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$[?(@.laName == ''Load-15'')].laLoad.first()'
          master_item:
            key: system.cpu.load.walk
          tags:
            - tag: component
              value: cpu
        - uuid: a34ec7a56e5c4b7eb9ecc1bb029735a2
          name: 'SNMP walk CPU load averages'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.2021.10.1.2,1.3.6.1.4.1.2021.10.1.3]'
          key: system.cpu.load.walk
          history: '0'
          value_type: TEXT
          description: |
            MIB: UCD-SNMP-MIB
            SNMP walk through laTable. The collected data used in dependent CPU load average items.
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - laName
                - 1.3.6.1.4.1.2021.10.1.2
                - '0'
                - laLoad
                - 1.3.6.1.4.1.2021.10.1.3
                - '0'
          tags:
            - tag: component
              value: cpu
            - tag: component
              value: raw
        - uuid: 94366f840edc4686a230682d623f1f41
          name: 'Number of CPUs'
          type: DEPENDENT
          key: system.cpu.num
          description: |
            MIB: HOST-RESOURCES-MIB
            Count the number of CPU cores by counting number of cores discovered in hrProcessorTable using LLD.
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#SNMPVALUE}'
                - 1.3.6.1.2.1.25.3.3.1.1
                - '0'
            - type: JAVASCRIPT
              parameters:
                - 'return JSON.parse(value).length;'
          master_item:
            key: system.cpu.walk
          tags:
            - tag: component
              value: cpu
        - uuid: c8740f4489c04eedb072869e27f68a60
          name: 'Context switches per second'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2021.11.60.0]'
          key: system.cpu.switches
          value_type: FLOAT
          description: |
            MIB: UCD-SNMP-MIB
            Number of context switches.
          preprocessing:
            - type: CHANGE_PER_SECOND
          tags:
            - tag: component
              value: cpu
        - uuid: e6d239830cf743b3adbaad91da793fd6
          name: 'SNMP walk system CPUs'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.2.1.25.3.3.1.1,1.3.6.1.4.1.2021.11.11.0,1.3.6.1.4.1.2021.11.50.0,1.3.6.1.4.1.2021.11.51.0,1.3.6.1.4.1.2021.11.52.0,1.3.6.1.4.1.2021.11.54.0,1.3.6.1.4.1.2021.11.56.0]'
          key: system.cpu.walk
          history: '0'
          value_type: TEXT
          description: |
            MIB: HOST-RESOURCES-MIB
            Discovering system CPUs.
          tags:
            - tag: component
              value: raw
        - uuid: d6ac8d84482244b88e4d2dbc676ea3d4
          name: 'System description'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.1.0]'
          key: 'system.descr[sysDescr.0]'
          delay: 15m
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            A textual description of the entity. This value should
            include the full name and version identification of the system's hardware type, software operating-system, and
            networking software.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: dc3e8cb20837479f8aad2d1948ac8875
          name: 'Uptime (hardware)'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.25.1.1.0]'
          key: 'system.hw.uptime[hrSystemUptime.0]'
          delay: 30s
          trends: '0'
          units: uptime
          description: |
            MIB: HOST-RESOURCES-MIB
            The amount of time since this host was last initialized. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system.
          preprocessing:
            - type: CHECK_NOT_SUPPORTED
              parameters:
                - '-1'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: 75c8390f14364962bd92df0c087e765a
          name: 'System location'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.6.0]'
          key: 'system.location[sysLocation.0]'
          delay: 15m
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            Physical location of the node (e.g., `equipment room`, `3rd floor`). If not provided, the value is a zero-length string.
          inventory_link: LOCATION
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 46b98d1ef62d49a0bb22687dc119acf0
          name: 'System name'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.5.0]'
          key: system.name
          delay: 15m
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name. If the name is unknown, the value is the zero-length string.
          inventory_link: NAME
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 4c3b96b22fa345c3a42fe17ed877b527
              expression: 'last(/TrueNAS CORE by SNMP/system.name,#1)<>last(/TrueNAS CORE by SNMP/system.name,#2) and length(last(/TrueNAS CORE by SNMP/system.name))>0'
              name: 'TrueNAS CORE: System name has changed'
              event_name: 'TrueNAS CORE: System name has changed (new name: {ITEM.VALUE})'
              priority: INFO
              description: 'The name of the system has changed. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
                - tag: scope
                  value: security
        - uuid: f21ada8be3c94f9d8e4c75f411f8b85a
          name: 'Uptime (network)'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.3.0]'
          key: 'system.net.uptime[sysUpTime.0]'
          delay: 30s
          trends: '0'
          units: uptime
          description: |
            MIB: SNMPv2-MIB
            Time (in hundredths of a second) since the network management portion of the system was last re-initialized.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: 79abfa4a6842499da1f03805de93c49f
          name: 'System object ID'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.2.0]'
          key: 'system.objectid[sysObjectID.0]'
          delay: 15m
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The vendor's authoritative identification of the network management subsystem contained in the entity. This value is allocated within the SMI enterprises subtree (1.3.6.1.4.1) and provides an easy and unambiguous means for determining`what kind of box' is being managed.  For example, if vendor`Flintstones, Inc.' was assigned the subtree1.3.6.1.4.1.4242, it could assign the identifier 1.3.6.1.4.1.4242.1.1 to its `Fred Router'.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: e61f086a8a3942569e6c7f67b24e8f86
          name: 'Free swap space'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2021.4.4.0]'
          key: system.swap.free
          units: B
          description: |
            MIB: UCD-SNMP-MIB
            The amount of swap space currently unused or available.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
            - tag: component
              value: storage
        - uuid: 2a075af85eed44c8adba2cb7bc657b40
          name: 'Free swap space in %'
          type: CALCULATED
          key: system.swap.pfree
          value_type: FLOAT
          units: '%'
          params: 'last(//system.swap.free)/last(//system.swap.total)*100'
          description: 'The free space of the swap volume/file expressed in %.'
          preprocessing:
            - type: CHECK_NOT_SUPPORTED
              parameters:
                - '-1'
              error_handler: CUSTOM_VALUE
              error_handler_params: '100'
          tags:
            - tag: component
              value: memory
            - tag: component
              value: storage
        - uuid: b0fc3cd77ed348bb955fc98d8636ab76
          name: 'Total swap space'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2021.4.3.0]'
          key: system.swap.total
          units: B
          description: |
            MIB: UCD-SNMP-MIB
            The total amount of swap space configured for this host.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
            - tag: component
              value: storage
        - uuid: 8111f8ada49c4559b4773cd32ca3226d
          name: 'SNMP walk disk temperatures'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.50536.3.1.2,1.3.6.1.4.1.50536.3.1.3]'
          key: truenas.disk.temp.walk
          history: '0'
          value_type: TEXT
          description: |
            MIB: FREENAS-MIB
            SNMP walk through hddTempTable. The collected data used in disk temperature LLD and dependent item prototypes.
          tags:
            - tag: component
              value: raw
            - tag: component
              value: storage
        - uuid: 2eaaabc61df64756a35aec95650abf7c
          name: 'ARC target size of cache'
          type: DEPENDENT
          key: truenas.zfs.arc.c
          units: B
          description: |
            MIB: FREENAS-MIB
            ARC target size of cache in bytes.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.4.6.0
                - '0'
            - type: MULTIPLIER
              parameters:
                - '1024'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: truenas.zfs.arc_l2arc.walk
          tags:
            - tag: component
              value: memory
            - tag: component
              value: zfs
        - uuid: a4ae886ac205413c85df7c527a9aadb3
          name: 'ARC data size'
          type: DEPENDENT
          key: truenas.zfs.arc.data
          units: B
          description: |
            MIB: FREENAS-MIB
            ARC data size used in bytes.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.4.3.0
                - '0'
            - type: MULTIPLIER
              parameters:
                - '1024'
          master_item:
            key: truenas.zfs.arc_l2arc.walk
          tags:
            - tag: component
              value: memory
            - tag: component
              value: zfs
        - uuid: e3c72ceecec2478685e4bd5983e48c12
          name: 'ARC cache hit ratio'
          type: DEPENDENT
          key: truenas.zfs.arc.hit.ratio
          value_type: FLOAT
          units: '%'
          description: |
            MIB: FREENAS-MIB
            ARC cache hit ration percentage.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.4.9.0
                - '0'
          master_item:
            key: truenas.zfs.arc_l2arc.walk
          tags:
            - tag: component
              value: memory
            - tag: component
              value: zfs
        - uuid: f4c6c12561944975999b59c30744b375
          name: 'ARC hits'
          type: DEPENDENT
          key: truenas.zfs.arc.hits
          value_type: FLOAT
          description: |
            MIB: FREENAS-MIB
            Total amount of cache hits in the ARC per second.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.4.4.0
                - '0'
            - type: CHANGE_PER_SECOND
          master_item:
            key: truenas.zfs.arc_l2arc.walk
          tags:
            - tag: component
              value: memory
            - tag: component
              value: zfs
        - uuid: db3cee6cf685446ca880e3ba0c7a51f1
          name: 'ARC metadata size'
          type: DEPENDENT
          key: truenas.zfs.arc.meta
          units: B
          description: |
            MIB: FREENAS-MIB
            ARC metadata size used in bytes.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.4.2.0
                - '0'
            - type: MULTIPLIER
              parameters:
                - '1024'
          master_item:
            key: truenas.zfs.arc_l2arc.walk
          tags:
            - tag: component
              value: memory
            - tag: component
              value: zfs
        - uuid: d39e5b7524054b5c8121a5b67506fc52
          name: 'ARC cache miss ratio'
          type: DEPENDENT
          key: truenas.zfs.arc.miss.ratio
          value_type: FLOAT
          units: '%'
          description: |
            MIB: FREENAS-MIB
            ARC cache miss ration percentage.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.4.10.0
                - '0'
          master_item:
            key: truenas.zfs.arc_l2arc.walk
          tags:
            - tag: component
              value: memory
            - tag: component
              value: zfs
        - uuid: 51b0901f89ca49f18b5af0c6325190ad
          name: 'ARC misses'
          type: DEPENDENT
          key: truenas.zfs.arc.misses
          value_type: FLOAT
          description: |
            MIB: FREENAS-MIB
            Total amount of cache misses in the ARC per second.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.4.5.0
                - '0'
            - type: CHANGE_PER_SECOND
          master_item:
            key: truenas.zfs.arc_l2arc.walk
          tags:
            - tag: component
              value: memory
            - tag: component
              value: zfs
        - uuid: 5b00055c79174a65af5168b47fb4dbd1
          name: 'ARC target size of MRU'
          type: DEPENDENT
          key: truenas.zfs.arc.p
          units: B
          description: |
            MIB: FREENAS-MIB
            ARC target size of MRU in bytes.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.4.7.0
                - '0'
            - type: MULTIPLIER
              parameters:
                - '1024'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: truenas.zfs.arc_l2arc.walk
          tags:
            - tag: component
              value: memory
            - tag: component
              value: zfs
        - uuid: a677b4991bc94e5b929bcf9f6a0c08ee
          name: 'ARC size'
          type: DEPENDENT
          key: truenas.zfs.arc.size
          units: B
          description: |
            MIB: FREENAS-MIB
            ARC size in bytes.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.4.1.0
                - '0'
            - type: MULTIPLIER
              parameters:
                - '1024'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: truenas.zfs.arc_l2arc.walk
          tags:
            - tag: component
              value: memory
            - tag: component
              value: zfs
        - uuid: 629537d839cb44d68ed3f1693abdb2ef
          name: 'SNMP walk ARC L2ARC'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.50536.1.4,1.3.6.1.4.1.50536.1.5]'
          key: truenas.zfs.arc_l2arc.walk
          history: '0'
          value_type: TEXT
          description: |
            MIB: FREENAS-MIB
            SNMP walk through arc and l2arc. The collected data used in dependent ARC and L2ARC items.
          tags:
            - tag: component
              value: memory
            - tag: component
              value: raw
            - tag: component
              value: zfs
        - uuid: 97ca4111c54d43baaf779b293f392037
          name: 'SNMP walk ZFS datasets'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.50536.1.2.1.1.2,1.3.6.1.4.1.50536.1.2.1.1.3,1.3.6.1.4.1.50536.1.2.1.1.4,1.3.6.1.4.1.50536.1.2.1.1.5,1.3.6.1.4.1.50536.1.2.1.1.6]'
          key: truenas.zfs.dataset.walk
          history: '0'
          value_type: TEXT
          description: |
            MIB: FREENAS-MIB
            SNMP walk through datasetTable. The collected data used in ZFS dataset LLD and dependent item prototypes.
          tags:
            - tag: component
              value: raw
            - tag: component
              value: storage
        - uuid: 2b2ca373849045969f6dbcd411a7e688
          name: 'L2ARC hits'
          type: DEPENDENT
          key: truenas.zfs.l2arc.hits
          value_type: FLOAT
          description: |
            MIB: FREENAS-MIB
            Hits to the L2 cache per second.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.5.1.0
                - '0'
            - type: CHANGE_PER_SECOND
          master_item:
            key: truenas.zfs.arc_l2arc.walk
          tags:
            - tag: component
              value: memory
            - tag: component
              value: zfs
        - uuid: ff6827a36cc9451f801dcf5a433378de
          name: 'L2ARC misses'
          type: DEPENDENT
          key: truenas.zfs.l2arc.misses
          value_type: FLOAT
          description: |
            MIB: FREENAS-MIB
            Misses to the L2 cache per second.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.5.2.0
                - '0'
            - type: CHANGE_PER_SECOND
          master_item:
            key: truenas.zfs.arc_l2arc.walk
          tags:
            - tag: component
              value: memory
            - tag: component
              value: zfs
        - uuid: d3408357df26465794eeb6d6706ee05a
          name: 'L2ARC read rate'
          type: DEPENDENT
          key: truenas.zfs.l2arc.read
          value_type: FLOAT
          units: Bps
          description: |
            MIB: FREENAS-MIB
            Read rate from L2 cache in bytes per second.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.5.3.0
                - '0'
            - type: CHANGE_PER_SECOND
          master_item:
            key: truenas.zfs.arc_l2arc.walk
          tags:
            - tag: component
              value: memory
            - tag: component
              value: zfs
        - uuid: ab95d192720b4f5fa897fed6f1aa40e2
          name: 'L2ARC size'
          type: DEPENDENT
          key: truenas.zfs.l2arc.size
          value_type: FLOAT
          units: B
          description: |
            MIB: FREENAS-MIB
            L2ARC size in bytes.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.5.5.0
                - '0'
            - type: MULTIPLIER
              parameters:
                - '1024'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: truenas.zfs.arc_l2arc.walk
          tags:
            - tag: component
              value: memory
            - tag: component
              value: zfs
        - uuid: 1e04b61c5b0242b095c41495f9f28b57
          name: 'L2ARC write rate'
          type: DEPENDENT
          key: truenas.zfs.l2arc.write
          value_type: FLOAT
          units: Bps
          description: |
            MIB: FREENAS-MIB
            Write rate from L2 cache in bytes per second.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.5.4.0
                - '0'
            - type: CHANGE_PER_SECOND
          master_item:
            key: truenas.zfs.arc_l2arc.walk
          tags:
            - tag: component
              value: memory
            - tag: component
              value: zfs
        - uuid: 73abc73aa39d4dc0a372c274fbea3fa1
          name: 'SNMP walk ZFS pools'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.50536.1.1.1.1.2,1.3.6.1.4.1.50536.1.1.1.1.3,1.3.6.1.4.1.50536.1.1.1.1.4,1.3.6.1.4.1.50536.1.1.1.1.5,1.3.6.1.4.1.50536.1.1.1.1.6,1.3.6.1.4.1.50536.1.1.1.1.7,1.3.6.1.4.1.50536.1.1.1.1.8,1.3.6.1.4.1.50536.1.1.1.1.9,1.3.6.1.4.1.50536.1.1.1.1.10,1.3.6.1.4.1.50536.1.1.1.1.11]'
          key: truenas.zfs.pools.walk
          history: '0'
          value_type: TEXT
          description: |
            MIB: FREENAS-MIB
            SNMP walk through zpoolTable. The collected data used in ZFS pool LLD and dependent item prototypes.
          tags:
            - tag: component
              value: raw
            - tag: component
              value: storage
        - uuid: a504d960680346ad863c5f2117301200
          name: 'ZIL operations 1 second'
          type: DEPENDENT
          key: truenas.zfs.zil.ops1
          value_type: FLOAT
          description: |
            MIB: FREENAS-MIB
            The ops column parsed from the command zilstat 1 1.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.6.1.0
                - '0'
          master_item:
            key: truenas.zfs.zil.walk
          tags:
            - tag: component
              value: log
            - tag: component
              value: zfs
        - uuid: d82112c728704383b873289f0b8bbce6
          name: 'ZIL operations 5 seconds'
          type: DEPENDENT
          key: truenas.zfs.zil.ops5
          value_type: FLOAT
          description: |
            MIB: FREENAS-MIB
            The ops column parsed from the command zilstat 5 1.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.6.2.0
                - '0'
          master_item:
            key: truenas.zfs.zil.walk
          tags:
            - tag: component
              value: log
            - tag: component
              value: zfs
        - uuid: 598dda71f21a410a82ba5b96e1564166
          name: 'ZIL operations 10 seconds'
          type: DEPENDENT
          key: truenas.zfs.zil.ops10
          value_type: FLOAT
          description: |
            MIB: FREENAS-MIB
            The ops column parsed from the command zilstat 10 1.
          preprocessing:
            - type: SNMP_WALK_VALUE
              parameters:
                - 1.3.6.1.4.1.50536.1.6.3.0
                - '0'
          master_item:
            key: truenas.zfs.zil.walk
          tags:
            - tag: component
              value: log
            - tag: component
              value: zfs
        - uuid: ffa31756524a4c679f8a059002b43173
          name: 'SNMP walk ZIL'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.50536.1.6]'
          key: truenas.zfs.zil.walk
          history: '0'
          value_type: TEXT
          description: |
            MIB: FREENAS-MIB
            SNMP walk through zil. The collected data used in dependent ZIL items.
          tags:
            - tag: component
              value: log
            - tag: component
              value: raw
            - tag: component
              value: zfs
        - uuid: b695ddba4fd14b8f85e0c5a9f567e32b
          name: 'SNMP walk ZFS volumes'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.50536.1.3.1.1.2,1.3.6.1.4.1.50536.1.3.1.1.3,1.3.6.1.4.1.50536.1.3.1.1.4,1.3.6.1.4.1.50536.1.3.1.1.5,1.3.6.1.4.1.50536.1.3.1.1.6]'
          key: truenas.zfs.zvols.walk
          history: '0'
          value_type: TEXT
          description: |
            MIB: FREENAS-MIB
            SNMP walk through zvolTable. The collected data used in ZFS volume LLD and dependent item prototypes.
          tags:
            - tag: component
              value: raw
            - tag: component
              value: storage
        - uuid: 845cd344b76f4836b472fca60e5426d1
          name: 'SNMP walk block devices'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.2021.13.15.1.1.2,1.3.6.1.4.1.2021.13.15.1.1.5,1.3.6.1.4.1.2021.13.15.1.1.6,1.3.6.1.4.1.2021.13.15.1.1.9]'
          key: vfs.dev.walk
          history: '0'
          value_type: TEXT
          description: |
            MIB: UCD-DISKIO-MIB
            SNMP walk through diskIOTable. The collected data used in filesystem LLD and dependent item prototypes.
          tags:
            - tag: component
              value: raw
            - tag: component
              value: storage
        - uuid: 43901b6beb7f4f559464775863d19976
          name: 'Available memory'
          type: CALCULATED
          key: vm.memory.available
          units: B
          params: last(//vm.memory.free)+last(//vm.memory.buffers)+last(//vm.memory.cached)
          description: 'Please note that memory utilization is a rough estimate, since memory available is calculated as free+buffers+cached, which is not 100% accurate, but the best we can get using SNMP.'
          tags:
            - tag: component
              value: memory
        - uuid: 3b6007f808e04eefafe236737773ce7f
          name: 'Memory (buffers)'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2021.4.14.0]'
          key: vm.memory.buffers
          units: B
          description: |
            MIB: UCD-SNMP-MIB
            The total amount of real or virtual memory currently allocated for use as memory buffers.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
        - uuid: ab4c02a4c1fc4ef69a31e9b83a1a9263
          name: 'Memory (cached)'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2021.4.15.0]'
          key: vm.memory.cached
          units: B
          description: |
            MIB: UCD-SNMP-MIB
            The total amount of real or virtual memory currently allocated for use as cached memory.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
        - uuid: d55491912c814481b0931e836838e9b0
          name: 'Free memory'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2021.4.6.0]'
          key: vm.memory.free
          units: B
          description: |
            MIB: UCD-SNMP-MIB
            The amount of real/physical memory currently unused or available.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
        - uuid: e3802f02a4364e6bb37fb7fe780c4137
          name: 'Total memory'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2021.4.5.0]'
          key: vm.memory.total
          units: B
          description: |
            MIB: UCD-SNMP-MIB
            The total memory expressed in bytes.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
        - uuid: c70fad7e758e480fbae726a677a29ead
          name: 'Memory utilization'
          type: CALCULATED
          key: vm.memory.util
          value_type: FLOAT
          units: '%'
          params: '(last(//vm.memory.total)-(last(//vm.memory.free)+last(//vm.memory.buffers)+last(//vm.memory.cached)))/last(//vm.memory.total)*100'
          description: 'Please note that memory utilization is a rough estimate, since memory available is calculated as free+buffers+cached, which is not 100% accurate, but the best we can get using SNMP.'
          tags:
            - tag: component
              value: memory
          triggers:
            - uuid: 3ee054e3d944441d9fd174e13b6a59ee
              expression: 'min(/TrueNAS CORE by SNMP/vm.memory.util,5m)>{$MEMORY.UTIL.MAX}'
              name: 'TrueNAS CORE: High memory utilization'
              event_name: 'TrueNAS CORE: High memory utilization (>{$MEMORY.UTIL.MAX}% for 5m)'
              priority: AVERAGE
              description: 'The system is running out of free memory.'
              dependencies:
                - name: 'TrueNAS CORE: Lack of available memory'
                  expression: 'min(/TrueNAS CORE by SNMP/vm.memory.available,5m)<{$MEMORY.AVAILABLE.MIN} and last(/TrueNAS CORE by SNMP/vm.memory.total)>0'
              tags:
                - tag: scope
                  value: capacity
                - tag: scope
                  value: performance
        - uuid: fcbcc100655d478bbf868ffc2a0302d8
          name: 'SNMP agent availability'
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          description: |
            Availability of SNMP checks on the host. The value of this item corresponds to availability icons in the host list.
            Possible values:
            0 - not available
            1 - available
            2 - unknown
          valuemap:
            name: zabbix.host.available
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 4c5e21bdc561429e9ce4f6f105aae7f6
              expression: 'max(/TrueNAS CORE by SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              name: 'TrueNAS CORE: No SNMP data collection'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'SNMP is not available for polling. Please check device connectivity and SNMP settings.'
              dependencies:
                - name: 'TrueNAS CORE: Unavailable by ICMP ping'
                  expression: 'max(/TrueNAS CORE by SNMP/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
      discovery_rules:
        - uuid: cc40c0d4ea184b12bf15056f103a4654
          name: 'CPU discovery'
          type: DEPENDENT
          key: cpu.discovery
          description: 'This discovery will create set of per core CPU metrics from UCD-SNMP-MIB, using {#CPU.COUNT} in preprocessing. That''s the only reason why LLD is used.'
          item_prototypes:
            - uuid: 03eaea043f2b4aee9ccc562ae5390656
              name: 'CPU idle time'
              type: DEPENDENT
              key: 'system.cpu.idle[{#SNMPINDEX}]'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                The time the CPU has spent doing nothing.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.11.0
                    - '0'
              master_item:
                key: system.cpu.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: 378d399d09bd4197b20f575f023a9423
              name: 'CPU interrupt time'
              type: DEPENDENT
              key: 'system.cpu.interrupt[{#SNMPINDEX}]'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                The amount of time the CPU has been servicing hardware interrupts.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.56.0
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: bd17c78973cf482a8916645847a9814f
              name: 'CPU iowait time'
              type: DEPENDENT
              key: 'system.cpu.iowait[{#SNMPINDEX}]'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                The amount of time the CPU has been waiting for I/O to complete.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.54.0
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: e25d8fe2e3b24fff86fe2d91e9b4f16e
              name: 'CPU nice time'
              type: DEPENDENT
              key: 'system.cpu.nice[{#SNMPINDEX}]'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                The time the CPU has spent running users' processes that have been niced.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.51.0
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: 6782830d2a25423fb0db137d66b2f2dd
              name: 'CPU system time'
              type: DEPENDENT
              key: 'system.cpu.system[{#SNMPINDEX}]'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                The time the CPU has spent running the kernel and its processes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.52.0
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: d38eaa9cf17a4778b0b6dfea897e3e6e
              name: 'CPU user time'
              type: DEPENDENT
              key: 'system.cpu.user[{#SNMPINDEX}]'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                The time the CPU has spent running users' processes that are not niced.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.50.0
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: 40f51efcbf47483f84c843c00bd1e034
              name: 'CPU utilization'
              type: DEPENDENT
              key: 'system.cpu.util[{#SNMPINDEX}]'
              value_type: FLOAT
              units: '%'
              description: 'The CPU utilization expressed in %.'
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - 'return (100 - value)'
              master_item:
                key: 'system.cpu.idle[{#SNMPINDEX}]'
              tags:
                - tag: component
                  value: cpu
              trigger_prototypes:
                - uuid: 776551cd5322405e8d7c2b9c30b3a82b
                  expression: 'min(/TrueNAS CORE by SNMP/system.cpu.util[{#SNMPINDEX}],5m)>{$CPU.UTIL.CRIT}'
                  name: 'TrueNAS CORE: High CPU utilization'
                  event_name: 'TrueNAS CORE: High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)'
                  opdata: 'Current utilization: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'The CPU utilization is too high. The system might be slow to respond.'
                  dependencies:
                    - name: 'TrueNAS CORE: Load average is too high'
                      expression: |
                        min(/TrueNAS CORE by SNMP/system.cpu.load.avg1,5m)/last(/TrueNAS CORE by SNMP/system.cpu.num)>{$LOAD_AVG_PER_CPU.MAX.WARN}
                        and last(/TrueNAS CORE by SNMP/system.cpu.load.avg5)>0
                        and last(/TrueNAS CORE by SNMP/system.cpu.load.avg15)>0
                  tags:
                    - tag: scope
                      value: performance
          graph_prototypes:
            - uuid: ef6bd369fc964266a4324f314d5dbdc2
              name: 'TrueNAS CORE: CPU usage{#SINGLETON}'
              type: STACKED
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - color: 199C0D
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'system.cpu.system[{#SNMPINDEX}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'system.cpu.user[{#SNMPINDEX}]'
                - sortorder: '2'
                  color: 00611C
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'system.cpu.nice[{#SNMPINDEX}]'
                - sortorder: '3'
                  color: F7941D
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'system.cpu.iowait[{#SNMPINDEX}]'
                - sortorder: '4'
                  color: FC6EA3
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'system.cpu.interrupt[{#SNMPINDEX}]'
            - uuid: 11de3174f0e24212bedd1ef81429db9d
              name: 'TrueNAS CORE: CPU utilization{#SINGLETON}'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'system.cpu.util[{#SNMPINDEX}]'
          master_item:
            key: system.cpu.num
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return JSON.stringify([{"{#CPU.COUNT}": value, "{#SNMPINDEX}": 0, "{#SINGLETON}":""}])'
        - uuid: a78d7feb497e46c9870344e569b01a60
          name: 'Network interfaces discovery'
          type: DEPENDENT
          key: net.if.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.MATCHES}'
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.MATCHES}'
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.MATCHES}'
              - macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.MATCHES}'
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.MATCHES}'
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.MATCHES}'
              - macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          description: 'Discovering interfaces from IF-MIB.'
          item_prototypes:
            - uuid: 3c3873ba5f8c473aa15efef467514d75
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets discarded'
              type: DEPENDENT
              key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
              description: |
                MIB: IF-MIB
                The number of inbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 28d757aaa3834e539f909afc478d11a6
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets with errors'
              type: DEPENDENT
              key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 5aeeb92e3eeb4b7ca61b3f66b42ea270
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits received'
              type: DEPENDENT
              key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets received on the interface, including framing characters. This object is a 64-bit version of ifInOctets. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 871849c94071437d9a7a8249bb421597
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets discarded'
              type: DEPENDENT
              key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
              description: |
                MIB: IF-MIB
                The number of outbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 74eac8a7eb5b4998b1fd05ec6ffebaf5
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets with errors'
              type: DEPENDENT
              key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 604e8060ed2742fab7722d4cd92aa14b
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits sent'
              type: DEPENDENT
              key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets transmitted out of the interface, including framing characters. This object is a 64-bit version of ifOutOctets.Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: bdb0895c1c1e4e3abe68e62989454a88
              name: 'Interface {#IFNAME}({#IFALIAS}): Speed'
              type: DEPENDENT
              key: 'net.if.speed[ifHighSpeed.{#SNMPINDEX}]'
              trends: '0'
              units: bps
              description: |
                MIB: IF-MIB
                An estimate of the interface's current bandwidth in units of 1,000,000 bits per second. If this object reports a value of `n`, then the speed of the interface is somewhere in the range of `n-500,000` to `n+499,999`.
                For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made, this object should contain the nominal bandwidth.
                For a sub-layer which has no concept of bandwidth, this object should be zero.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: e4ce41cb19bc43058ee268a6c513abd4
              name: 'Interface {#IFNAME}({#IFALIAS}): Operational status'
              type: DEPENDENT
              key: 'net.if.status[ifOperStatus.{#SNMPINDEX}]'
              trends: '0'
              description: |
                MIB: IF-MIB
                The current operational state of the interface.
                - The testing(3) state indicates that no operational packet scan be passed
                - If ifAdminStatus is down(2) then ifOperStatus should be down(2)
                - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic
                - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)
                - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state
                - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.
              valuemap:
                name: 'IF-MIB::ifOperStatus'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: 7b3d635ed17b41fc9ac242f2e010be65
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
                  name: 'TrueNAS CORE: Interface {#IFNAME}({#IFALIAS}): Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. It can be triggered if the operations status is down.
                    2. `{$IFCONTROL:"{#IFNAME}"}=1` - a user can redefine the context macro to "0", marking this interface as not important. No new trigger will be fired if this interface is down.
                    3. `last(/TEMPLATE_NAME/METRIC,#1)<>last(/TEMPLATE_NAME/METRIC,#2)` - the trigger fires only if the operational status was up to (1) sometime before (so, does not fire for "eternal off" interfaces.)
                    
                    WARNING: if closed manually - it will not fire again on the next poll, because of .diff.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: ed51f6b579b040088312d9312378ed4a
              name: 'Interface {#IFNAME}({#IFALIAS}): Interface type'
              type: DEPENDENT
              key: 'net.if.type[ifType.{#SNMPINDEX}]'
              trends: '0'
              description: |
                MIB: IF-MIB
                The type of interface.
                Additional values for ifType are assigned by the Internet Assigned Numbers Authority (IANA),
                through updating the syntax of the IANAifType textual convention.
              valuemap:
                name: 'IF-MIB::ifType'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.3.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
          trigger_prototypes:
            - uuid: 486e833486c240379f6c7cb34172a402
              expression: |
                change(/TrueNAS CORE by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])<0 and last(/TrueNAS CORE by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
                and (
                last(/TrueNAS CORE by SNMP/net.if.type[ifType.{#SNMPINDEX}])=6 or
                last(/TrueNAS CORE by SNMP/net.if.type[ifType.{#SNMPINDEX}])=7 or
                last(/TrueNAS CORE by SNMP/net.if.type[ifType.{#SNMPINDEX}])=11 or
                last(/TrueNAS CORE by SNMP/net.if.type[ifType.{#SNMPINDEX}])=62 or
                last(/TrueNAS CORE by SNMP/net.if.type[ifType.{#SNMPINDEX}])=69 or
                last(/TrueNAS CORE by SNMP/net.if.type[ifType.{#SNMPINDEX}])=117
                )
                and
                (last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2)
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                (change(/TrueNAS CORE by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0 and last(/TrueNAS CORE by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}],#2)>0) or
                (last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2)
              name: 'TrueNAS CORE: Interface {#IFNAME}({#IFALIAS}): Ethernet has changed to lower speed than it was before'
              opdata: 'Current reported speed: {ITEM.LASTVALUE1}'
              priority: INFO
              description: 'This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              dependencies:
                - name: 'TrueNAS CORE: Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: performance
            - uuid: 3b6a73abbc7943c687d579acedb84393
              expression: |
                (avg(/TrueNAS CORE by SNMP/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/TrueNAS CORE by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) or
                avg(/TrueNAS CORE by SNMP/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/TrueNAS CORE by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])) and
                last(/TrueNAS CORE by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/TrueNAS CORE by SNMP/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/TrueNAS CORE by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) and
                avg(/TrueNAS CORE by SNMP/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/TrueNAS CORE by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])
              name: 'TrueNAS CORE: Interface {#IFNAME}({#IFALIAS}): High bandwidth usage'
              event_name: 'TrueNAS CORE: Interface {#IFNAME}({#IFALIAS}): High bandwidth usage (>{$IF.UTIL.MAX:"{#IFNAME}"}%)'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'The utilization of the network interface is close to its estimated maximum bandwidth.'
              manual_close: 'YES'
              dependencies:
                - name: 'TrueNAS CORE: Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: performance
            - uuid: 8ebbfbdd56984e4eb8f52f730aaca429
              expression: |
                min(/TrueNAS CORE by SNMP/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
                or min(/TrueNAS CORE by SNMP/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/TrueNAS CORE by SNMP/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/TrueNAS CORE by SNMP/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'TrueNAS CORE: Interface {#IFNAME}({#IFALIAS}): High error rate'
              event_name: 'TrueNAS CORE: Interface {#IFNAME}({#IFALIAS}): High error rate (>{$IF.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'It recovers when it is below 80% of the `{$IF.ERRORS.WARN:"{#IFNAME}"}` threshold.'
              manual_close: 'YES'
              dependencies:
                - name: 'TrueNAS CORE: Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/TrueNAS CORE by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
          graph_prototypes:
            - uuid: dacff40c560e41529c48d9025104b2bb
              name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
                - sortorder: '1'
                  drawtype: BOLD_LINE
                  color: F63100
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
                - sortorder: '2'
                  color: 00611C
                  yaxisside: RIGHT
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
                - sortorder: '3'
                  color: F7941D
                  yaxisside: RIGHT
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
                - sortorder: '4'
                  color: FC6EA3
                  yaxisside: RIGHT
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
                - sortorder: '5'
                  color: 6C59DC
                  yaxisside: RIGHT
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
          master_item:
            key: net.if.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#IFOPERSTATUS}'
                - 1.3.6.1.2.1.2.2.1.8
                - '0'
                - '{#IFADMINSTATUS}'
                - 1.3.6.1.2.1.2.2.1.7
                - '0'
                - '{#IFALIAS}'
                - 1.3.6.1.2.1.31.1.1.1.18
                - '0'
                - '{#IFNAME}'
                - 1.3.6.1.2.1.31.1.1.1.1
                - '0'
                - '{#IFDESCR}'
                - 1.3.6.1.2.1.2.2.1.2
                - '0'
                - '{#IFTYPE}'
                - 1.3.6.1.2.1.2.2.1.3
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: b3906a308e4c4631a96a4aa188d22c74
          name: 'Disks temperature discovery'
          type: DEPENDENT
          key: truenas.disk.temp.discovery
          description: 'Disks temperature discovery from FREENAS-MIB.'
          item_prototypes:
            - uuid: 7de2508fff174bd78b4ea0424a67fbf9
              name: 'Disk [{#DISK_NAME}]'': Temperature'
              type: DEPENDENT
              key: 'truenas.disk.temp[{#DISK_NAME}]'
              value_type: FLOAT
              units: C
              description: |
                MIB: FREENAS-MIB
                The temperature of this HDD in mC.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.50536.3.1.3.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '0.001'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: truenas.disk.temp.walk
              tags:
                - tag: component
                  value: storage
                - tag: disk
                  value: '{#DISK_NAME}'
              trigger_prototypes:
                - uuid: fda99a2e62064414af85c1137cbf0aef
                  expression: 'avg(/TrueNAS CORE by SNMP/truenas.disk.temp[{#DISK_NAME}],5m) > {$TEMPERATURE.MAX.CRIT:"{#DISK_NAME}"}'
                  name: 'TrueNAS CORE: Disk [{#DISK_NAME}]'': Average disk temperature is too high'
                  event_name: 'TrueNAS CORE: Disk [{#DISK_NAME}]'': Average disk temperature is too high (over {$TEMPERATURE.MAX.CRIT:"{#DISK_NAME}"}C for 5m)'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Disk temperature is high.'
                  tags:
                    - tag: scope
                      value: notice
                - uuid: 73194e7637a84dca976b218e9f4248c2
                  expression: 'avg(/TrueNAS CORE by SNMP/truenas.disk.temp[{#DISK_NAME}],5m) > {$TEMPERATURE.MAX.WARN:"{#DISK_NAME}"}'
                  name: 'TrueNAS CORE: Disk [{#DISK_NAME}]'': Average disk temperature is too high'
                  event_name: 'TrueNAS CORE: Disk [{#DISK_NAME}]'': Average disk temperature is too high (over {$TEMPERATURE.MAX.WARN:"{#DISK_NAME}"}C for 5m)'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Disk temperature is high.'
                  tags:
                    - tag: scope
                      value: notice
          graph_prototypes:
            - uuid: 0334f7b454644a7cb25864a67dfbf158
              name: 'Disk [{#DISK_NAME}]'': Temperature'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'truenas.disk.temp[{#DISK_NAME}]'
          master_item:
            key: truenas.disk.temp.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#DISK_NAME}'
                - 1.3.6.1.4.1.50536.3.1.2
                - '0'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        - uuid: f3d22d302e274b12927afd9453bb787a
          name: 'ZFS datasets discovery'
          type: DEPENDENT
          key: truenas.zfs.dataset.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#DATASET_NAME}'
                value: '{$DATASET.NAME.MATCHES}'
              - macro: '{#DATASET_NAME}'
                value: '{$DATASET.NAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          description: 'ZFS datasets discovery from FREENAS-MIB.'
          item_prototypes:
            - uuid: 3c3eab95b8e74e608fe3b7abab98c76b
              name: 'Dataset [{#DATASET_NAME}]: Available space'
              type: DEPENDENT
              key: 'truenas.dataset.avail[{#DATASET_NAME}]'
              units: B
              description: |
                MIB: FREENAS-MIB
                The available size of the dataset in bytes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.50536.1.2.1.1.6.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '{#DATASET_ALLOC_UNITS}'
              master_item:
                key: truenas.zfs.dataset.walk
              tags:
                - tag: component
                  value: storage
                - tag: dataset
                  value: '{#DATASET_NAME}'
            - uuid: fd6b3a3ebfb041b3a9026fb1b4370ec7
              name: 'Dataset [{#DATASET_NAME}]: Usage in %'
              type: CALCULATED
              key: 'truenas.dataset.pused[{#DATASET_NAME}]'
              value_type: FLOAT
              units: '%'
              params: 'last(//truenas.dataset.used[{#DATASET_NAME}]) * 100 / last(//truenas.dataset.size.total[{#DATASET_NAME}])'
              description: 'The used size of the dataset in %.'
              tags:
                - tag: component
                  value: storage
                - tag: dataset
                  value: '{#DATASET_NAME}'
            - uuid: 5ead1929891a4152b581f9adf35ce4ce
              name: 'Dataset [{#DATASET_NAME}]: Total space'
              type: DEPENDENT
              key: 'truenas.dataset.size.total[{#DATASET_NAME}]'
              units: B
              description: |
                MIB: FREENAS-MIB
                The size of the dataset in bytes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.50536.1.2.1.1.4.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '{#DATASET_ALLOC_UNITS}'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: truenas.zfs.dataset.walk
              tags:
                - tag: component
                  value: storage
                - tag: dataset
                  value: '{#DATASET_NAME}'
            - uuid: 0e24fceacd64430abed01294ffd28104
              name: 'Dataset [{#DATASET_NAME}]: Used space'
              type: DEPENDENT
              key: 'truenas.dataset.used[{#DATASET_NAME}]'
              units: B
              description: |
                MIB: FREENAS-MIB
                The used size of the dataset in bytes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.50536.1.2.1.1.5.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '{#DATASET_ALLOC_UNITS}'
              master_item:
                key: truenas.zfs.dataset.walk
              tags:
                - tag: component
                  value: storage
                - tag: dataset
                  value: '{#DATASET_NAME}'
          trigger_prototypes:
            - uuid: f759e058ef5345d884662f51db0c222e
              expression: 'min(/TrueNAS CORE by SNMP/truenas.dataset.pused[{#DATASET_NAME}],5m) > {$DATASET.PUSED.MAX.WARN:"{#DATASET_NAME}"} and last(/TrueNAS CORE by SNMP/truenas.dataset.avail[{#DATASET_NAME}]) < {$DATASET.FREE.MIN.WARN:"{#POOLNAME}"}'
              name: 'TrueNAS CORE: Dataset [{#DATASET_NAME}]: High space usage'
              event_name: 'TrueNAS CORE: Dataset [{#DATASET_NAME}]: High space usage (more than {$DATASET.PUSED.MAX.WARN:"{#DATASET_NAME}"}% used)'
              opdata: 'Current usage: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: |
                Two conditions should match:
                1. The first condition - utilization of the space should be above `{$DATASET.PUSED.MAX.WARN:"{#DATASET_NAME}"}%.`
                2. The second condition - the dataset free space is less than `{$DATASET.FREE.MIN.WARN:"{#POOLNAME}"}`.
              dependencies:
                - name: 'TrueNAS CORE: Dataset [{#DATASET_NAME}]: Very high space usage'
                  expression: 'min(/TrueNAS CORE by SNMP/truenas.dataset.pused[{#DATASET_NAME}],5m) > {$DATASET.PUSED.MAX.CRIT:"{#DATASET_NAME}"} and last(/TrueNAS CORE by SNMP/truenas.dataset.avail[{#DATASET_NAME}]) < {$DATASET.FREE.MIN.CRIT:"{#POOLNAME}"}'
              tags:
                - tag: scope
                  value: capacity
                - tag: scope
                  value: performance
            - uuid: f0e37c1f63aa4e3090c0dc8c4f0dfe9b
              expression: 'min(/TrueNAS CORE by SNMP/truenas.dataset.pused[{#DATASET_NAME}],5m) > {$DATASET.PUSED.MAX.CRIT:"{#DATASET_NAME}"} and last(/TrueNAS CORE by SNMP/truenas.dataset.avail[{#DATASET_NAME}]) < {$DATASET.FREE.MIN.CRIT:"{#POOLNAME}"}'
              name: 'TrueNAS CORE: Dataset [{#DATASET_NAME}]: Very high space usage'
              event_name: 'TrueNAS CORE: Dataset [{#DATASET_NAME}]: Very high space usage (more than {$DATASET.PUSED.MAX.CRIT:"{#DATASET_NAME}"}% used)'
              opdata: 'Current usage: {ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: |
                Two conditions should match:
                1. The first condition - utilization of the space should be above `{$DATASET.PUSED.MAX.CRIT:"{#DATASET_NAME}"}%.`
                2. The second condition - the dataset free space is less than `{$DATASET.FREE.MIN.CRIT:"{#POOLNAME}"}`.
              tags:
                - tag: scope
                  value: capacity
                - tag: scope
                  value: performance
          graph_prototypes:
            - uuid: 38637298316543bdb9f2c291285f8077
              name: 'Dataset [{#DATASET_NAME}]: Space usage'
              width: '600'
              height: '340'
              type: PIE
              show_3d: 'YES'
              graph_items:
                - color: '969696'
                  calc_fnc: LAST
                  type: GRAPH_SUM
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'truenas.dataset.size.total[{#DATASET_NAME}]'
                - sortorder: '1'
                  color: C80000
                  calc_fnc: LAST
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'truenas.dataset.used[{#DATASET_NAME}]'
          master_item:
            key: truenas.zfs.dataset.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#DATASET_NAME}'
                - 1.3.6.1.4.1.50536.1.2.1.1.2
                - '0'
                - '{#DATASET_ALLOC_UNITS}'
                - 1.3.6.1.4.1.50536.1.2.1.1.3
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        - uuid: edde9729f6304a9b83d31a1c62356fdd
          name: 'ZFS pools discovery'
          type: DEPENDENT
          key: truenas.zfs.pools.discovery
          description: 'ZFS pools discovery from FREENAS-MIB.'
          item_prototypes:
            - uuid: 2727c62d279f46b0938b1ef6c3b70fe5
              name: 'Pool [{#POOLNAME}]: Available space'
              type: DEPENDENT
              key: 'truenas.zpool.avail[{#POOLNAME}]'
              units: B
              description: |
                MIB: FREENAS-MIB
                The available size of the storage pool in bytes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.50536.1.1.1.1.6.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '{#POOL_ALLOC_UNITS}'
              master_item:
                key: truenas.zfs.pools.walk
              tags:
                - tag: component
                  value: storage
                - tag: pool
                  value: '{#POOLNAME}'
            - uuid: 382c3a50845f4d96a44dc22704768d41
              name: 'Pool [{#POOLNAME}]: Health'
              type: DEPENDENT
              key: 'truenas.zpool.health[{#POOLNAME}]'
              description: |
                MIB: FREENAS-MIB
                The current health of the containing pool, as reported by zpool status.
              valuemap:
                name: 'FREENAS-MIB::ZPoolHealthType'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.50536.1.1.1.1.7.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: truenas.zfs.pools.walk
              tags:
                - tag: component
                  value: health
                - tag: component
                  value: storage
                - tag: pool
                  value: '{#POOLNAME}'
              trigger_prototypes:
                - uuid: 676c2abdd102484a92db3501ccc2ca51
                  expression: 'last(/TrueNAS CORE by SNMP/truenas.zpool.health[{#POOLNAME}]) <> 0'
                  name: 'TrueNAS CORE: Pool [{#POOLNAME}]: Status is not online'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Please check pool status.'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 5f972063f958463ab132b8d478092bd8
              name: 'Pool [{#POOLNAME}]: Usage in %'
              type: CALCULATED
              key: 'truenas.zpool.pused[{#POOLNAME}]'
              value_type: FLOAT
              units: '%'
              params: 'last(//truenas.zpool.used[{#POOLNAME}]) * 100 / last(//truenas.zpool.size.total[{#POOLNAME}])'
              description: 'The used size of the storage pool in %.'
              tags:
                - tag: component
                  value: storage
                - tag: pool
                  value: '{#POOLNAME}'
            - uuid: b5766173631a47ee8c58e24f5c0523b5
              name: 'Pool [{#POOLNAME}]: Read rate'
              type: DEPENDENT
              key: 'truenas.zpool.read.bytes[{#POOLNAME}]'
              value_type: FLOAT
              units: Bps
              description: |
                MIB: FREENAS-MIB
                The bandwidth of all read operations (including metadata), expressed as units per second (averaged since system booted).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.50536.1.1.1.1.10.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '{#POOL_ALLOC_UNITS}'
                - type: CHANGE_PER_SECOND
              master_item:
                key: truenas.zfs.pools.walk
              tags:
                - tag: component
                  value: storage
                - tag: pool
                  value: '{#POOLNAME}'
            - uuid: f32abc8617c6466d8a92219def967bd8
              name: 'Pool [{#POOLNAME}]: Read operations rate'
              type: DEPENDENT
              key: 'truenas.zpool.read.ops[{#POOLNAME}]'
              value_type: FLOAT
              units: IOPS
              description: |
                MIB: FREENAS-MIB
                The number of read I/O operations sent to the pool or device, including metadata requests (averaged since system booted).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.50536.1.1.1.1.8.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
              master_item:
                key: truenas.zfs.pools.walk
              tags:
                - tag: component
                  value: storage
                - tag: pool
                  value: '{#POOLNAME}'
            - uuid: 567422ecdcec49faac94540f64a05e3a
              name: 'Pool [{#POOLNAME}]: Total space'
              type: DEPENDENT
              key: 'truenas.zpool.size.total[{#POOLNAME}]'
              units: B
              description: |
                MIB: FREENAS-MIB
                The size of the storage pool in bytes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.50536.1.1.1.1.4.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '{#POOL_ALLOC_UNITS}'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: truenas.zfs.pools.walk
              tags:
                - tag: component
                  value: storage
                - tag: pool
                  value: '{#POOLNAME}'
            - uuid: fe5cf78cdcdd4386982f5cd204d99283
              name: 'Pool [{#POOLNAME}]: Used space'
              type: DEPENDENT
              key: 'truenas.zpool.used[{#POOLNAME}]'
              units: B
              description: |
                MIB: FREENAS-MIB
                The used size of the storage pool in bytes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.50536.1.1.1.1.5.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '{#POOL_ALLOC_UNITS}'
              master_item:
                key: truenas.zfs.pools.walk
              tags:
                - tag: component
                  value: storage
                - tag: pool
                  value: '{#POOLNAME}'
            - uuid: d11e981ec16c4da0aee6842bdddfe2fd
              name: 'Pool [{#POOLNAME}]: Write rate'
              type: DEPENDENT
              key: 'truenas.zpool.write.bytes[{#POOLNAME}]'
              value_type: FLOAT
              units: Bps
              description: |
                MIB: FREENAS-MIB
                The bandwidth of all write operations, expressed as units per second (averaged since system booted).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.50536.1.1.1.1.11.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '{#POOL_ALLOC_UNITS}'
                - type: CHANGE_PER_SECOND
              master_item:
                key: truenas.zfs.pools.walk
              tags:
                - tag: component
                  value: storage
                - tag: pool
                  value: '{#POOLNAME}'
            - uuid: e4bfc421633a433ca1b895fa4f5cf96e
              name: 'Pool [{#POOLNAME}]: Write operations rate'
              type: DEPENDENT
              key: 'truenas.zpool.write.ops[{#POOLNAME}]'
              value_type: FLOAT
              units: IOPS
              description: |
                MIB: FREENAS-MIB
                The number of write I/O operations sent to the pool or device (averaged since system booted).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.50536.1.1.1.1.9.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
              master_item:
                key: truenas.zfs.pools.walk
              tags:
                - tag: component
                  value: storage
                - tag: pool
                  value: '{#POOLNAME}'
          trigger_prototypes:
            - uuid: 18eef491c14b4f768400b4acca5c7e80
              expression: 'min(/TrueNAS CORE by SNMP/truenas.zpool.pused[{#POOLNAME}],5m) > {$ZPOOL.PUSED.MAX.WARN:"{#POOLNAME}"} and last(/TrueNAS CORE by SNMP/truenas.zpool.avail[{#POOLNAME}]) < {$ZPOOL.FREE.MIN.WARN:"{#POOLNAME}"}'
              name: 'TrueNAS CORE: Pool [{#POOLNAME}]: High space usage'
              event_name: 'TrueNAS CORE: Pool [{#POOLNAME}]: High space usage (more than {$ZPOOL.PUSED.MAX.WARN:"{#POOLNAME}"}% used)'
              opdata: 'Current usage: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: |
                Two conditions should match:
                1. The first condition - utilization of the space should be above `{$ZPOOL.PUSED.MAX.WARN:"{#POOLNAME}"}%.`
                2. The second condition - the pool free space is less than `{$ZPOOL.FREE.MIN.WARN:"{#POOLNAME}"}`.
              dependencies:
                - name: 'TrueNAS CORE: Pool [{#POOLNAME}]: Very high space usage'
                  expression: 'min(/TrueNAS CORE by SNMP/truenas.zpool.pused[{#POOLNAME}],5m) > {$ZPOOL.PUSED.MAX.CRIT:"{#POOLNAME}"} and last(/TrueNAS CORE by SNMP/truenas.zpool.avail[{#POOLNAME}]) < {$ZPOOL.FREE.MIN.CRIT:"{#POOLNAME}"}'
              tags:
                - tag: scope
                  value: capacity
                - tag: scope
                  value: performance
            - uuid: ab01140b8a724c1cbb79be032de8c8b5
              expression: 'min(/TrueNAS CORE by SNMP/truenas.zpool.pused[{#POOLNAME}],5m) > {$ZPOOL.PUSED.MAX.CRIT:"{#POOLNAME}"} and last(/TrueNAS CORE by SNMP/truenas.zpool.avail[{#POOLNAME}]) < {$ZPOOL.FREE.MIN.CRIT:"{#POOLNAME}"}'
              name: 'TrueNAS CORE: Pool [{#POOLNAME}]: Very high space usage'
              event_name: 'TrueNAS CORE: Pool [{#POOLNAME}]: Very high space usage (more than {$ZPOOL.PUSED.MAX.CRIT:"{#POOLNAME}"}% used)'
              opdata: 'Current usage: {ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: |
                Two conditions should match:
                1. The first condition - utilization of the space should be above `{$ZPOOL.PUSED.MAX.CRIT:"{#POOLNAME}"}%.`
                2. The second condition - the pool free space is less than `{$ZPOOL.FREE.MIN.CRIT:"{#POOLNAME}"}`.
              tags:
                - tag: scope
                  value: capacity
                - tag: scope
                  value: performance
          graph_prototypes:
            - uuid: 8c2ed6ea842941b3b306efe87df844be
              name: 'Pool [{#POOLNAME}]: Read/write rates'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'truenas.zpool.read.bytes[{#POOLNAME}]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: F63100
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'truenas.zpool.write.bytes[{#POOLNAME}]'
            - uuid: 497e60420e314ec3a3de904042ae4756
              name: 'Pool [{#POOLNAME}]: Space usage'
              width: '600'
              height: '340'
              type: PIE
              show_3d: 'YES'
              graph_items:
                - color: '969696'
                  calc_fnc: LAST
                  type: GRAPH_SUM
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'truenas.zpool.size.total[{#POOLNAME}]'
                - sortorder: '1'
                  color: C80000
                  calc_fnc: LAST
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'truenas.zpool.used[{#POOLNAME}]'
          master_item:
            key: truenas.zfs.pools.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#POOLNAME}'
                - 1.3.6.1.4.1.50536.1.1.1.1.2
                - '0'
                - '{#POOL_ALLOC_UNITS}'
                - 1.3.6.1.4.1.50536.1.1.1.1.3
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        - uuid: dfeb1df58c024b27a0a65206d896975c
          name: 'ZFS volumes discovery'
          type: DEPENDENT
          key: truenas.zfs.zvols.discovery
          description: 'ZFS volumes discovery from FREENAS-MIB.'
          item_prototypes:
            - uuid: 26967102b3a946c997fbbdcc5c2d78bc
              name: 'TrueNAS CORE: ZFS volume [{#ZVOL_NAME}]: Available space'
              type: DEPENDENT
              key: 'truenas.zvol.avail[{#ZVOL_NAME}]'
              units: B
              description: |
                MIB: FREENAS-MIB
                The available of the ZFS volume in bytes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.50536.1.3.1.1.6.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '{#ZVOL_ALLOC_UNITS}'
              master_item:
                key: truenas.zfs.zvols.walk
              tags:
                - tag: component
                  value: storage
                - tag: volume
                  value: '{#ZVOL_NAME}'
            - uuid: cc01786aff804d6998b039525214ddbd
              name: 'TrueNAS CORE: ZFS volume [{#ZVOL_NAME}]: Total space'
              type: DEPENDENT
              key: 'truenas.zvol.size.total[{#ZVOL_NAME}]'
              units: B
              description: |
                MIB: FREENAS-MIB
                The size of the ZFS volume in bytes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.50536.1.3.1.1.4.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '{#ZVOL_ALLOC_UNITS}'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: truenas.zfs.zvols.walk
              tags:
                - tag: component
                  value: storage
                - tag: volume
                  value: '{#ZVOL_NAME}'
            - uuid: a722d904125d46729c29ad4283d0b1b0
              name: 'TrueNAS CORE: ZFS volume [{#ZVOL_NAME}]: Used space'
              type: DEPENDENT
              key: 'truenas.zvol.used[{#ZVOL_NAME}]'
              units: B
              description: |
                MIB: FREENAS-MIB
                The used size of the ZFS volume in bytes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.50536.1.3.1.1.5.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '{#ZVOL_ALLOC_UNITS}'
              master_item:
                key: truenas.zfs.zvols.walk
              tags:
                - tag: component
                  value: storage
                - tag: volume
                  value: '{#ZVOL_NAME}'
          graph_prototypes:
            - uuid: 18746b4b3cfb4d1baf06df7b05a047f9
              name: 'TrueNAS CORE: ZFS volume [{#ZVOL_NAME}]: Space usage'
              width: '600'
              height: '340'
              type: PIE
              show_3d: 'YES'
              graph_items:
                - color: '969696'
                  calc_fnc: LAST
                  type: GRAPH_SUM
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'truenas.zvol.size.total[{#ZVOL_NAME}]'
                - sortorder: '1'
                  color: C80000
                  calc_fnc: LAST
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'truenas.zvol.used[{#ZVOL_NAME}]'
          master_item:
            key: truenas.zfs.zvols.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#ZVOL_NAME}'
                - 1.3.6.1.4.1.50536.1.3.1.1.2
                - '0'
                - '{#ZVOL_ALLOC_UNITS}'
                - 1.3.6.1.4.1.50536.1.3.1.1.3
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
        - uuid: 1f992aa87f9e4074a8cba928b2017a03
          name: 'Block devices discovery'
          type: DEPENDENT
          key: vfs.dev.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#DEVNAME}'
                value: '{$VFS.DEV.DEVNAME.MATCHES}'
              - macro: '{#DEVNAME}'
                value: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          description: 'Block devices are discovered from UCD-DISKIO-MIB::diskIOTable (http://net-snmp.sourceforge.net/docs/mibs/ucdDiskIOMIB.html#diskIOTable).'
          item_prototypes:
            - uuid: ba220c4106cb4bff9dd60c92aee7919a
              name: 'TrueNAS CORE: [{#DEVNAME}]: Disk read rate'
              type: DEPENDENT
              key: 'vfs.dev.read.rate[{#SNMPINDEX}]'
              value_type: FLOAT
              units: '!r/s'
              description: |
                MIB: UCD-DISKIO-MIB
                The number of read accesses from this device since boot.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.2021.13.15.1.1.5.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
              master_item:
                key: vfs.dev.walk
              tags:
                - tag: component
                  value: storage
                - tag: disk
                  value: '{#DEVNAME}'
            - uuid: 0dd2f25f1d2a45f2ae265d8550fe7d45
              name: 'TrueNAS CORE: [{#DEVNAME}]: Disk utilization'
              type: DEPENDENT
              key: 'vfs.dev.util[{#SNMPINDEX}]'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-DISKIO-MIB
                The 1 minute average load of disk (%).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.2021.13.15.1.1.9.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: vfs.dev.walk
              tags:
                - tag: component
                  value: storage
                - tag: disk
                  value: '{#DEVNAME}'
            - uuid: 1549def5cf23434b8d0a19ac951eb2ff
              name: 'TrueNAS CORE: [{#DEVNAME}]: Disk write rate'
              type: DEPENDENT
              key: 'vfs.dev.write.rate[{#SNMPINDEX}]'
              value_type: FLOAT
              units: '!w/s'
              description: |
                MIB: UCD-DISKIO-MIB
                The number of write accesses from this device since boot.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.2021.13.15.1.1.6.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
              master_item:
                key: vfs.dev.walk
              tags:
                - tag: component
                  value: storage
                - tag: disk
                  value: '{#DEVNAME}'
          graph_prototypes:
            - uuid: c6e277b4a9e949df9e7bfd6adefc65b5
              name: 'TrueNAS CORE: [{#DEVNAME}]: Read/write rates'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'vfs.dev.read.rate[{#SNMPINDEX}]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: F63100
                  item:
                    host: 'TrueNAS CORE by SNMP'
                    key: 'vfs.dev.write.rate[{#SNMPINDEX}]'
          master_item:
            key: vfs.dev.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#DEVNAME}'
                - 1.3.6.1.4.1.2021.13.15.1.1.2
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
      tags:
        - tag: class
          value: hardware
        - tag: subclass
          value: backup
        - tag: target
          value: truenas-core
      macros:
        - macro: '{$CPU.UTIL.CRIT}'
          value: '90'
          description: 'Threshold of CPU utilization for warning trigger in %.'
          config:
            type: TEXT
            priority: '1'
            section_name: Thresholds
            label: 'Threshold for CPU utilization (critical)'
            description: 'Threshold of CPU utilization for warning trigger in %. In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$DATASET.FREE.MIN.CRIT}'
          value: 5G
          description: 'This macro is used for trigger expression. It can be overridden on the host or linked on the template level.'
          config:
            type: TEXT
            priority: '17'
            section_name: Thresholds
            label: 'Dataset free space minimum (critical)'
            description: 'This macro is used for trigger expression. It can be overridden on the host or linked on the template level.'
        - macro: '{$DATASET.FREE.MIN.WARN}'
          value: 5G
          description: 'This macro is used for trigger expression. It can be overridden on the host or linked on the template level.'
          config:
            type: TEXT
            priority: '15'
            section_name: Thresholds
            label: 'Dataset free space minimum (warning)'
            description: 'This macro is used for trigger expression. It can be overridden on the host or linked on the template level.'
        - macro: '{$DATASET.NAME.MATCHES}'
          value: .+
          description: 'This macro is used in datasets discovery. Can be overridden on the host or linked template level'
          config:
            type: TEXT
            priority: '8'
            section_name: Filters
            label: 'Dataset name filter (include)'
            description: 'This macro is used in datasets discovery. Can be overridden on the host or linked template level'
        - macro: '{$DATASET.NAME.NOT_MATCHES}'
          value: '^(boot|.+\.system(.+)?$)'
          description: 'This macro is used in datasets discovery. Can be overridden on the host or linked template level'
          config:
            type: TEXT
            priority: '9'
            section_name: Filters
            label: 'Dataset name filter (exclude)'
            description: 'This macro is used in datasets discovery. Can be overridden on the host or linked template level'
        - macro: '{$DATASET.PUSED.MAX.CRIT}'
          value: '90'
          description: 'Threshold of used dataset space for average severity trigger in %.'
          config:
            type: TEXT
            priority: '16'
            section_name: Thresholds
            label: 'Dataset percent used maximum (critical)'
            description: 'Threshold of used dataset space for average severity trigger in %. In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$DATASET.PUSED.MAX.WARN}'
          value: '80'
          description: 'Threshold of used dataset space for warning trigger in %.'
          config:
            type: TEXT
            priority: '14'
            section_name: Thresholds
            label: 'Dataset percent used maximum (warning)'
            description: 'Threshold of used dataset space for warning trigger in %. In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$ICMP_LOSS_WARN}'
          value: '20'
          description: 'Warning threshold of ICMP packet loss in %.'
          config:
            type: TEXT
            priority: '21'
            section_name: Thresholds
            label: 'Threshold of ICMP packet loss'
            description: 'Warning threshold of ICMP packet loss in %. In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.15'
          description: 'Warning threshold of the average ICMP response time in seconds.'
          config:
            type: TEXT
            priority: '22'
            section_name: Thresholds
            label: 'Threshold of the average ICMP response'
            description: 'Warning threshold of the average ICMP response time in seconds. No less than 0.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$IF.ERRORS.WARN}'
          value: '2'
          description: 'Warning threshold of error packet rate. Can be used with interface name as context.'
          config:
            type: TEXT
            priority: '25'
            section_name: Thresholds
            label: 'Threshold of error packet rate'
            description: 'Warning threshold of error packet rate. No less than 0.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$IF.UTIL.MAX}'
          value: '90'
          description: 'Used as a threshold in the interface utilization trigger.'
          config:
            type: TEXT
            priority: '24'
            section_name: Thresholds
            label: 'The threshold in the interface utilization'
            description: 'Used as a threshold in the interface utilization trigger. In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$IFCONTROL}'
          value: '1'
          description: 'Link status trigger will be fired only for interfaces where the context macro equals "1".'
          config:
            type: CHECKBOX
            priority: '23'
            label: 'Interfaces control'
            description: 'Fire a trigger when the interface operational status changes to "Link down".'
            options:
              - checked: '1'
                unchecked: '0'
        - macro: '{$LOAD_AVG_PER_CPU.MAX.WARN}'
          value: '1.5'
          description: 'Load per CPU considered sustainable. Tune if needed.'
          config:
            type: TEXT
            priority: '2'
            section_name: Thresholds
            label: 'The CPU load per core'
            description: 'Load per CPU considered sustainable. Tune if needed.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$MEMORY.AVAILABLE.MIN}'
          value: 20M
          description: 'Threshold of available memory for trigger in bytes.'
          config:
            type: TEXT
            priority: '3'
            section_name: Thresholds
            label: 'Threshold for available memory'
            description: 'Threshold of available memory for trigger in bytes.'
        - macro: '{$MEMORY.UTIL.MAX}'
          value: '90'
          description: 'Threshold of memory utilization for trigger in %'
          config:
            type: TEXT
            priority: '4'
            section_name: Thresholds
            label: 'Threshold for memory utilization'
            description: 'Threshold of memory utilization for trigger in % In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
          value: '^.*'
          description: 'Used in network interface discovery rule filters.'
          config:
            type: TEXT
            priority: '30'
            section_name: Filters
            label: 'Filter network interface by adminstatus'
            description: 'Regex string to include discovered interface by adminstatus.'
        - macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
          value: ^2$
          description: 'Ignore `down(2)` administrative status'
          config:
            type: TEXT
            priority: '31'
            section_name: Filters
            label: 'Filter network interface by adminstatus (exclude)'
            description: 'Regex string to exclude discovered interface by adminstatus.'
        - macro: '{$NET.IF.IFALIAS.MATCHES}'
          value: '.*'
          description: 'Used in network interface discovery rule filters.'
          config:
            type: TEXT
            priority: '34'
            section_name: Filters
            label: 'Filter network interface by alias'
            description: 'Regex string to include discovered interface by alias.'
        - macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in network interface discovery rule filters.'
          config:
            type: TEXT
            priority: '35'
            section_name: Filters
            label: 'Filter network interface by alias (exclude)'
            description: 'Regex string to exclude discovered interface by alias.'
        - macro: '{$NET.IF.IFDESCR.MATCHES}'
          value: '.*'
          description: 'Used in network interface discovery rule filters.'
          config:
            type: TEXT
            priority: '32'
            section_name: Filters
            label: 'Filter network interface by description'
            description: 'Regex string to include discovered interface by description.'
        - macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in network interface discovery rule filters.'
          config:
            type: TEXT
            priority: '33'
            section_name: Filters
            label: 'Filter network interface by description (exclude)'
            description: 'Regex string to exclude discovered interface by description.'
        - macro: '{$NET.IF.IFNAME.MATCHES}'
          value: '^.*$'
          description: 'Used for network interface discovery. Can be overridden on the host or linked template level.'
          config:
            type: TEXT
            priority: '26'
            section_name: Filters
            label: 'Filter for network interface by name'
            description: 'Regex string to include discovered interface by name.'
        - macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
          value: '(^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12})'
          description: 'Filters out `loopbacks`, `nulls`, docker `veth` links and `docker0 bridge` by default.'
          config:
            type: TEXT
            priority: '27'
            section_name: Filters
            label: 'Filter for network interface by name (exclude)'
            description: 'Filters out `loopbacks`, `nulls`, docker `veth` links and `docker0` bridge by default.'
        - macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
          value: '^.*$'
          description: 'Used for network interface discovery. Can be overridden on the host or linked template level.'
          config:
            type: TEXT
            priority: '28'
            section_name: Filters
            label: 'Filter network interface by status'
            description: 'Regex string to include discovered interface by status.'
        - macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
          value: ^6$
          description: 'Ignore `notPresent(6)`'
          config:
            type: TEXT
            priority: '29'
            section_name: Filters
            label: 'Filter network interface by status (exclude)'
            description: 'Regex string to exclude discovered interface by status.'
        - macro: '{$NET.IF.IFTYPE.MATCHES}'
          value: '.*'
          description: 'Used in network interface discovery rule filters.'
          config:
            type: TEXT
            priority: '36'
            section_name: Filters
            label: 'Filter network interface by type'
            description: 'Regex string to include discovered interface by type.'
        - macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in network interface discovery rule filters.'
          config:
            type: TEXT
            priority: '37'
            section_name: Filters
            label: 'Filter network interface by type (exclude)'
            description: 'Regex string to exclude discovered interface by type.'
        - macro: '{$SNMP.TIMEOUT}'
          value: 5m
          description: 'Time interval for the SNMP availability trigger.'
          config:
            type: TEXT
            priority: '20'
            section_name: Other
            label: 'Time interval'
            description: 'Time interval for the SNMP availability trigger.'
        - macro: '{$SWAP.PFREE.MIN.WARN}'
          value: '50'
          description: 'Threshold of free swap space for warning trigger in %.'
          config:
            type: TEXT
            priority: '5'
            section_name: Thresholds
            label: 'Swap free space warning (%)'
            description: 'Threshold of free swap space for warning trigger in %.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$TEMPERATURE.MAX.CRIT}'
          value: '65'
          description: 'This macro is used for trigger expression. It can be overridden on the host or linked on the template level.'
          config:
            type: TEXT
            priority: '19'
            section_name: Thresholds
            label: 'Temperature maximum (critical)'
            description: 'This macro is used for trigger expression. It can be overridden on the host or linked on the template level.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$TEMPERATURE.MAX.WARN}'
          value: '50'
          description: 'This macro is used for trigger expression. It can be overridden on the host or linked on the template level.'
          config:
            type: TEXT
            priority: '18'
            section_name: Thresholds
            label: 'Temperature maximum (warning)'
            description: 'This macro is used for trigger expression. It can be overridden on the host or linked on the template level.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$VFS.DEV.DEVNAME.MATCHES}'
          value: .+
          description: 'This macro is used in block devices discovery. Can be overridden on the host or linked template level'
          config:
            type: TEXT
            priority: '6'
            section_name: Filters
            label: 'Device name filter (include)'
            description: 'This macro is used in block devices discovery. Can be overridden on the host or linked template level'
        - macro: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
          value: '^(loop[0-9]*|sd[a-z][0-9]+|nbd[0-9]+|sr[0-9]+|fd[0-9]+|dm-[0-9]+|ram[0-9]+|ploop[a-z0-9]+|md[0-9]*|hcp[0-9]*|cd[0-9]*|pass[0-9]*|zram[0-9]*)'
          description: 'This macro is used in block devices discovery. Can be overridden on the host or linked template level'
          config:
            type: TEXT
            priority: '7'
            section_name: Filters
            label: 'Device name filter (exclude)'
            description: 'This macro is used in block devices discovery. Can be overridden on the host or linked template level'
        - macro: '{$ZPOOL.FREE.MIN.CRIT}'
          value: 5G
          description: 'This macro is used for trigger expression. It can be overridden on the host or linked on the template level.'
          config:
            type: TEXT
            priority: '13'
            section_name: Thresholds
            label: 'ZPool free space minimum (critical)'
            description: 'This macro is used for trigger expression. It can be overridden on the host or linked on the template level.'
        - macro: '{$ZPOOL.FREE.MIN.WARN}'
          value: 5G
          description: 'This macro is used for trigger expression. It can be overridden on the host or linked on the template level.'
          config:
            type: TEXT
            priority: '11'
            section_name: Thresholds
            label: 'ZPool free space minimum (warning)'
            description: 'This macro is used for trigger expression. It can be overridden on the host or linked on the template level.'
        - macro: '{$ZPOOL.PUSED.MAX.CRIT}'
          value: '90'
          description: 'Threshold of used pool space for average severity trigger in %.'
          config:
            type: TEXT
            priority: '12'
            section_name: Thresholds
            label: 'ZPool percent used maximum (critical)'
            description: 'Threshold of used pool space for average severity trigger in %. In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$ZPOOL.PUSED.MAX.WARN}'
          value: '80'
          description: 'Threshold of used pool space for warning trigger in %.'
          config:
            type: TEXT
            priority: '10'
            section_name: Thresholds
            label: 'ZPool percent used maximum (warning)'
            description: 'Threshold of used pool space for warning trigger in %. In the range from 0 to 100 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
      dashboards:
        - uuid: 6db6fb2b5fe04a7095fcbec6e70e76e1
          name: 'TrueNAS CORE: Overview'
          pages:
            - name: Resources
              widgets:
                - type: graph
                  width: '72'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'TrueNAS CORE by SNMP'
                        name: 'TrueNAS CORE: Memory utilization'
                    - type: STRING
                      name: reference
                      value: AAAAA
                - type: graph
                  'y': '5'
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'TrueNAS CORE by SNMP'
                        name: 'TrueNAS CORE: Memory usage'
                    - type: STRING
                      name: reference
                      value: AAAAB
                - type: graphprototype
                  'y': '10'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'TrueNAS CORE by SNMP'
                        name: 'TrueNAS CORE: CPU usage{#SINGLETON}'
                    - type: STRING
                      name: reference
                      value: AAAAD
                - type: graphprototype
                  'y': '15'
                  width: '36'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'TrueNAS CORE by SNMP'
                        name: 'TrueNAS CORE: CPU utilization{#SINGLETON}'
                    - type: STRING
                      name: reference
                      value: AAAAE
                - type: graph
                  'y': '20'
                  width: '72'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'TrueNAS CORE by SNMP'
                        name: 'TrueNAS CORE: CPU jumps'
                    - type: STRING
                      name: reference
                      value: AAAAG
                - type: graph
                  x: '36'
                  'y': '5'
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'TrueNAS CORE by SNMP'
                        name: 'TrueNAS CORE: Swap usage'
                    - type: STRING
                      name: reference
                      value: AAAAC
                - type: graph
                  x: '36'
                  'y': '15'
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'TrueNAS CORE by SNMP'
                        name: 'TrueNAS CORE: System load'
                    - type: STRING
                      name: reference
                      value: AAAAF
            - name: Disks
              widgets:
                - type: graphprototype
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'TrueNAS CORE by SNMP'
                        name: 'TrueNAS CORE: [{#DEVNAME}]: Read/write rates'
                    - type: STRING
                      name: reference
                      value: AAAAH
                - type: graphprototype
                  'y': '5'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'TrueNAS CORE by SNMP'
                        name: 'Disk [{#DISK_NAME}]'': Temperature'
                    - type: STRING
                      name: reference
                      value: AAAAI
            - name: ZFS
              widgets:
                - type: graph
                  width: '72'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'TrueNAS CORE by SNMP'
                        name: 'TrueNAS CORE: ARC hit ratio'
                    - type: STRING
                      name: reference
                      value: AAAAJ
                - type: graphprototype
                  'y': '5'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'TrueNAS CORE by SNMP'
                        name: 'Pool [{#POOLNAME}]: Space usage'
                    - type: STRING
                      name: reference
                      value: AAAAK
                - type: graphprototype
                  'y': '10'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'TrueNAS CORE by SNMP'
                        name: 'Pool [{#POOLNAME}]: Read/write rates'
                    - type: STRING
                      name: reference
                      value: AAAAL
                - type: graphprototype
                  'y': '15'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'TrueNAS CORE by SNMP'
                        name: 'TrueNAS CORE: ZFS volume [{#ZVOL_NAME}]: Space usage'
                    - type: STRING
                      name: reference
                      value: AAAAM
                - type: graphprototype
                  'y': '20'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'TrueNAS CORE by SNMP'
                        name: 'Dataset [{#DATASET_NAME}]: Space usage'
                    - type: STRING
                      name: reference
                      value: AAAAN
            - name: 'Network interfaces'
              widgets:
                - type: graphprototype
                  width: '72'
                  height: '10'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'TrueNAS CORE by SNMP'
                        name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
                    - type: STRING
                      name: reference
                      value: AAAAO
      valuemaps:
        - uuid: 1ce70fc8edf2449ea6a0c687f359441a
          name: 'FREENAS-MIB::ZPoolHealthType'
          mappings:
            - value: '0'
              newvalue: online
            - value: '1'
              newvalue: degraded
            - value: '2'
              newvalue: faulted
            - value: '3'
              newvalue: offline
            - value: '4'
              newvalue: unavail
            - value: '5'
              newvalue: removed
        - uuid: 8206c1b8a10840c0908b34c95f8ba4b3
          name: 'IF-MIB::ifOperStatus'
          mappings:
            - value: '1'
              newvalue: up
            - value: '2'
              newvalue: down
            - value: '4'
              newvalue: unknown
            - value: '5'
              newvalue: dormant
            - value: '6'
              newvalue: notPresent
            - value: '7'
              newvalue: lowerLayerDown
        - uuid: f5115f963d0043f6b76ebbd27aaba600
          name: 'IF-MIB::ifType'
          mappings:
            - value: '1'
              newvalue: other
            - value: '2'
              newvalue: regular1822
            - value: '3'
              newvalue: hdh1822
            - value: '4'
              newvalue: ddnX25
            - value: '5'
              newvalue: rfc877x25
            - value: '6'
              newvalue: ethernetCsmacd
            - value: '7'
              newvalue: iso88023Csmacd
            - value: '8'
              newvalue: iso88024TokenBus
            - value: '9'
              newvalue: iso88025TokenRing
            - value: '10'
              newvalue: iso88026Man
            - value: '11'
              newvalue: starLan
            - value: '12'
              newvalue: proteon10Mbit
            - value: '13'
              newvalue: proteon80Mbit
            - value: '14'
              newvalue: hyperchannel
            - value: '15'
              newvalue: fddi
            - value: '16'
              newvalue: lapb
            - value: '17'
              newvalue: sdlc
            - value: '18'
              newvalue: ds1
            - value: '19'
              newvalue: e1
            - value: '20'
              newvalue: basicISDN
            - value: '21'
              newvalue: primaryISDN
            - value: '22'
              newvalue: propPointToPointSerial
            - value: '23'
              newvalue: ppp
            - value: '24'
              newvalue: softwareLoopback
            - value: '25'
              newvalue: eon
            - value: '26'
              newvalue: ethernet3Mbit
            - value: '27'
              newvalue: nsip
            - value: '28'
              newvalue: slip
            - value: '29'
              newvalue: ultra
            - value: '30'
              newvalue: ds3
            - value: '31'
              newvalue: sip
            - value: '32'
              newvalue: frameRelay
            - value: '33'
              newvalue: rs232
            - value: '34'
              newvalue: para
            - value: '35'
              newvalue: arcnet
            - value: '36'
              newvalue: arcnetPlus
            - value: '37'
              newvalue: atm
            - value: '38'
              newvalue: miox25
            - value: '39'
              newvalue: sonet
            - value: '40'
              newvalue: x25ple
            - value: '41'
              newvalue: iso88022llc
            - value: '42'
              newvalue: localTalk
            - value: '43'
              newvalue: smdsDxi
            - value: '44'
              newvalue: frameRelayService
            - value: '45'
              newvalue: v35
            - value: '46'
              newvalue: hssi
            - value: '47'
              newvalue: hippi
            - value: '48'
              newvalue: modem
            - value: '49'
              newvalue: aal5
            - value: '50'
              newvalue: sonetPath
            - value: '51'
              newvalue: sonetVT
            - value: '52'
              newvalue: smdsIcip
            - value: '53'
              newvalue: propVirtual
            - value: '54'
              newvalue: propMultiplexor
            - value: '55'
              newvalue: ieee80212
            - value: '56'
              newvalue: fibreChannel
            - value: '57'
              newvalue: hippiInterface
            - value: '58'
              newvalue: frameRelayInterconnect
            - value: '59'
              newvalue: aflane8023
            - value: '60'
              newvalue: aflane8025
            - value: '61'
              newvalue: cctEmul
            - value: '62'
              newvalue: fastEther
            - value: '63'
              newvalue: isdn
            - value: '64'
              newvalue: v11
            - value: '65'
              newvalue: v36
            - value: '66'
              newvalue: g703at64k
            - value: '67'
              newvalue: g703at2mb
            - value: '68'
              newvalue: qllc
            - value: '69'
              newvalue: fastEtherFX
            - value: '70'
              newvalue: channel
            - value: '71'
              newvalue: ieee80211
            - value: '72'
              newvalue: ibm370parChan
            - value: '73'
              newvalue: escon
            - value: '74'
              newvalue: dlsw
            - value: '75'
              newvalue: isdns
            - value: '76'
              newvalue: isdnu
            - value: '77'
              newvalue: lapd
            - value: '78'
              newvalue: ipSwitch
            - value: '79'
              newvalue: rsrb
            - value: '80'
              newvalue: atmLogical
            - value: '81'
              newvalue: ds0
            - value: '82'
              newvalue: ds0Bundle
            - value: '83'
              newvalue: bsc
            - value: '84'
              newvalue: async
            - value: '85'
              newvalue: cnr
            - value: '86'
              newvalue: iso88025Dtr
            - value: '87'
              newvalue: eplrs
            - value: '88'
              newvalue: arap
            - value: '89'
              newvalue: propCnls
            - value: '90'
              newvalue: hostPad
            - value: '91'
              newvalue: termPad
            - value: '92'
              newvalue: frameRelayMPI
            - value: '93'
              newvalue: x213
            - value: '94'
              newvalue: adsl
            - value: '95'
              newvalue: radsl
            - value: '96'
              newvalue: sdsl
            - value: '97'
              newvalue: vdsl
            - value: '98'
              newvalue: iso88025CRFPInt
            - value: '99'
              newvalue: myrinet
            - value: '100'
              newvalue: voiceEM
            - value: '101'
              newvalue: voiceFXO
            - value: '102'
              newvalue: voiceFXS
            - value: '103'
              newvalue: voiceEncap
            - value: '104'
              newvalue: voiceOverIp
            - value: '105'
              newvalue: atmDxi
            - value: '106'
              newvalue: atmFuni
            - value: '107'
              newvalue: atmIma
            - value: '108'
              newvalue: pppMultilinkBundle
            - value: '109'
              newvalue: ipOverCdlc
            - value: '110'
              newvalue: ipOverClaw
            - value: '111'
              newvalue: stackToStack
            - value: '112'
              newvalue: virtualIpAddress
            - value: '113'
              newvalue: mpc
            - value: '114'
              newvalue: ipOverAtm
            - value: '115'
              newvalue: iso88025Fiber
            - value: '116'
              newvalue: tdlc
            - value: '117'
              newvalue: gigabitEthernet
            - value: '118'
              newvalue: hdlc
            - value: '119'
              newvalue: lapf
            - value: '120'
              newvalue: v37
            - value: '121'
              newvalue: x25mlp
            - value: '122'
              newvalue: x25huntGroup
            - value: '123'
              newvalue: trasnpHdlc
            - value: '124'
              newvalue: interleave
            - value: '125'
              newvalue: fast
            - value: '126'
              newvalue: ip
            - value: '127'
              newvalue: docsCableMaclayer
            - value: '128'
              newvalue: docsCableDownstream
            - value: '129'
              newvalue: docsCableUpstream
            - value: '130'
              newvalue: a12MppSwitch
            - value: '131'
              newvalue: tunnel
            - value: '132'
              newvalue: coffee
            - value: '133'
              newvalue: ces
            - value: '134'
              newvalue: atmSubInterface
            - value: '135'
              newvalue: l2vlan
            - value: '136'
              newvalue: l3ipvlan
            - value: '137'
              newvalue: l3ipxvlan
            - value: '138'
              newvalue: digitalPowerline
            - value: '139'
              newvalue: mediaMailOverIp
            - value: '140'
              newvalue: dtm
            - value: '141'
              newvalue: dcn
            - value: '142'
              newvalue: ipForward
            - value: '143'
              newvalue: msdsl
            - value: '144'
              newvalue: ieee1394
            - value: '145'
              newvalue: if-gsn
            - value: '146'
              newvalue: dvbRccMacLayer
            - value: '147'
              newvalue: dvbRccDownstream
            - value: '148'
              newvalue: dvbRccUpstream
            - value: '149'
              newvalue: atmVirtual
            - value: '150'
              newvalue: mplsTunnel
            - value: '151'
              newvalue: srp
            - value: '152'
              newvalue: voiceOverAtm
            - value: '153'
              newvalue: voiceOverFrameRelay
            - value: '154'
              newvalue: idsl
            - value: '155'
              newvalue: compositeLink
            - value: '156'
              newvalue: ss7SigLink
            - value: '157'
              newvalue: propWirelessP2P
            - value: '158'
              newvalue: frForward
            - value: '159'
              newvalue: rfc1483
            - value: '160'
              newvalue: usb
            - value: '161'
              newvalue: ieee8023adLag
            - value: '162'
              newvalue: bgppolicyaccounting
            - value: '163'
              newvalue: frf16MfrBundle
            - value: '164'
              newvalue: h323Gatekeeper
            - value: '165'
              newvalue: h323Proxy
            - value: '166'
              newvalue: mpls
            - value: '167'
              newvalue: mfSigLink
            - value: '168'
              newvalue: hdsl2
            - value: '169'
              newvalue: shdsl
            - value: '170'
              newvalue: ds1FDL
            - value: '171'
              newvalue: pos
            - value: '172'
              newvalue: dvbAsiIn
            - value: '173'
              newvalue: dvbAsiOut
            - value: '174'
              newvalue: plc
            - value: '175'
              newvalue: nfas
            - value: '176'
              newvalue: tr008
            - value: '177'
              newvalue: gr303RDT
            - value: '178'
              newvalue: gr303IDT
            - value: '179'
              newvalue: isup
            - value: '180'
              newvalue: propDocsWirelessMaclayer
            - value: '181'
              newvalue: propDocsWirelessDownstream
            - value: '182'
              newvalue: propDocsWirelessUpstream
            - value: '183'
              newvalue: hiperlan2
            - value: '184'
              newvalue: propBWAp2Mp
            - value: '185'
              newvalue: sonetOverheadChannel
            - value: '186'
              newvalue: digitalWrapperOverheadChannel
            - value: '187'
              newvalue: aal2
            - value: '188'
              newvalue: radioMAC
            - value: '189'
              newvalue: atmRadio
            - value: '190'
              newvalue: imt
            - value: '191'
              newvalue: mvl
            - value: '192'
              newvalue: reachDSL
            - value: '193'
              newvalue: frDlciEndPt
            - value: '194'
              newvalue: atmVciEndPt
            - value: '195'
              newvalue: opticalChannel
            - value: '196'
              newvalue: opticalTransport
            - value: '197'
              newvalue: propAtm
            - value: '198'
              newvalue: voiceOverCable
            - value: '199'
              newvalue: infiniband
            - value: '200'
              newvalue: teLink
            - value: '201'
              newvalue: q2931
            - value: '202'
              newvalue: virtualTg
            - value: '203'
              newvalue: sipTg
            - value: '204'
              newvalue: sipSig
            - value: '205'
              newvalue: docsCableUpstreamChannel
            - value: '206'
              newvalue: econet
            - value: '207'
              newvalue: pon155
            - value: '208'
              newvalue: pon622
            - value: '209'
              newvalue: bridge
            - value: '210'
              newvalue: linegroup
            - value: '211'
              newvalue: voiceEMFGD
            - value: '212'
              newvalue: voiceFGDEANA
            - value: '213'
              newvalue: voiceDID
            - value: '214'
              newvalue: mpegTransport
            - value: '215'
              newvalue: sixToFour
            - value: '216'
              newvalue: gtp
            - value: '217'
              newvalue: pdnEtherLoop1
            - value: '218'
              newvalue: pdnEtherLoop2
            - value: '219'
              newvalue: opticalChannelGroup
            - value: '220'
              newvalue: homepna
            - value: '221'
              newvalue: gfp
            - value: '222'
              newvalue: ciscoISLvlan
            - value: '223'
              newvalue: actelisMetaLOOP
            - value: '224'
              newvalue: fcipLink
            - value: '225'
              newvalue: rpr
            - value: '226'
              newvalue: qam
            - value: '227'
              newvalue: lmp
            - value: '228'
              newvalue: cblVectaStar
            - value: '229'
              newvalue: docsCableMCmtsDownstream
            - value: '230'
              newvalue: adsl2
            - value: '231'
              newvalue: macSecControlledIF
            - value: '232'
              newvalue: macSecUncontrolledIF
            - value: '233'
              newvalue: aviciOpticalEther
            - value: '234'
              newvalue: atmbond
            - value: '235'
              newvalue: voiceFGDOS
            - value: '236'
              newvalue: mocaVersion1
            - value: '237'
              newvalue: ieee80216WMAN
            - value: '238'
              newvalue: adsl2plus
            - value: '239'
              newvalue: dvbRcsMacLayer
            - value: '240'
              newvalue: dvbTdm
            - value: '241'
              newvalue: dvbRcsTdma
            - value: '242'
              newvalue: x86Laps
            - value: '243'
              newvalue: wwanPP
            - value: '244'
              newvalue: wwanPP2
            - value: '245'
              newvalue: voiceEBS
            - value: '246'
              newvalue: ifPwType
            - value: '247'
              newvalue: ilan
            - value: '248'
              newvalue: pip
            - value: '249'
              newvalue: aluELP
            - value: '250'
              newvalue: gpon
            - value: '251'
              newvalue: vdsl2
            - value: '252'
              newvalue: capwapDot11Profile
            - value: '253'
              newvalue: capwapDot11Bss
            - value: '254'
              newvalue: capwapWtpVirtualRadio
            - value: '255'
              newvalue: bits
            - value: '256'
              newvalue: docsCableUpstreamRfPort
            - value: '257'
              newvalue: cableDownstreamRfPort
            - value: '258'
              newvalue: vmwareVirtualNic
            - value: '259'
              newvalue: ieee802154
            - value: '260'
              newvalue: otnOdu
            - value: '261'
              newvalue: otnOtu
            - value: '262'
              newvalue: ifVfiType
            - value: '263'
              newvalue: g9981
            - value: '264'
              newvalue: g9982
            - value: '265'
              newvalue: g9983
            - value: '266'
              newvalue: aluEpon
            - value: '267'
              newvalue: aluEponOnu
            - value: '268'
              newvalue: aluEponPhysicalUni
            - value: '269'
              newvalue: aluEponLogicalLink
            - value: '270'
              newvalue: aluGponOnu
            - value: '271'
              newvalue: aluGponPhysicalUni
            - value: '272'
              newvalue: vmwareNicTeam
            - value: '277'
              newvalue: docsOfdmDownstream
            - value: '278'
              newvalue: docsOfdmaUpstream
            - value: '279'
              newvalue: gfast
            - value: '280'
              newvalue: sdci
            - value: '281'
              newvalue: xboxWireless
            - value: '282'
              newvalue: fastdsl
            - value: '283'
              newvalue: docsCableScte55d1FwdOob
            - value: '284'
              newvalue: docsCableScte55d1RetOob
            - value: '285'
              newvalue: docsCableScte55d2DsOob
            - value: '286'
              newvalue: docsCableScte55d2UsOob
            - value: '287'
              newvalue: docsCableNdf
            - value: '288'
              newvalue: docsCableNdr
            - value: '289'
              newvalue: ptm
            - value: '290'
              newvalue: ghn
        - uuid: 8673d9a283674ca2bcd973f5fdff7258
          name: 'Service state'
          mappings:
            - value: '0'
              newvalue: Down
            - value: '1'
              newvalue: Up
        - uuid: 0fe93c05f4c94ce8943950210218f6d9
          name: zabbix.host.available
          mappings:
            - value: '0'
              newvalue: 'not available'
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: unknown
  triggers:
    - uuid: 6c1708d53693435c87cd27f1568345c1
      expression: 'min(/TrueNAS CORE by SNMP/system.swap.pfree,5m)<{$SWAP.PFREE.MIN.WARN} and last(/TrueNAS CORE by SNMP/system.swap.total)>0'
      name: 'TrueNAS CORE: High swap space usage'
      event_name: 'TrueNAS CORE: High swap space usage (less than {$SWAP.PFREE.MIN.WARN}% free)'
      opdata: 'Free: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}'
      priority: WARNING
      description: 'If there is no swap configured, this trigger is ignored.'
      dependencies:
        - name: 'TrueNAS CORE: High memory utilization'
          expression: 'min(/TrueNAS CORE by SNMP/vm.memory.util,5m)>{$MEMORY.UTIL.MAX}'
        - name: 'TrueNAS CORE: Lack of available memory'
          expression: 'min(/TrueNAS CORE by SNMP/vm.memory.available,5m)<{$MEMORY.AVAILABLE.MIN} and last(/TrueNAS CORE by SNMP/vm.memory.total)>0'
      tags:
        - tag: scope
          value: capacity
        - tag: scope
          value: performance
    - uuid: 6864f43129064a0bba5e659b514eb8d9
      expression: '(last(/TrueNAS CORE by SNMP/system.hw.uptime[hrSystemUptime.0])>0 and last(/TrueNAS CORE by SNMP/system.hw.uptime[hrSystemUptime.0])<10m) or (last(/TrueNAS CORE by SNMP/system.hw.uptime[hrSystemUptime.0])=0 and last(/TrueNAS CORE by SNMP/system.net.uptime[sysUpTime.0])<10m)'
      name: 'TrueNAS CORE: Host has been restarted'
      event_name: 'TrueNAS CORE: {HOST.NAME} has been restarted (uptime < 10m)'
      priority: WARNING
      description: 'Uptime is less than 10 minutes.'
      manual_close: 'YES'
      dependencies:
        - name: 'TrueNAS CORE: No SNMP data collection'
          expression: 'max(/TrueNAS CORE by SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
      tags:
        - tag: scope
          value: notice
    - uuid: 0a04cc4789a14f1090232fce196c0e4d
      expression: 'min(/TrueNAS CORE by SNMP/vm.memory.available,5m)<{$MEMORY.AVAILABLE.MIN} and last(/TrueNAS CORE by SNMP/vm.memory.total)>0'
      name: 'TrueNAS CORE: Lack of available memory'
      event_name: 'TrueNAS CORE: Lack of available memory (<{$MEMORY.AVAILABLE.MIN} of {ITEM.VALUE2})'
      opdata: 'Available: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}'
      priority: AVERAGE
      description: 'The system is running out of memory.'
      tags:
        - tag: scope
          value: capacity
        - tag: scope
          value: performance
    - uuid: c923ea2cc04848de911ad9a41defaff6
      expression: |
        min(/TrueNAS CORE by SNMP/system.cpu.load.avg1,5m)/last(/TrueNAS CORE by SNMP/system.cpu.num)>{$LOAD_AVG_PER_CPU.MAX.WARN}
        and last(/TrueNAS CORE by SNMP/system.cpu.load.avg5)>0
        and last(/TrueNAS CORE by SNMP/system.cpu.load.avg15)>0
      name: 'TrueNAS CORE: Load average is too high'
      event_name: 'TrueNAS CORE: Load average is too high (per CPU load over {$LOAD_AVG_PER_CPU.MAX.WARN} for 5m)'
      opdata: 'Load averages(1m 5m 15m): ({ITEM.LASTVALUE1} {ITEM.LASTVALUE3} {ITEM.LASTVALUE4}), # of CPUs: {ITEM.LASTVALUE2}'
      priority: AVERAGE
      description: 'The load average per CPU is too high. The system may be slow to respond.'
      tags:
        - tag: scope
          value: performance
  graphs:
    - uuid: 621f703356cb4522bef8f1c89732c9cb
      name: 'TrueNAS CORE: ARC hit ratio'
      type: STACKED
      ymin_type_1: FIXED
      graph_items:
        - color: 199C0D
          item:
            host: 'TrueNAS CORE by SNMP'
            key: truenas.zfs.arc.hit.ratio
        - sortorder: '1'
          color: F63100
          item:
            host: 'TrueNAS CORE by SNMP'
            key: truenas.zfs.arc.miss.ratio
    - uuid: 977c98430b1241988206b56b3fc40091
      name: 'TrueNAS CORE: CPU jumps'
      graph_items:
        - color: 199C0D
          item:
            host: 'TrueNAS CORE by SNMP'
            key: system.cpu.switches
        - sortorder: '1'
          color: F63100
          item:
            host: 'TrueNAS CORE by SNMP'
            key: system.cpu.intr
    - uuid: 5c95f63eaaf049cab4884b2785c5d382
      name: 'TrueNAS CORE: Memory usage'
      ymin_type_1: FIXED
      graph_items:
        - drawtype: BOLD_LINE
          color: 199C0D
          item:
            host: 'TrueNAS CORE by SNMP'
            key: vm.memory.total
        - sortorder: '1'
          drawtype: GRADIENT_LINE
          color: F63100
          item:
            host: 'TrueNAS CORE by SNMP'
            key: vm.memory.available
    - uuid: a36f52864942457894638adef660a775
      name: 'TrueNAS CORE: Memory utilization'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        - drawtype: GRADIENT_LINE
          color: 199C0D
          item:
            host: 'TrueNAS CORE by SNMP'
            key: vm.memory.util
    - uuid: bd67954025d145c8a0eb2f21d53a52f5
      name: 'TrueNAS CORE: Swap usage'
      graph_items:
        - color: 199C0D
          item:
            host: 'TrueNAS CORE by SNMP'
            key: system.swap.free
        - sortorder: '1'
          color: F63100
          item:
            host: 'TrueNAS CORE by SNMP'
            key: system.swap.total
    - uuid: f7a0b78f1f814e2b94cec941168eafaa
      name: 'TrueNAS CORE: System load'
      ymin_type_1: FIXED
      graph_items:
        - color: 199C0D
          item:
            host: 'TrueNAS CORE by SNMP'
            key: system.cpu.load.avg1
        - sortorder: '1'
          color: F63100
          item:
            host: 'TrueNAS CORE by SNMP'
            key: system.cpu.load.avg5
        - sortorder: '2'
          color: 00611C
          item:
            host: 'TrueNAS CORE by SNMP'
            key: system.cpu.load.avg15
        - sortorder: '3'
          color: F7941D
          yaxisside: RIGHT
          item:
            host: 'TrueNAS CORE by SNMP'
            key: system.cpu.num
