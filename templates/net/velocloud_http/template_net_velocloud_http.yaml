zabbix_export:
  version: '8.0'
  template_groups:
    - uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  host_groups:
    - uuid: f2481361f99448eea617b7b1d4765566
      name: 'Discovered hosts'
  templates:
    - uuid: e1ca624566424496bff9d90c261ab37b
      template: 'VeloCloud SD-WAN by HTTP'
      name: 'VeloCloud SD-WAN by HTTP'
      description: |
        Template for monitoring VeloCloud SD-WAN https://www.arista.com/en/support/velocloud-resources
        
        You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/
        
        Generated by official Zabbix template tool "Templator"
      wizard_ready: 'YES'
      readme: |
        ## Overview
        
        - This template provides monitoring capabilities for VeloCloud SD-WAN using the API.
        - It works without any external scripts and uses the script item.
        
        ## Setup
        
        1. Create an API token in the VeloCloud SD-WAN Orchestrator.
        > See [Arista documentation](https://www.arista.com/en/global-settings-guide-vc-6-4/sase-6-4-user-management) for details.
        
        2. Link the template to a host.
        3. Set the following fields: `API token`, `API URL`.
        
        **Note**: By default, the `Enterprise ID` field is empty. In this case, data will be retrieved for all Enterprises (privileges required: READ ENTERPRISE and READ EDGE).
        If you need to monitor only one Enterprise, fill in this field (requires only READ EDGE privileges).
      vendor:
        name: Zabbix
        version: 8.0-2
      groups:
        - name: 'Templates/Network devices'
      items:
        - uuid: 3d96f6e755934bc8a4ee7300a165adae
          name: 'Get data'
          type: SCRIPT
          key: velocloud.get
          delay: '{$VELOCLOUD.SDWAN.FREQUENCY}'
          history: '0'
          value_type: TEXT
          params: |
            var VeloCloud = {
            	params: {},
            
            	setParams: function (params) {
            		['url', 'token'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		VeloCloud.params = params;
            
            		if (VeloCloud.params.token === '{' + '$VELOCLOUD.TOKEN}') {
            			throw 'Please change {' + '$VELOCLOUD.TOKEN} macro with the proper value.';
            		}
            		if (!VeloCloud.params.url.startsWith('http://') && !VeloCloud.params.url.startsWith('https://')) {
            			VeloCloud.params.url = 'https://' + params.url;
            		}
            		if (!VeloCloud.params.url.endsWith('/')) {
            			VeloCloud.params.url += '/';
            		}
            
            	},
            
            	getField: function (data, path, trace) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path + ' - ' + trace;
            			}
            			data = data[step];
            		}
            
            		return data;
            	},
            
            	request: function (url, body) {
            
            		var response, request = new HttpRequest();
            
            		if (typeof VeloCloud.params.http_proxy !== 'undefined' && VeloCloud.params.http_proxy !== '') {
            			request.setProxy(VeloCloud.params.http_proxy);
            		}
            
            		request.addHeader('Content-Type: application/json');
            		request.addHeader('Authorization: Token ' + VeloCloud.params.token);
            
            		response = request.post(url, body);
            
            		Zabbix.log(4, '[ SD-WAN API ] [ ' + url + ' ] Received response with status code ' + request.getStatus() + ': ' + response);
            
            		if (request.getStatus() !== 200 || response === null) {
            			throw 'Request failed with status code ' + request.getStatus() + ': ' + response;
            		}
            		try {
            			response = JSON.parse(response);
            		}
            		catch (error) {
            			throw 'Failed to parse response received from SD-WAN API. Check debug log for more information.';
            		}
            		if (response.error && response.error.message) {
            			throw response.error.message;
            		}
            
            		return response;
            
            	},
            
            	getMetricsData: function () {
            		var enterprises = [],
            			edges = [];
            
            		if (typeof VeloCloud.params.enterprise_id !== 'undefined' && VeloCloud.params.enterprise_id !== '') {
            			response_edges = VeloCloud.request(VeloCloud.params.url + 'portal/rest/enterprise/getEnterpriseEdges',
            				JSON.stringify({
            					enterpriseId: Number(VeloCloud.params.enterprise_id),
            					with: ['site'],
            					fieldsNeeded: [
            						"id",
            						"enterpriseId",
            						"name"
            					]
            				}));
            
            			edges = response_edges;
            
            		} else {
            
            			enterprises = VeloCloud.getField(VeloCloud.request(VeloCloud.params.url + 'portal/rest/monitoring/getAggregates', '{}'), 'enterprises', 'error get enterprises');
            
            			if (!Array.isArray(enterprises)) {
            				enterprises = [enterprises];
            			}
            			for (var i in enterprises) {
            				response_edges = VeloCloud.request(VeloCloud.params.url + 'portal/rest/enterprise/getEnterpriseEdges', JSON.stringify({
            					enterpriseId: VeloCloud.getField(enterprises[i], 'id', 'error get enterpriseId'),
            					with: ['site'],
            					fieldsNeeded: [
            						"id",
            						"enterpriseId",
            						"name"
            					]
            				}));
            				edges = edges.concat(response_edges);
            			}
            
            		}
            
            		return { edges: edges, enterprises: enterprises };
            	}
            }
            
            try {
            	VeloCloud.setParams(JSON.parse(value));
            	return JSON.stringify(VeloCloud.getMetricsData());
            }
            catch (error) {
            	error += (String(error).endsWith('.')) ? '' : '.';
            	Zabbix.log(3, '[ VeloCloud ] ERROR: ' + error);
            	return JSON.stringify({ 'error': error });
            }
          description: 'JSON result from VeloCloud API requests.'
          timeout: '{$VELOCLOUD.SDWAN.DATA.TIMEOUT}'
          parameters:
            - name: enterprise_id
              value: '{$VELOCLOUD.ENTERPRISE.ID}'
            - name: http_proxy
              value: '{$VELOCLOUD.HTTP_PROXY}'
            - name: token
              value: '{$VELOCLOUD.TOKEN}'
            - name: url
              value: '{$VELOCLOUD.URL}'
          tags:
            - tag: component
              value: raw
        - uuid: 0e201ebcdc2f491f901a883f9cc3ce69
          name: 'Get network gateway data collection errors'
          type: DEPENDENT
          key: velocloud.get.edges.error
          value_type: TEXT
          description: 'Errors from aggregate data collection for network gateways.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.error
              error_handler: CUSTOM_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: velocloud.network.gateway.get
          tags:
            - tag: component
              value: application
          triggers:
            - uuid: 40aad027b5fc43babe9f5bcb2d458453
              expression: 'length(last(/VeloCloud SD-WAN by HTTP/velocloud.get.edges.error))>0'
              name: 'VeloCloud: There are errors in network gateways item'
              priority: WARNING
              description: 'There are errors in the aggregate script item for network gateways.'
              tags:
                - tag: scope
                  value: notice
        - uuid: 8a54309d8abc4fc7816b168329243de4
          name: 'Get data collection errors'
          type: DEPENDENT
          key: velocloud.get.error
          value_type: TEXT
          description: 'Errors from aggregate data collection.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.error
              error_handler: CUSTOM_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          master_item:
            key: velocloud.get
          tags:
            - tag: component
              value: application
          triggers:
            - uuid: a0623655a2fa4f60962ad560b8bb5a13
              expression: 'length(last(/VeloCloud SD-WAN by HTTP/velocloud.get.error))>0'
              name: 'VeloCloud: There are errors in aggregate script item'
              priority: WARNING
              description: 'There are errors in the aggregate script item.'
              tags:
                - tag: scope
                  value: notice
        - uuid: d7444ca3a03b468385b5cccad55c0492
          name: 'Get version info errors'
          type: DEPENDENT
          key: velocloud.info.get.error
          value_type: TEXT
          description: 'Errors from version info response.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.error
              error_handler: CUSTOM_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          master_item:
            key: velocloud.version.info.get
          tags:
            - tag: component
              value: application
          triggers:
            - uuid: cbdb8c53e1f1496facd1225e38bf98eb
              expression: 'length(last(/VeloCloud SD-WAN by HTTP/velocloud.info.get.error))>0'
              name: 'VeloCloud: There are errors in version info item'
              priority: WARNING
              description: 'There are errors in the version info item.'
              tags:
                - tag: scope
                  value: notice
        - uuid: 5fdaf4757bf34657984cb7f071c304cb
          name: 'Get network gateways'
          type: HTTP_AGENT
          key: velocloud.network.gateway.get
          delay: '{$VELOCLOUD.SDWAN.FREQUENCY}'
          history: '0'
          value_type: TEXT
          description: 'Gets network gateway information.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          url: 'https://{$VELOCLOUD.URL}/portal/rest/network/getNetworkGateways'
          posts: '{ "with": ["site"] }'
          headers:
            - name: Content-Type
              value: application/json
            - name: Authorization
              value: 'Token {$VELOCLOUD.TOKEN}'
          request_method: POST
          tags:
            - tag: component
              value: raw
        - uuid: 3f589e2191c5419fb89cc33639595ae9
          name: 'Orchestrator API version'
          type: DEPENDENT
          key: velocloud.orchestrator.api_version
          value_type: TEXT
          description: 'Version of VeloCloud SD-WAN Orchestrator API.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.apiVersion
          master_item:
            key: velocloud.version.info.get
          tags:
            - tag: component
              value: orchestrator
          triggers:
            - uuid: 5a95d9c614e74c2c8b6181fc8dff2226
              expression: 'last(/VeloCloud SD-WAN by HTTP/velocloud.orchestrator.api_version,#1)<>last(/VeloCloud SD-WAN by HTTP/velocloud.orchestrator.api_version,#2) and length(last(/VeloCloud SD-WAN by HTTP/velocloud.orchestrator.api_version))>0'
              name: 'VeloCloud: Orchestrator API version has changed'
              priority: AVERAGE
              description: 'The VeloCloud Orchestrator API version has changed.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: availability
        - uuid: ab24d8fc4c2a4130bca1b4b6d4f311ae
          name: 'Orchestrator build'
          type: DEPENDENT
          key: velocloud.orchestrator.build
          value_type: CHAR
          description: 'Build of VeloCloud SD-WAN Orchestrator API.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.build
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: velocloud.version.info.get
          tags:
            - tag: component
              value: orchestrator
          triggers:
            - uuid: 37c16b3cbd8b4680ab85a1fea819611f
              expression: 'last(/VeloCloud SD-WAN by HTTP/velocloud.orchestrator.build,#1)<>last(/VeloCloud SD-WAN by HTTP/velocloud.orchestrator.build,#2) and length(last(/VeloCloud SD-WAN by HTTP/velocloud.orchestrator.build))>0'
              name: 'VeloCloud: Orchestrator build has changed'
              priority: INFO
              description: 'The VeloCloud Orchestrator build has changed.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: 1f60b61051494ab495de4dfe2cd83450
          name: 'Orchestrator version'
          type: DEPENDENT
          key: velocloud.orchestrator.version
          value_type: CHAR
          description: 'Version of VMware SD-WAN Orchestrator API.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.version
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: velocloud.version.info.get
          tags:
            - tag: component
              value: orchestrator
          triggers:
            - uuid: a1d8e4d61a804c8fb11b33f590f0885c
              expression: 'last(/VeloCloud SD-WAN by HTTP/velocloud.orchestrator.version,#1)<>last(/VeloCloud SD-WAN by HTTP/velocloud.orchestrator.version,#2) and length(last(/VeloCloud SD-WAN by HTTP/velocloud.orchestrator.version))>0'
              name: 'VeloCloud: Orchestrator version has changed'
              priority: INFO
              description: 'The VeloCloud Orchestrator version has changed.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: 1206789df5b44af7ba1c5416662344dd
          name: 'System properties'
          type: HTTP_AGENT
          key: velocloud.system.properties
          delay: 6h
          value_type: TEXT
          description: 'System properties of VMware SD-WAN.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          url: 'https://{$VELOCLOUD.URL}/portal/rest/systemProperty/getSystemProperties'
          posts: '{ "normalize": true }'
          headers:
            - name: Content-Type
              value: application/json
            - name: Authorization
              value: 'Token {$VELOCLOUD.TOKEN}'
          request_method: POST
          tags:
            - tag: component
              value: application
          triggers:
            - uuid: 58541dfe798843fa822276e84a32b919
              expression: 'last(/VeloCloud SD-WAN by HTTP/velocloud.system.properties,#1)<>last(/VeloCloud SD-WAN by HTTP/velocloud.system.properties,#2)'
              name: 'VeloCloud: System properties have changed'
              priority: INFO
              description: 'The system properties have changed.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: d0d6978941fb45dda2791e9c0e2cf7c7
          name: 'Get version info data'
          type: HTTP_AGENT
          key: velocloud.version.info.get
          delay: '{$VELOCLOUD.SDWAN.FREQUENCY}'
          history: '0'
          value_type: TEXT
          description: 'Gets system version information.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          url: 'https://{$VELOCLOUD.URL}/portal/rest/system/getVersionInfo'
          posts: '{}'
          headers:
            - name: Content-Type
              value: application/json
            - name: Authorization
              value: 'Token {$VELOCLOUD.TOKEN}'
          request_method: POST
          tags:
            - tag: component
              value: raw
      discovery_rules:
        - uuid: 522ba6551cc64094b60a136d07c9921d
          name: 'Edge discovery'
          type: DEPENDENT
          key: velocloud.edge.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#EDGE.NAME}'
                value: '{$VELOCLOUD.LLD.EDGES.NAME.FILTER.MATCHES}'
              - macro: '{#EDGE.NAME}'
                value: '{$VELOCLOUD.LLD.EDGES.NAME.FILTER.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#EDGE.STATE}'
                value: '{$VELOCLOUD.LLD.EDGES.STATE.FILTER.MATCHES}'
              - macro: '{#EDGE.STATE}'
                value: '{$VELOCLOUD.LLD.EDGES.STATE.FILTER.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          description: 'Get Edge instances.'
          host_prototypes:
            - uuid: 5896745a4b844f1a826d5dd060bc2b5b
              host: '{#EDGE.NAME}'
              name: '{#EDGE.NAME}'
              inventory_mode: AUTOMATIC
              group_links:
                - group:
                    name: 'Discovered hosts'
              templates:
                - name: 'VeloCloud SD-WAN Edge by HTTP'
              macros:
                - macro: '{$VELOCLOUD.EDGE.ID}'
                  value: '{#EDGE.ID}'
                  description: 'SD-WAN Edge id.'
                - macro: '{$VELOCLOUD.EDGE.INVENTORY}'
                  value: '{#EDGE.INVENTORY}'
                  description: 'SD-WAN Edge inventory.'
                - macro: '{$VELOCLOUD.EDGE.NAME}'
                  value: '{#EDGE.NAME}'
                  description: 'SD-WAN Edge name.'
                - macro: '{$VELOCLOUD.ENTERPRISE.ID}'
                  value: '{#ENTERPRISE.ID}'
                  description: 'SD-WAN Enterprise id.'
              tags:
                - tag: city
                  value: '{#EDGE.CITY}'
                - tag: country
                  value: '{#EDGE.COUNTRY}'
                - tag: service
                  value: edge
          master_item:
            key: velocloud.get
          lld_macro_paths:
            - lld_macro: '{#EDGE.CITY}'
              path: $.site.city
            - lld_macro: '{#EDGE.COUNTRY}'
              path: $.site.country
            - lld_macro: '{#EDGE.ID}'
              path: $.id
            - lld_macro: '{#EDGE.INVENTORY}'
              path: $.site
            - lld_macro: '{#EDGE.NAME}'
              path: $.name
            - lld_macro: '{#EDGE.STATE}'
              path: $.site.state
            - lld_macro: '{#ENTERPRISE.ID}'
              path: $.enterpriseId
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.edges
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: e2879e0ce6e44203b0615c36ba626cc0
          name: 'Gateway metric discovery'
          type: DEPENDENT
          key: velocloud.gateway.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#NAME}'
                value: '{$VELOCLOUD.LLD.GATEWAYS.FILTER.MATCHES}'
              - macro: '{#NAME}'
                value: '{$VELOCLOUD.LLD.GATEWAYS.FILTER.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          description: 'Metrics for gateway statistics.'
          item_prototypes:
            - uuid: 52859166849d4cdf860664f8d3b8088d
              name: 'Gateway [{#NAME}]: Connected edges'
              type: DEPENDENT
              key: 'velocloud.gateway.connected_edges[{#ID}]'
              description: 'Edges connected to gateway.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.connectedEdges
              master_item:
                key: 'velocloud.get.gateway[{#ID}]'
              tags:
                - tag: city
                  value: '{#CITY}'
                - tag: component
                  value: gateway
                - tag: name
                  value: '{#NAME}'
                - tag: state
                  value: '{#STATE}'
              trigger_prototypes:
                - uuid: f0d7bdb2ac3540258ab6a276b43a382c
                  expression: 'last(/VeloCloud SD-WAN by HTTP/velocloud.gateway.connected_edges[{#ID}],#1)<>last(/VeloCloud SD-WAN by HTTP/velocloud.gateway.connected_edges[{#ID}],#2)'
                  name: 'VeloCloud: Gateway [{#NAME}]: The number of connected edges has changed'
                  priority: WARNING
                  description: 'The number of connected Edges has changed.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: notice
            - uuid: 5e588efb83be4dc2bc29eaa0a6630718
              name: 'Gateway [{#NAME}]: Description'
              type: DEPENDENT
              key: 'velocloud.gateway.description[{#ID}]'
              value_type: TEXT
              description: 'Gateway description.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.description
                - type: STR_REPLACE
                  parameters:
                    - 'null'
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
              master_item:
                key: 'velocloud.get.gateway[{#ID}]'
              tags:
                - tag: city
                  value: '{#CITY}'
                - tag: component
                  value: gateway
                - tag: name
                  value: '{#NAME}'
                - tag: state
                  value: '{#STATE}'
            - uuid: 7f2a0a68386744cb84fab35df8c55a07
              name: 'Gateway [{#NAME}]: IP address'
              type: DEPENDENT
              key: 'velocloud.gateway.ip_address[{#ID}]'
              value_type: TEXT
              description: 'Gateway IP address.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.ipAddress
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'velocloud.get.gateway[{#ID}]'
              tags:
                - tag: city
                  value: '{#CITY}'
                - tag: component
                  value: gateway
                - tag: name
                  value: '{#NAME}'
                - tag: state
                  value: '{#STATE}'
            - uuid: b304460854f0485189f88df12483b5ac
              name: 'Gateway [{#NAME}]: Service uptime'
              type: DEPENDENT
              key: 'velocloud.gateway.service_uptime[{#ID}]'
              units: uptime
              description: 'Gateway service uptime.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.serviceUpSince
                - type: JAVASCRIPT
                  parameters:
                    - |
                      value == '0000-00-00 00:00:00' ? value = 0 : value = Math.round((Date.now() - new Date(value).valueOf()) / 1000);
                      return value;
              master_item:
                key: 'velocloud.get.gateway[{#ID}]'
              tags:
                - tag: city
                  value: '{#CITY}'
                - tag: component
                  value: gateway
                - tag: name
                  value: '{#NAME}'
                - tag: state
                  value: '{#STATE}'
            - uuid: 91784583eda943a7ace430413450391c
              name: 'Gateway [{#NAME}]: State'
              type: DEPENDENT
              key: 'velocloud.gateway.state[{#ID}]'
              value_type: TEXT
              description: 'Gateway state.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.gatewayState
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'velocloud.get.gateway[{#ID}]'
              tags:
                - tag: city
                  value: '{#CITY}'
                - tag: component
                  value: gateway
                - tag: name
                  value: '{#NAME}'
                - tag: state
                  value: '{#STATE}'
            - uuid: d902600ef51640ffaaa4384ce505bcc2
              name: 'Gateway [{#NAME}]: System uptime'
              type: DEPENDENT
              key: 'velocloud.gateway.system_uptime[{#ID}]'
              units: uptime
              description: 'Gateway system uptime.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.systemUpSince
                - type: JAVASCRIPT
                  parameters:
                    - |
                      value == '0000-00-00 00:00:00' ? value = 0 : value = Math.round((Date.now() - new Date(value).valueOf()) / 1000);
                      return value;
              master_item:
                key: 'velocloud.get.gateway[{#ID}]'
              tags:
                - tag: city
                  value: '{#CITY}'
                - tag: component
                  value: gateway
                - tag: name
                  value: '{#NAME}'
                - tag: state
                  value: '{#STATE}'
              trigger_prototypes:
                - uuid: e51ea2da27284067bd3ec8fa4faffdde
                  expression: 'last(/VeloCloud SD-WAN by HTTP/velocloud.gateway.system_uptime[{#ID}])>0 and last(/VeloCloud SD-WAN by HTTP/velocloud.gateway.system_uptime[{#ID}])<600'
                  name: 'VeloCloud: Gateway [{#NAME}]: Gateway has been restarted'
                  event_name: 'VeloCloud: Gateway [{#NAME}]: Gateway has been restarted (uptime < 10m)'
                  priority: WARNING
                  description: 'Gateway was restarted.'
                  tags:
                    - tag: scope
                      value: notice
            - uuid: 66c8fe8095724fb38966b05ef5d77a37
              name: 'Gateway [{#NAME}]: Utilization CPU'
              type: DEPENDENT
              key: 'velocloud.gateway.utilization.cpu[{#ID}]'
              value_type: FLOAT
              units: '%'
              description: 'Gateway CPU utilization.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.utilizationDetail.cpu
              master_item:
                key: 'velocloud.get.gateway[{#ID}]'
              tags:
                - tag: city
                  value: '{#CITY}'
                - tag: component
                  value: cpu
                - tag: component
                  value: gateway
                - tag: name
                  value: '{#NAME}'
                - tag: state
                  value: '{#STATE}'
            - uuid: b510c38771464024a66dc20ce9d75505
              name: 'Gateway [{#NAME}]: Utilization load'
              type: DEPENDENT
              key: 'velocloud.gateway.utilization.load[{#ID}]'
              value_type: FLOAT
              units: '%'
              description: 'Gateway load.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.utilizationDetail.load
              master_item:
                key: 'velocloud.get.gateway[{#ID}]'
              tags:
                - tag: city
                  value: '{#CITY}'
                - tag: component
                  value: gateway
                - tag: name
                  value: '{#NAME}'
                - tag: state
                  value: '{#STATE}'
            - uuid: ad83565ae40f480dacd56e63bd475ddc
              name: 'Gateway [{#NAME}]: Utilization memory'
              type: DEPENDENT
              key: 'velocloud.gateway.utilization.memory[{#ID}]'
              value_type: FLOAT
              units: '%'
              description: 'Gateway memory utilization.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.utilizationDetail.memory
              master_item:
                key: 'velocloud.get.gateway[{#ID}]'
              tags:
                - tag: city
                  value: '{#CITY}'
                - tag: component
                  value: gateway
                - tag: component
                  value: memory
                - tag: name
                  value: '{#NAME}'
                - tag: state
                  value: '{#STATE}'
            - uuid: b10c51350f604a8195e9c0176ca2de85
              name: 'Gateway [{#NAME}]: Utilization overall'
              type: DEPENDENT
              key: 'velocloud.gateway.utilization.overall[{#ID}]'
              value_type: FLOAT
              units: '%'
              description: 'Gateway overall utilization.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.utilizationDetail.overall
              master_item:
                key: 'velocloud.get.gateway[{#ID}]'
              tags:
                - tag: city
                  value: '{#CITY}'
                - tag: component
                  value: gateway
                - tag: name
                  value: '{#NAME}'
                - tag: state
                  value: '{#STATE}'
            - uuid: 5c11969073ab415abe08c74626bd5dd1
              name: 'Gateway [{#NAME}]: Raw data'
              type: DEPENDENT
              key: 'velocloud.get.gateway[{#ID}]'
              history: '0'
              value_type: TEXT
              description: 'Raw data for VeloCloud gateway.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[?(@.id==''{#ID}'')].first()'
              master_item:
                key: velocloud.network.gateway.get
              tags:
                - tag: component
                  value: raw
          graph_prototypes:
            - uuid: d8d9b176f439436ba6fe69ec8bc6409e
              name: 'Gateway [{#NAME}]: Utilization'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'VeloCloud SD-WAN by HTTP'
                    key: 'velocloud.gateway.utilization.cpu[{#ID}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'VeloCloud SD-WAN by HTTP'
                    key: 'velocloud.gateway.utilization.load[{#ID}]'
                - sortorder: '2'
                  color: 00611C
                  item:
                    host: 'VeloCloud SD-WAN by HTTP'
                    key: 'velocloud.gateway.utilization.memory[{#ID}]'
                - sortorder: '3'
                  color: F7941D
                  item:
                    host: 'VeloCloud SD-WAN by HTTP'
                    key: 'velocloud.gateway.utilization.overall[{#ID}]'
          master_item:
            key: velocloud.network.gateway.get
          lld_macro_paths:
            - lld_macro: '{#CITY}'
              path: $.site.city
            - lld_macro: '{#ID}'
              path: $.id
            - lld_macro: '{#NAME}'
              path: $.name
            - lld_macro: '{#STATE}'
              path: $.site.state
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
      tags:
        - tag: class
          value: network
        - tag: target
          value: velocloud-sd-wan
      macros:
        - macro: '{$VELOCLOUD.ENTERPRISE.ID}'
          description: 'VeloCloud SD-WAN Enterprise ID. Specify a single Enterprise ID (requires READ EDGE privileges). By default parameter is empty, data will be retrieved for all Enterprises (privileges required: READ ENTERPRISE and READ EDGE).'
          config:
            type: TEXT
            priority: '3'
            section_name: Other
            label: 'Enterprise ID'
            description: 'VeloCloud SD-WAN Enterprise ID.'
            required: 'YES'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$VELOCLOUD.HTTP_PROXY}'
          description: 'The HTTP proxy for script items (set if needed). If the macro is empty, then no proxy is used.'
          config:
            type: TEXT
            priority: '6'
            section_name: Other
            label: 'HTTP proxy'
            description: 'HTTP proxy to use for requests.'
        - macro: '{$VELOCLOUD.LLD.EDGES.NAME.FILTER.MATCHES}'
          value: '.*'
          description: 'Filter for discoverable Edges by name.'
          config:
            type: TEXT
            priority: '7'
            section_name: 'Discovery filters'
            label: 'Edges name matches'
            description: 'Regex to match Edges names.'
        - macro: '{$VELOCLOUD.LLD.EDGES.NAME.FILTER.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Filter to exclude discovered Edges by name.'
          config:
            type: TEXT
            priority: '8'
            section_name: 'Discovery filters'
            label: 'Edges name not matches'
            description: 'A regex to exclude certain Edges names from discovery.'
        - macro: '{$VELOCLOUD.LLD.EDGES.STATE.FILTER.MATCHES}'
          value: '.*'
          description: 'Filter for discoverable Edges by state.'
          config:
            type: TEXT
            priority: '9'
            section_name: 'Discovery filters'
            label: 'Edges state matches'
            description: 'Regex to match Edges state.'
        - macro: '{$VELOCLOUD.LLD.EDGES.STATE.FILTER.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Filter to exclude discovered Edges by state.'
          config:
            type: TEXT
            priority: '10'
            section_name: 'Discovery filters'
            label: 'Edges state not matches'
            description: 'A regex to exclude Edges by state from discovery.'
        - macro: '{$VELOCLOUD.LLD.GATEWAYS.FILTER.MATCHES}'
          value: '.*'
          description: 'Filter for discoverable gateways.'
          config:
            type: TEXT
            priority: '11'
            section_name: 'Discovery filters'
            label: 'Gateways name matches'
            description: 'Regex to match gateways name.'
        - macro: '{$VELOCLOUD.LLD.GATEWAYS.FILTER.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Filter to exclude discovered gateways.'
          config:
            type: TEXT
            priority: '12'
            section_name: 'Discovery filters'
            label: 'Gateways name not matches'
            description: 'A regex to exclude certain gateways names from discovery.'
        - macro: '{$VELOCLOUD.SDWAN.DATA.TIMEOUT}'
          value: 15s
          description: 'Response timeout for API.'
          config:
            type: TEXT
            priority: '5'
            label: 'API timeout'
            description: 'Response timeout for the API (e.g., 15s). In the range from 1 to 60 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$VELOCLOUD.SDWAN.FREQUENCY}'
          value: 1h
          description: 'Update interval for raw item, expressed in hours.'
          config:
            type: TEXT
            priority: '4'
            label: 'Update interval'
            description: 'Update interval for raw item (e.g., 1h).'
        - macro: '{$VELOCLOUD.TOKEN}'
          type: SECRET_TEXT
          description: 'VeloCloud SD-WAN Orchestrator API token.'
          config:
            type: TEXT
            priority: '1'
            label: 'API token'
            description: 'VeloCloud SD-WAN Orchestrator API token.'
            required: 'YES'
        - macro: '{$VELOCLOUD.URL}'
          description: 'VeloCloud SD-WAN Orchestrator URL, e.g., `vco.velocloud.net`.'
          config:
            type: TEXT
            priority: '2'
            label: 'API URL'
            description: 'VeloCloud SD-WAN Orchestrator API URL. Format example: `vco.velocloud.net`'
            required: 'YES'
      dashboards:
        - uuid: 05278fc67ef34ec191e6a76f12e13627
          name: 'VeloCloud: General'
          pages:
            - name: Overview
              widgets:
                - type: item
                  width: '24'
                  height: '4'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'VeloCloud SD-WAN by HTTP'
                        key: velocloud.orchestrator.api_version
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '4'
                    - type: INTEGER
                      name: value_size
                      value: '15'
                - type: item
                  x: '24'
                  width: '24'
                  height: '4'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'VeloCloud SD-WAN by HTTP'
                        key: velocloud.orchestrator.build
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '4'
                    - type: INTEGER
                      name: value_size
                      value: '15'
                - type: item
                  x: '48'
                  width: '24'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'VeloCloud SD-WAN by HTTP'
                        key: velocloud.orchestrator.version
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '20'
            - name: Gateways
              widgets:
                - type: honeycomb
                  name: State
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Gateway [*]: State'
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: STRING
                      name: reference
                      value: YWRAS
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                - type: svggraph
                  name: 'Utilization load'
                  'y': '4'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 78909C
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Gateway [*]: Utilization load'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: STRING
                      name: reference
                      value: CBDAC
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: honeycomb
                  name: 'IP address'
                  x: '36'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Gateway [*]: IP address'
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: STRING
                      name: reference
                      value: XGHBR
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                - type: svggraph
                  name: 'Utilization overall'
                  x: '36'
                  'y': '4'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 78909C
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Gateway [*]: Utilization overall'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: STRING
                      name: reference
                      value: CBFDD
                    - type: INTEGER
                      name: righty
                      value: '0'
    - uuid: 6fd1bd7226934f498169202ba4e9a482
      template: 'VeloCloud SD-WAN Edge by HTTP'
      name: 'VeloCloud SD-WAN Edge by HTTP'
      description: |
        Template for monitoring VeloCloud SD-WAN Edges https://www.arista.com/en/solutions/sd-wan
        
        You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/
        
        Generated by official Zabbix template tool "Templator"
      wizard_ready: 'YES'
      readme: |
        ## Overview
        
        - This template provides monitoring capabilities for VeloCloud SD-WAN Edge using the API.
        - It works without any external scripts and uses the script item.
        
        ## Setup
        
        1. Create an API token in the VeloCloud SD-WAN Orchestrator.
        > See [Arista documentation](https://www.arista.com/en/global-settings-guide-vc-6-4/sase-6-4-user-management) for details.
        
        2. Link the template to a host.
        3. Set the following fields: `API token`, `API URL`, `Enterprise ID`, `Edge ID`.
      vendor:
        name: Zabbix
        version: 8.0-0
      groups:
        - name: 'Templates/Network devices'
      items:
        - uuid: 79aa9ebb1ce64944a78a7c8d7603f53b
          name: 'Activation state'
          type: DEPENDENT
          key: velocloud.edge.activation
          description: 'Edge activation state.'
          valuemap:
            name: 'Edge activation state'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $..activationState.first()
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
            - type: JAVASCRIPT
              parameters:
                - |
                  switch (value) {
                  	case 'PENDING':
                  		return 0;
                  	case 'ACTIVATED':
                  		return 1;
                  	default:
                  		return 10;
                  }
          master_item:
            key: velocloud.edge.get.data
          tags:
            - tag: component
              value: edge
            - tag: component
              value: system
        - uuid: 8a57dfd93a334b8bb606ae3b4f0c5cb7
          name: 'CPU core temperature'
          type: DEPENDENT
          key: velocloud.edge.cpu.core.temp
          units: Â°C
          description: 'Temperature of the CPU core.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.cpuCoreTemp.max
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: velocloud.edge.status.metric.get
          tags:
            - tag: component
              value: cpu
        - uuid: 89f694d5b7784af5a5cd853e30a722e5
          name: 'CPU usage in percent'
          type: DEPENDENT
          key: velocloud.edge.cpu.usage
          value_type: FLOAT
          units: '%'
          description: 'CPU usage as a percentage.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.cpuPct.max
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: velocloud.edge.status.metric.get
          tags:
            - tag: component
              value: cpu
          triggers:
            - uuid: c8a6374d35fd49bf8952873b63570ae2
              expression: 'min(/VeloCloud SD-WAN Edge by HTTP/velocloud.edge.cpu.usage,15m)>{$VELOCLOUD.EDGE.CPU.UTIL.WARN}'
              name: 'VeloCloud Edge: High CPU utilization'
              event_name: 'VeloCloud Edge: High CPU utilization (over {$VELOCLOUD.EDGE.CPU.UTIL.WARN}% for 15m)'
              opdata: 'Current CPU usage: {ITEM.LASTVALUE1}%'
              priority: WARNING
              description: 'The system is experiencing high CPU usage.'
              tags:
                - tag: scope
                  value: capacity
                - tag: scope
                  value: performance
        - uuid: cecb2a3698704c4c89ef12eb3bb39222
          name: Description
          type: DEPENDENT
          key: velocloud.edge.description
          value_type: TEXT
          description: 'Edge description.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $..description.first()
            - type: STR_REPLACE
              parameters:
                - 'null'
                - ''
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: velocloud.edge.get.data
          tags:
            - tag: component
              value: edge
            - tag: component
              value: system
        - uuid: e875793d90e04672b1ac4ffa79c0e40a
          name: 'Flow count'
          type: DEPENDENT
          key: velocloud.edge.flow.count
          description: 'Number of flows.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.flowCount.max
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: velocloud.edge.status.metric.get
          tags:
            - tag: component
              value: system
        - uuid: e159cb72d8c44b4aab356eebc15da589
          name: 'Get edge data'
          type: HTTP_AGENT
          key: velocloud.edge.get.data
          delay: '{$VELOCLOUD.EDGE.FREQUENCY}'
          history: '0'
          value_type: TEXT
          description: 'Edge data in JSON format.'
          timeout: '{$VELOCLOUD.EDGE.DATA.TIMEOUT}'
          url: 'https://{$VELOCLOUD.URL}/portal/rest/edge/getEdge'
          posts: '{ "enterpriseId": {$VELOCLOUD.ENTERPRISE.ID}, "id": {$VELOCLOUD.EDGE.ID} }'
          headers:
            - name: Content-Type
              value: application/json
            - name: Authorization
              value: 'Token {$VELOCLOUD.TOKEN}'
          request_method: POST
          tags:
            - tag: component
              value: raw
        - uuid: f0b94440c1db4638b79b48aee74f770f
          name: 'Get edge data collection errors'
          type: DEPENDENT
          key: velocloud.edge.get.data.error
          value_type: TEXT
          description: 'Verify that data collection completed without errors.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.error
              error_handler: CUSTOM_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          master_item:
            key: velocloud.edge.get.data
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 411e557e080b470f8dfb8267b78a0851
              expression: 'length(last(/VeloCloud SD-WAN Edge by HTTP/velocloud.edge.get.data.error))>0'
              name: 'VeloCloud Edge: Failed to get metric data'
              priority: WARNING
              description: 'Failed to get API metrics for Edge.'
              tags:
                - tag: scope
                  value: notice
        - uuid: 37aac853345e4b9f954cca4b37ae4047
          name: 'Get edge peer data'
          type: SCRIPT
          key: velocloud.edge.get.peer.data
          delay: '{$VELOCLOUD.EDGE.FREQUENCY}'
          history: '0'
          value_type: TEXT
          params: |
            var VeloCloud = {
            	params: {},
            
            	setParams: function (params) {
            		['url', 'token'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		VeloCloud.params = params;
            
            		if (VeloCloud.params.token === '{' + '$VELOCLOUD.TOKEN}') {
            			throw 'Please change {' + '$VELOCLOUD.TOKEN} macro with the proper value.';
            		}
            		if (!VeloCloud.params.url.startsWith('http://') && !VeloCloud.params.url.startsWith('https://')) {
            			VeloCloud.params.url = 'https://' + params.url;
            		}
            		if (!VeloCloud.params.url.endsWith('/')) {
            			VeloCloud.params.url += '/';
            		}
            
            	},
            
            	getField: function (data, path, trace) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path + ' - ' + trace;
            			}
            			data = data[step];
            		}
            
            		return data;
            	},
            
            	request: function (url, body) {
            
            		var response, request = new HttpRequest();
            
            		if (typeof VeloCloud.params.http_proxy !== 'undefined' && VeloCloud.params.http_proxy !== '') {
            			request.setProxy(VeloCloud.params.http_proxy);
            		}
            
            		request.addHeader('Content-Type: application/json');
            		request.addHeader('Authorization: Token ' + VeloCloud.params.token);
            
            		response = request.post(url, body);
            
            		Zabbix.log(4, '[ SD-WAN API ] [ ' + url + ' ] Received response with status code ' + request.getStatus() + ': ' + response);
            
            		if (request.getStatus() !== 200 || response === null) {
            			throw 'Request failed with status code ' + request.getStatus() + ': ' + response;
            		}
            		try {
            			response = JSON.parse(response);
            		}
            		catch (error) {
            			throw 'Failed to parse response received from SD-WAN API. Check debug log for more information.';
            		}
            		if (response.error && response.error.message) {
            			throw response.error.message;
            		}
            
            		return response;
            
            	},
            
            	getMetricsData: function () {
            		var edge_sdwan = [],
            			edge_sdwan_path = [];
            
            
            		response_edge_sdwan = VeloCloud.request(VeloCloud.params.url + 'portal/rest/edge/getEdgeSDWANPeers', JSON.stringify({ enterpriseId: Number(VeloCloud.params.enterprise_id), edgeId: Number(VeloCloud.params.edge_id) }));
            
            		if (!Array.isArray(response_edge_sdwan)) {
            			response_edge_sdwan = [response_edge_sdwan];
            		}
            
            		for (var e in response_edge_sdwan) {
            			data = {
            				enterpriseId: Number(VeloCloud.params.enterprise_id),
            				edgeId: Number(VeloCloud.params.edge_id),
            				peerLogicalId: VeloCloud.getField(response_edge_sdwan[e], 'deviceLogicalId', 'error get peerLogicalId')
            			};
            			response_edge_sdwan_path = VeloCloud.request(VeloCloud.params.url + 'portal/rest/metrics/getEdgeSDWANPeerPathMetrics', JSON.stringify(data));
            			edge_sdwan_path = edge_sdwan_path.concat(response_edge_sdwan_path);
            
            			response_edge_sdwan[e].edgeId = Number(VeloCloud.params.edge_id);
            			response_edge_sdwan[e].edgeName = VeloCloud.params.edge_name;
            			response_edge_sdwan[e].enterpriseId = Number(VeloCloud.params.enterprise_id);
            		}
            
            		edge_sdwan = edge_sdwan.concat(response_edge_sdwan);
            
            		return { edgeSDWan: edge_sdwan, edgeSDWanPath: edge_sdwan_path };
            
            	}
            }
            
            try {
            	VeloCloud.setParams(JSON.parse(value));
            	return JSON.stringify(VeloCloud.getMetricsData());
            }
            catch (error) {
            	error += (String(error).endsWith('.')) ? '' : '.';
            	Zabbix.log(3, '[ VeloCloud ] ERROR: ' + error);
            	return JSON.stringify({ 'error': error });
            }
          description: 'Edge peer metric data in JSON format.'
          timeout: '{$VELOCLOUD.EDGE.DATA.TIMEOUT}'
          parameters:
            - name: edge_id
              value: '{$VELOCLOUD.EDGE.ID}'
            - name: edge_name
              value: '{$VELOCLOUD.EDGE.NAME}'
            - name: enterprise_id
              value: '{$VELOCLOUD.ENTERPRISE.ID}'
            - name: token
              value: '{$VELOCLOUD.TOKEN}'
            - name: url
              value: '{$VELOCLOUD.URL}'
          tags:
            - tag: component
              value: raw
        - uuid: 09290826633842e39c25839307046872
          name: 'Handoff queue drops'
          type: DEPENDENT
          key: velocloud.edge.handoff.queue.drops
          description: 'Packets dropped from the handoff queue.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.handoffQueueDrops.max
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: velocloud.edge.status.metric.get
          tags:
            - tag: component
              value: system
        - uuid: ff105efa22c4445e8fc3236ccb7eb32a
          name: 'HA state'
          type: DEPENDENT
          key: velocloud.edge.ha_state
          description: 'Edge high availability state.'
          valuemap:
            name: 'Edge HA status'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $..haState.first()
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
            - type: JAVASCRIPT
              parameters:
                - |
                  switch (value) {
                  	case 'UNCONFIGURED':
                  		return 0;
                  	case 'READY':
                  		return 1;
                  	case 'PENDING_INIT':
                  		return 2;
                  	case 'FAILED':
                  		return 3;
                  	default:
                  		return 10;
                  }
          master_item:
            key: velocloud.edge.get.data
          tags:
            - tag: component
              value: edge
            - tag: component
              value: system
          triggers:
            - uuid: 182bf6b988be490dbfa580b304fce19c
              expression: 'last(/VeloCloud SD-WAN Edge by HTTP/velocloud.edge.ha_state)=3'
              name: 'VeloCloud Edge: HA state is in "FAILED" state'
              priority: WARNING
              description: 'High availability state is "FAILED".'
              tags:
                - tag: scope
                  value: availability
        - uuid: c155979946c44782b7eb64de0a9e80fd
          name: 'Get link metric data'
          type: HTTP_AGENT
          key: velocloud.edge.link.get.data
          delay: '{$VELOCLOUD.EDGE.FREQUENCY}'
          history: '0'
          value_type: TEXT
          description: 'Link metric data in JSON format.'
          timeout: '{$VELOCLOUD.EDGE.DATA.TIMEOUT}'
          url: 'https://{$VELOCLOUD.URL}/portal/rest/monitoring/getAggregateEdgeLinkMetrics'
          posts: '{ "enterpriseId": {$VELOCLOUD.ENTERPRISE.ID}, "id": {$VELOCLOUD.EDGE.ID} }'
          headers:
            - name: Content-Type
              value: application/json
            - name: Authorization
              value: 'Token {$VELOCLOUD.TOKEN}'
          request_method: POST
          tags:
            - tag: component
              value: raw
        - uuid: 2bc1862325494b9bb7ffabfc3c67c527
          name: 'Memory usage in percent'
          type: DEPENDENT
          key: velocloud.edge.memory.usage
          value_type: FLOAT
          units: '%'
          description: 'Percentage of memory usage.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.memoryPct.max
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: velocloud.edge.status.metric.get
          tags:
            - tag: component
              value: memory
          triggers:
            - uuid: 03e08de7977f4299a46e65d3ef0c8d8f
              expression: 'min(/VeloCloud SD-WAN Edge by HTTP/velocloud.edge.memory.usage,15m)>{$VELOCLOUD.EDGE.MEMORY.UTIL.WARN}'
              name: 'VeloCloud Edge: High memory utilization'
              event_name: 'VeloCloud Edge: High memory utilization (over {$VELOCLOUD.EDGE.MEMORY.UTIL.WARN}% for 15m)'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'The system is running out of free memory.'
              tags:
                - tag: scope
                  value: capacity
                - tag: scope
                  value: performance
        - uuid: 08e7d1bb35634163b6d8afbde9e580ef
          name: 'Model number'
          type: DEPENDENT
          key: velocloud.edge.model
          value_type: TEXT
          description: 'Edge model number.'
          inventory_link: MODEL
          preprocessing:
            - type: JSONPATH
              parameters:
                - $..modelNumber.first()
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: velocloud.edge.get.data
          tags:
            - tag: component
              value: edge
            - tag: component
              value: system
        - uuid: f6f3f357d8d84c528bc5c1b6ae9ac868
          name: 'Service uptime'
          type: DEPENDENT
          key: velocloud.edge.service_uptime
          units: uptime
          description: 'Edge service uptime.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $..serviceUpSince.first()
            - type: JAVASCRIPT
              parameters:
                - |
                  value == '0000-00-00 00:00:00' ? value = 0 : value = Math.round((Date.now() - new Date(value).valueOf()) / 1000);
                  return value;
          master_item:
            key: velocloud.edge.get.data
          tags:
            - tag: component
              value: system
        - uuid: 9c2607c18dd740fdaa6ccaf07b2e4605
          name: 'Site city'
          type: SCRIPT
          key: velocloud.edge.site.city
          delay: 15m
          value_type: CHAR
          params: 'var inventory = JSON.stringify({$VELOCLOUD.EDGE.INVENTORY}), site = JSON.parse(inventory); if (site && site.city) { return site.city; } return '''';'
          description: 'Edge site city.'
          inventory_link: SITE_CITY
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          timeout: 10s
          tags:
            - tag: component
              value: inventory
        - uuid: f42d576a55e1483597120086a1ad82bb
          name: 'Site contact email'
          type: SCRIPT
          key: velocloud.edge.site.contact.email
          delay: 15m
          value_type: CHAR
          params: 'var inventory = JSON.stringify({$VELOCLOUD.EDGE.INVENTORY}), site = JSON.parse(inventory); if (site && site.contactEmail) { return site.contactEmail; } return '''';'
          description: 'Edge site contact email.'
          inventory_link: POC_1_EMAIL
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          timeout: 10s
          tags:
            - tag: component
              value: inventory
        - uuid: 3af49b08f5e045dda5e6fde965c57a36
          name: 'Site contact name'
          type: SCRIPT
          key: velocloud.edge.site.contact.name
          delay: 15m
          value_type: CHAR
          params: 'var inventory = JSON.stringify({$VELOCLOUD.EDGE.INVENTORY}), site = JSON.parse(inventory); if (site && site.contactName) { return site.contactName; } return '''';'
          description: 'Edge site contact name.'
          inventory_link: POC_1_NAME
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          timeout: 10s
          tags:
            - tag: component
              value: inventory
        - uuid: 1202af89193f4e86a016b5b77abf904c
          name: 'Site country'
          type: SCRIPT
          key: velocloud.edge.site.country
          delay: 15m
          value_type: CHAR
          params: 'var inventory = JSON.stringify({$VELOCLOUD.EDGE.INVENTORY}), site = JSON.parse(inventory); if (site && site.country) { return site.country; } return '''';'
          description: 'Edge site country.'
          inventory_link: SITE_COUNTRY
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          timeout: 10s
          tags:
            - tag: component
              value: inventory
        - uuid: b3e6b124960a4f169aba84bb3d65e618
          name: 'Site latitude'
          type: SCRIPT
          key: velocloud.edge.site.latitude
          delay: 15m
          value_type: CHAR
          params: 'var inventory = JSON.stringify({$VELOCLOUD.EDGE.INVENTORY}), site = JSON.parse(inventory); if (site && site.lat) { return site.lat; } return '''';'
          description: 'Edge site location latitude.'
          inventory_link: LOCATION_LAT
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          timeout: 10s
          tags:
            - tag: component
              value: inventory
        - uuid: a603e0982b5b40f79c4d2d6b9c7d0499
          name: 'Site longitude'
          type: SCRIPT
          key: velocloud.edge.site.longitude
          delay: 15m
          value_type: CHAR
          params: 'var inventory = JSON.stringify({$VELOCLOUD.EDGE.INVENTORY}), site = JSON.parse(inventory); if (site && site.lon) { return site.lon; } return '''';'
          description: 'Edge site location longitude.'
          inventory_link: LOCATION_LON
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          timeout: 10s
          tags:
            - tag: component
              value: inventory
        - uuid: 9afbf4ea56724985b225e351abba686e
          name: 'Site state'
          type: SCRIPT
          key: velocloud.edge.site.state
          delay: 15m
          value_type: CHAR
          params: 'var inventory = JSON.stringify({$VELOCLOUD.EDGE.INVENTORY}), site = JSON.parse(inventory); if (site && site.state) { return site.state; } return '''';'
          description: 'Edge site state.'
          inventory_link: SITE_STATE
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          timeout: 10s
          tags:
            - tag: component
              value: inventory
        - uuid: a262b95d6bd142acbb5f60d3a5197e0b
          name: 'Software version'
          type: DEPENDENT
          key: velocloud.edge.software_version
          value_type: TEXT
          description: 'Edge software version.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $..softwareVersion.first()
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: velocloud.edge.get.data
          tags:
            - tag: component
              value: system
        - uuid: 719ede2402b248a49b01565eeadee98d
          name: State
          type: DEPENDENT
          key: velocloud.edge.state
          description: 'Edge state.'
          valuemap:
            name: 'Edge states'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $..edgeState.first()
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
            - type: JAVASCRIPT
              parameters:
                - |
                  switch (value) {
                  	case 'OFFLINE':
                  		return 0;
                  	case 'CONNECTED':
                  		return 1;
                  	case 'NEVER_ACTIVATED':
                  		return 2;
                  	default:
                  		return 10;
                  }
          master_item:
            key: velocloud.edge.get.data
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 962d2d0c6f124424b2e5a7aca89d293f
              expression: 'last(/VeloCloud SD-WAN Edge by HTTP/velocloud.edge.state)=0'
              name: 'VeloCloud Edge: Edge is in "OFFLINE" state'
              priority: WARNING
              description: 'Edge state is "OFFLINE".'
              tags:
                - tag: scope
                  value: availability
        - uuid: fe7c54e7cdd143e0ac7a7fb173905202
          name: 'Get edge status metrics'
          type: HTTP_AGENT
          key: velocloud.edge.status.metric.get
          delay: 15m
          history: '0'
          value_type: TEXT
          description: 'Edge status metrics in JSON format.'
          url: 'https://{$VELOCLOUD.URL}/portal/rest/metrics/getEdgeStatusMetrics'
          posts: '{ "enterpriseId": {$VELOCLOUD.ENTERPRISE.ID}, "edgeId": {$VELOCLOUD.EDGE.ID} }'
          headers:
            - name: Content-Type
              value: application/json
            - name: Authorization
              value: 'Token {$VELOCLOUD.TOKEN}'
          request_method: POST
          tags:
            - tag: component
              value: raw
        - uuid: a32cf2363fda411eb55b9103c67c95f3
          name: 'System uptime'
          type: DEPENDENT
          key: velocloud.edge.system_uptime
          units: uptime
          description: 'Edge system uptime.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $..systemUpSince.first()
            - type: JAVASCRIPT
              parameters:
                - |
                  value == '0000-00-00 00:00:00' ? value = 0 : value = Math.round((Date.now() - new Date(value).valueOf()) / 1000);
                  return value;
          master_item:
            key: velocloud.edge.get.data
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 32e7a8a9b28a4f288254b8fbcba058dd
              expression: 'last(/VeloCloud SD-WAN Edge by HTTP/velocloud.edge.system_uptime)>0 and last(/VeloCloud SD-WAN Edge by HTTP/velocloud.edge.system_uptime)<600'
              name: 'VeloCloud Edge: Edge has been restarted'
              event_name: 'VeloCloud Edge: Edge has been restarted (uptime < 10m)'
              priority: WARNING
              description: 'Edge was restarted.'
              tags:
                - tag: scope
                  value: notice
        - uuid: d700795b93814e4e8e24d08ebdbc311b
          name: 'Tunnel count'
          type: DEPENDENT
          key: velocloud.edge.tunnel.count
          description: 'Total number of active tunnels.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.tunnelCount.max
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: velocloud.edge.status.metric.get
          tags:
            - tag: component
              value: system
        - uuid: 8253db4d5b8e407fa29f5ad47e98ee97
          name: 'Tunnel count V6'
          type: DEPENDENT
          key: velocloud.edge.tunnel.count.v6
          description: 'Total number of IPv6 tunnels.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.tunnelCountV6.max
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: velocloud.edge.status.metric.get
          tags:
            - tag: component
              value: system
      discovery_rules:
        - uuid: e334e0f58230456f83b5efc3801bd775
          name: 'Link metric discovery'
          type: DEPENDENT
          key: velocloud.link.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#NAME}'
                value: '{$VELOCLOUD.LLD.LINKS.NAME.FILTER.MATCHES}'
              - macro: '{#NAME}'
                value: '{$VELOCLOUD.LLD.LINKS.NAME.FILTER.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          description: 'Metrics for link statistics.'
          item_prototypes:
            - uuid: 7067ea17701b4c92af83ae0fdecbac0d
              name: 'Link [{#NAME}]:[{#IP}]: Raw data'
              type: DEPENDENT
              key: 'velocloud.get.link[{#ID}]'
              history: '0'
              value_type: TEXT
              description: 'Raw data for this VeloCloud link.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[?(@.linkId==''{#ID}'')].first()'
              master_item:
                key: velocloud.edge.link.get.data
              tags:
                - tag: component
                  value: raw
            - uuid: ca85601c81d943119e8e61a3eb878479
              name: 'Link [{#NAME}]:[{#IP}]: Best latency rx, ms'
              type: DEPENDENT
              key: 'velocloud.link.best_latency_rx[{#ID}]'
              value_type: FLOAT
              units: ms
              description: 'Best receive latency in milliseconds.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.bestLatencyMsRx
              master_item:
                key: 'velocloud.get.link[{#ID}]'
              tags:
                - tag: component
                  value: link
                - tag: enterprise
                  value: '{#ENTERPRISE}'
                - tag: interface
                  value: '{#IF}'
                - tag: ip
                  value: '{#IP}'
                - tag: name
                  value: '{#NAME}'
            - uuid: 924da40ad2024275a08aef84de24569a
              name: 'Link [{#NAME}]:[{#IP}]: Best latency tx, ms'
              type: DEPENDENT
              key: 'velocloud.link.best_latency_tx[{#ID}]'
              value_type: FLOAT
              units: ms
              description: 'Best transmit latency in milliseconds.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.bestLatencyMsTx
              master_item:
                key: 'velocloud.get.link[{#ID}]'
              tags:
                - tag: component
                  value: link
                - tag: enterprise
                  value: '{#ENTERPRISE}'
                - tag: interface
                  value: '{#IF}'
                - tag: ip
                  value: '{#IP}'
                - tag: name
                  value: '{#NAME}'
            - uuid: 05f14fbb358a46408f33fb6b08d7ea6d
              name: 'Link [{#NAME}]:[{#IP}]: Best loss rx, %'
              type: DEPENDENT
              key: 'velocloud.link.best_loss_rx.pct[{#ID}]'
              value_type: FLOAT
              description: 'Best receive loss in percent.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.bestLossPctRx
              master_item:
                key: 'velocloud.get.link[{#ID}]'
              tags:
                - tag: component
                  value: link
                - tag: enterprise
                  value: '{#ENTERPRISE}'
                - tag: interface
                  value: '{#IF}'
                - tag: ip
                  value: '{#IP}'
                - tag: name
                  value: '{#NAME}'
            - uuid: 2dbe6a58e02e42f4afec515daff6948f
              name: 'Link [{#NAME}]:[{#IP}]: Best loss tx, %'
              type: DEPENDENT
              key: 'velocloud.link.best_loss_tx.pct[{#ID}]'
              value_type: FLOAT
              description: 'Best transmit loss in percent.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.bestLossPctTx
              master_item:
                key: 'velocloud.get.link[{#ID}]'
              tags:
                - tag: component
                  value: link
                - tag: enterprise
                  value: '{#ENTERPRISE}'
                - tag: interface
                  value: '{#IF}'
                - tag: ip
                  value: '{#IP}'
                - tag: name
                  value: '{#NAME}'
            - uuid: c1e039d841c1461fb6afb4a5b589e029
              name: 'Link [{#NAME}]:[{#IP}]: Bytes in'
              type: DEPENDENT
              key: 'velocloud.link.bytes_rx[{#ID}]'
              units: B
              description: 'Received bytes for link.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.bytesRx
              master_item:
                key: 'velocloud.get.link[{#ID}]'
              tags:
                - tag: component
                  value: link
                - tag: enterprise
                  value: '{#ENTERPRISE}'
                - tag: interface
                  value: '{#IF}'
                - tag: ip
                  value: '{#IP}'
                - tag: name
                  value: '{#NAME}'
            - uuid: 91a0963dc57144e39902dbf49cfa07de
              name: 'Link [{#NAME}]:[{#IP}]: Bytes out'
              type: DEPENDENT
              key: 'velocloud.link.bytes_tx[{#ID}]'
              units: B
              description: 'Transmitted bytes for link.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.bytesTx
              master_item:
                key: 'velocloud.get.link[{#ID}]'
              tags:
                - tag: component
                  value: link
                - tag: enterprise
                  value: '{#ENTERPRISE}'
                - tag: interface
                  value: '{#IF}'
                - tag: ip
                  value: '{#IP}'
                - tag: name
                  value: '{#NAME}'
            - uuid: d74da7b2097d4ebcbafdf37d1a77150d
              name: 'Link [{#NAME}]:[{#IP}]: Last active'
              type: DEPENDENT
              key: 'velocloud.link.last_active[{#ID}]'
              units: s
              description: 'Time since last activity for link, in seconds.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.link.linkLastActive
                - type: JAVASCRIPT
                  parameters:
                    - 'return Math.round((Date.now() - new Date(value).valueOf()) / 1000);'
              master_item:
                key: 'velocloud.get.link[{#ID}]'
              tags:
                - tag: component
                  value: link
                - tag: enterprise
                  value: '{#ENTERPRISE}'
                - tag: interface
                  value: '{#IF}'
                - tag: ip
                  value: '{#IP}'
                - tag: name
                  value: '{#NAME}'
            - uuid: ae9c4dc8bc7542a0a36c8879c3ad54df
              name: 'Link [{#NAME}]:[{#IP}]: Packets in'
              type: DEPENDENT
              key: 'velocloud.link.packets_rx[{#ID}]'
              units: '!packets'
              description: 'Received packets for link.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.packetsRx
              master_item:
                key: 'velocloud.get.link[{#ID}]'
              tags:
                - tag: component
                  value: link
                - tag: enterprise
                  value: '{#ENTERPRISE}'
                - tag: interface
                  value: '{#IF}'
                - tag: ip
                  value: '{#IP}'
                - tag: name
                  value: '{#NAME}'
            - uuid: 583457c341cf41529e98b7631d8b52d6
              name: 'Link [{#NAME}]:[{#IP}]: Packets out'
              type: DEPENDENT
              key: 'velocloud.link.packets_tx[{#ID}]'
              units: '!packets'
              description: 'Transmitted packets for link.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.packetsTx
              master_item:
                key: 'velocloud.get.link[{#ID}]'
              tags:
                - tag: component
                  value: link
                - tag: enterprise
                  value: '{#ENTERPRISE}'
                - tag: interface
                  value: '{#IF}'
                - tag: ip
                  value: '{#IP}'
                - tag: name
                  value: '{#NAME}'
            - uuid: ebb11f5f2445427cb6e4dbe82d63017c
              name: 'Link [{#NAME}]:[{#IP}]: State'
              type: DEPENDENT
              key: 'velocloud.link.state[{#ID}]'
              description: 'Link state.'
              valuemap:
                name: 'Link states'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.link.linkState
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
                - type: JAVASCRIPT
                  parameters:
                    - |
                      switch (value) {
                      	case 'UNSTABLE':
                      		return 0;
                      	case 'STABLE':
                      		return 1;
                      	case 'DISCONNECTED':
                      		return 2;
                      	default:
                      		return 10;
                      }
              master_item:
                key: 'velocloud.get.link[{#ID}]'
              tags:
                - tag: component
                  value: link
                - tag: enterprise
                  value: '{#ENTERPRISE}'
                - tag: interface
                  value: '{#IF}'
                - tag: ip
                  value: '{#IP}'
                - tag: name
                  value: '{#NAME}'
              trigger_prototypes:
                - uuid: 7505955885414bdbbee9b93227a2c69e
                  expression: 'last(/VeloCloud SD-WAN Edge by HTTP/velocloud.link.state[{#ID}])<>1'
                  name: 'VeloCloud Edge: Link [{#NAME}]:[{#IP}]: Link state is not "STABLE"'
                  priority: WARNING
                  description: 'Link state is not "STABLE".'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 547fd14177874f0eb9871248589e55c5
              name: 'Link [{#NAME}]:[{#IP}]: Total bytes'
              type: DEPENDENT
              key: 'velocloud.link.total_bytes[{#ID}]'
              units: B
              description: 'Total bytes for link.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.totalBytes
              master_item:
                key: 'velocloud.get.link[{#ID}]'
              tags:
                - tag: component
                  value: link
                - tag: enterprise
                  value: '{#ENTERPRISE}'
                - tag: interface
                  value: '{#IF}'
                - tag: ip
                  value: '{#IP}'
                - tag: name
                  value: '{#NAME}'
            - uuid: 849d47a34d7742eeb660b25871d6f43a
              name: 'Link [{#NAME}]:[{#IP}]: Total packets'
              type: DEPENDENT
              key: 'velocloud.link.total_packets[{#ID}]'
              units: '!packets'
              description: 'Total packets for link.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.totalPackets
              master_item:
                key: 'velocloud.get.link[{#ID}]'
              tags:
                - tag: component
                  value: link
                - tag: enterprise
                  value: '{#ENTERPRISE}'
                - tag: interface
                  value: '{#IF}'
                - tag: ip
                  value: '{#IP}'
                - tag: name
                  value: '{#NAME}'
          graph_prototypes:
            - uuid: 3d166d25437640faa3f708dbfec91d85
              name: 'Link [{#NAME}]:[{#IP}]:[{#ID}]: Best latency'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'VeloCloud SD-WAN Edge by HTTP'
                    key: 'velocloud.link.best_latency_rx[{#ID}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'VeloCloud SD-WAN Edge by HTTP'
                    key: 'velocloud.link.best_latency_tx[{#ID}]'
            - uuid: 01e93c93fd0545a4bbb6c14bcea5f862
              name: 'Link [{#NAME}]:[{#IP}]:[{#ID}]: Best loss'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'VeloCloud SD-WAN Edge by HTTP'
                    key: 'velocloud.link.best_loss_rx.pct[{#ID}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'VeloCloud SD-WAN Edge by HTTP'
                    key: 'velocloud.link.best_loss_tx.pct[{#ID}]'
            - uuid: 3023541e671242618f3a0860e38c76a9
              name: 'Link [{#NAME}]:[{#IP}]:[{#ID}]: Bytes summary'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'VeloCloud SD-WAN Edge by HTTP'
                    key: 'velocloud.link.bytes_rx[{#ID}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'VeloCloud SD-WAN Edge by HTTP'
                    key: 'velocloud.link.bytes_tx[{#ID}]'
                - sortorder: '2'
                  color: 00611C
                  item:
                    host: 'VeloCloud SD-WAN Edge by HTTP'
                    key: 'velocloud.link.total_bytes[{#ID}]'
            - uuid: a27f4d1877e541beb18c3144988e48fa
              name: 'Link [{#NAME}]:[{#IP}]:[{#ID}]: Packets summary'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'VeloCloud SD-WAN Edge by HTTP'
                    key: 'velocloud.link.packets_rx[{#ID}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'VeloCloud SD-WAN Edge by HTTP'
                    key: 'velocloud.link.packets_tx[{#ID}]'
                - sortorder: '2'
                  color: 00611C
                  item:
                    host: 'VeloCloud SD-WAN Edge by HTTP'
                    key: 'velocloud.link.total_packets[{#ID}]'
          master_item:
            key: velocloud.edge.link.get.data
          lld_macro_paths:
            - lld_macro: '{#ENTERPRISE}'
              path: $.link.enterpriseName
            - lld_macro: '{#ID}'
              path: $.link.linkId
            - lld_macro: '{#IF}'
              path: $.link.interface
            - lld_macro: '{#IP}'
              path: $.link.linkIpAddress
            - lld_macro: '{#NAME}'
              path: $.link.displayName
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: e3c8ac51bd304a96ab9fb7876b1b70f6
          name: 'SD-WAN peer path metric discovery'
          type: DEPENDENT
          key: velocloud.sdwan.path.discovery
          description: 'Metrics for SD-WAN peer paths.'
          item_prototypes:
            - uuid: a9cd1da8eb3e4844a39119e8fac033e9
              name: 'Path [{#NAME}]:[{#SOURCE} => {#DESTINATION}]: Raw data'
              type: DEPENDENT
              key: 'velocloud.get.sdwan_path[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              history: '0'
              value_type: TEXT
              description: 'Raw data for VeloCloud SD-WAN peer path.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.edgeSDWanPath[?(@.source.linkName==''{#NAME}'' && @.source.linkLogicalId==''{#LINK.LOGICAL.ID}'' && @.source.deviceName==''{#SOURCE}'' && @.destination.deviceName==''{#DESTINATION}'')].first()'
              master_item:
                key: velocloud.edge.get.peer.data
              tags:
                - tag: component
                  value: raw
                - tag: component
                  value: sd-wan-path
            - uuid: 54e1f10281d64c859a7a210fa091ee4d
              name: 'Path [{#NAME}]:[{#SOURCE} => {#DESTINATION}]: Bytes in'
              type: DEPENDENT
              key: 'velocloud.sdwan.path.bytes_rx[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              units: B
              description: 'Bytes received for SD-WAN peer path.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.metrics.bytesRx
              master_item:
                key: 'velocloud.get.sdwan_path[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              tags:
                - tag: component
                  value: sd-wan-path
                - tag: destination
                  value: '{#DESTINATION}'
                - tag: path
                  value: '{#NAME}'
                - tag: source
                  value: '{#SOURCE}'
            - uuid: 57873613524b4cc29600971457b4ea85
              name: 'Path [{#NAME}]:[{#SOURCE} => {#DESTINATION}]: Bytes out'
              type: DEPENDENT
              key: 'velocloud.sdwan.path.bytes_tx[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              units: B
              description: 'Bytes transmitted for SD-WAN peer path.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.metrics.bytesTx
              master_item:
                key: 'velocloud.get.sdwan_path[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              tags:
                - tag: component
                  value: sd-wan-path
                - tag: destination
                  value: '{#DESTINATION}'
                - tag: path
                  value: '{#NAME}'
                - tag: source
                  value: '{#SOURCE}'
            - uuid: 37d693c024c14b168689d860fbdafb14
              name: 'Path [{#NAME}]:[{#SOURCE} => {#DESTINATION}]: Packets in'
              type: DEPENDENT
              key: 'velocloud.sdwan.path.packets_rx[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              units: '!packets'
              description: 'Packets received for SD-WAN peer path.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.metrics.packetsRx
              master_item:
                key: 'velocloud.get.sdwan_path[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              tags:
                - tag: component
                  value: sd-wan-path
                - tag: destination
                  value: '{#DESTINATION}'
                - tag: path
                  value: '{#NAME}'
                - tag: source
                  value: '{#SOURCE}'
            - uuid: 61141a5b812c47ebb00ab042a2acee8f
              name: 'Path [{#NAME}]:[{#SOURCE} => {#DESTINATION}]: Packets out'
              type: DEPENDENT
              key: 'velocloud.sdwan.path.packets_tx[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              units: '!packets'
              description: 'Packets transmitted for SD-WAN peer path.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.metrics.packetsTx
              master_item:
                key: 'velocloud.get.sdwan_path[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              tags:
                - tag: component
                  value: sd-wan-path
                - tag: destination
                  value: '{#DESTINATION}'
                - tag: path
                  value: '{#NAME}'
                - tag: source
                  value: '{#SOURCE}'
            - uuid: 3a858422652644cdbede50a3b86097be
              name: 'Path [{#NAME}]:[{#SOURCE} => {#DESTINATION}]: Packet loss in'
              type: DEPENDENT
              key: 'velocloud.sdwan.path.packet_loss_rx[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              value_type: FLOAT
              units: '%'
              description: 'Received packet loss for SD-WAN peer path.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.metrics.packetLossRx
              master_item:
                key: 'velocloud.get.sdwan_path[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              tags:
                - tag: component
                  value: sd-wan-path
                - tag: destination
                  value: '{#DESTINATION}'
                - tag: path
                  value: '{#NAME}'
                - tag: source
                  value: '{#SOURCE}'
            - uuid: 75369efc91734964b8a5872fc921c684
              name: 'Path [{#NAME}]:[{#SOURCE} => {#DESTINATION}]: Packet loss out'
              type: DEPENDENT
              key: 'velocloud.sdwan.path.packet_loss_tx[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              value_type: FLOAT
              units: '%'
              description: 'Transmitted packet loss for SD-WAN peer path.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.metrics.packetLossTx
              master_item:
                key: 'velocloud.get.sdwan_path[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              tags:
                - tag: component
                  value: sd-wan-path
                - tag: destination
                  value: '{#DESTINATION}'
                - tag: path
                  value: '{#NAME}'
                - tag: source
                  value: '{#SOURCE}'
            - uuid: 2a52d7cab0604ff2bb87e17d6e3cfda1
              name: 'Path [{#NAME}]:[{#SOURCE} => {#DESTINATION}]: Bytes total'
              type: DEPENDENT
              key: 'velocloud.sdwan.path.total_bytes[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              units: B
              description: 'Total bytes for SD-WAN peer path.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.metrics.totalBytes
              master_item:
                key: 'velocloud.get.sdwan_path[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              tags:
                - tag: component
                  value: sd-wan-path
                - tag: destination
                  value: '{#DESTINATION}'
                - tag: path
                  value: '{#NAME}'
                - tag: source
                  value: '{#SOURCE}'
            - uuid: e071f96cdb7f48909e6afba191fa31f2
              name: 'Path [{#NAME}]:[{#SOURCE} => {#DESTINATION}]: Total packets'
              type: DEPENDENT
              key: 'velocloud.sdwan.path.total_packets[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              units: '!packets'
              description: 'Total packets for SD-WAN peer path.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.metrics.totalPackets
              master_item:
                key: 'velocloud.get.sdwan_path[{#NAME}/{#SOURCE}/{#DESTINATION}/{#LINK.LOGICAL.ID}]'
              tags:
                - tag: component
                  value: sd-wan-path
                - tag: destination
                  value: '{#DESTINATION}'
                - tag: path
                  value: '{#NAME}'
                - tag: source
                  value: '{#SOURCE}'
          master_item:
            key: velocloud.edge.get.peer.data
          lld_macro_paths:
            - lld_macro: '{#DESTINATION}'
              path: $.destination.deviceName
            - lld_macro: '{#LINK.LOGICAL.ID}'
              path: $.source.linkLogicalId
            - lld_macro: '{#NAME}'
              path: $.source.linkName
            - lld_macro: '{#SOURCE}'
              path: $.source.deviceName
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.edgeSDWanPath
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 5fcdbf684e29440f92d9a5718931966e
          name: 'SD-WAN peer metric discovery'
          type: DEPENDENT
          key: velocloud.sdwan.peer.discovery
          description: 'Metrics for SD-WAN peers.'
          item_prototypes:
            - uuid: b49bcac20607419084db11943224e85f
              name: 'SD-WAN Peer [{#NAME}]:[{#TYPE}]: Raw data'
              type: DEPENDENT
              key: 'velocloud.get.sdwan.peer[{#EDGE.ID}/{#ID}]'
              history: '0'
              value_type: TEXT
              description: 'Raw data for VeloCloud SD-WAN peer.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.edgeSDWan[?(@.deviceLogicalId==''{#ID}'' && @.edgeId==''{#EDGE.ID}'')].first()'
              master_item:
                key: velocloud.edge.get.peer.data
              tags:
                - tag: component
                  value: raw
                - tag: component
                  value: sd-wan-peer
            - uuid: f10ff8d7db5e4c08835aa317d975854a
              name: 'SD-WAN Peer [{#NAME}]:[{#TYPE}]: Dead path'
              type: DEPENDENT
              key: 'velocloud.sdwan.peer.dead_path[{#EDGE.ID}/{#ID}]'
              description: 'Number of dead paths for SD-WAN peer.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.pathStatusCount.dead
              master_item:
                key: 'velocloud.get.sdwan.peer[{#EDGE.ID}/{#ID}]'
              tags:
                - tag: component
                  value: sd-wan-peer
                - tag: edge
                  value: '{#EDGE}'
                - tag: peer
                  value: '{#NAME}'
                - tag: type
                  value: '{#TYPE}'
            - uuid: 917d56352c444a8babf0b499540b8cf3
              name: 'SD-WAN Peer [{#NAME}]:[{#TYPE}]: Description'
              type: DEPENDENT
              key: 'velocloud.sdwan.peer.description[{#EDGE.ID}/{#ID}]'
              value_type: TEXT
              description: 'Description of SD-WAN peer.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.description
                - type: STR_REPLACE
                  parameters:
                    - 'null'
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
              master_item:
                key: 'velocloud.get.sdwan.peer[{#EDGE.ID}/{#ID}]'
              tags:
                - tag: component
                  value: sd-wan-peer
                - tag: edge
                  value: '{#EDGE}'
                - tag: peer
                  value: '{#NAME}'
                - tag: type
                  value: '{#TYPE}'
            - uuid: 7e3d1fa5d1224972b5db03e6ff52cd6b
              name: 'SD-WAN Peer [{#NAME}]:[{#TYPE}]: Stable path'
              type: DEPENDENT
              key: 'velocloud.sdwan.peer.stable_path[{#EDGE.ID}/{#ID}]'
              description: 'Number of stable paths for SD-WAN peer.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.pathStatusCount.stable
              master_item:
                key: 'velocloud.get.sdwan.peer[{#EDGE.ID}/{#ID}]'
              tags:
                - tag: component
                  value: sd-wan-peer
                - tag: edge
                  value: '{#EDGE}'
                - tag: peer
                  value: '{#NAME}'
                - tag: type
                  value: '{#TYPE}'
            - uuid: 8db7e0a4e7db4a1e85a785468a601a5f
              name: 'SD-WAN Peer [{#NAME}]:[{#TYPE}]: Standby path'
              type: DEPENDENT
              key: 'velocloud.sdwan.peer.standby_path[{#EDGE.ID}/{#ID}]'
              description: 'Number of standby paths for SD-WAN peer.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.pathStatusCount.standby
              master_item:
                key: 'velocloud.get.sdwan.peer[{#EDGE.ID}/{#ID}]'
              tags:
                - tag: component
                  value: sd-wan-peer
                - tag: edge
                  value: '{#EDGE}'
                - tag: peer
                  value: '{#NAME}'
                - tag: type
                  value: '{#TYPE}'
            - uuid: 91c755ccf2d4463583a96d0fc8806507
              name: 'SD-WAN Peer [{#NAME}]:[{#TYPE}]: Total path'
              type: DEPENDENT
              key: 'velocloud.sdwan.peer.total_path[{#EDGE.ID}/{#ID}]'
              description: 'Number of total paths for SD-WAN peer.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.pathStatusCount.total
              master_item:
                key: 'velocloud.get.sdwan.peer[{#EDGE.ID}/{#ID}]'
              tags:
                - tag: component
                  value: sd-wan-peer
                - tag: edge
                  value: '{#EDGE}'
                - tag: peer
                  value: '{#NAME}'
                - tag: type
                  value: '{#TYPE}'
            - uuid: b7451d0fb6f4487f981c183dd6680f62
              name: 'SD-WAN Peer [{#NAME}]:[{#TYPE}]: Unknown path'
              type: DEPENDENT
              key: 'velocloud.sdwan.peer.unknown_path[{#EDGE.ID}/{#ID}]'
              description: 'Number of unknown paths for SD-WAN peer.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.pathStatusCount.unknown
              master_item:
                key: 'velocloud.get.sdwan.peer[{#EDGE.ID}/{#ID}]'
              tags:
                - tag: component
                  value: sd-wan-peer
                - tag: edge
                  value: '{#EDGE}'
                - tag: peer
                  value: '{#NAME}'
                - tag: type
                  value: '{#TYPE}'
            - uuid: 7c4ba627011a447e89232e082c15174c
              name: 'SD-WAN Peer [{#NAME}]:[{#TYPE}]: Unstable path'
              type: DEPENDENT
              key: 'velocloud.sdwan.peer.unstable_path[{#EDGE.ID}/{#ID}]'
              description: 'Number of unstable paths for SD-WAN peer.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.pathStatusCount.unstable
              master_item:
                key: 'velocloud.get.sdwan.peer[{#EDGE.ID}/{#ID}]'
              tags:
                - tag: component
                  value: sd-wan-peer
                - tag: edge
                  value: '{#EDGE}'
                - tag: peer
                  value: '{#NAME}'
                - tag: type
                  value: '{#TYPE}'
          graph_prototypes:
            - uuid: acc5c04f97724dbfa18293211ebbd70c
              name: 'SD-WAN Peer [{#NAME}]:[{#TYPE}]: {#EDGE.ID}: Path overview'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'VeloCloud SD-WAN Edge by HTTP'
                    key: 'velocloud.sdwan.peer.stable_path[{#EDGE.ID}/{#ID}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'VeloCloud SD-WAN Edge by HTTP'
                    key: 'velocloud.sdwan.peer.dead_path[{#EDGE.ID}/{#ID}]'
                - sortorder: '2'
                  color: 00611C
                  item:
                    host: 'VeloCloud SD-WAN Edge by HTTP'
                    key: 'velocloud.sdwan.peer.standby_path[{#EDGE.ID}/{#ID}]'
                - sortorder: '3'
                  color: F7941D
                  item:
                    host: 'VeloCloud SD-WAN Edge by HTTP'
                    key: 'velocloud.sdwan.peer.unknown_path[{#EDGE.ID}/{#ID}]'
                - sortorder: '4'
                  color: FC6EA3
                  item:
                    host: 'VeloCloud SD-WAN Edge by HTTP'
                    key: 'velocloud.sdwan.peer.unstable_path[{#EDGE.ID}/{#ID}]'
          master_item:
            key: velocloud.edge.get.peer.data
          lld_macro_paths:
            - lld_macro: '{#EDGE.ID}'
              path: $.edgeId
            - lld_macro: '{#EDGE}'
              path: $.edgeName
            - lld_macro: '{#ID}'
              path: $.deviceLogicalId
            - lld_macro: '{#NAME}'
              path: $.peerName
            - lld_macro: '{#TYPE}'
              path: $.peerType
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.edgeSDWan
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
      tags:
        - tag: class
          value: network
        - tag: target
          value: velocloud-sd-wan-edge
      macros:
        - macro: '{$VELOCLOUD.EDGE.CPU.UTIL.WARN}'
          value: '80'
          description: 'Warning threshold of cluster service CPU utilization expressed in percent.'
          config:
            type: TEXT
            priority: '6'
            section_name: Thresholds
            label: 'CPU Utilization Warning Threshold'
            description: 'The maximum CPU utilization percentage before a warning is triggered.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$VELOCLOUD.EDGE.DATA.TIMEOUT}'
          value: 15s
          description: 'Response timeout for API.'
          config:
            type: TEXT
            priority: '8'
            label: 'API timeout'
            description: 'Response timeout for the API (e.g., 15s). In the range from 1 to 60 inclusive.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$VELOCLOUD.EDGE.FREQUENCY}'
          value: 15m
          description: 'Update interval for raw item collection.'
          config:
            type: TEXT
            priority: '7'
            label: 'Update interval'
            description: 'Update interval for raw item (e.g., 1h).'
        - macro: '{$VELOCLOUD.EDGE.ID}'
          description: 'SD-WAN Edge ID.'
          config:
            type: TEXT
            priority: '4'
            label: 'Edge ID'
            description: 'VeloCloud SD-WAN Edge ID.'
            required: 'YES'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$VELOCLOUD.EDGE.MEMORY.UTIL.WARN}'
          value: '70'
          description: 'Warning threshold of cluster memory utilization expressed in percent.'
          config:
            type: TEXT
            priority: '5'
            section_name: Thresholds
            label: 'Memory Utilization Warning Threshold'
            description: 'The maximum memory utilization percentage before a warning is triggered.'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$VELOCLOUD.ENTERPRISE.ID}'
          description: 'VeloCloud SD-WAN Enterprise ID. Specify a single Enterprise ID (requires READ EDGE privileges). By default parameter is empty, data will be retrieved for all Enterprises (privileges required: READ ENTERPRISE and READ EDGE).'
          config:
            type: TEXT
            priority: '3'
            label: 'Enterprise ID'
            description: 'VeloCloud SD-WAN Enterprise ID.'
            required: 'YES'
            regex: '^-?([0-9]+|(([0-9]+)\.([0-9]+)))$'
        - macro: '{$VELOCLOUD.LLD.LINKS.NAME.FILTER.MATCHES}'
          value: '.*'
          description: 'Filter for discoverable links.'
          config:
            type: TEXT
            priority: '9'
            section_name: 'Discovery filters'
            label: 'links name matches'
            description: 'Regex to match links names.'
        - macro: '{$VELOCLOUD.LLD.LINKS.NAME.FILTER.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Filter to exclude discovered links.'
          config:
            type: TEXT
            priority: '10'
            section_name: 'Discovery filters'
            label: 'Links name not matches'
            description: 'A regex to exclude certain links names from discovery.'
        - macro: '{$VELOCLOUD.TOKEN}'
          type: SECRET_TEXT
          description: 'VeloCloud SD-WAN Orchestrator API token.'
          config:
            type: TEXT
            priority: '1'
            label: 'API token'
            description: 'VeloCloud SD-WAN Orchestrator API token.'
            required: 'YES'
        - macro: '{$VELOCLOUD.URL}'
          description: 'VeloCloud SD-WAN Orchestrator URL, e.g., `vco.velocloud.net`.'
          config:
            type: TEXT
            priority: '2'
            label: 'API URL'
            description: 'VeloCloud SD-WAN Orchestrator API URL. Format example: `vco.velocloud.net`'
            required: 'YES'
      dashboards:
        - uuid: e286e61fd48b42e0b2cc10375f947966
          name: 'VeloCloud: General'
          pages:
            - name: Overview
              widgets:
                - type: item
                  width: '14'
                  height: '4'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'VeloCloud SD-WAN Edge by HTTP'
                        key: velocloud.edge.activation
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '4'
                    - type: INTEGER
                      name: value_size
                      value: '15'
                - type: gauge
                  name: 'CPU usage'
                  'y': '4'
                  width: '14'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: angle
                      value: '270'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'VeloCloud SD-WAN Edge by HTTP'
                        key: velocloud.edge.cpu.usage
                    - type: INTEGER
                      name: show.0
                      value: '3'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: show.2
                      value: '4'
                    - type: INTEGER
                      name: show.3
                      value: '5'
                    - type: STRING
                      name: thresholds.0.color
                      value: 2196F3
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: FF8000
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '60'
                    - type: STRING
                      name: thresholds.2.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '80'
                    - type: INTEGER
                      name: th_arc_size
                      value: '20'
                    - type: INTEGER
                      name: th_show_arc
                      value: '1'
                    - type: INTEGER
                      name: units_bold
                      value: '1'
                    - type: INTEGER
                      name: units_size
                      value: '20'
                    - type: INTEGER
                      name: value_bold
                      value: '1'
                    - type: INTEGER
                      name: value_size
                      value: '20'
                - type: gauge
                  name: 'Memory usage'
                  'y': '9'
                  width: '14'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: angle
                      value: '270'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'VeloCloud SD-WAN Edge by HTTP'
                        key: velocloud.edge.memory.usage
                    - type: INTEGER
                      name: show.0
                      value: '3'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: show.2
                      value: '4'
                    - type: INTEGER
                      name: show.3
                      value: '5'
                    - type: STRING
                      name: thresholds.0.color
                      value: 9CCC65
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: FF8000
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '60'
                    - type: STRING
                      name: thresholds.2.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '80'
                    - type: INTEGER
                      name: th_arc_size
                      value: '20'
                    - type: INTEGER
                      name: th_show_arc
                      value: '1'
                    - type: INTEGER
                      name: units_bold
                      value: '1'
                    - type: INTEGER
                      name: units_size
                      value: '20'
                    - type: INTEGER
                      name: value_bold
                      value: '1'
                    - type: INTEGER
                      name: value_size
                      value: '20'
                - type: geomap
                  name: 'Edge geo'
                  'y': '14'
                  width: '72'
                  height: '7'
                  fields:
                    - type: STRING
                      name: default_view
                      value: '40.6892494,-74.0466891,10'
                    - type: STRING
                      name: reference
                      value: FZFLX
                - type: item
                  x: '14'
                  width: '14'
                  height: '4'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'VeloCloud SD-WAN Edge by HTTP'
                        key: velocloud.edge.ha_state
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '4'
                    - type: INTEGER
                      name: value_size
                      value: '15'
                - type: svggraph
                  name: 'Best latency sent'
                  x: '14'
                  'y': '4'
                  width: '58'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 388E3C
                    - type: STRING
                      name: ds.0.items.0
                      value: '*Best latency tx, ms'
                    - type: STRING
                      name: reference
                      value: FDBBC
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: svggraph
                  name: 'Best latency received'
                  x: '14'
                  'y': '9'
                  width: '58'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 1565C0
                    - type: STRING
                      name: ds.0.items.0
                      value: '*Best latency rx, ms'
                    - type: STRING
                      name: reference
                      value: XMHZG
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: item
                  x: '28'
                  width: '14'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'VeloCloud SD-WAN Edge by HTTP'
                        key: velocloud.edge.model
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '20'
                - type: item
                  x: '42'
                  width: '14'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'VeloCloud SD-WAN Edge by HTTP'
                        key: velocloud.edge.software_version
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '20'
                - type: item
                  x: '56'
                  width: '16'
                  height: '4'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'VeloCloud SD-WAN Edge by HTTP'
                        key: velocloud.edge.system_uptime
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: value_size
                      value: '20'
            - name: Links
              widgets:
                - type: svggraph
                  name: 'Output packets'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 5E35B1
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Link *: Packets out'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: INTEGER
                      name: legend_lines
                      value: '4'
                    - type: STRING
                      name: reference
                      value: FFCAF
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: svggraph
                  name: 'Best loss tx'
                  'y': '5'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: '795548'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Link *: Best loss tx, %'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: STRING
                      name: reference
                      value: FCDDA
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: svggraph
                  name: 'Incoming traffic'
                  'y': '10'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 78909C
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Link *: Bytes in'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: STRING
                      name: reference
                      value: FEECA
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: svggraph
                  name: 'Input packets'
                  x: '36'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 0D47A1
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Link *: Packets in'
                    - type: INTEGER
                      name: legend_lines
                      value: '4'
                    - type: STRING
                      name: reference
                      value: AEBCF
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: svggraph
                  name: 'Best loss rx'
                  x: '36'
                  'y': '5'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: AC3C00
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Link *: Best loss rx, %'
                    - type: STRING
                      name: reference
                      value: ACDAE
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: svggraph
                  name: 'Outgoing traffic'
                  x: '36'
                  'y': '10'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 9575CD
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Link *: Bytes out'
                    - type: STRING
                      name: reference
                      value: AEBFA
                    - type: INTEGER
                      name: righty
                      value: '0'
            - name: 'SD-WAN peers'
              widgets:
                - type: honeycomb
                  name: 'Stable path'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'SD-WAN Peer [*]:[*]: Stable path'
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: STRING
                      name: reference
                      value: YWRAS
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                - type: honeycomb
                  name: 'Unstable path'
                  'y': '4'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'SD-WAN Peer [*]:[*]: Unstable path'
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: INTEGER
                      name: primary_label_bold
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AGOOH
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                - type: honeycomb
                  name: 'Unknown path'
                  'y': '8'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'SD-WAN Peer [*]:[*]: Unknown path'
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: INTEGER
                      name: primary_label_bold
                      value: '1'
                    - type: STRING
                      name: reference
                      value: ACDEB
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                - type: honeycomb
                  name: 'Standby path'
                  x: '36'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'SD-WAN Peer [*]:[*]: Standby path'
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: STRING
                      name: reference
                      value: XGHBR
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                - type: honeycomb
                  name: 'Dead path'
                  x: '36'
                  'y': '4'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'SD-WAN Peer [*]:[*]: Dead path'
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: INTEGER
                      name: primary_label_bold
                      value: '1'
                    - type: STRING
                      name: reference
                      value: CBFDD
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                - type: honeycomb
                  name: 'Total path'
                  x: '36'
                  'y': '8'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'SD-WAN Peer [*]:[*]: Total path'
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: INTEGER
                      name: primary_label_bold
                      value: '1'
                    - type: STRING
                      name: reference
                      value: ABBEA
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
            - name: 'SD-WAN peers path'
              widgets:
                - type: svggraph
                  name: 'Output packets'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 5E35B1
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Path *: Packets out'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: INTEGER
                      name: legend_lines
                      value: '4'
                    - type: STRING
                      name: reference
                      value: EBDDA
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: svggraph
                  name: 'Packet loss in'
                  'y': '5'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: '795548'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Path *: Packet loss in'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: STRING
                      name: reference
                      value: DBDFF
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: svggraph
                  name: 'Incoming traffic'
                  'y': '10'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 78909C
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Path *: Bytes in'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: STRING
                      name: reference
                      value: CBDAC
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: svggraph
                  name: 'Input packets'
                  x: '36'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 0D47A1
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Path *: Packets in'
                    - type: INTEGER
                      name: legend_lines
                      value: '4'
                    - type: STRING
                      name: reference
                      value: FDDAB
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: svggraph
                  name: 'Packet loss out'
                  x: '36'
                  'y': '5'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: AC3C00
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Path *: Packet loss out'
                    - type: STRING
                      name: reference
                      value: BFDDC
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: svggraph
                  name: 'Outgoing traffic'
                  x: '36'
                  'y': '10'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 9575CD
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Path *: Bytes out'
                    - type: STRING
                      name: reference
                      value: DCBAD
                    - type: INTEGER
                      name: righty
                      value: '0'
      valuemaps:
        - uuid: fb5c3e8c7565458b80e55f16c3e088d7
          name: 'Edge activation state'
          mappings:
            - value: '0'
              newvalue: PENDING
            - value: '1'
              newvalue: ACTIVATED
            - value: '10'
              newvalue: UNKNOWN
        - uuid: 017a5a34c8984720ae2032855255fb76
          name: 'Edge HA status'
          mappings:
            - value: '0'
              newvalue: UNCONFIGURED
            - value: '1'
              newvalue: READY
            - value: '2'
              newvalue: PENDING_INIT
            - value: '3'
              newvalue: FAILED
            - value: '10'
              newvalue: UNKNOWN
        - uuid: 1ca0e7345c1b4bfd89da2009cf81a6a8
          name: 'Edge states'
          mappings:
            - value: '0'
              newvalue: OFFLINE
            - value: '1'
              newvalue: CONNECTED
            - value: '2'
              newvalue: NEVER_ACTIVATED
            - value: '10'
              newvalue: UNKNOWN
        - uuid: 4233328ae66d4961ab1709bd9fbaa791
          name: 'Link states'
          mappings:
            - value: '0'
              newvalue: UNSTABLE
            - value: '1'
              newvalue: STABLE
            - value: '2'
              newvalue: DISCONNECTED
            - value: '10'
              newvalue: UNKNOWN
