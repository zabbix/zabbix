zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    - uuid: 6095f32a1e6f432a8a053e6245891632
      template: 'Ribbon SBC Edge by HTTP'
      name: 'Ribbon SBC Edge by HTTP'
      description: |
        The Ribbon Session Border Controller Edge (SBC Edge) is a security and interoperability solution for medium-sized businesses and large branch offices.
        
        This template is designed for the effortless deployment of Ribbon SBC Edge monitoring and doesn't require any external scripts.
        
        More details can be found in the official Ribbon documentation:
        - REST API Reference: https://publicdoc.rbbn.com/spaces/UXAPIDOC/pages/17400598/Configuration+Resources
        - REST API User's Guide: https://publicdoc.rbbn.com/spaces/UXAPIDOC/pages/387008766/REST+API+User+s+Guide
        
        Generated by official Zabbix template tool "Templator"
      vendor:
        name: Zabbix
        version: 7.0-0
      groups:
        - name: 'Templates/Network devices'
      items:
        - uuid: 1c2a712b43194ee2b3dc923647a69086
          name: 'Get active alarms'
          type: SCRIPT
          key: ribbon.alarm.get
          delay: '{$RIBBON.INTERVAL:"get_alarm"}'
          history: '0'
          value_type: TEXT
          trends: '0'
          params: |
            var Ribbon = {
            	params: {},
            	request: new HttpRequest(),
            
            	setParams: function (params) {
            		['url', 'username', 'password'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		Ribbon.params = params;
            
            		if (typeof Ribbon.params.url === 'string') {
            			if (Ribbon.params.url.endsWith('/')) {
            				Ribbon.params.url = Ribbon.params.url.slice(0,-1);
            			}
            		}
            
            	},
            
            	getRequest: function (url) {
            		var response;
            
            		if (typeof Ribbon.params.proxy !== 'undefined' && Ribbon.params.proxy !== '') {
            			Ribbon.request.setProxy(Ribbon.params.proxy);
            		}
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Sending request: ' + Ribbon.params.url  + url);
            
            		response = Ribbon.request.get(Ribbon.params.url + url);
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Received response with status code ' + Ribbon.request.getStatus() + ': ' + response);
            
            		if (Ribbon.request.getStatus() < 200 || Ribbon.request.getStatus() >= 300) {
            			throw 'Cannot connect to Ribbon SBC. Check debug log for more information.';
            		}
            
            		try {
            			response = JSON.parse(XML.toJson(response));
            		}
            		catch (error) {
            			throw 'Failed to parse response received from Ribbon SBC API. Check debug log for more information.';
            		}
            
            		return response;
            	},
            
            	getField: function (data, path) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path;
            			}
            			data = data[step];
            		}
            
            		return data;
            	},
            
            	login: function () {
            		var response = "",
            			cookies = "",
            			payload = 'Username=' + encodeURIComponent(Ribbon.params.username) + '&Password=' + encodeURIComponent(Ribbon.params.password);
            
            		Ribbon.request.addHeader('Content-Type', 'application/x-www-form-urlencoded');
            		response = Ribbon.request.post(Ribbon.params.url + '/rest/login', payload);
            
            		var headers = Ribbon.request.getHeaders();
            		for (var key in headers) {
            			if (key.toLowerCase() == 'set-cookie') {
            				cookies = headers[key];
            			}
            		}
            
            		Ribbon.request.addHeader('Cookie', cookies);
            	},
            
            	logout: function () {
            		var response = Ribbon.request.post(Ribbon.params.url + '/rest/logout');
            
            		return JSON.parse(XML.toJson(response));
            	}
            };
            
            try {
            	var result = {};
            
            	Ribbon.setParams(JSON.parse(value));
            	Ribbon.login();
            
            	var activealarm_list = Ribbon.getField(Ribbon.getRequest("/rest/activealarm"), 'root.activealarm_list'),
            		count = Ribbon.getField(activealarm_list, '@count');
            
            	if (count !== '0') {
            		var activealarm = Ribbon.getField(activealarm_list, 'activealarm_pk');
            
            		if (!Array.isArray(activealarm)) {
            			activealarm = [activealarm];
            		}
            
            		for (var alarm in activealarm) {
            			var id = Ribbon.getField(activealarm[alarm], '@id');
            			result[id] = Ribbon.getField(Ribbon.getRequest("/rest/activealarm/" + id), 'root.activealarm');
            		}
            	}
            
            	Ribbon.logout();
            
            	return JSON.stringify(result);
            }
            catch (error) {
            	Zabbix.log(3, '[ Ribbon SBC Edge ] Alarms ERROR: ' + error);
            	error_msg = 'Failed to get active alarm from API:' + error;
            
            	return JSON.stringify({ 'error': error_msg });
            }
          description: 'Gets the active alarms.'
          timeout: '{$RIBBON.TIMEOUT}'
          parameters:
            - name: password
              value: '{$RIBBON.PASSWORD}'
            - name: proxy
              value: '{$RIBBON.PROXY}'
            - name: url
              value: '{$RIBBON.URL}'
            - name: username
              value: '{$RIBBON.USERNAME}'
          tags:
            - tag: component
              value: raw
        - uuid: 28eed9b2ddb7440b9bb5b1183a9d6ff3
          name: 'Get certificate info'
          type: SCRIPT
          key: ribbon.cert.get
          delay: '{$RIBBON.INTERVAL:"get_certificate"}'
          history: '0'
          value_type: TEXT
          trends: '0'
          params: |
            var Ribbon = {
            	params: {},
            	request: new HttpRequest(),
            
            	setParams: function (params) {
            		['url', 'username', 'password'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		Ribbon.params = params;
            
            		if (typeof Ribbon.params.url === 'string') {
            			if (Ribbon.params.url.endsWith('/')) {
            				Ribbon.params.url = Ribbon.params.url.slice(0,-1);
            			}
            		}
            
            	},
            
            	getRequest: function (url) {
            		var response;
            
            		if (typeof Ribbon.params.proxy !== 'undefined' && Ribbon.params.proxy !== '') {
            			Ribbon.request.setProxy(Ribbon.params.proxy);
            		}
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Sending request: ' + Ribbon.params.url  + url);
            
            		response = Ribbon.request.get(Ribbon.params.url + url);
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Received response with status code ' + Ribbon.request.getStatus() + ': ' + response);
            
            		if (Ribbon.request.getStatus() < 200 || Ribbon.request.getStatus() >= 300) {
            			throw 'Cannot connect to Ribbon SBC. Check debug log for more information.';
            		}
            
            		try {
            			response = JSON.parse(XML.toJson(response));
            		}
            		catch (error) {
            			throw 'Failed to parse response received from Ribbon SBC API. Check debug log for more information.';
            		}
            
            		return response;
            	},
            
            	getField: function (data, path) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path;
            			}
            			data = data[step];
            		}
            
            		return data;
            	},
            
            	login: function () {
            		var response = "",
            			cookies = "",
            			payload = 'Username=' + encodeURIComponent(Ribbon.params.username) + '&Password=' + encodeURIComponent(Ribbon.params.password);
            
            		Ribbon.request.addHeader('Content-Type', 'application/x-www-form-urlencoded');
            		response = Ribbon.request.post(Ribbon.params.url + '/rest/login', payload);
            
            		var headers = Ribbon.request.getHeaders();
            		for (var key in headers) {
            			if (key.toLowerCase() == 'set-cookie') {
            				cookies = headers[key];
            			}
            		}
            
            		Ribbon.request.addHeader('Cookie', cookies);
            	},
            
            	logout: function () {
            		var response = Ribbon.request.post(Ribbon.params.url + '/rest/logout');
            
            		return JSON.parse(XML.toJson(response));
            	}
            };
            
            try {
            	var result = {};
            
            	Ribbon.setParams(JSON.parse(value));
            	Ribbon.login();
            
            	var certificate_list = Ribbon.getField(Ribbon.getRequest("/rest/certificate"), 'root.certificate_list'),
            		count = Ribbon.getField(certificate_list, '@count');
            
            	if (count !== '0') {
            		var certificate = Ribbon.getField(certificate_list, 'certificate_pk');
            
            		if (!Array.isArray(certificate)) {
            			certificate = [certificate];
            		}
            
            		for (var cert in certificate) {
            			var id = Ribbon.getField(certificate[cert], '@id');
            			result[id] = Ribbon.getField(Ribbon.getRequest("/rest/certificate/" + id), 'root.certificate');
            		}
            	}
            
            	Ribbon.logout();
            
            	return JSON.stringify(result);
            }
            catch (error) {
            	Zabbix.log(3, '[ Ribbon SBC Edge ] Certificate ERROR: ' + error);
            	error_msg = 'Failed to get certificate data from API:' + error;
            
            	return JSON.stringify({ 'error': error_msg });
            }
          description: 'Gets certificate information.'
          timeout: '{$RIBBON.TIMEOUT}'
          parameters:
            - name: password
              value: '{$RIBBON.PASSWORD}'
            - name: proxy
              value: '{$RIBBON.PROXY}'
            - name: url
              value: '{$RIBBON.URL}'
            - name: username
              value: '{$RIBBON.USERNAME}'
          tags:
            - tag: component
              value: raw
        - uuid: c1f97c4fd20142b2918303dc0839cfee
          name: 'ASM Operating System License Type'
          type: DEPENDENT
          key: ribbon.chassis.asm.license.type
          delay: '0'
          description: |
            The ASM Operating System version that is licensed by the factory.
            Possible values:
            - Unknown
            - Win2008R2
            - Win2012R2
            - Win2019
          valuemap:
            name: 'Ribbon: ASM Operating System License Type'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.chassis.AsmOsLicenseType
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: system
        - uuid: 432c7e601ca3411ca301f69523c9e497
          name: 'Chassis board bottom temperature'
          type: DEPENDENT
          key: ribbon.chassis.board.bottom.temp
          delay: '0'
          units: '!°C'
          description: 'Indicates the temperature on the bottom of the main board in degrees Celsius.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.chassis.rt_Chassis_BoardBottom_Temp1
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: sensor
          triggers:
            - uuid: 35998716d90f4b3382042312bdef9ced
              expression: 'avg(/Ribbon SBC Edge by HTTP/ribbon.chassis.board.bottom.temp,5m)>{$RIBBON.TEMP.BOTTOM.MAIN.BOARD.CRIT}'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'max(/Ribbon SBC Edge by HTTP/ribbon.chassis.board.bottom.temp,5m)<{$RIBBON.TEMP.BOTTOM.MAIN.BOARD.CRIT}-3'
              name: 'Ribbon: Temperature on the bottom of the main board is above critical threshold'
              event_name: 'Ribbon: Temperature on the bottom of the main board is above critical threshold: >{$RIBBON.TEMP.BOTTOM.MAIN.BOARD.CRIT}'
              opdata: 'Current temperature: {ITEM.LASTVALUE1}'
              priority: HIGH
              description: 'This trigger uses temperature the bottom of the main board value.'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: e5d80421a325463bbe3e6b45263d6f29
          name: 'Chassis board top temperature'
          type: DEPENDENT
          key: ribbon.chassis.board.top.temp
          delay: '0'
          units: '!°C'
          description: 'Indicates the temperature on the top of the main board in degrees Celsius.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.chassis.rt_Chassis_BoardTop_Temp2
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: sensor
          triggers:
            - uuid: f80c73ecab184a9aa4428839e34e8f79
              expression: 'avg(/Ribbon SBC Edge by HTTP/ribbon.chassis.board.top.temp,5m)>{$RIBBON.TEMP.TOP.MAIN.BOARD.CRIT}'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'max(/Ribbon SBC Edge by HTTP/ribbon.chassis.board.top.temp,5m)<{$RIBBON.TEMP.TOP.MAIN.BOARD.CRIT}-3'
              name: 'Ribbon: Temperature on the top of the main board is above critical threshold'
              event_name: 'Ribbon: Temperature on the top of the main board is above critical threshold: >{$RIBBON.TEMP.TOP.MAIN.BOARD.CRIT}'
              opdata: 'Current temperature: {ITEM.LASTVALUE1}'
              priority: HIGH
              description: 'This trigger uses temperature of on the top of the main board value.'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: 8030911f70f54e90af72087fbfad8195
          name: 'Chassis core switch temperature'
          type: DEPENDENT
          key: ribbon.chassis.core.switch.temp
          delay: '0'
          units: '!°C'
          description: 'Indicates the core switch temperature in degrees Celsius.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.chassis.rt_Chassis_CoreSwitch_Temp
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: sensor
          triggers:
            - uuid: 89c191a345064655b861f500d8ced4c3
              expression: 'avg(/Ribbon SBC Edge by HTTP/ribbon.chassis.core.switch.temp,5m)>{$RIBBON.TEMP.CORE.CRIT}'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'max(/Ribbon SBC Edge by HTTP/ribbon.chassis.core.switch.temp,5m)<{$RIBBON.TEMP.CORE.CRIT}-3'
              name: 'Ribbon: Temperature on chassis core switch is above critical threshold'
              event_name: 'Ribbon: Temperature on chassis core switch is above critical threshold: >{$RIBBON.TEMP.CORE.CRIT}'
              opdata: 'Current temperature: {ITEM.LASTVALUE1}'
              priority: HIGH
              description: 'This trigger uses temperature of chassis core switch value.'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: 838b633a55734788973aa9cf96a8db87
          name: 'Chassis Status'
          type: DEPENDENT
          key: ribbon.chassis.status
          delay: '0'
          description: |
            Indicates the hardware initialization state for this card.
            Possible values:
              - None
              - Card Idle
              - Card Detected
              - Card Activating
              - Card Activated
              - Card Remove Requested
              - Card Removing
              - Card Removed
              - Card Downloading
              - Card Failed
              - Card Disabled Long Loop
              - MAX
          valuemap:
            name: 'Ribbon: System status'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.chassis.rt_Status
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: a778de02ee3147709551bfd4fd363db1
              expression: 'last(/Ribbon SBC Edge by HTTP/ribbon.chassis.status)=9'
              name: 'Ribbon: Chassis status - Card Failed'
              priority: AVERAGE
              description: 'The current chassis status - Card Failed.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 22a66eac1fe24e3fa389035229dffd66
          name: 'Chassis type'
          type: DEPENDENT
          key: ribbon.chassis.type
          delay: '0'
          value_type: CHAR
          trends: '0'
          description: |
            Indicates the hardware or software platform type of the SBC system.
            For hardware appliances, identifies whether the device is an SBC1000 or SBC2000.
            For software-based deployments (SWe), indicates the virtual or software chassis type.
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.chassis.rt_Chassis_Type
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: system
        - uuid: f04175a8aea44c60a372be27b266ffc0
          name: 'CPU Load average 1m'
          type: DEPENDENT
          key: ribbon.cpu.load.avg1
          delay: '0'
          value_type: FLOAT
          description: 'Average number of processes over the last minute waiting to run because the CPU is busy.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.historicalstatistics.rt_CPULoadAverage1m
            - type: MULTIPLIER
              parameters:
                - '0.01'
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: cpu
        - uuid: 3643fd54c5d0406792bfd0183585f2de
          name: 'CPU Load average 5m'
          type: DEPENDENT
          key: ribbon.cpu.load.avg5
          delay: '0'
          value_type: FLOAT
          description: 'Average number of processes over the last five minutes waiting to run because the CPU is busy.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.historicalstatistics.rt_CPULoadAverage5m
            - type: MULTIPLIER
              parameters:
                - '0.01'
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: cpu
        - uuid: 44669fba4717429688730da02f80b8fd
          name: 'CPU Load average 15m'
          type: DEPENDENT
          key: ribbon.cpu.load.avg15
          delay: '0'
          value_type: FLOAT
          description: 'Average number of processes over the last fifteen minutes waiting to run because the CPU is busy.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.historicalstatistics.rt_CPULoadAverage15m
            - type: MULTIPLIER
              parameters:
                - '0.01'
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: cpu
        - uuid: 9d29d99112ef4b89bd3d53bf2820072c
          name: 'CPU usage'
          type: DEPENDENT
          key: ribbon.cpu.usage
          delay: '0'
          units: '%'
          description: 'Average CPU usage in percent.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.historicalstatistics.rt_CPUUsage
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: cpu
          triggers:
            - uuid: 07f6e1ede4df44b88834391d527206ac
              expression: 'min(/Ribbon SBC Edge by HTTP/ribbon.cpu.usage,5m)>{$RIBBON.CPU.UTIL.CRIT}'
              name: 'Ribbon: High CPU utilization'
              event_name: 'Ribbon: High CPU utilization (over {$RIBBON.CPU.UTIL.CRIT}% for 5m)'
              opdata: 'Current utilization: {ITEM.LASTVALUE}'
              priority: AVERAGE
              description: 'CPU utilization is too high. The system might be slow to respond.'
              tags:
                - tag: scope
                  value: availability
        - uuid: e488322bded4491eb43e5f1a4e55240c
          name: 'Get disk partition'
          type: SCRIPT
          key: ribbon.disk.get
          delay: '{$RIBBON.INTERVAL:"get_disk"}'
          history: '0'
          value_type: TEXT
          trends: '0'
          params: |
            var Ribbon = {
            	params: {},
            	request: new HttpRequest(),
            
            	setParams: function (params) {
            		['url', 'username', 'password'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		Ribbon.params = params;
            
            		if (typeof Ribbon.params.url === 'string') {
            			if (Ribbon.params.url.endsWith('/')) {
            				Ribbon.params.url = Ribbon.params.url.slice(0,-1);
            			}
            		}
            
            	},
            
            	getRequest: function (url) {
            		var response;
            
            		if (typeof Ribbon.params.proxy !== 'undefined' && Ribbon.params.proxy !== '') {
            			Ribbon.request.setProxy(Ribbon.params.proxy);
            		}
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Sending request: ' + Ribbon.params.url  + url);
            
            		response = Ribbon.request.get(Ribbon.params.url + url);
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Received response with status code ' + Ribbon.request.getStatus() + ': ' + response);
            
            		if (Ribbon.request.getStatus() < 200 || Ribbon.request.getStatus() >= 300) {
            			throw 'Cannot connect to Ribbon SBC. Check debug log for more information.';
            		}
            
            		try {
            			response = JSON.parse(XML.toJson(response));
            		}
            		catch (error) {
            			throw 'Failed to parse response received from Ribbon SBC API. Check debug log for more information.';
            		}
            
            		return response;
            	},
            
            	getField: function (data, path) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path;
            			}
            			data = data[step];
            		}
            
            		return data;
            	},
            
            	login: function () {
            		var response = "",
            			cookies = "",
            			payload = 'Username=' + encodeURIComponent(Ribbon.params.username) + '&Password=' + encodeURIComponent(Ribbon.params.password);
            
            		Ribbon.request.addHeader('Content-Type', 'application/x-www-form-urlencoded');
            		response = Ribbon.request.post(Ribbon.params.url + '/rest/login', payload);
            
            		var headers = Ribbon.request.getHeaders();
            		for (var key in headers) {
            			if (key.toLowerCase() == 'set-cookie') {
            				cookies = headers[key];
            			}
            		}
            
            		Ribbon.request.addHeader('Cookie', cookies);
            	},
            
            	logout: function () {
            		var response = Ribbon.request.post(Ribbon.params.url + '/rest/logout');
            
            		return JSON.parse(XML.toJson(response));
            	}
            };
            
            try {
            	var result = {};
            
            	Ribbon.setParams(JSON.parse(value));
            	Ribbon.login();
            
            	var diskpartition_list = Ribbon.getField(Ribbon.getRequest("/rest/diskpartition"), 'root.diskpartition_list'),
            		count = Ribbon.getField(diskpartition_list, '@count');
            
            	if (count !== '0') {
            		var diskpartition = Ribbon.getField(diskpartition_list, 'diskpartition_pk');
            
            		if (!Array.isArray(diskpartition)) {
            			diskpartition = [diskpartition];
            		}
            
            		for (var disk in diskpartition) {
            			var id = Ribbon.getField(diskpartition[disk], '@id');
            			result[id] = Ribbon.getField(Ribbon.getRequest("/rest/diskpartition/" + id), 'root.diskpartition');
            		}
            	}
            
            	Ribbon.logout();
            
            	return JSON.stringify(result);
            }
            catch (error) {
            	Zabbix.log(3, '[ Ribbon SBC Edge ] Disk ERROR: ' + error);
            	error_msg = 'Failed to get disk data from API:' + error;
            
            	return JSON.stringify({ 'error': error_msg });
            }
          description: 'Gets the system disk partition.'
          timeout: '{$RIBBON.TIMEOUT}'
          parameters:
            - name: password
              value: '{$RIBBON.PASSWORD}'
            - name: proxy
              value: '{$RIBBON.PROXY}'
            - name: url
              value: '{$RIBBON.URL}'
            - name: username
              value: '{$RIBBON.USERNAME}'
          tags:
            - tag: component
              value: raw
        - uuid: 4523833235224d2cbfafbc9612c61241
          name: 'Get DSP cards'
          type: SCRIPT
          key: ribbon.dsp.card.get
          delay: '{$RIBBON.INTERVAL:"get_dsp_card"}'
          history: '0'
          value_type: TEXT
          trends: '0'
          params: |
            var Ribbon = {
            	params: {},
            	request: new HttpRequest(),
            
            	setParams: function (params) {
            		['url', 'username', 'password'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		Ribbon.params = params;
            
            		if (typeof Ribbon.params.url === 'string') {
            			if (Ribbon.params.url.endsWith('/')) {
            				Ribbon.params.url = Ribbon.params.url.slice(0,-1);
            			}
            		}
            
            	},
            
            	getRequest: function (url) {
            		var response;
            
            		if (typeof Ribbon.params.proxy !== 'undefined' && Ribbon.params.proxy !== '') {
            			Ribbon.request.setProxy(Ribbon.params.proxy);
            		}
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Sending request: ' + Ribbon.params.url  + url);
            
            		response = Ribbon.request.get(Ribbon.params.url + url);
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Received response with status code ' + Ribbon.request.getStatus() + ': ' + response);
            
            		if (Ribbon.request.getStatus() < 200 || Ribbon.request.getStatus() >= 300) {
            			throw 'Cannot connect to Ribbon SBC. Check debug log for more information.';
            		}
            
            		try {
            			response = JSON.parse(XML.toJson(response));
            		}
            		catch (error) {
            			throw 'Failed to parse response received from Ribbon SBC API. Check debug log for more information.';
            		}
            
            		return response;
            	},
            
            	getField: function (data, path) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path;
            			}
            			data = data[step];
            		}
            
            		return data;
            	},
            
            	login: function () {
            		var response = "",
            			cookies = "",
            			payload = 'Username=' + encodeURIComponent(Ribbon.params.username) + '&Password=' + encodeURIComponent(Ribbon.params.password);
            
            		Ribbon.request.addHeader('Content-Type', 'application/x-www-form-urlencoded');
            		response = Ribbon.request.post(Ribbon.params.url + '/rest/login', payload);
            
            		var headers = Ribbon.request.getHeaders();
            		for (var key in headers) {
            			if (key.toLowerCase() == 'set-cookie') {
            				cookies = headers[key];
            			}
            		}
            
            		Ribbon.request.addHeader('Cookie', cookies);
            	},
            
            	logout: function () {
            		var response = Ribbon.request.post(Ribbon.params.url + '/rest/logout');
            
            		return JSON.parse(XML.toJson(response));
            	}
            };
            
            try {
            	var result = {};
            
            	Ribbon.setParams(JSON.parse(value));
            	Ribbon.login();
            
            	var dspcard_list = Ribbon.getField(Ribbon.getRequest("/rest/dspcard"), 'root.dspcard_list'),
            		count = Ribbon.getField(dspcard_list, '@count');
            
            	if (count !== '0') {
            		var dspcard = Ribbon.getField(dspcard_list, 'dspcard_pk');
            
            		if (!Array.isArray(dspcard)) {
            			dspcard = [dspcard];
            		}
            
            		for (var card in dspcard) {
            			var id = Ribbon.getField(dspcard[card], '@id');
            			result[id] = Ribbon.getField(Ribbon.getRequest("/rest/dspcard/" + id), 'root.dspcard');
            		}
            
            	}
            
            	Ribbon.logout();
            
            	return JSON.stringify(result);
            }
            catch (error) {
            	Zabbix.log(3, '[ Ribbon SBC Edge ] DSP Card ERROR: ' + error);
            	error_msg = 'Failed to get DSP card data from API:' + error;
            
            	return JSON.stringify({ 'error': error_msg });
            }
          description: 'Gets DSP card data.'
          timeout: '{$RIBBON.TIMEOUT}'
          parameters:
            - name: password
              value: '{$RIBBON.PASSWORD}'
            - name: proxy
              value: '{$RIBBON.PROXY}'
            - name: url
              value: '{$RIBBON.URL}'
            - name: username
              value: '{$RIBBON.USERNAME}'
          tags:
            - tag: component
              value: raw
        - uuid: c16a04d4ac1041509c563c46b05d4d65
          name: 'Get fan'
          type: SCRIPT
          key: ribbon.fan.get
          delay: '{$RIBBON.INTERVAL:"get_fan"}'
          history: '0'
          value_type: TEXT
          trends: '0'
          params: |
            var Ribbon = {
            	params: {},
            	request: new HttpRequest(),
            
            	setParams: function (params) {
            		['url', 'username', 'password'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		Ribbon.params = params;
            
            		if (typeof Ribbon.params.url === 'string') {
            			if (Ribbon.params.url.endsWith('/')) {
            				Ribbon.params.url = Ribbon.params.url.slice(0,-1);
            			}
            		}
            
            	},
            
            	getRequest: function (url) {
            		var response;
            
            		if (typeof Ribbon.params.proxy !== 'undefined' && Ribbon.params.proxy !== '') {
            			Ribbon.request.setProxy(Ribbon.params.proxy);
            		}
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Sending request: ' + Ribbon.params.url  + url);
            
            		response = Ribbon.request.get(Ribbon.params.url + url);
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Received response with status code ' + Ribbon.request.getStatus() + ': ' + response);
            
            		if (Ribbon.request.getStatus() < 200 || Ribbon.request.getStatus() >= 300) {
            			throw 'Cannot connect to Ribbon SBC. Check debug log for more information.';
            		}
            
            		try {
            			response = JSON.parse(XML.toJson(response));
            		}
            		catch (error) {
            			throw 'Failed to parse response received from Ribbon SBC API. Check debug log for more information.';
            		}
            
            		return response;
            	},
            
            	getField: function (data, path) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path;
            			}
            			data = data[step];
            		}
            
            		return data;
            	},
            
            	login: function () {
            		var response = "",
            			cookies = "",
            			payload = 'Username=' + encodeURIComponent(Ribbon.params.username) + '&Password=' + encodeURIComponent(Ribbon.params.password);
            
            		Ribbon.request.addHeader('Content-Type', 'application/x-www-form-urlencoded');
            		response = Ribbon.request.post(Ribbon.params.url + '/rest/login', payload);
            
            		var headers = Ribbon.request.getHeaders();
            		for (var key in headers) {
            			if (key.toLowerCase() == 'set-cookie') {
            				cookies = headers[key];
            			}
            		}
            
            		Ribbon.request.addHeader('Cookie', cookies);
            	},
            
            	logout: function () {
            		var response = Ribbon.request.post(Ribbon.params.url + '/rest/logout');
            
            		return JSON.parse(XML.toJson(response));
            	}
            };
            
            try {
            	var result = {};
            
            	Ribbon.setParams(JSON.parse(value));
            	Ribbon.login();
            
            	var fan_list = Ribbon.getField(Ribbon.getRequest("/rest/fan"), 'root.fan_list'),
            		count = Ribbon.getField(fan_list, '@count');
            
            	if (count !== '0') {
            		var fans = Ribbon.getField(fan_list, 'fan_pk');
            
            		if (!Array.isArray(fans)) {
            			fans = [fans];
            		}
            
            		for (var fan in fans) {
            			var id = Ribbon.getField(fans[fan], '@id');
            			result[id] = Ribbon.getField(Ribbon.getRequest("/rest/fan/" + id), 'root.fan');
            		}
            	}
            
            	Ribbon.logout();
            
            	return JSON.stringify(result);
            }
            catch (error) {
            	Zabbix.log(3, '[ Ribbon SBC Edge ] Fan ERROR: ' + error);
            	error_msg = 'Failed to get fans data from API:' + error;
            
            	return JSON.stringify({ 'error': error_msg });
            }
          description: 'Gets fan data.'
          timeout: '{$RIBBON.TIMEOUT}'
          parameters:
            - name: password
              value: '{$RIBBON.PASSWORD}'
            - name: proxy
              value: '{$RIBBON.PROXY}'
            - name: url
              value: '{$RIBBON.URL}'
            - name: username
              value: '{$RIBBON.USERNAME}'
          tags:
            - tag: component
              value: raw
        - uuid: 0b35ef10ea54481690fce00029a9742b
          name: 'File descriptor usage'
          type: DEPENDENT
          key: ribbon.fd.usage
          delay: '0'
          description: 'Number of file descriptors used by the system.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.historicalstatistics.rt_FDUsage
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: storage
        - uuid: b3c2f1999f174d879852ac08971fb7ec
          name: 'License class'
          type: DEPENDENT
          key: ribbon.license.class
          delay: '0'
          description: |
            Indicates the version of license format.
              0 - This is a v1 or legacy SBC 1000/2000 license.
              1 - This is a v2 or legacy SWe Edge license.
              2 - This is a v3 or new SWe Edge license.
          valuemap:
            name: 'Ribbon: License class'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.license.LicenseClass
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: license
        - uuid: 576d439b408049abad82432453dc6572
          name: 'License expiration date'
          type: DEPENDENT
          key: ribbon.license.expiration.date
          delay: '0'
          value_type: CHAR
          trends: '0'
          description: 'Shows when the license is due to expire. This attribute is only applicable to the SBC 1000 and 2000.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.license.ExpirationDate
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: license
        - uuid: 5f3e2f3e1b1c4f2fa6f3e8b1c9e4d5a6
          name: 'SIP Channels licensed'
          type: DEPENDENT
          key: ribbon.license.sip.channels
          delay: '0'
          description: 'Displays the total number of SIP channel licenses purchased for the system.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.license.SIPChannels
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: license
        - uuid: a7370c87a0ce4c30b6f3606fd2cae3cf
          name: 'Available SIP Channels licensed'
          type: DEPENDENT
          key: ribbon.license.sip.channels.available
          delay: '0'
          description: 'Displays the total number of SIP Channel licenses currently available for use on the system.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.license.AvailableSIPCh
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: license
        - uuid: d4e5f6a7b8c94d1e9f0a1b2c3d4e5f6a
          name: 'SIP Registrations licensed'
          type: DEPENDENT
          key: ribbon.license.sip.registrations
          delay: '0'
          description: 'Displays the total number of SIP registration licenses purchased for the system. Deprecated on SWe Edge since SIP registration feature is now free.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.license.SIPRegistrations
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: license
        - uuid: f3a781257fe04f1ebc72c7c21ff75dd5
          name: 'SIP Registrations available'
          type: DEPENDENT
          key: ribbon.license.sip.registrations.available
          delay: '0'
          description: 'Displays the total number of SIP registration licenses currently available for use on the system. Deprecated on SWe Edge since SIP registration feature is now free.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.license.AvailableSIPReg
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: license
        - uuid: 29fea51d87d94d268eeb37de47c3ac0e
          name: 'License type'
          type: DEPENDENT
          key: ribbon.license.type
          delay: '0'
          description: |
            Shows the type of license.
              0 - No license installed.
              1 - Node license is installed.
              2 - Base license is installed.
          valuemap:
            name: 'Ribbon: License type'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.license.LicenseType
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: license
        - uuid: caa51fc4d639432b96b6b20304be74a2
          name: 'Memory usage'
          type: DEPENDENT
          key: ribbon.memory.usage
          delay: '0'
          units: '%'
          description: 'Average usage of system memory in percent.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.historicalstatistics.rt_MemoryUsage
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: memory
          triggers:
            - uuid: cd378b8df60c43d98e866f72c240b08e
              expression: 'min(/Ribbon SBC Edge by HTTP/ribbon.memory.usage,5m)>{$RIBBON.MEMORY.UTIL.CRIT}'
              name: 'Ribbon: High memory utilization'
              event_name: 'Ribbon: High memory utilization (over {$RIBBON.MEMORY.UTIL.CRIT}% for 5m)'
              opdata: 'Current utilization: {ITEM.LASTVALUE}'
              priority: AVERAGE
              description: 'Memory utilization is too high. The system might be slow to respond.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 14f5043b667145018111d537c3e3fea6
          name: 'Get interface'
          type: SCRIPT
          key: ribbon.net.if.get
          delay: '{$RIBBON.INTERVAL:"get_interface"}'
          history: '0'
          value_type: TEXT
          trends: '0'
          params: |
            var Ribbon = {
            	params: {},
            	request: new HttpRequest(),
            
            	setParams: function (params) {
            		['url', 'username', 'password'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		Ribbon.params = params;
            
            		if (typeof Ribbon.params.url === 'string') {
            			if (Ribbon.params.url.endsWith('/')) {
            				Ribbon.params.url = Ribbon.params.url.slice(0,-1);
            			}
            		}
            
            	},
            
            	getRequest: function (url) {
            		var response;
            
            		if (typeof Ribbon.params.proxy !== 'undefined' && Ribbon.params.proxy !== '') {
            			Ribbon.request.setProxy(Ribbon.params.proxy);
            		}
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Sending request: ' + Ribbon.params.url  + url);
            
            		response = Ribbon.request.get(Ribbon.params.url + url);
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Received response with status code ' + Ribbon.request.getStatus() + ': ' + response);
            
            		if (Ribbon.request.getStatus() < 200 || Ribbon.request.getStatus() >= 300) {
            			throw 'Cannot connect to Ribbon SBC. Check debug log for more information.';
            		}
            
            		try {
            			response = JSON.parse(XML.toJson(response));
            		}
            		catch (error) {
            			throw 'Failed to parse response received from Ribbon SBC API. Check debug log for more information.';
            		}
            
            		return response;
            	},
            
            	getField: function (data, path) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path;
            			}
            			data = data[step];
            		}
            
            		return data;
            	},
            
            	login: function () {
            		var response = "",
            			cookies = "",
            			payload = 'Username=' + encodeURIComponent(Ribbon.params.username) + '&Password=' + encodeURIComponent(Ribbon.params.password);
            
            		Ribbon.request.addHeader('Content-Type', 'application/x-www-form-urlencoded');
            		response = Ribbon.request.post(Ribbon.params.url + '/rest/login', payload);
            
            		var headers = Ribbon.request.getHeaders();
            		for (var key in headers) {
            			if (key.toLowerCase() == 'set-cookie') {
            				cookies = headers[key];
            			}
            		}
            
            		Ribbon.request.addHeader('Cookie', cookies);
            	},
            
            	logout: function () {
            		var response = Ribbon.request.post(Ribbon.params.url + '/rest/logout');
            
            		return JSON.parse(XML.toJson(response));
            	}
            };
            
            try {
            	var result = {};
            
            	Ribbon.setParams(JSON.parse(value));
            	Ribbon.login();
            
            	var ethernetport_list = Ribbon.getField(Ribbon.getRequest("/rest/ethernetport"), 'root.ethernetport_list'),
            		count = Ribbon.getField(ethernetport_list, '@count');
            
            	if (count !== '0') {
            		var ethernetport = Ribbon.getField(ethernetport_list, 'ethernetport_pk');
            
            		if (!Array.isArray(ethernetport)) {
            			ethernetport = [ethernetport];
            		}
            
            		for (var eth in ethernetport) {
            			var id = Ribbon.getField(ethernetport[eth], '@id');
            			result[id] = Ribbon.getField(Ribbon.getRequest("/rest/ethernetport/" + id), 'root.ethernetport');
            		}
            	}
            
            	Ribbon.logout();
            
            	return JSON.stringify(result);
            }
            catch (error) {
            	Zabbix.log(3, '[ Ribbon SBC Edge ] Interface ERROR: ' + error);
            	error_msg = 'Failed to get interface data from API:' + error;
            
            	return JSON.stringify({ 'error': error_msg });
            }
          description: 'Gets the system ethernet port statistics.'
          timeout: '{$RIBBON.TIMEOUT}'
          parameters:
            - name: password
              value: '{$RIBBON.PASSWORD}'
            - name: proxy
              value: '{$RIBBON.PROXY}'
            - name: url
              value: '{$RIBBON.URL}'
            - name: username
              value: '{$RIBBON.USERNAME}'
          tags:
            - tag: component
              value: raw
        - uuid: 4f060e13a75c44a1b468ab5546bf58e2
          name: 'Number of call attempts'
          type: DEPENDENT
          key: ribbon.number.call.attempts
          delay: '0'
          description: 'Total number of call attempts system-wide since the system came up.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.systemcallstats.rt_NumCallAttempts
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: application
        - uuid: a865d9559e7947efb3a6055fb6433d85
          name: 'Number of call currently up'
          type: DEPENDENT
          key: ribbon.number.call.currently
          delay: '0'
          description: 'Number of currently connected calls system-wide.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.systemcallstats.rt_NumCallCurrentlyUp
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: application
        - uuid: 86db48bf6e4f44428910f46a4c67c029
          name: 'Number of call failed'
          type: DEPENDENT
          key: ribbon.number.call.failed
          delay: '0'
          description: 'Total number of failed calls system-wide since the system came up.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.systemcallstats.rt_NumCallFailed
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: application
        - uuid: 5e70a41d4f5a4f1a8ac4c753220554a8
          name: 'Number of call succeeded'
          type: DEPENDENT
          key: ribbon.number.call.succeeded
          delay: '0'
          description: 'Total number of successful calls system-wide since the system came up.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.systemcallstats.rt_NumCallSucceeded
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: application
        - uuid: 23900dbafdfc4c5ca70cfaef5432a5e6
          name: 'Get power supply'
          type: SCRIPT
          key: ribbon.psu.get
          delay: '{$RIBBON.INTERVAL:"get_psu"}'
          history: '0'
          value_type: TEXT
          trends: '0'
          params: |
            var Ribbon = {
            	params: {},
            	request: new HttpRequest(),
            
            	setParams: function (params) {
            		['url', 'username', 'password'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		Ribbon.params = params;
            
            		if (typeof Ribbon.params.url === 'string') {
            			if (Ribbon.params.url.endsWith('/')) {
            				Ribbon.params.url = Ribbon.params.url.slice(0,-1);
            			}
            		}
            
            	},
            
            	getRequest: function (url) {
            		var response;
            
            		if (typeof Ribbon.params.proxy !== 'undefined' && Ribbon.params.proxy !== '') {
            			Ribbon.request.setProxy(Ribbon.params.proxy);
            		}
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Sending request: ' + Ribbon.params.url  + url);
            
            		response = Ribbon.request.get(Ribbon.params.url + url);
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Received response with status code ' + Ribbon.request.getStatus() + ': ' + response);
            
            		if (Ribbon.request.getStatus() < 200 || Ribbon.request.getStatus() >= 300) {
            			throw 'Cannot connect to Ribbon SBC. Check debug log for more information.';
            		}
            
            		try {
            			response = JSON.parse(XML.toJson(response));
            		}
            		catch (error) {
            			throw 'Failed to parse response received from Ribbon SBC API. Check debug log for more information.';
            		}
            
            		return response;
            	},
            
            	getField: function (data, path) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path;
            			}
            			data = data[step];
            		}
            
            		return data;
            	},
            
            	login: function () {
            		var response = "",
            			cookies = "",
            			payload = 'Username=' + encodeURIComponent(Ribbon.params.username) + '&Password=' + encodeURIComponent(Ribbon.params.password);
            
            		Ribbon.request.addHeader('Content-Type', 'application/x-www-form-urlencoded');
            		response = Ribbon.request.post(Ribbon.params.url + '/rest/login', payload);
            
            		var headers = Ribbon.request.getHeaders();
            		for (var key in headers) {
            			if (key.toLowerCase() == 'set-cookie') {
            				cookies = headers[key];
            			}
            		}
            
            		Ribbon.request.addHeader('Cookie', cookies);
            	},
            
            	logout: function () {
            		var response = Ribbon.request.post(Ribbon.params.url + '/rest/logout');
            
            		return JSON.parse(XML.toJson(response));
            	}
            };
            
            try {
            	var result = {};
            
            	Ribbon.setParams(JSON.parse(value));
            	Ribbon.login();
            
            	var powersupply_list = Ribbon.getField(Ribbon.getRequest("/rest/powersupply"), 'root.powersupply_list'),
            		count = Ribbon.getField(powersupply_list, '@count');
            
            	if (count !== '0') {
            		var powersupply = Ribbon.getField(powersupply_list, 'powersupply_pk');
            
            		if (!Array.isArray(powersupply)) {
            			powersupply = [powersupply];
            		}
            
            		for (var psu in powersupply) {
            			var id = Ribbon.getField(powersupply[psu], '@id');
            			result[id] = Ribbon.getField(Ribbon.getRequest("/rest/powersupply/" + id), 'root.powersupply');
            		}
            	}
            
            	Ribbon.logout();
            
            	return JSON.stringify(result);
            }
            catch (error) {
            	Zabbix.log(3, '[ Ribbon SBC Edge ] PSU ERROR: ' + error);
            	error_msg = 'Failed to get powersupply data from API:' + error;
            
            	return JSON.stringify({ 'error': error_msg });
            }
          description: 'Gets PSU data.'
          timeout: '{$RIBBON.TIMEOUT}'
          parameters:
            - name: password
              value: '{$RIBBON.PASSWORD}'
            - name: proxy
              value: '{$RIBBON.PROXY}'
            - name: url
              value: '{$RIBBON.URL}'
            - name: username
              value: '{$RIBBON.USERNAME}'
          tags:
            - tag: component
              value: raw
        - uuid: eca3e34854254afc8b886f0e26b5d084
          name: 'Get SIP servers'
          type: SCRIPT
          key: ribbon.sip.server.get
          delay: '{$RIBBON.INTERVAL:"get_sip_server"}'
          history: '0'
          value_type: TEXT
          trends: '0'
          params: |
            var Ribbon = {
            	params: {},
            	request: new HttpRequest(),
            
            	setParams: function (params) {
            		['url', 'username', 'password'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		Ribbon.params = params;
            
            		if (typeof Ribbon.params.url === 'string') {
            			if (Ribbon.params.url.endsWith('/')) {
            				Ribbon.params.url = Ribbon.params.url.slice(0,-1);
            			}
            		}
            
            	},
            
            	getRequest: function (url) {
            		var response;
            
            		if (typeof Ribbon.params.proxy !== 'undefined' && Ribbon.params.proxy !== '') {
            			Ribbon.request.setProxy(Ribbon.params.proxy);
            		}
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Sending request: ' + Ribbon.params.url  + url);
            
            		response = Ribbon.request.get(Ribbon.params.url + url);
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Received response with status code ' + Ribbon.request.getStatus() + ': ' + response);
            
            		if (Ribbon.request.getStatus() < 200 || Ribbon.request.getStatus() >= 300) {
            			throw 'Cannot connect to Ribbon SBC. Check debug log for more information.';
            		}
            
            		try {
            			response = JSON.parse(XML.toJson(response));
            		}
            		catch (error) {
            			throw 'Failed to parse response received from Ribbon SBC API. Check debug log for more information.';
            		}
            
            		return response;
            	},
            
            	getField: function (data, path) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path;
            			}
            			data = data[step];
            		}
            
            		return data;
            	},
            
            	login: function () {
            		var response = "",
            			cookies = "",
            			payload = 'Username=' + encodeURIComponent(Ribbon.params.username) + '&Password=' + encodeURIComponent(Ribbon.params.password);
            
            		Ribbon.request.addHeader('Content-Type', 'application/x-www-form-urlencoded');
            		response = Ribbon.request.post(Ribbon.params.url + '/rest/login', payload);
            
            		var headers = Ribbon.request.getHeaders();
            		for (var key in headers) {
            			if (key.toLowerCase() == 'set-cookie') {
            				cookies = headers[key];
            			}
            		}
            
            		Ribbon.request.addHeader('Cookie', cookies);
            	},
            
            	logout: function () {
            		var response = Ribbon.request.post(Ribbon.params.url + '/rest/logout');
            
            		return JSON.parse(XML.toJson(response));
            	}
            };
            
            try {
            	var metrics,
            		result = {};
            
            	Ribbon.setParams(JSON.parse(value));
            	Ribbon.login();
            
            	var sipservertable_list = Ribbon.getField(Ribbon.getRequest("/rest/sipservertable"), 'root.sipservertable_list'),
            		count = Ribbon.getField(sipservertable_list, '@count');
            
            	if (count !== '0') {
            		var sipservertable = Ribbon.getField(sipservertable_list, 'sipservertable_pk');
            
            		if (!Array.isArray(sipservertable)) {
            			sipservertable = [sipservertable];
            		}
            
            		for (var sipserver in sipservertable) {
            			var id = Ribbon.getField(sipservertable[sipserver], '@id');
            
            			result[id] = Ribbon.getField(Ribbon.getRequest("/rest/sipservertable/" + id), 'root.sipservertable');
            
            			if (typeof result[id].Sequence !== 'null' && result[id].Sequence === '1') {
            				result[id].metrics = Ribbon.getField(Ribbon.getRequest("/rest/sipservertable/" + id + "/sipserver/1"), 'root.sipserver');
            			}
            		}
            	}
            
            	Ribbon.logout();
            
            	return JSON.stringify(result);
            }
            catch (error) {
            	Zabbix.log(3, '[ Ribbon SBC Edge ] SIP ERROR: ' + error);
            	error_msg = 'Failed to get SIP server data from API:' + error;
            
            	return JSON.stringify({ 'error': error_msg });
            }
          description: 'Gets SIP server data.'
          timeout: '{$RIBBON.TIMEOUT}'
          parameters:
            - name: password
              value: '{$RIBBON.PASSWORD}'
            - name: proxy
              value: '{$RIBBON.PROXY}'
            - name: url
              value: '{$RIBBON.URL}'
            - name: username
              value: '{$RIBBON.USERNAME}'
          tags:
            - tag: component
              value: raw
        - uuid: ff3c9af32b8b4201b621760455828b91
          name: 'Get SIP Signaling Group'
          type: SCRIPT
          key: ribbon.sip.signal.group.get
          delay: '{$RIBBON.INTERVAL:"get_sip_sg"}'
          history: '0'
          value_type: TEXT
          trends: '0'
          params: |
            var Ribbon = {
            	params: {},
            	request: new HttpRequest(),
            
            	setParams: function (params) {
            		['url', 'username', 'password'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		Ribbon.params = params;
            
            		if (typeof Ribbon.params.url === 'string') {
            			if (Ribbon.params.url.endsWith('/')) {
            				Ribbon.params.url = Ribbon.params.url.slice(0,-1);
            			}
            		}
            
            	},
            
            	getRequest: function (url) {
            		var response;
            
            		if (typeof Ribbon.params.proxy !== 'undefined' && Ribbon.params.proxy !== '') {
            			Ribbon.request.setProxy(Ribbon.params.proxy);
            		}
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Sending request: ' + Ribbon.params.url  + url);
            
            		response = Ribbon.request.get(Ribbon.params.url + url);
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Received response with status code ' + Ribbon.request.getStatus() + ': ' + response);
            
            		if (Ribbon.request.getStatus() < 200 || Ribbon.request.getStatus() >= 300) {
            			throw 'Cannot connect to Ribbon SBC. Check debug log for more information.';
            		}
            
            		try {
            			response = JSON.parse(XML.toJson(response));
            		}
            		catch (error) {
            			throw 'Failed to parse response received from Ribbon SBC API. Check debug log for more information.';
            		}
            
            		return response;
            	},
            
            	getField: function (data, path) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path;
            			}
            			data = data[step];
            		}
            
            		return data;
            	},
            
            	login: function () {
            		var response = "",
            			cookies = "",
            			payload = 'Username=' + encodeURIComponent(Ribbon.params.username) + '&Password=' + encodeURIComponent(Ribbon.params.password);
            
            		Ribbon.request.addHeader('Content-Type', 'application/x-www-form-urlencoded');
            		response = Ribbon.request.post(Ribbon.params.url + '/rest/login', payload);
            
            		var headers = Ribbon.request.getHeaders();
            		for (var key in headers) {
            			if (key.toLowerCase() == 'set-cookie') {
            				cookies = headers[key];
            			}
            		}
            
            		Ribbon.request.addHeader('Cookie', cookies);
            	},
            
            	logout: function () {
            		var response = Ribbon.request.post(Ribbon.params.url + '/rest/logout');
            
            		return JSON.parse(XML.toJson(response));
            	}
            };
            
            try {
            	var result = {};
            
            	Ribbon.setParams(JSON.parse(value));
            	Ribbon.login();
            
            	var sipsg_list = Ribbon.getField(Ribbon.getRequest("/rest/sipsg"), 'root.sipsg_list'),
            		count = Ribbon.getField(sipsg_list, '@count');
            
            	if (count !== '0') {
            		var sipsg = Ribbon.getField(sipsg_list, 'sipsg_pk');
            
            		if (!Array.isArray(sipsg)) {
            			sipsg = [sipsg];
            		}
            
            		for (var group in sipsg) {
            			var id = Ribbon.getField(sipsg[group], '@id');
            
            			result[id] = Ribbon.getField(Ribbon.getRequest("/rest/sipsg/" + id), 'root.sipsg');
            		}
            	}
            
            	Ribbon.logout();
            
            	return JSON.stringify(result);
            }
            catch (error) {
            	Zabbix.log(3, '[ Ribbon SBC Edge ] SIPsg ERROR: ' + error);
            	error_msg = 'Failed to get data from API:' + error;
            
            	return JSON.stringify({ 'error': error_msg });
            }
          description: 'Gets SIP Signaling Group data.'
          timeout: '{$RIBBON.TIMEOUT}'
          parameters:
            - name: password
              value: '{$RIBBON.PASSWORD}'
            - name: proxy
              value: '{$RIBBON.PROXY}'
            - name: url
              value: '{$RIBBON.URL}'
            - name: username
              value: '{$RIBBON.USERNAME}'
          tags:
            - tag: component
              value: raw
        - uuid: 7a2c9c562b6641bcbe45cb50386368b2
          name: 'DNS server 1'
          type: DEPENDENT
          key: ribbon.system.dns.server1
          delay: '0'
          value_type: CHAR
          trends: '0'
          description: 'Primary DNS server currently in use on the system.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.system.rt_DNSServer1IP
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: network
          triggers:
            - uuid: 729be287a380479c9d916610432038c0
              expression: 'last(/Ribbon SBC Edge by HTTP/ribbon.system.dns.server1,#1)<>last(/Ribbon SBC Edge by HTTP/ribbon.system.dns.server1,#2) and length(last(/Ribbon SBC Edge by HTTP/ribbon.system.dns.server1))>0'
              name: 'Ribbon: DNS server 1 has been changed'
              event_name: 'Ribbon: DNS server 1 has been changed on ({ITEM.LASTVALUE1})'
              priority: WARNING
              description: 'The DNS server 1 has been changed. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: 963ffed43764435cb0cedaa46bde6665
          name: 'DNS server 2'
          type: DEPENDENT
          key: ribbon.system.dns.server2
          delay: '0'
          value_type: CHAR
          trends: '0'
          description: 'Secondary DNS server currently in use on the system.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.system.rt_DNSServer2IP
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: network
          triggers:
            - uuid: 0fab918917b7407b983b4e0da3cab4a5
              expression: 'last(/Ribbon SBC Edge by HTTP/ribbon.system.dns.server2,#1)<>last(/Ribbon SBC Edge by HTTP/ribbon.system.dns.server2,#2) and length(last(/Ribbon SBC Edge by HTTP/ribbon.system.dns.server2))>0'
              name: 'Ribbon: DNS server 2 has been changed'
              event_name: 'Ribbon: DNS server 2 has been changed on ({ITEM.LASTVALUE1})'
              priority: WARNING
              description: 'The DNS server 2 has been changed. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: 84eaf3b4cac446e19f22e05610fcf6ad
          name: 'Node name'
          type: DEPENDENT
          key: ribbon.system.node.name
          delay: '0'
          value_type: CHAR
          trends: '0'
          description: 'Sets the DNS host name for the system.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.system.NodeName
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: system
        - uuid: 3266a81e84e64d91b4f08eeab1b53287
          name: 'Serial number'
          type: DEPENDENT
          key: ribbon.system.serial.number
          delay: '0'
          value_type: CHAR
          trends: '0'
          description: 'Sets the serial number of the system.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.system.SerialNumber
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: system
        - uuid: 652980a128b546b983c3f044efe89068
          name: 'Software base build number'
          type: DEPENDENT
          key: ribbon.system.software.base.build
          delay: '0'
          value_type: CHAR
          trends: '0'
          description: 'The exact build: machine, time, and date. It should be reported whenever reporting any bug or crash related to the current software.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.system.rt_Software_Base_BuildNumber
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: system
        - uuid: 039e1092659940e7bc6470f45c661162
          name: 'Software base version'
          type: DEPENDENT
          key: ribbon.system.software.base.version
          delay: '0'
          value_type: CHAR
          trends: '0'
          description: 'Base software version.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.system.rt_Software_Base_Version
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: system
        - uuid: 764f62d23312409ba5f924ff4e2f1338
          name: 'Get system stats'
          type: SCRIPT
          key: ribbon.system.stats.get
          delay: '{$RIBBON.INTERVAL:"get_system_stats"}'
          history: '0'
          value_type: TEXT
          trends: '0'
          params: |
            var Ribbon = {
            	params: {},
            	request: new HttpRequest(),
            
            	setParams: function (params) {
            		['url', 'username', 'password'].forEach(function (field) {
            			if (typeof params !== 'object' || typeof params[field] === 'undefined' || params[field] === '') {
            				throw 'Required param is not set: ' + field + '.';
            			}
            		});
            
            		Ribbon.params = params;
            
            		if (typeof Ribbon.params.url === 'string') {
            			if (Ribbon.params.url.endsWith('/')) {
            				Ribbon.params.url = Ribbon.params.url.slice(0,-1);
            			}
            		}
            
            	},
            
            	getRequest: function (url) {
            		var response;
            
            		if (typeof Ribbon.params.proxy !== 'undefined' && Ribbon.params.proxy !== '') {
            			Ribbon.request.setProxy(Ribbon.params.proxy);
            		}
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Sending request: ' + Ribbon.params.url  + url);
            
            		response = Ribbon.request.get(Ribbon.params.url + url);
            
            		Zabbix.log(4, '[ Ribbon SBC Edge ] Received response with status code ' + Ribbon.request.getStatus() + ': ' + response);
            
            		if (Ribbon.request.getStatus() < 200 || Ribbon.request.getStatus() >= 300) {
            			throw 'Cannot connect to Ribbon SBC. Check debug log for more information.';
            		}
            
            		try {
            			response = JSON.parse(XML.toJson(response));
            		}
            		catch (error) {
            			throw 'Failed to parse response received from Ribbon SBC API. Check debug log for more information.';
            		}
            
            		return response;
            	},
            
            	getField: function (data, path) {
            		const steps = path.split('.');
            
            		for (var i = 0; i < steps.length; i++) {
            			var step = steps[i];
            
            			if (typeof data !== 'object' || typeof data[step] === 'undefined') {
            				throw 'Required field was not found: ' + path;
            			}
            			data = data[step];
            		}
            
            		return data;
            	},
            
            	login: function () {
            		var response = "",
            			cookies = "",
            			payload = 'Username=' + encodeURIComponent(Ribbon.params.username) + '&Password=' + encodeURIComponent(Ribbon.params.password);
            
            		Ribbon.request.addHeader('Content-Type', 'application/x-www-form-urlencoded');
            		response = Ribbon.request.post(Ribbon.params.url + '/rest/login', payload);
            
            		var headers = Ribbon.request.getHeaders();
            		for (var key in headers) {
            			if (key.toLowerCase() == 'set-cookie') {
            				cookies = headers[key];
            			}
            		}
            
            		Ribbon.request.addHeader('Cookie', cookies);
            	},
            
            	logout: function () {
            		var response = Ribbon.request.post(Ribbon.params.url + '/rest/logout');
            
            		return JSON.parse(XML.toJson(response));
            	}
            };
            
            try {
            	var result = {};
            
            	Ribbon.setParams(JSON.parse(value));
            	Ribbon.login();
            
            	result.system = Ribbon.getField(Ribbon.getRequest("/rest/system"), 'root.system');
            	result.systemcallstats = Ribbon.getField(Ribbon.getRequest("/rest/systemcallstats"), 'root.systemcallstats');
            	result.historicalstatistics = Ribbon.getField(Ribbon.getRequest("/rest/system/historicalstatistics/1"), 'root.historicalstatistics');
            	result.chassis = Ribbon.getField(Ribbon.getRequest("/rest/chassis"), 'root.chassis');
            	result.license = Ribbon.getField(Ribbon.getRequest("/rest/license"), 'root.license');
            
            	Ribbon.logout();
            
            	return JSON.stringify(result);
            }
            catch (error) {
            	Zabbix.log(3, '[ Ribbon SBC Edge ] System data ERROR: ' + error);
            	error_msg = 'Failed to get system data from API:' + error;
            
            	return JSON.stringify({ 'error':  error_msg });
            }
          description: 'Gets the system statistics.'
          timeout: '{$RIBBON.TIMEOUT}'
          parameters:
            - name: password
              value: '{$RIBBON.PASSWORD}'
            - name: proxy
              value: '{$RIBBON.PROXY}'
            - name: url
              value: '{$RIBBON.URL}'
            - name: username
              value: '{$RIBBON.USERNAME}'
          tags:
            - tag: component
              value: raw
        - uuid: b64aa9a227264033ad34a9f928dcf7de
          name: Status
          type: DEPENDENT
          key: ribbon.system.status
          delay: '0'
          trends: '0'
          description: |
            Indicates the hardware initialization state for this card.
            Possible values:
            - None
            - Card Idle
            - Card Detected
            - Card Activating
            - Card Activated
            - Card Remove Requested
            - Card Removing
            - Card Removed
            - Card Downloading
            - Card Failed
            - Card Disabled Long Loop
            - MAX
          valuemap:
            name: 'Ribbon: System status'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.system.Status
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 01f76a527a4743618027c9dc972ce132
              expression: 'last(/Ribbon SBC Edge by HTTP/ribbon.system.status)=9'
              name: 'Ribbon: System status - Card Failed'
              priority: AVERAGE
              description: 'The current system status - Card Failed.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 48de69c997174406a13920203a70acab
          name: 'Memory total'
          type: DEPENDENT
          key: ribbon.system.total.memory
          delay: '0'
          units: B
          description: 'Indicates the amount of RAM available in the system.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.system.TotalSystemMemory
            - type: MULTIPLIER
              parameters:
                - '1048576'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: memory
        - uuid: 1f7989838b6242979e24046ece70b2e7
          name: 'Temporary partition usage'
          type: DEPENDENT
          key: ribbon.tmp.part.usage
          delay: '0'
          value_type: FLOAT
          units: '%'
          description: 'Percentage of the temporary partition used.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.historicalstatistics.rt_TmpPartUsage
          master_item:
            key: ribbon.system.stats.get
          tags:
            - tag: component
              value: memory
      discovery_rules:
        - uuid: f4b48b81b6f4449596ea9f2380888483
          name: 'Alarm discovery'
          type: DEPENDENT
          key: ribbon.alarm.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#ALARM.EVENT.ID}'
                value: '{$RIBBON.ALARM.DISCOVERY.EVENT.ID.MATCHES}'
                formulaid: A
              - macro: '{#ALARM.EVENT.ID}'
                value: '{$RIBBON.ALARM.DISCOVERY.EVENT.ID.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#ALARM.STATE}'
                value: '{$RIBBON.ALARM.DISCOVERY.STATE.MATCHES}'
                formulaid: C
              - macro: '{#ALARM.STATE}'
                value: '{$RIBBON.ALARM.DISCOVERY.STATE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
          description: 'Used for discovering active alarms.'
          item_prototypes:
            - uuid: 0a69e67c013040f5b760d606498c00d9
              name: 'Alarm [{#ALARM.EVENT.ID}.{#ALARM.EVENT.SUB.ID}]: Source: [{#ALARM.SOURCE}]: Severity'
              type: DEPENDENT
              key: 'ribbon.alarm.severity[{#ALARM.ID}]'
              delay: '0'
              description: 'Severity of `{#ALARM.CONDITION}` event.'
              valuemap:
                name: 'Ribbon: Alarm Severity'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.{#ALARM.ID}.aSeverity'
              master_item:
                key: ribbon.alarm.get
              tags:
                - tag: alarm
                  value: '{#ALARM.EVENT.ID}.{#ALARM.EVENT.SUB.ID}'
                - tag: component
                  value: alarm
              trigger_prototypes:
                - uuid: 1adce8721d334165a94ace0c2bd6efaa
                  expression: 'last(/Ribbon SBC Edge by HTTP/ribbon.alarm.severity[{#ALARM.ID}])=4'
                  name: 'Ribbon: Alarm [{#ALARM.EVENT.ID}.{#ALARM.EVENT.SUB.ID}]: Source: [{#ALARM.SOURCE}]: Severity is critical'
                  opdata: 'Current severity: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: 'The alarm `{#ALARM.CONDITION}` severity is critical.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
                - uuid: 9581ed26f3e44956b6fc1c9b6899f92f
                  expression: 'last(/Ribbon SBC Edge by HTTP/ribbon.alarm.severity[{#ALARM.ID}])=3'
                  name: 'Ribbon: Alarm [{#ALARM.EVENT.ID}.{#ALARM.EVENT.SUB.ID}]: Source: [{#ALARM.SOURCE}]: Severity is major'
                  opdata: 'Current severity: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'The alarm `{#ALARM.CONDITION}` severity is major.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
                - uuid: 596ac083d1714cc1ae6d6649c60c614a
                  expression: 'last(/Ribbon SBC Edge by HTTP/ribbon.alarm.severity[{#ALARM.ID}])=2'
                  name: 'Ribbon: Alarm [{#ALARM.EVENT.ID}.{#ALARM.EVENT.SUB.ID}]: Source: [{#ALARM.SOURCE}]: Severity is minor'
                  opdata: 'Current severity: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'The alarm `{#ALARM.CONDITION}` severity is minor.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
          master_item:
            key: ribbon.alarm.get
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  if (value === '' || value === '{}') {
                  	return '[]';
                  };
                  
                  const json_data = JSON.parse(value);
                  var output_data = [];
                  
                  for (var entity in json_data) {
                  	output_data.push({
                  		"{#ALARM.ID}": json_data[entity]["@id"],
                  		"{#ALARM.EVENT.ID}": json_data[entity]["EventID"],
                  		"{#ALARM.EVENT.SUB.ID}": json_data[entity]["EventSubID"],
                  		"{#ALARM.CONDITION}": json_data[entity]["Condition"],
                  		"{#ALARM.SOURCE}": json_data[entity]["InstanceOID"],
                  		"{#ALARM.STATE}": json_data[entity]["aState"]
                  	});
                  };
                  
                  return JSON.stringify(output_data);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 97cc15da89f441b8b7a830124e0e8ab7
          name: 'Certificate discovery'
          type: DEPENDENT
          key: ribbon.cert.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#CERT.NAME}'
                value: '{$RIBBON.CERTIFICATE.DISCOVERY.NAME.MATCHES}'
                formulaid: A
              - macro: '{#CERT.NAME}'
                value: '{$RIBBON.CERTIFICATE.DISCOVERY.NAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          description: 'Used for discovering certificates.'
          item_prototypes:
            - uuid: 1234567890ab4cdebcdef1234567890a
              name: 'Certificate [{#CERT.NAME}]: Raw data'
              type: DEPENDENT
              key: 'ribbon.cert.status.raw.data[{#CERT.ID}]'
              delay: '0'
              history: '0'
              value_type: TEXT
              trends: '0'
              description: 'Raw data for "{#CERT.NAME}" certificate.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.{#CERT.ID}'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: ribbon.cert.get
              tags:
                - tag: certificate
                  value: '{#CERT.NAME}'
                - tag: component
                  value: certificate
                - tag: component
                  value: raw
            - uuid: 98b1be079a8c485cbe468d332f2709d6
              name: 'Certificate [{#CERT.NAME}]: Valid until'
              type: DEPENDENT
              key: 'ribbon.cert.status.valid.until[{#CERT.ID}]'
              delay: '0'
              units: unixtime
              description: 'Indicates the expiration date of this certificate.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.CertEndDateEpoch
              master_item:
                key: 'ribbon.cert.status.raw.data[{#CERT.ID}]'
              tags:
                - tag: certificate
                  value: '{#CERT.NAME}'
                - tag: component
                  value: certificate
            - uuid: 606295f441714240a9cb20276cc21664
              name: 'Certificate [{#CERT.NAME}]: Status'
              type: DEPENDENT
              key: 'ribbon.cert.status[{#CERT.ID}]'
              delay: '0'
              value_type: CHAR
              trends: '0'
              description: 'Displays the status of the certificate validation and verification against the trusted CA.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.CertVerifyStatus
              master_item:
                key: 'ribbon.cert.status.raw.data[{#CERT.ID}]'
              tags:
                - tag: certificate
                  value: '{#CERT.NAME}'
                - tag: component
                  value: certificate
              trigger_prototypes:
                - uuid: ca28f7431d134a6cadbbf039e342e843
                  expression: 'last(/Ribbon SBC Edge by HTTP/ribbon.cert.status[{#CERT.ID}])<>"OK"'
                  name: 'Ribbon: Certificate [{#CERT.NAME}]: Status in not OK'
                  opdata: 'Current status: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: 'The certificate status is not OK.'
                  tags:
                    - tag: scope
                      value: availability
          master_item:
            key: ribbon.cert.get
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  if (value === '' || value === '{}') {
                  	return '[]';
                  };
                  
                  const json_data = JSON.parse(value);
                  var output_data = [];
                  
                  for (var entity in json_data) {
                  	output_data.push({
                  		"{#CERT.ID}": json_data[entity]["@id"],
                  		"{#CERT.NAME}": json_data[entity]["CertCommonName"]
                  	});
                  };
                  
                  return JSON.stringify(output_data);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: f7409cc2f49945c79e659caa7e86f53f
          name: 'Disk partition discovery'
          type: DEPENDENT
          key: ribbon.disk.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#DISK.NAME}'
                value: '{$RIBBON.DISK.DISCOVERY.NAME.MATCHES}'
                formulaid: A
              - macro: '{#DISK.NAME}'
                value: '{$RIBBON.DISK.DISCOVERY.NAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#DISK.TYPE}'
                value: '{$RIBBON.DISK.DISCOVERY.TYPE.MATCHES}'
                formulaid: C
              - macro: '{#DISK.TYPE}'
                value: '{$RIBBON.DISK.DISCOVERY.TYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
          description: 'Used for discovering system disk partition.'
          item_prototypes:
            - uuid: a2c476e67fbb48da914834cbe2146975
              name: 'Disk [{#DISK.NAME}]: Raw data'
              type: DEPENDENT
              key: 'ribbon.disk.raw.data[{#DISK.ID}]'
              delay: '0'
              history: '0'
              value_type: TEXT
              trends: '0'
              description: 'Raw data of the disk partition.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.{#DISK.ID}'
              master_item:
                key: ribbon.disk.get
              tags:
                - tag: component
                  value: capacity
                - tag: component
                  value: raw
                - tag: disk
                  value: '{#DISK.NAME}'
            - uuid: f8236f0b24304091b72aad4a44ec86ef
              name: 'Disk [{#DISK.NAME}]: Available'
              type: DEPENDENT
              key: 'ribbon.disk.size.available[{#DISK.ID}]'
              delay: '0'
              units: B
              description: 'Amount of memory in bytes, available for use in the file system.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_MemoryAvailable
              master_item:
                key: 'ribbon.disk.raw.data[{#DISK.ID}]'
              tags:
                - tag: component
                  value: capacity
                - tag: disk
                  value: '{#DISK.NAME}'
            - uuid: b7e0cc62963f4b9cab987b1bbd91e521
              name: 'Disk [{#DISK.NAME}]: Size'
              type: DEPENDENT
              key: 'ribbon.disk.size.max[{#DISK.ID}]'
              delay: '0'
              units: B
              description: 'Specifies the maximum amount of memory, in bytes available in this partition.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_MaximumSize
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
              master_item:
                key: 'ribbon.disk.raw.data[{#DISK.ID}]'
              tags:
                - tag: component
                  value: capacity
                - tag: disk
                  value: '{#DISK.NAME}'
            - uuid: e866506e32c44931ac3a3eb280b2a372
              name: 'Disk [{#DISK.NAME}]: Used'
              type: DEPENDENT
              key: 'ribbon.disk.size.used[{#DISK.ID}]'
              delay: '0'
              units: B
              description: 'Amount of memory in bytes, used by the existing files in the file system.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_MemoryUsed
              master_item:
                key: 'ribbon.disk.raw.data[{#DISK.ID}]'
              tags:
                - tag: component
                  value: capacity
                - tag: disk
                  value: '{#DISK.NAME}'
            - uuid: 0b75d8331cc5411f830d8f2303be8eda
              name: 'Disk [{#DISK.NAME}]: Type'
              type: DEPENDENT
              key: 'ribbon.disk.type[{#DISK.ID}]'
              delay: '0'
              description: |
                Identifies the user-friendly physical device holding the partition.
                Possible values:
                - Configuration
                - Logs
                - Temp
                - Core File
                - ASM Module
                - Software Update
                - Internal Logs
                - System
                - Others
                - Packet Capture Logs
              valuemap:
                name: 'Ribbon: Disk type'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_PartitionType
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
              master_item:
                key: 'ribbon.disk.raw.data[{#DISK.ID}]'
              tags:
                - tag: component
                  value: capacity
                - tag: disk
                  value: '{#DISK.NAME}'
            - uuid: ba402d0de10d49ba9cf9dbd3c5e42497
              name: 'Disk [{#DISK.NAME}]: Utilization'
              type: DEPENDENT
              key: 'ribbon.disk.usage.percent[{#DISK.ID}]'
              delay: '0'
              units: '!%'
              description: 'Amount of memory used by this partition, expressed as a percentage.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_CurrentUsage
              master_item:
                key: 'ribbon.disk.raw.data[{#DISK.ID}]'
              tags:
                - tag: component
                  value: capacity
                - tag: disk
                  value: '{#DISK.NAME}'
              trigger_prototypes:
                - uuid: 1ef41f56bb1e42bf83fc14a98c60bdc3
                  expression: 'min(/Ribbon SBC Edge by HTTP/ribbon.disk.usage.percent[{#DISK.ID}],5m)>{$RIBBON.DISK.USED.MAX:"{#DISK.NAME}"}'
                  name: 'Ribbon: Disk [{#DISK.NAME}]: Disk space usage is high'
                  event_name: 'Ribbon: Disk [{#DISK.NAME}]: Disk space usage is high (more {$RIBBON.DISK.USED.MAX:"{#DISK.NAME}"}% for 5m)'
                  opdata: 'Current usage: {ITEM.LASTVALUE}'
                  priority: AVERAGE
                  description: 'Disk space usage is larger than the threshold.'
                  tags:
                    - tag: scope
                      value: availability
          master_item:
            key: ribbon.disk.get
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  if (value === '' || value === '{}') {
                  	return '[]';
                  };
                  
                  const json_data = JSON.parse(value);
                  var output_data = [];
                  
                  for (var entity in json_data) {
                  	output_data.push({
                  		"{#DISK.ID}": json_data[entity]["@id"],
                  		"{#DISK.NAME}": json_data[entity].rt_PartitionName,
                  		"{#DISK.TYPE}": json_data[entity].rt_PartitionType
                  	});
                  };
                  
                  return JSON.stringify(output_data);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 3c631d9182514870baa83f42d0eebe3d
          name: 'DSP card discovery'
          type: DEPENDENT
          key: ribbon.dsp.card.discovery
          delay: '0'
          description: 'Used for discovering DSP cards.'
          item_prototypes:
            - uuid: 398b159419f84b0f8a0ec54db3d24bb5
              name: 'DSP Card [{#DSP.CARD.ID}]: Available'
              type: DEPENDENT
              key: 'ribbon.dsp.card.available[{#DSP.CARD.ID}]'
              delay: '0'
              description: |
                Identifies whether a DSP Module is installed in this slot.
                Possible values:
                  - False
                  - True
              valuemap:
                name: 'Ribbon: Bool'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_Available
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ribbon.dsp.card.raw.data[{#DSP.CARD.ID}]'
              tags:
                - tag: component
                  value: dsp
                - tag: dsp_card
                  value: '{#DSP.CARD.ID}'
            - uuid: 95f176c173374542902d170864f1e2ca
              name: 'DSP Card [{#DSP.CARD.ID}]: Channels in use'
              type: DEPENDENT
              key: 'ribbon.dsp.card.channels.in.use[{#DSP.CARD.ID}]'
              delay: '0'
              description: 'Indicates the number of channels currently in use on the DSP Module.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_ChannelsInUse
              master_item:
                key: 'ribbon.dsp.card.raw.data[{#DSP.CARD.ID}]'
              tags:
                - tag: component
                  value: dsp
                - tag: dsp_card
                  value: '{#DSP.CARD.ID}'
            - uuid: 668923672d8a43b58a38e66c0a80f6fb
              name: 'DSP Card [{#DSP.CARD.ID}]: CPU usage'
              type: DEPENDENT
              key: 'ribbon.dsp.card.cpu.usage.percent[{#DSP.CARD.ID}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: 'Indicates the current CPU level for this DSP. Only applicable if the DSP is available.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_CPUUsage
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'ribbon.dsp.card.raw.data[{#DSP.CARD.ID}]'
              tags:
                - tag: component
                  value: cpu
                - tag: component
                  value: dsp
                - tag: dsp_card
                  value: '{#DSP.CARD.ID}'
              trigger_prototypes:
                - uuid: c3b9a4aabfc644c598226cdbad79b267
                  expression: 'avg(/Ribbon SBC Edge by HTTP/ribbon.dsp.card.cpu.usage.percent[{#DSP.CARD.ID}],15m)>{$RIBBON.DSP.CARD.CPU.USAGE.CRIT:"{#DSP.CARD.ID}"}'
                  name: 'Ribbon: DSP Card [{#DSP.CARD.ID}]: CPU usage is high'
                  event_name: 'Ribbon: DSP Card [{#DSP.CARD.ID}]: CPU usage is high (more than {$RIBBON.DSP.CARD.CPU.USAGE.CRIT:"{#DSP.CARD.ID}"}% for 15m)'
                  opdata: 'Current usage: {ITEM.LASTVALUE}'
                  priority: AVERAGE
                  description: 'The DSP card CPU usage is higher than the threshold.'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 27fe538ff91e4004a85da110d11837dc
              name: 'DSP Card [{#DSP.CARD.ID}]: Location'
              type: DEPENDENT
              key: 'ribbon.dsp.card.location[{#DSP.CARD.ID}]'
              delay: '0'
              description: |
                The hardware module's location within the SBC.
                Possible values:
                  - Unknown
                  - LineCard1
                  - LineCard2
                  - DSPCard1
                  - DSPCard2
                  - DSPCard3
                  - DSPCard4
                  - DSPCard5
                  - DSPCard6
                  - BITS_WAN
                  - SFP
                  - COMExpress
                  - Mainboard
                  - PSU1
                  - PSU2
                  - UX1000_Telco_1
                  - UX1000_Telco_2
                  - UX1000_Telco_3
                  - UX1000_Telco_4
                  - UX1000_Telco_5
                  - UX1000_Telco_6
                  - UX1000_DS1_Telco
                  - UX1000_DS1_WAN
                  - MAX
              valuemap:
                name: 'Ribbon: Card Location'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_Location
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
              master_item:
                key: 'ribbon.dsp.card.raw.data[{#DSP.CARD.ID}]'
              tags:
                - tag: component
                  value: dsp
                - tag: dsp_card
                  value: '{#DSP.CARD.ID}'
            - uuid: 6e27897765784155a72d8a82befd4b45
              name: 'DSP Card [{#DSP.CARD.ID}]: Raw data'
              type: DEPENDENT
              key: 'ribbon.dsp.card.raw.data[{#DSP.CARD.ID}]'
              delay: '0'
              history: '0'
              value_type: TEXT
              trends: '0'
              description: 'Raw data for `{#DSP.CARD.ID}` DSP card.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.{#DSP.CARD.ID}'
              master_item:
                key: ribbon.dsp.card.get
              tags:
                - tag: component
                  value: dsp
                - tag: component
                  value: raw
                - tag: dsp_card
                  value: '{#DSP.CARD.ID}'
            - uuid: aaf0b56a5e3545ec86dd680990ebeb15
              name: 'DSP Card [{#DSP.CARD.ID}]: Service status'
              type: DEPENDENT
              key: 'ribbon.dsp.card.service.status[{#DSP.CARD.ID}]'
              delay: '0'
              description: |
                Indicates the status of the DSP Module
                `Detected` - The module is detected by the SBC software but is not initialized or available for signal processing tasks.
                `Available` - The module is ready for signal processing tasks.
              valuemap:
                name: 'Ribbon: Service status'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_ServiceStatus
              master_item:
                key: 'ribbon.dsp.card.raw.data[{#DSP.CARD.ID}]'
              tags:
                - tag: component
                  value: dsp
                - tag: dsp_card
                  value: '{#DSP.CARD.ID}'
              trigger_prototypes:
                - uuid: 92385745ac444bcbb513e7783c7d4042
                  expression: 'last(/Ribbon SBC Edge by HTTP/ribbon.dsp.card.service.status[{#DSP.CARD.ID}])=0'
                  name: 'Ribbon: DSP Card [{#DSP.CARD.ID}]: Service status is Detected'
                  opdata: 'Current status: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'The DSP card service status is Detected.'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 5e2f3f3e1f1e4f2fa6f3e8b1c4d5e6f7
              name: 'DSP Card [{#DSP.CARD.ID}]: Status'
              type: DEPENDENT
              key: 'ribbon.dsp.card.status[{#DSP.CARD.ID}]'
              delay: '0'
              description: |
                Indicates the hardware initialization state for this DSP card.
                Possible values:
                  - None
                  - Card Idle
                  - Card Detected
                  - Card Activating
                  - Card Activated
                  - Card Remove Requested
                  - Card Removing
                  - Card Removed
                  - Card Downloading
                  - Card Failed
                  - Card Disabled Long Loop
                  - MAX
              valuemap:
                name: 'Ribbon: System status'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_Status
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ribbon.dsp.card.raw.data[{#DSP.CARD.ID}]'
              tags:
                - tag: component
                  value: dsp
                - tag: component
                  value: system
                - tag: dsp_card
                  value: '{#DSP.CARD.ID}'
              trigger_prototypes:
                - uuid: 9998a0a93f314d69a7a36ac6bfe5a258
                  expression: 'last(/Ribbon SBC Edge by HTTP/ribbon.dsp.card.status[{#DSP.CARD.ID}])=9'
                  name: 'Ribbon: DSP Card [{#DSP.CARD.ID}]: Status is FAILED'
                  opdata: 'Current status: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: 'The DSP card status is failed.'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 22e8b25b626449b7856a3f61a16e11a7
              name: 'DSP Card [{#DSP.CARD.ID}]: Updated time'
              type: DEPENDENT
              key: 'ribbon.dsp.card.updated.time[{#DSP.CARD.ID}]'
              delay: '0'
              units: uptime
              description: 'Indicates the time, when this DSP reported it''s CPU usage.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_UpdatedTime
              master_item:
                key: 'ribbon.dsp.card.raw.data[{#DSP.CARD.ID}]'
              tags:
                - tag: component
                  value: dsp
                - tag: dsp_card
                  value: '{#DSP.CARD.ID}'
          master_item:
            key: ribbon.dsp.card.get
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  if (value === '' || value === '{}') {
                  	return '[]';
                  };
                  
                  const json_data = JSON.parse(value);
                  var output_data = [];
                  
                  for (var entity in json_data) {
                  	output_data.push({
                  		"{#DSP.CARD.ID}": json_data[entity]["@id"]
                  	});
                  };
                  
                  return JSON.stringify(output_data);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 18f07f6f15be4778977006db87fad929
          name: 'Fan discovery'
          type: DEPENDENT
          key: ribbon.fan.discovery
          delay: '0'
          description: 'Used for discovering fans.'
          item_prototypes:
            - uuid: 85033b1d2e6449a494580d60a7a34d80
              name: 'Fan [{#FAN.ID}]: Speed'
              type: DEPENDENT
              key: 'ribbon.fan.speed[{#FAN.ID}]'
              delay: '0'
              units: '!RPM'
              description: 'Indicates the speed of the fan in RPM.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.{#FAN.ID}.Fan_Speed'
              master_item:
                key: ribbon.fan.get
              tags:
                - tag: component
                  value: fan
                - tag: component
                  value: sensor
          master_item:
            key: ribbon.fan.get
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  if (value === '' || value === '{}') {
                  	return '[]';
                  };
                  
                  const json_data = JSON.parse(value);
                  var output_data = [];
                  
                  for (var entity in json_data) {
                  	output_data.push({
                  		"{#FAN.ID}": json_data[entity]["@id"]
                  	});
                  };
                  
                  return JSON.stringify(output_data);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 3647c72235f7420a9937749a04eb1ed4
          name: 'Network interface discovery'
          type: DEPENDENT
          key: ribbon.net.if.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#INTERFACE.NAME}'
                value: '{$RIBBON.INTERFACE.DISCOVERY.NAME.MATCHES}'
                formulaid: A
              - macro: '{#INTERFACE.NAME}'
                value: '{$RIBBON.INTERFACE.DISCOVERY.NAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#INTERFACE.TYPE}'
                value: '{$RIBBON.INTERFACE.DISCOVERY.TYPE.MATCHES}'
                formulaid: C
              - macro: '{#INTERFACE.TYPE}'
                value: '{$RIBBON.INTERFACE.DISCOVERY.TYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
          description: 'Used for discovering system interfaces.'
          item_prototypes:
            - uuid: 2c3fd61a0881477d9cf1f12bcff5e499
              name: 'Interface [{#INTERFACE.NAME}]: Config interface state'
              type: DEPENDENT
              key: 'ribbon.net.if.config.state[{#INTERFACE.ID}]'
              delay: '0'
              description: |
                Specifies the Administrative State of the resource.
                Possible values:
                - Disabled
                - Enabled
              valuemap:
                name: 'Ribbon: Config interface state'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.ConfigIEState
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ribbon.net.if.raw.data[{#INTERFACE.ID}]'
              tags:
                - tag: component
                  value: network
                - tag: interface
                  value: '{#INTERFACE.NAME}'
            - uuid: 7d6db1ff5b2144cda406798bfaa5a4f6
              name: 'Interface [{#INTERFACE.NAME}]: Bits received'
              type: DEPENDENT
              key: 'ribbon.net.if.in.octets[{#INTERFACE.ID}]'
              delay: '0'
              units: bps
              description: 'Displays the number of received bits on this port.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_ifInOctets
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'ribbon.net.if.raw.data[{#INTERFACE.ID}]'
              tags:
                - tag: component
                  value: network
                - tag: interface
                  value: '{#INTERFACE.NAME}'
            - uuid: c47ba8091f6e47758d5c67b3e7af9687
              name: 'Interface [{#INTERFACE.NAME}]: Networking mode'
              type: DEPENDENT
              key: 'ribbon.net.if.networking.mode[{#INTERFACE.ID}]'
              delay: '0'
              description: |
                Specifies if the port is in switched mode or routed mode.
                Possible values:
                - Switch
                - Route
              valuemap:
                name: 'Ribbon: Networking mode'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.ifNetworkingMode
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
              master_item:
                key: 'ribbon.net.if.raw.data[{#INTERFACE.ID}]'
              tags:
                - tag: component
                  value: network
                - tag: interface
                  value: '{#INTERFACE.NAME}'
            - uuid: e9d6248bc3e84fc4973c35ce89dc775c
              name: 'Interface [{#INTERFACE.NAME}]: Operational status'
              type: DEPENDENT
              key: 'ribbon.net.if.operator.state[{#INTERFACE.ID}]'
              delay: '0'
              description: |
                The operational status of the interface.
                Possible values:
                - Up
                - Down
              valuemap:
                name: 'Ribbon: Operational status'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_ifOperatorStatus
              master_item:
                key: 'ribbon.net.if.raw.data[{#INTERFACE.ID}]'
              tags:
                - tag: component
                  value: network
                - tag: interface
                  value: '{#INTERFACE.NAME}'
            - uuid: ed237fe950c049859f62be677e38c645
              name: 'Interface [{#INTERFACE.NAME}]: Bits sent'
              type: DEPENDENT
              key: 'ribbon.net.if.out.octets[{#INTERFACE.ID}]'
              delay: '0'
              units: bps
              description: 'Displays the number of transmitted bits on this port.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_ifOutOctets
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'ribbon.net.if.raw.data[{#INTERFACE.ID}]'
              tags:
                - tag: component
                  value: network
                - tag: interface
                  value: '{#INTERFACE.NAME}'
            - uuid: 408a4289df4b4203b705bbc896b3b489
              name: 'Interface [{#INTERFACE.NAME}]: Raw data'
              type: DEPENDENT
              key: 'ribbon.net.if.raw.data[{#INTERFACE.ID}]'
              delay: '0'
              history: '0'
              value_type: TEXT
              trends: '0'
              description: 'Raw data of the interface.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.{#INTERFACE.ID}'
              master_item:
                key: ribbon.net.if.get
              tags:
                - tag: component
                  value: network
                - tag: component
                  value: raw
                - tag: interface
                  value: '{#INTERFACE.NAME}'
            - uuid: 537994b412f646298847c9f1556ccfcc
              name: 'Interface [{#INTERFACE.NAME}]: Speed'
              type: DEPENDENT
              key: 'ribbon.net.if.speed[{#INTERFACE.ID}]'
              delay: '0'
              description: |
                An estimate of the interface's current bandwidth in bits per second.
                Possible values:
                - 10 Mbps
                - 100 Mbps
                - 1000 Mbps
                - Auto
              valuemap:
                name: 'Ribbon: Interface speed'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_ifSpeed
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
              master_item:
                key: 'ribbon.net.if.raw.data[{#INTERFACE.ID}]'
              tags:
                - tag: component
                  value: network
                - tag: interface
                  value: '{#INTERFACE.NAME}'
            - uuid: 6f16fc284492411a945786a25ea88a8f
              name: 'Interface [{#INTERFACE.NAME}]: Interface type'
              type: DEPENDENT
              key: 'ribbon.net.if.type[{#INTERFACE.ID}]'
              delay: '0'
              description: |
                Specifies the interface type.
                Possible values:
                - Ethernet
                - VLAN
                - QINQ
                - BONDED
                - BRIDGE
              valuemap:
                name: 'Ribbon: Interface Type'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.ifType
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
              master_item:
                key: 'ribbon.net.if.raw.data[{#INTERFACE.ID}]'
              tags:
                - tag: component
                  value: network
                - tag: interface
                  value: '{#INTERFACE.NAME}'
          trigger_prototypes:
            - uuid: 131026a699674931b135604f1dea4b66
              expression: 'last(/Ribbon SBC Edge by HTTP/ribbon.net.if.operator.state[{#INTERFACE.ID}])=1 and last(/Ribbon SBC Edge by HTTP/ribbon.net.if.config.state[{#INTERFACE.ID}])=1'
              name: 'Ribbon: Interface [{#INTERFACE.NAME}]: Operational status is DOWN'
              opdata: 'Current status: {ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: 'The operational status of the interface is down.'
              tags:
                - tag: scope
                  value: availability
          master_item:
            key: ribbon.net.if.get
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  if (value === '' || value === '{}') {
                  	return '[]';
                  };
                  
                  const json_data = JSON.parse(value);
                  var output_data = [];
                  
                  for (var entity in json_data) {
                  	output_data.push({
                  		"{#INTERFACE.ID}": json_data[entity]["@id"],
                  		"{#INTERFACE.NAME}": json_data[entity].ifName,
                  		"{#INTERFACE.TYPE}": json_data[entity].ifType
                  	});
                  };
                  
                  return JSON.stringify(output_data);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 3e140fc4939e4d69b1eddbc34f67d33c
          name: 'Power supply discovery'
          type: DEPENDENT
          key: ribbon.psu.discovery
          delay: '0'
          description: 'Used for discovering the power supply.'
          item_prototypes:
            - uuid: 9deb137ec4884586afea405ed144b00a
              name: 'PSU [{#PSU.ID}]: AC input good'
              type: DEPENDENT
              key: 'ribbon.psu.ac.input.good[{#PSU.ID}]'
              delay: '0'
              description: |
                Indicates whether the AC power input for this power supply is in a good state.
                Possible values:
                - False
                - True
              valuemap:
                name: 'Ribbon: Bool'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.ACInputGood
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3h
              master_item:
                key: 'ribbon.psu.raw.data[{#PSU.ID}]'
              tags:
                - tag: component
                  value: psu
                - tag: psu
                  value: '{#PSU.ID}'
              trigger_prototypes:
                - uuid: 6f70c36a7c144c5ebf3fe6911d4c8d07
                  expression: 'last(/Ribbon SBC Edge by HTTP/ribbon.psu.ac.input.good[{#PSU.ID}]) = 0'
                  name: 'Ribbon: PSU [{#PSU.ID}]: AC input is not OK'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'The AC power input of the power supply reports a bad state.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 88ca7c8494824e24871f9b63d5ab663c
              name: 'PSU [{#PSU.ID}]: Current in'
              type: DEPENDENT
              key: 'ribbon.psu.current.in[{#PSU.ID}]'
              delay: '0'
              value_type: FLOAT
              units: A
              description: 'Input current of this power supply in amperes.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.CurrentIn
              master_item:
                key: 'ribbon.psu.raw.data[{#PSU.ID}]'
              tags:
                - tag: component
                  value: psu
                - tag: psu
                  value: '{#PSU.ID}'
            - uuid: 763bfd2a314543e8b33962f3e6fa4d54
              name: 'PSU [{#PSU.ID}]: Current out'
              type: DEPENDENT
              key: 'ribbon.psu.current.out[{#PSU.ID}]'
              delay: '0'
              value_type: FLOAT
              units: A
              description: 'Output current of this power supply in amperes.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.CurrentOut
              master_item:
                key: 'ribbon.psu.raw.data[{#PSU.ID}]'
              tags:
                - tag: component
                  value: psu
                - tag: psu
                  value: '{#PSU.ID}'
            - uuid: 0269a8584a8a470ca10cdce57be13f0d
              name: 'PSU [{#PSU.ID}]: Fan1 speed'
              type: DEPENDENT
              key: 'ribbon.psu.fan1.speed[{#PSU.ID}]'
              delay: '0'
              units: '!RPM'
              description: 'The speed of the first fan on this power supply in RPM.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.Fan1_Speed
              master_item:
                key: 'ribbon.psu.raw.data[{#PSU.ID}]'
              tags:
                - tag: component
                  value: fan
                - tag: component
                  value: psu
                - tag: psu
                  value: '{#PSU.ID}'
            - uuid: 3b496cc4557743908d6da52171c4c5b6
              name: 'PSU [{#PSU.ID}]: Fan2 speed'
              type: DEPENDENT
              key: 'ribbon.psu.fan2.speed[{#PSU.ID}]'
              delay: '0'
              units: '!RPM'
              description: 'The speed of the second fan on this power supply in RPM.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.Fan2_Speed
              master_item:
                key: 'ribbon.psu.raw.data[{#PSU.ID}]'
              tags:
                - tag: component
                  value: fan
                - tag: component
                  value: psu
                - tag: psu
                  value: '{#PSU.ID}'
            - uuid: abb2d6a045674ddcbfe8befb489ea8cc
              name: 'PSU [{#PSU.ID}]: Power in'
              type: DEPENDENT
              key: 'ribbon.psu.power.in[{#PSU.ID}]'
              delay: '0'
              units: W
              description: 'Input power of this power supply in watts.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.PowerIn
              master_item:
                key: 'ribbon.psu.raw.data[{#PSU.ID}]'
              tags:
                - tag: component
                  value: psu
                - tag: psu
                  value: '{#PSU.ID}'
            - uuid: 7a0631c2afc44200bc466b07dd2e2861
              name: 'PSU [{#PSU.ID}]: Power out'
              type: DEPENDENT
              key: 'ribbon.psu.power.out[{#PSU.ID}]'
              delay: '0'
              units: W
              description: 'Output power of this power supply in watts.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.PowerOut
              master_item:
                key: 'ribbon.psu.raw.data[{#PSU.ID}]'
              tags:
                - tag: component
                  value: psu
                - tag: psu
                  value: '{#PSU.ID}'
            - uuid: 6363fec4ace74dbeb1ca7cc8d2874ba5
              name: 'PSU [{#PSU.ID}]: Raw data'
              type: DEPENDENT
              key: 'ribbon.psu.raw.data[{#PSU.ID}]'
              delay: '0'
              history: '0'
              value_type: TEXT
              trends: '0'
              description: 'Raw data for this power supply.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.{#PSU.ID}'
              master_item:
                key: ribbon.psu.get
              tags:
                - tag: component
                  value: psu
                - tag: component
                  value: raw
                - tag: psu
                  value: '{#PSU.ID}'
            - uuid: 2dcb0fac8c294186ad3f1003c6b4f552
              name: 'PSU [{#PSU.ID}]: Temperature'
              type: DEPENDENT
              key: 'ribbon.psu.temp[{#PSU.ID}]'
              delay: '0'
              value_type: FLOAT
              units: °C
              description: 'Temperature of this power supply in degrees Celsius.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.Temp
              master_item:
                key: 'ribbon.psu.raw.data[{#PSU.ID}]'
              tags:
                - tag: component
                  value: psu
                - tag: psu
                  value: '{#PSU.ID}'
              trigger_prototypes:
                - uuid: 0084aa4adf6949b888fc30e5643dd96b
                  expression: 'avg(/Ribbon SBC Edge by HTTP/ribbon.psu.temp[{#PSU.ID}],5m)>{$RIBBON.TEMP.PSU.CRIT}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/Ribbon SBC Edge by HTTP/ribbon.psu.temp[{#PSU.ID}],5m)<{$RIBBON.TEMP.PSU.CRIT}-3'
                  name: 'Ribbon: PSU [{#PSU.ID}]: Temperature on power supply is above critical threshold'
                  event_name: 'Ribbon: PSU [{#PSU.ID}]: Temperature is above critical threshold: >{$RIBBON.TEMP.PSU.CRIT}'
                  opdata: 'Current temperature: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: 'This trigger uses temperature of power supply value.'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
            - uuid: d91ff2d143b9418b91933ab52c6361eb
              name: 'PSU [{#PSU.ID}]: Voltage in'
              type: DEPENDENT
              key: 'ribbon.psu.voltage.in[{#PSU.ID}]'
              delay: '0'
              units: V
              description: 'Input voltage of this power supply.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.VoltageIn
              master_item:
                key: 'ribbon.psu.raw.data[{#PSU.ID}]'
              tags:
                - tag: component
                  value: psu
                - tag: psu
                  value: '{#PSU.ID}'
            - uuid: f6591d2a5a7f445d9ea20d52355640fd
              name: 'PSU [{#PSU.ID}]: Voltage out'
              type: DEPENDENT
              key: 'ribbon.psu.voltage.out[{#PSU.ID}]'
              delay: '0'
              value_type: FLOAT
              units: V
              description: 'Output voltage of this power supply.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.VoltageOut
              master_item:
                key: 'ribbon.psu.raw.data[{#PSU.ID}]'
              tags:
                - tag: component
                  value: psu
                - tag: psu
                  value: '{#PSU.ID}'
          master_item:
            key: ribbon.psu.get
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  if (value === '' || value === '{}') {
                  	return '[]';
                  };
                  
                  const json_data = JSON.parse(value);
                  var output_data = [];
                  
                  for (var entity in json_data) {
                  	output_data.push({
                  		"{#PSU.ID}": json_data[entity]["@id"]
                  	});
                  };
                  
                  return JSON.stringify(output_data);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: b2237143db0c42b1bf8f470909df889e
          name: 'SIP server discovery'
          type: DEPENDENT
          key: ribbon.sip.server.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#SIP.SEQUENCE}'
                value: '1'
                formulaid: A
              - macro: '{#SIP.SERVER.NAME}'
                value: '{$RIBBON.SIP.SERVER.DISCOVERY.NAME.MATCHES}'
                formulaid: B
              - macro: '{#SIP.SERVER.NAME}'
                value: '{$RIBBON.SIP.SERVER.DISCOVERY.NAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: C
          description: 'Used for discovering SIP servers.'
          item_prototypes:
            - uuid: aac31d5ee67c4f33b7d602e83acbd288
              name: 'SIP Server [{#SIP.SERVER.NAME}]:[{#SIP.SERVER.DESCR}]: Downtime'
              type: DEPENDENT
              key: 'ribbon.sip.server.downtime[{#SIP.SERVER.NAME}]'
              delay: '0'
              description: 'Displays the time for which server was down due to not responding to options request or dns failures.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_DownTime
              master_item:
                key: 'ribbon.sip.server.raw.data[{#SIP.SERVER.NAME}]'
              tags:
                - tag: component
                  value: sip-server
                - tag: sip_server
                  value: '{#SIP.SERVER.NAME}'
            - uuid: e5e2790fba5f4cfe8c610b326a1b1040
              name: 'SIP Server [{#SIP.SERVER.NAME}]:[{#SIP.SERVER.DESCR}]: Host'
              type: DEPENDENT
              key: 'ribbon.sip.server.host[{#SIP.SERVER.NAME}]'
              delay: '0'
              value_type: CHAR
              trends: '0'
              description: 'Specifies the IP address or FQDN where this Signaling Group sends SIP messages. If an FQDN is configured all the associated servers are included and used according to the server selection configuration element.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.Host
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3h
              master_item:
                key: 'ribbon.sip.server.raw.data[{#SIP.SERVER.NAME}]'
              tags:
                - tag: component
                  value: sip-server
                - tag: sip_server
                  value: '{#SIP.SERVER.NAME}'
            - uuid: 3860ea61774d4e3b80cf2c43c477af93
              name: 'SIP Server [{#SIP.SERVER.NAME}]:[{#SIP.SERVER.DESCR}]: Port'
              type: DEPENDENT
              key: 'ribbon.sip.server.port[{#SIP.SERVER.NAME}]'
              delay: '0'
              description: 'Specifies the port number to send SIP messages.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.Port
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3h
              master_item:
                key: 'ribbon.sip.server.raw.data[{#SIP.SERVER.NAME}]'
              tags:
                - tag: component
                  value: sip-server
                - tag: sip_server
                  value: '{#SIP.SERVER.NAME}'
            - uuid: 0418fc972e4b499daa407e571d4bc0fe
              name: 'SIP Server [{#SIP.SERVER.NAME}]:[{#SIP.SERVER.DESCR}]: Raw data'
              type: DEPENDENT
              key: 'ribbon.sip.server.raw.data[{#SIP.SERVER.NAME}]'
              delay: '0'
              history: '0'
              value_type: TEXT
              trends: '0'
              description: 'Raw data for this SIP server.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.{#SIP.SERVER.ID}.metrics'
              master_item:
                key: ribbon.sip.server.get
              tags:
                - tag: component
                  value: raw
                - tag: component
                  value: sip
                - tag: sip_server
                  value: '{#SIP.SERVER.NAME}'
            - uuid: 7f0c7b0461104e838dbe9e5e88635198
              name: 'SIP Server [{#SIP.SERVER.NAME}]:[{#SIP.SERVER.DESCR}]: Status'
              type: DEPENDENT
              key: 'ribbon.sip.server.status[{#SIP.SERVER.NAME}]'
              delay: '0'
              description: 'Indicates the status of the SIP server.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_ServerStatus
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ribbon.sip.server.raw.data[{#SIP.SERVER.NAME}]'
              tags:
                - tag: component
                  value: sip-server
                - tag: sip_server
                  value: '{#SIP.SERVER.NAME}'
            - uuid: a556865ccad74d6aa3a36ef2411ba673
              name: 'SIP Server [{#SIP.SERVER.NAME}]:[{#SIP.SERVER.DESCR}]: Transactions failed'
              type: DEPENDENT
              key: 'ribbon.sip.server.transactions.failed[{#SIP.SERVER.NAME}]'
              delay: '0'
              description: 'Displays the number of failed SBC client transactions with the server.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_TransactionFalures
              master_item:
                key: 'ribbon.sip.server.raw.data[{#SIP.SERVER.NAME}]'
              tags:
                - tag: component
                  value: sip-server
                - tag: sip_server
                  value: '{#SIP.SERVER.NAME}'
              trigger_prototypes:
                - uuid: 2034204162de44b097c5bfd08c3b170e
                  expression: 'last(/Ribbon SBC Edge by HTTP/ribbon.sip.server.transactions.failed[{#SIP.SERVER.NAME}])>{$RIBBON.SIP.SERVER.TRANSACTIONS.FAILED.MAX:"{#SIP.SERVER.NAME}"}'
                  name: 'Ribbon: SIP Server [{#SIP.SERVER.NAME}]: Failed transactions are high'
                  event_name: 'Ribbon: SIP Server [{#SIP.SERVER.NAME}]: Failed transactions are high (more than {$RIBBON.SIP.SERVER.TRANSACTIONS.FAILED.MAX:"{#SIP.SERVER.NAME}"})'
                  opdata: 'Current failed transactions: {ITEM.LASTVALUE}'
                  priority: AVERAGE
                  description: 'The number of failed transactions is higher than the threshold.'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 6f80f25094a14f82bf0102fd1acae965
              name: 'SIP Server [{#SIP.SERVER.NAME}]:[{#SIP.SERVER.DESCR}]: Transactions'
              type: DEPENDENT
              key: 'ribbon.sip.server.transactions[{#SIP.SERVER.NAME}]'
              delay: '0'
              description: 'Displays the number of SBC client transactions with the server.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_Transactions
              master_item:
                key: 'ribbon.sip.server.raw.data[{#SIP.SERVER.NAME}]'
              tags:
                - tag: component
                  value: sip-server
                - tag: sip_server
                  value: '{#SIP.SERVER.NAME}'
            - uuid: 2f4a25ae814446f59e8a7b0cf6494369
              name: 'SIP Server [{#SIP.SERVER.NAME}]:[{#SIP.SERVER.DESCR}]: Type'
              type: DEPENDENT
              key: 'ribbon.sip.server.type[{#SIP.SERVER.NAME}]'
              delay: '0'
              description: |
                Specifies the method to use to lookup SIP servers
                `eConventionalSrvr` - A configured server entry defined by IP or FQDN.
                `eSrvRecordTemplateSrvr` - This is not an actual server but a template which will populate the server(s) once the SRV Query gets a response from DNS.
                `eSrvRecordSrvr`- The actual server created after SRV Query."
              valuemap:
                name: 'Ribbon: SIP Server Type'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.ServerType
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3h
              master_item:
                key: 'ribbon.sip.server.raw.data[{#SIP.SERVER.NAME}]'
              tags:
                - tag: component
                  value: sip-server
                - tag: sip_server
                  value: '{#SIP.SERVER.NAME}'
            - uuid: fabeaa0f64364fd5b70e71b41924309e
              name: 'SIP Server [{#SIP.SERVER.NAME}]:[{#SIP.SERVER.DESCR}]: Uptime'
              type: DEPENDENT
              key: 'ribbon.sip.server.uptime[{#SIP.SERVER.NAME}]'
              delay: '0'
              description: 'Displays the time for which the server was functioning and responding to SIP Options.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_UpTime
              master_item:
                key: 'ribbon.sip.server.raw.data[{#SIP.SERVER.NAME}]'
              tags:
                - tag: component
                  value: sip-server
                - tag: sip_server
                  value: '{#SIP.SERVER.NAME}'
          master_item:
            key: ribbon.sip.server.get
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  if (value === '' || value === '{}') {
                  	return '[]';
                  };
                  
                  const json_data = JSON.parse(value);
                  var output_data = [];
                  
                  for (var entity in json_data) {
                  	output_data.push({
                  		"{#SIP.SERVER.ID}": json_data[entity]["@id"],
                  		"{#SIP.SERVER.DESCR}": json_data[entity]["Description"],
                  		"{#SIP.SERVER.NAME}": json_data[entity]["StringName"],
                  		"{#SIP.SEQUENCE}": json_data[entity]["Sequence"] ? json_data[entity]["Sequence"] : 0
                  	});
                  };
                  
                  return JSON.stringify(output_data);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 5f3e2d6e2c1b4f2fa9e8b7c6d5a4b3c2
          name: 'SIP signal group discovery'
          type: DEPENDENT
          key: ribbon.sip.signal.group.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#SIP.SIGNAL.GROUP.DESCR}'
                value: '{$RIBBON.SIP.SIGNAL.GROUP.DISCOVERY.DESCR.MATCHES}'
                formulaid: A
              - macro: '{#SIP.SIGNAL.GROUP.DESCR}'
                value: '{$RIBBON.SIP.SIGNAL.GROUP.DISCOVERY.DESCR.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          description: 'Used for discovering SIP signal groups.'
          item_prototypes:
            - uuid: cfbe8c0b00894c5486ce3f04e911d3d1
              name: 'SIP Signal Group [{#SIP.SIGNAL.GROUP.DESCR}]: Number of channels'
              type: DEPENDENT
              key: 'ribbon.sip.signal.group.number.of.channels[{#SIP.SIGNAL.GROUP.ID}]'
              delay: '0'
              description: 'Provides the number of channels currently provisioned on this signaling group.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_NumberOfChannels
              master_item:
                key: 'ribbon.sip.signal.group.raw.data[{#SIP.SIGNAL.GROUP.ID}]'
              tags:
                - tag: component
                  value: sip-signal-group
                - tag: sip_signal_group
                  value: '{#SIP.SIGNAL.GROUP.DESCR}'
            - uuid: d4f5e6a7b8c94d3e9f0a1b2c3d4e5f60
              name: 'SIP Signal Group [{#SIP.SIGNAL.GROUP.DESCR}]: Raw data'
              type: DEPENDENT
              key: 'ribbon.sip.signal.group.raw.data[{#SIP.SIGNAL.GROUP.ID}]'
              delay: '0'
              history: '0'
              value_type: TEXT
              trends: '0'
              description: 'Raw data for this SIP signal group.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.{#SIP.SIGNAL.GROUP.ID}'
              master_item:
                key: ribbon.sip.signal.group.get
              tags:
                - tag: component
                  value: raw
                - tag: component
                  value: sip-signal-group
                - tag: sip_signal_group
                  value: '{#SIP.SIGNAL.GROUP.DESCR}'
            - uuid: 87f113bfa57641718b9d06f1713cf1db
              name: 'SIP Signal Group [{#SIP.SIGNAL.GROUP.DESCR}]: Status'
              type: DEPENDENT
              key: 'ribbon.sip.signal.group.status[{#SIP.SIGNAL.GROUP.ID}]'
              delay: '0'
              description: |
                Provides the runtime operational status of the signaling group.
                Possible values:
                - sgsUP
                - sgsDOWN
                - sgsUpDraining
                - sgsUpDrained
                - sgsUpPeersDown
                - sgsNONE_EXISTS
              valuemap:
                name: 'Ribbon: SIP Signaling status'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_Status
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ribbon.sip.signal.group.raw.data[{#SIP.SIGNAL.GROUP.ID}]'
              tags:
                - tag: component
                  value: sip-signal-group
                - tag: sip_signal_group
                  value: '{#SIP.SIGNAL.GROUP.DESCR}'
              trigger_prototypes:
                - uuid: b53a522d91eb48c386cc525f67bd3d39
                  expression: 'last(/Ribbon SBC Edge by HTTP/ribbon.sip.signal.group.status[{#SIP.SIGNAL.GROUP.ID}])=1'
                  name: 'Ribbon: SIP Signal Group [{#SIP.SIGNAL.GROUP.DESCR}]: Status is DOWN'
                  opdata: 'Current status: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'The SIP signaling group status is down.'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 0772710a64294b43b71f0d7bf6687644
              name: 'SIP Signal Group [{#SIP.SIGNAL.GROUP.DESCR}]: Type'
              type: DEPENDENT
              key: 'ribbon.sip.signal.group.type[{#SIP.SIGNAL.GROUP.ID}]'
              delay: '0'
              description: |
                Provides the signaling type of the signaling group.
                Possible values:
                - sgISDN
                - sgSIP
                - sgCAS
              valuemap:
                name: 'Ribbon: SIP Signaling Type'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.rt_Type
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ribbon.sip.signal.group.raw.data[{#SIP.SIGNAL.GROUP.ID}]'
              tags:
                - tag: component
                  value: sip-signal-group
                - tag: sip_signal_group
                  value: '{#SIP.SIGNAL.GROUP.DESCR}'
          master_item:
            key: ribbon.sip.signal.group.get
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  if (value === '' || value === '{}') {
                  	return '[]';
                  };
                  
                  const json_data = JSON.parse(value);
                  var output_data = [];
                  
                  for (var entity in json_data) {
                  	output_data.push({
                  		"{#SIP.SIGNAL.GROUP.ID}": json_data[entity]["@id"],
                  		"{#SIP.SIGNAL.GROUP.DESCR}": json_data[entity]["Description"]
                  	});
                  };
                  
                  return JSON.stringify(output_data);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
      tags:
        - tag: class
          value: software
        - tag: subclass
          value: communication
        - tag: target
          value: ribbon
        - tag: target
          value: ribbon-sbc-edge
      macros:
        - macro: '{$RIBBON.ALARM.DISCOVERY.EVENT.ID.MATCHES}'
          value: '.*'
          description: 'Sets of the alarm event ID to be allowed in discovery. See the https://publicdoc.rbbn.com/spaces/UXDOC70/pages/122292177/Alarms+and+Events+Reference for possible values.'
        - macro: '{$RIBBON.ALARM.DISCOVERY.EVENT.ID.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Sets of the alarm event ID to be ignored in discovery.'
        - macro: '{$RIBBON.ALARM.DISCOVERY.STATE.MATCHES}'
          value: '.*'
          description: 'Sets of the alarm state to be allowed in discovery.'
        - macro: '{$RIBBON.ALARM.DISCOVERY.STATE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Sets of the alarm state to be ignored in discovery.'
        - macro: '{$RIBBON.CERTIFICATE.DISCOVERY.NAME.MATCHES}'
          value: '.*'
          description: 'Sets the regex string of the certificate name to be allowed in discovery.'
        - macro: '{$RIBBON.CERTIFICATE.DISCOVERY.NAME.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Sets the regex string of the certificate name to be ignored in discovery.'
        - macro: '{$RIBBON.CPU.UTIL.CRIT}'
          value: '90'
          description: 'The threshold of CPU usage in percent.'
        - macro: '{$RIBBON.DISK.DISCOVERY.NAME.MATCHES}'
          value: '.*'
          description: 'Sets the regex string of the disk name to be allowed in discovery.'
        - macro: '{$RIBBON.DISK.DISCOVERY.NAME.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Sets the regex string of the disk name to be ignored in discovery.'
        - macro: '{$RIBBON.DISK.DISCOVERY.TYPE.MATCHES}'
          value: '.*'
          description: 'Sets the regex string of the disk type to be allowed in discovery.'
        - macro: '{$RIBBON.DISK.DISCOVERY.TYPE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Sets the regex string of the disk type to be ignored in discovery.'
        - macro: '{$RIBBON.DISK.USED.MAX}'
          value: '90'
          description: 'The threshold of the disk usage in percent.'
        - macro: '{$RIBBON.DSP.CARD.CPU.USAGE.CRIT}'
          value: '90'
          description: 'The threshold of DSP card CPU usage in percent.'
        - macro: '{$RIBBON.INTERFACE.DISCOVERY.NAME.MATCHES}'
          value: '.*'
          description: 'Sets the regex string of the interface name to be allowed in discovery.'
        - macro: '{$RIBBON.INTERFACE.DISCOVERY.NAME.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Sets the regex string of the interface name to be ignored in discovery.'
        - macro: '{$RIBBON.INTERFACE.DISCOVERY.TYPE.MATCHES}'
          value: '.*'
          description: 'Sets the regex string of the interface type to be allowed in discovery.'
        - macro: '{$RIBBON.INTERFACE.DISCOVERY.TYPE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Sets the regex string of the interface type to be ignored in discovery.'
        - macro: '{$RIBBON.INTERVAL}'
          value: 1m
          description: 'The update interval for the script items that retrieve data from the API. Can be used with context if needed (check the context values in relevant items).'
        - macro: '{$RIBBON.INTERVAL:"get_alarm"}'
          value: 5m
          description: 'The update interval for the script item that retrieve the active alarms.'
        - macro: '{$RIBBON.INTERVAL:"get_certificate"}'
          value: 5m
          description: 'The update interval for the script item that retrieve the certificate info.'
        - macro: '{$RIBBON.INTERVAL:"get_disk"}'
          value: 5m
          description: 'The update interval for the script item that retrieve the disk partition data.'
        - macro: '{$RIBBON.INTERVAL:"get_dsp_card"}'
          value: 5m
          description: 'The update interval for the script item that retrieve the DSP card data.'
        - macro: '{$RIBBON.INTERVAL:"get_fan"}'
          value: 15m
          description: 'The update interval for the script item that retrieve the fan data.'
        - macro: '{$RIBBON.INTERVAL:"get_interface"}'
          value: 1m
          description: 'The update interval for the script item that retrieve the interface data.'
        - macro: '{$RIBBON.INTERVAL:"get_psu"}'
          value: 5m
          description: 'The update interval for the script item that retrieve the power supply data.'
        - macro: '{$RIBBON.INTERVAL:"get_sip_server"}'
          value: 5m
          description: 'The update interval for the script item that retrieve the SIP server data.'
        - macro: '{$RIBBON.INTERVAL:"get_system_stats"}'
          value: 1m
          description: 'The update interval for the script item that retrieve the system stats.'
        - macro: '{$RIBBON.MEMORY.UTIL.CRIT}'
          value: '90'
          description: 'The threshold of memory usage in percent.'
        - macro: '{$RIBBON.PASSWORD}'
          type: SECRET_TEXT
          description: 'Ribbon SBC user password.'
        - macro: '{$RIBBON.PROXY}'
          description: 'Sets the HTTP proxy value. If this macro is empty, then no proxy is used.'
        - macro: '{$RIBBON.SIP.SERVER.DISCOVERY.NAME.MATCHES}'
          value: '.*'
          description: 'Sets the regex string of the SIP server name to be allowed in discovery.'
        - macro: '{$RIBBON.SIP.SERVER.DISCOVERY.NAME.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Sets the regex string of the SIP server name to be ignored in discovery.'
        - macro: '{$RIBBON.SIP.SERVER.TRANSACTIONS.FAILED.MAX}'
          value: '100'
          description: 'The threshold of the SIP server failed transactions.'
        - macro: '{$RIBBON.SIP.SIGNAL.GROUP.DISCOVERY.DESCR.MATCHES}'
          value: '.*'
          description: 'Sets the regex string of the SIP signal group description to be allowed in discovery.'
        - macro: '{$RIBBON.SIP.SIGNAL.GROUP.DISCOVERY.DESCR.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Sets the regex string of the SIP signal group description to be ignored in discovery.'
        - macro: '{$RIBBON.TEMP.BOTTOM.MAIN.BOARD.CRIT}'
          value: '80'
          description: 'The threshold of temperature on the bottom of the main board in degrees Celsius.'
        - macro: '{$RIBBON.TEMP.CORE.CRIT}'
          value: '80'
          description: 'The threshold of core switch temperature in degrees Celsius.'
        - macro: '{$RIBBON.TEMP.PSU.CRIT}'
          value: '80'
          description: 'The threshold of power supply temperature in degrees Celsius.'
        - macro: '{$RIBBON.TEMP.TOP.MAIN.BOARD.CRIT}'
          value: '80'
          description: 'The threshold of temperature on the top of the main board in degrees Celsius.'
        - macro: '{$RIBBON.TIMEOUT}'
          value: 60s
          description: 'The timeout threshold for the script items that retrieve data from the API.'
        - macro: '{$RIBBON.URL}'
          description: 'Ribbon SBC API IP.'
        - macro: '{$RIBBON.USERNAME}'
          description: 'Ribbon SBC username.'
      dashboards:
        - uuid: 2d0d73cf6b2e4779a20cbcceede080ad
          name: 'Ribbon: Overview'
          pages:
            - name: 'Ribbon: Overview'
              widgets:
                - type: gauge
                  name: 'CPU utilization'
                  width: '18'
                  height: '4'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: description
                      value: 'CPU utilization'
                    - type: INTEGER
                      name: desc_size
                      value: '10'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.cpu.usage
                    - type: INTEGER
                      name: scale_size
                      value: '10'
                    - type: STRING
                      name: thresholds.0.color
                      value: 00C48C
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: FFBF59
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '70'
                    - type: STRING
                      name: thresholds.2.color
                      value: E45959
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '90'
                    - type: INTEGER
                      name: th_show_arc
                      value: '1'
                    - type: INTEGER
                      name: th_show_labels
                      value: '1'
                    - type: STRING
                      name: units
                      value: '%'
                - type: svggraph
                  name: 'Resource usage'
                  'y': '4'
                  width: '36'
                  height: '6'
                  fields:
                    - type: STRING
                      name: ds.0.color.0
                      value: 0D47A1
                    - type: INTEGER
                      name: ds.0.dataset_type
                      value: '0'
                    - type: STRING
                      name: ds.0.data_set_label
                      value: 'CPU usage'
                    - type: INTEGER
                      name: ds.0.fill
                      value: '5'
                    - type: ITEM
                      name: ds.0.itemids.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.cpu.usage
                    - type: INTEGER
                      name: ds.1.axisy
                      value: '1'
                    - type: STRING
                      name: ds.1.color.0
                      value: FF465C
                    - type: INTEGER
                      name: ds.1.dataset_type
                      value: '0'
                    - type: INTEGER
                      name: ds.1.fill
                      value: '5'
                    - type: ITEM
                      name: ds.1.itemids.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.memory.usage
                    - type: STRING
                      name: lefty_max
                      value: '100'
                    - type: STRING
                      name: lefty_min
                      value: '0'
                    - type: INTEGER
                      name: legend_columns
                      value: '1'
                    - type: INTEGER
                      name: legend_lines
                      value: '2'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAC
                    - type: INTEGER
                      name: righty
                      value: '1'
                    - type: STRING
                      name: righty_max
                      value: '100'
                    - type: STRING
                      name: righty_min
                      value: '0'
                - type: item
                  name: 'Chassis Status'
                  'y': '10'
                  width: '18'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.chassis.status
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: value_bold
                      value: '0'
                - type: gauge
                  name: 'Memory utilization'
                  x: '18'
                  width: '18'
                  height: '4'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: description
                      value: 'Memory utilization'
                    - type: INTEGER
                      name: desc_size
                      value: '10'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.memory.usage
                    - type: INTEGER
                      name: scale_size
                      value: '10'
                    - type: STRING
                      name: thresholds.0.color
                      value: 00C48C
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: FFBF59
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '70'
                    - type: STRING
                      name: thresholds.2.color
                      value: E45959
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '90'
                    - type: INTEGER
                      name: th_show_arc
                      value: '1'
                    - type: INTEGER
                      name: th_show_labels
                      value: '1'
                    - type: STRING
                      name: units
                      value: '%'
                - type: item
                  name: 'Chassis type'
                  x: '18'
                  'y': '10'
                  width: '18'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.chassis.type
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: value_bold
                      value: '0'
                - type: item
                  name: 'Node name'
                  x: '36'
                  width: '18'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.system.node.name
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: value_bold
                      value: '0'
                - type: item
                  name: 'Software base build number'
                  x: '36'
                  'y': '2'
                  width: '18'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.system.software.base.build
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: value_bold
                      value: '0'
                - type: svggraph
                  name: Calls
                  x: '36'
                  'y': '4'
                  width: '36'
                  height: '6'
                  fields:
                    - type: STRING
                      name: ds.0.color.0
                      value: FDD835
                    - type: INTEGER
                      name: ds.0.dataset_type
                      value: '0'
                    - type: STRING
                      name: ds.0.data_set_label
                      value: 'Number of call attempts'
                    - type: INTEGER
                      name: ds.0.fill
                      value: '5'
                    - type: ITEM
                      name: ds.0.itemids.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.number.call.attempts
                    - type: STRING
                      name: ds.1.color.0
                      value: 03A9F4
                    - type: INTEGER
                      name: ds.1.dataset_type
                      value: '0'
                    - type: STRING
                      name: ds.1.data_set_label
                      value: 'Number of call currently up'
                    - type: INTEGER
                      name: ds.1.fill
                      value: '5'
                    - type: ITEM
                      name: ds.1.itemids.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.number.call.currently
                    - type: STRING
                      name: ds.2.color.0
                      value: F4511E
                    - type: INTEGER
                      name: ds.2.dataset_type
                      value: '0'
                    - type: STRING
                      name: ds.2.data_set_label
                      value: 'Number of call failed'
                    - type: INTEGER
                      name: ds.2.fill
                      value: '5'
                    - type: ITEM
                      name: ds.2.itemids.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.number.call.failed
                    - type: STRING
                      name: ds.3.color.0
                      value: 66BB6A
                    - type: INTEGER
                      name: ds.3.dataset_type
                      value: '0'
                    - type: STRING
                      name: ds.3.data_set_label
                      value: 'Number of call succeeded'
                    - type: INTEGER
                      name: ds.3.fill
                      value: '5'
                    - type: ITEM
                      name: ds.3.itemids.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.number.call.succeeded
                    - type: INTEGER
                      name: legend_columns
                      value: '1'
                    - type: INTEGER
                      name: legend_lines
                      value: '4'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAD
                - type: item
                  name: 'ASM Operating System License Type'
                  x: '36'
                  'y': '10'
                  width: '36'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.chassis.asm.license.type
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: value_bold
                      value: '0'
                - type: item
                  name: 'Serial number'
                  x: '54'
                  width: '18'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.system.serial.number
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: value_bold
                      value: '0'
                - type: item
                  name: 'Software base version'
                  x: '54'
                  'y': '2'
                  width: '18'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: desc_size
                      value: '20'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.system.software.base.version
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: value_bold
                      value: '0'
            - name: 'Ribbon: Resources'
              widgets:
                - type: svggraph
                  name: 'Chassis temperature'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color.0
                      value: 00C48C
                    - type: INTEGER
                      name: ds.0.dataset_type
                      value: '0'
                    - type: STRING
                      name: ds.0.data_set_label
                      value: 'Chassis board bottom'
                    - type: INTEGER
                      name: ds.0.fill
                      value: '5'
                    - type: ITEM
                      name: ds.0.itemids.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.chassis.board.bottom.temp
                    - type: STRING
                      name: ds.1.color.0
                      value: 1976D2
                    - type: INTEGER
                      name: ds.1.dataset_type
                      value: '0'
                    - type: STRING
                      name: ds.1.data_set_label
                      value: 'Chassis board top'
                    - type: INTEGER
                      name: ds.1.fill
                      value: '5'
                    - type: ITEM
                      name: ds.1.itemids.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.chassis.board.top.temp
                    - type: STRING
                      name: ds.2.color.0
                      value: E45959
                    - type: INTEGER
                      name: ds.2.dataset_type
                      value: '0'
                    - type: STRING
                      name: ds.2.data_set_label
                      value: 'Chassis core switch'
                    - type: INTEGER
                      name: ds.2.fill
                      value: '5'
                    - type: ITEM
                      name: ds.2.itemids.0
                      value:
                        host: 'Ribbon SBC Edge by HTTP'
                        key: ribbon.chassis.core.switch.temp
                    - type: INTEGER
                      name: legend_columns
                      value: '1'
                    - type: INTEGER
                      name: legend_lines
                      value: '3'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAE
                - type: svggraph
                  name: 'Interface bits received'
                  'y': '4'
                  width: '36'
                  height: '4'
                  fields:
                    - type: INTEGER
                      name: ds.0.fill
                      value: '5'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Interface*Bits received'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAG
                - type: svggraph
                  name: 'Interface bits sent'
                  'y': '8'
                  width: '36'
                  height: '4'
                  fields:
                    - type: INTEGER
                      name: ds.0.fill
                      value: '5'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Interface*Bits sent'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAI
                - type: honeycomb
                  name: 'Disk usage percent'
                  x: '36'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Disk*Utilization'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("Disk\s\[(.*)\]","\1")}'
                    - type: STRING
                      name: reference
                      value: AAAAF
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                    - type: INTEGER
                      name: secondary_label_units_show
                      value: '0'
                    - type: STRING
                      name: thresholds.0.color
                      value: 00C48C
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: FFBF59
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '70'
                    - type: STRING
                      name: thresholds.2.color
                      value: E45959
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '90'
                - type: honeycomb
                  name: 'Fan speed'
                  x: '36'
                  'y': '4'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Fan*Speed'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("Fan\s\[(.*)\]","Fan: \1")}'
                    - type: STRING
                      name: reference
                      value: AAAAH
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                    - type: INTEGER
                      name: secondary_label_units_show
                      value: '0'
                - type: honeycomb
                  name: 'Interface Operational status'
                  x: '36'
                  'y': '8'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Interface*Operational status'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("Interface\s\[(.*)\]","If: \1")}'
                    - type: STRING
                      name: reference
                      value: AAAAJ
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                    - type: INTEGER
                      name: secondary_label_units_show
                      value: '0'
                    - type: STRING
                      name: thresholds.0.color
                      value: E65660
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.1.color
                      value: 3BC97D
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '0'
            - name: 'Ribbon: DSP Card'
              widgets:
                - type: itemnavigator
                  width: '12'
                  height: '5'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'DSP Card [*]: CPU usage'
                    - type: STRING
                      name: reference
                      value: DAHTV
                - type: gauge
                  name: 'CPU utilization'
                  x: '12'
                  width: '16'
                  height: '5'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: description
                      value: 'CPU utilization'
                    - type: INTEGER
                      name: desc_size
                      value: '10'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: STRING
                      name: itemid._reference
                      value: DAHTV._itemid
                    - type: INTEGER
                      name: scale_size
                      value: '10'
                    - type: STRING
                      name: thresholds.0.color
                      value: 00C48C
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: FFBF59
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '70'
                    - type: STRING
                      name: thresholds.2.color
                      value: E45959
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '90'
                    - type: INTEGER
                      name: th_show_arc
                      value: '1'
                    - type: INTEGER
                      name: th_show_labels
                      value: '1'
                    - type: STRING
                      name: units
                      value: '%'
                - type: honeycomb
                  name: 'Service status'
                  x: '28'
                  width: '22'
                  height: '5'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'DSP Card [*]: Service status'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("DSP Card\s\[(.*)\]","Card: \1")}'
                    - type: STRING
                      name: reference
                      value: HPEXB
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                    - type: INTEGER
                      name: secondary_label_units_show
                      value: '0'
                    - type: STRING
                      name: thresholds.0.color
                      value: E45959
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: 00C48C
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                - type: honeycomb
                  name: Available
                  x: '50'
                  width: '22'
                  height: '5'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'DSP Card [*]: Available'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("DSP Card\s\[(.*)\]","Card: \1")}'
                    - type: STRING
                      name: reference
                      value: DVNSR
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                    - type: INTEGER
                      name: secondary_label_units_show
                      value: '0'
                    - type: STRING
                      name: thresholds.0.color
                      value: E45959
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: 00C48C
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
            - name: 'Ribbon: PSU'
              widgets:
                - type: svggraph
                  name: 'PSU power in'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: E45959
                    - type: INTEGER
                      name: ds.0.fill
                      value: '5'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'PSU*Power in'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAK
                - type: svggraph
                  name: 'PSU Voltage in'
                  'y': '4'
                  width: '24'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: E45959
                    - type: INTEGER
                      name: ds.0.fill
                      value: '5'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'PSU*Voltage in'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAM
                - type: svggraph
                  name: 'PSU Current in'
                  'y': '8'
                  width: '24'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: E45959
                    - type: INTEGER
                      name: ds.0.fill
                      value: '5'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'PSU*Current in'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAP
                - type: svggraph
                  name: 'PSU Voltage out'
                  x: '24'
                  'y': '4'
                  width: '24'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 00C48C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '5'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'PSU*Voltage out'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAN
                - type: svggraph
                  name: 'PSU Current out'
                  x: '24'
                  'y': '8'
                  width: '24'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 00C48C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '5'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'PSU*Current out'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAQ
                - type: svggraph
                  name: 'PSU power out'
                  x: '36'
                  width: '36'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 00C48C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '5'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'PSU*Power out'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAL
                - type: honeycomb
                  name: 'PSU Fan speed'
                  x: '48'
                  'y': '4'
                  width: '24'
                  height: '4'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'PSU*Fan*speed'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("PSU\s\[(.*)\].*Fan(\d)","PSU: \1 Fan: \2")}'
                    - type: STRING
                      name: reference
                      value: AAAAO
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                    - type: INTEGER
                      name: secondary_label_units_show
                      value: '0'
                - type: svggraph
                  name: 'PSU Temperature'
                  x: '48'
                  'y': '8'
                  width: '24'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 3d6edf
                    - type: INTEGER
                      name: ds.0.fill
                      value: '5'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'PSU*Temperature'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: AAAAR
            - name: Alarms
              widgets:
                - type: honeycomb
                  width: '72'
                  height: '8'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Alarm [*]: Source: [*]: Severity'
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: STRING
                      name: reference
                      value: PLLDM
                    - type: STRING
                      name: thresholds.0.color
                      value: 29B6F6
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.1.color
                      value: FFEE58
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '2'
                    - type: STRING
                      name: thresholds.2.color
                      value: FF8000
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '3'
                    - type: STRING
                      name: thresholds.3.color
                      value: FF0000
                    - type: STRING
                      name: thresholds.3.threshold
                      value: '4'
      valuemaps:
        - uuid: 9cd4e329a1154ebe8ca53cee6dc6c94f
          name: 'Ribbon: Alarm Severity'
          mappings:
            - value: '0'
              newvalue: INDETERMINATE
            - value: '1'
              newvalue: WARNING
            - value: '2'
              newvalue: MINOR
            - value: '3'
              newvalue: MAJOR
            - value: '4'
              newvalue: CRITICAL
        - uuid: 3d340848400b4dc59da9d48bd3609bae
          name: 'Ribbon: ASM Operating System License Type'
          mappings:
            - value: '0'
              newvalue: Unknown
            - value: '1'
              newvalue: Win2008R2
            - value: '2'
              newvalue: Win2012R2
            - value: '3'
              newvalue: Win2019
        - uuid: b8451f08019b4b04b176acfb836de8ce
          name: 'Ribbon: Bool'
          mappings:
            - value: '0'
              newvalue: 'False'
            - value: '1'
              newvalue: 'True'
        - uuid: 0d4b6e2459f446f7bc51a43d484c0a88
          name: 'Ribbon: Card Location'
          mappings:
            - value: '0'
              newvalue: Unknown
            - value: '1'
              newvalue: LineCard1
            - value: '2'
              newvalue: LineCard2
            - value: '3'
              newvalue: DSPCard1
            - value: '4'
              newvalue: DSPCard2
            - value: '5'
              newvalue: DSPCard3
            - value: '6'
              newvalue: DSPCard4
            - value: '7'
              newvalue: DSPCard5
            - value: '8'
              newvalue: DSPCard6
            - value: '9'
              newvalue: BITS_WAN
            - value: '10'
              newvalue: SFP
            - value: '11'
              newvalue: COMExpress
            - value: '12'
              newvalue: Mainboard
            - value: '13'
              newvalue: PSU1
            - value: '14'
              newvalue: PSU2
            - value: '15'
              newvalue: UX1000_Telco_1
            - value: '16'
              newvalue: UX1000_Telco_2
            - value: '17'
              newvalue: UX1000_Telco_3
            - value: '18'
              newvalue: UX1000_Telco_4
            - value: '19'
              newvalue: UX1000_Telco_5
            - value: '20'
              newvalue: UX1000_Telco_6
            - value: '21'
              newvalue: UX1000_DS1_Telco
            - value: '22'
              newvalue: UX1000_DS1_WAN
            - value: '23'
              newvalue: MAX
        - uuid: 38b59bdd6f4b4390ae853247ed21897d
          name: 'Ribbon: Config interface state'
          mappings:
            - value: '0'
              newvalue: Disabled
            - value: '1'
              newvalue: Enabled
        - uuid: 1030653f7dad40efb62e6af9d8c75b41
          name: 'Ribbon: Disk type'
          mappings:
            - value: '0'
              newvalue: Configuration
            - value: '1'
              newvalue: Logs
            - value: '2'
              newvalue: Temp
            - value: '3'
              newvalue: 'Core File'
            - value: '4'
              newvalue: 'ASM Module'
            - value: '5'
              newvalue: 'Software Update'
            - value: '6'
              newvalue: 'Internal Logs'
            - value: '7'
              newvalue: System
            - value: '8'
              newvalue: Others
            - value: '9'
              newvalue: 'Packet Capture Logs'
        - uuid: f783799e74a9482db3868b8e4713101a
          name: 'Ribbon: Interface speed'
          mappings:
            - value: '0'
              newvalue: '10 Mbps'
            - value: '1'
              newvalue: '100 Mbps'
            - value: '2'
              newvalue: '1000 Mbps'
            - value: '3'
              newvalue: Auto
        - uuid: c713bf35021b4acc87c18bf7555d4016
          name: 'Ribbon: Interface Type'
          mappings:
            - value: '0'
              newvalue: Ethernet
            - value: '1'
              newvalue: VLAN
            - value: '2'
              newvalue: QINQ
            - value: '3'
              newvalue: BONDED
            - value: '4'
              newvalue: BRIDGE
        - uuid: 23e45cd16d4c43eea1c3a085904d6d1d
          name: 'Ribbon: License class'
          mappings:
            - value: '0'
              newvalue: lt1k2kLegacy
            - value: '1'
              newvalue: ltLegacy
            - value: '2'
              newvalue: ltRibbon
        - uuid: 5f1e2b3e1c5e4b2fa6f3e8b1c4d5e6f9
          name: 'Ribbon: License type'
          mappings:
            - value: '0'
              newvalue: ltNone
            - value: '1'
              newvalue: ltLicense
            - value: '2'
              newvalue: ltBaseLiecnse
        - uuid: 2e08efb9e354424499526bbff51a61e3
          name: 'Ribbon: Networking mode'
          mappings:
            - value: '0'
              newvalue: Switch
            - value: '1'
              newvalue: Route
        - uuid: f16e30cc4010463ebd7daeadca0962ce
          name: 'Ribbon: Operational status'
          mappings:
            - value: '0'
              newvalue: Up
            - value: '1'
              newvalue: Down
        - uuid: d11c36edb8984267b85dd1d44e338790
          name: 'Ribbon: Service status'
          mappings:
            - value: '0'
              newvalue: Detected
            - value: '1'
              newvalue: Available
        - uuid: 4f3e2b3e1c5e4b2fa6f3e8b1c4d5e6f8
          name: 'Ribbon: SIP Server Type'
          mappings:
            - value: '0'
              newvalue: eConventionalSrvr
            - value: '1'
              newvalue: eSrvRecordTemplateSrvr
            - value: '2'
              newvalue: eSrvRecordSrvr
        - uuid: 27fe7c8b631943bc940d51bdd2ae3d85
          name: 'Ribbon: SIP Signaling status'
          mappings:
            - value: '0'
              newvalue: sgsUP
            - value: '1'
              newvalue: sgsDOWN
            - value: '2'
              newvalue: sgsUpDraining
            - value: '3'
              newvalue: sgsUpDrained
            - value: '4'
              newvalue: sgsUpPeersDown
            - value: '5'
              newvalue: sgsNONE_EXISTS
        - uuid: 83e2c8a2821a4c5da37d2675c64d1596
          name: 'Ribbon: SIP Signaling Type'
          mappings:
            - value: '0'
              newvalue: sgISDN
            - value: '1'
              newvalue: sgSIP
            - value: '2'
              newvalue: sgCAS
        - uuid: bd7bb2d61072409ca8fa5273dc7caa7f
          name: 'Ribbon: System status'
          mappings:
            - value: '0'
              newvalue: None
            - value: '1'
              newvalue: 'Card Idle'
            - value: '2'
              newvalue: 'Card Detected'
            - value: '3'
              newvalue: 'Card Activating'
            - value: '4'
              newvalue: 'Card Activated'
            - value: '5'
              newvalue: 'Card Remove Requested'
            - value: '6'
              newvalue: 'Card Removing'
            - value: '7'
              newvalue: 'Card Removed'
            - value: '8'
              newvalue: 'Card Downloading'
            - value: '9'
              newvalue: 'Card Failed'
            - value: '10'
              newvalue: 'Card Disabled Long Loop'
            - value: '11'
              newvalue: MAX
