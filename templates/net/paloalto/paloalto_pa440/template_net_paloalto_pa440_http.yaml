zabbix_export:
  version: '7.4'
  template_groups:
    - uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    - uuid: edc752f178f94b9dbaee459ec7bacc66
      template: 'Palo Alto PA-440 by HTTP'
      name: 'Palo Alto PA-440 by HTTP'
      description: |
        This template is designed for the effortless deployment of Palo Alto PA-440 monitoring by Zabbix via XML API and doesn't require any external scripts.
        
        Setup:
        
        Configure a user for monitoring. Note that in order to retrieve the device certificate information, superuser privileges are required. If you opt for a user with limited access (for security reasons), the device certificate expiration metrics will not be discovered.
        
        Superuser privileges user (full access to all data):
        1. Add a new administrator user. Go to "Device" > "Administrators" and click "Add".
        2. Enter the necessary details. Set the "Administrator Type" to "Dynamic" and select the built-in "Superuser" role. Commit the changes.
        
        Limited privileges user (no access to device certificate data):
        1. Create a new Admin Role. Go to "Device" > "Admin Role" and click "Add".
        2. Enter the necessary details. Adjust the list of permissions:
        - Restrict access to all sections in the "Web UI" tab
        - Allow access to the "Configuration" and "Operational Requests" sections in the "XML API" tab
        - Check that the access to CLI is set to "None" in the "Command Line" tab
        - Restrict access to all sections in the "REST API" tab
        3. Add a new administrator user. Go to "Device" > "Administrators" and click "Add".
        4. Enter the necessary details. Set the "Administrator Type" to "Role Based" and select the profile that was created in the previous steps. Commit the changes.
        
        Set the host macros:
        1. Set the firewall XML API endpoint URL in the "{$PAN.PA440.API.URL}" macro in the format "<scheme>://<host>[:port]/api" (port is optional).
        2. Set the name of the user that you created in the "{$PAN.PA440.USER}" macro.
        3. Set the password of the user that you created in the "{$PAN.PA440.PASSWORD}" macro.
        
        For more details about PAN-OS API, refer to the official documentation:
        https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-panorama-api
        
        Generated by official Zabbix template tool "Templator"
      vendor:
        name: Zabbix
        version: 7.4-0
      groups:
        - name: 'Templates/Network devices'
      items:
        - uuid: de2197db515d46cab5349720285ed40e
          name: 'App-ID release date'
          type: DEPENDENT
          key: pan.pa440.app_id.release_date
          value_type: CHAR
          description: 'Currently installed application definition release date. If no release date is found, the value is discarded.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.response.result.system[''app-release-date'']'
              error_handler: DISCARD_VALUE
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: pan.pa440.system_info.get
          tags:
            - tag: component
              value: app-id
            - tag: component
              value: system
        - uuid: 03a2a4e32463409f94e08b72c5c1ac78
          name: 'App-ID version'
          type: DEPENDENT
          key: pan.pa440.app_id.version
          value_type: CHAR
          description: 'Currently installed application definition version. If no application definition is found, 0 is returned.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.response.result.system[''app-version'']'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: pan.pa440.system_info.get
          tags:
            - tag: component
              value: app-id
            - tag: component
              value: system
        - uuid: 4bdcedebb6dd4fd4951a13c52749b89d
          name: 'Get device certificate'
          type: HTTP_AGENT
          key: pan.pa440.certificate.device.get
          delay: 1h
          history: '0'
          value_type: TEXT
          authtype: BASIC
          username: '{$PAN.PA440.USER}'
          password: '{$PAN.PA440.PASSWORD}'
          description: 'Get the information about the device certificate. Note that superuser privileges are required to obtain the device certificate data.'
          preprocessing:
            - type: XML_TO_JSON
          timeout: '{$PAN.PA440.TIMEOUT}'
          url: '{$PAN.PA440.API.URL}'
          query_fields:
            - name: type
              value: op
            - name: cmd
              value: '<show><device-certificate><status></status></device-certificate></show>'
          status_codes: ''
          http_proxy: '{$PAN.PA440.HTTP_PROXY}'
          tags:
            - tag: component
              value: raw
        - uuid: 278c6f5c85bf4c659afa0b08f4c56c23
          name: 'Get device certificate check'
          type: DEPENDENT
          key: pan.pa440.certificate.device.get.check
          value_type: TEXT
          description: 'Data collection check. Check the latest values for details.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  const item_data = JSON.parse(value);
                  
                  var zbx_error_msg = '';
                  
                  if (item_data.response['@status'] !== 'success') {
                  	zbx_error_msg = 'Unknown error. Test the item manually and check the retrieved value.';
                  
                  	if (item_data.response.msg && item_data.response.msg.line) {
                  		zbx_error_msg = item_data.response.msg.line;
                  	}
                  
                  	if (item_data.response.result && item_data.response.result.msg) {
                  		zbx_error_msg = item_data.response.result.msg;
                  	}
                  }
                  
                  return zbx_error_msg;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          master_item:
            key: pan.pa440.certificate.device.get
          tags:
            - tag: component
              value: status
          triggers:
            - uuid: 44ab6b7c72bd4ccbbab3daed1f229417
              expression: 'length(last(/Palo Alto PA-440 by HTTP/pan.pa440.certificate.device.get.check))>0'
              name: 'PA-440: Failed to get device certificate data from the API'
              priority: HIGH
              description: 'Failed to get data from the API. Check the latest values for details.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 0d8d933aff9a4523aa784722616aa40f
          name: 'Get certificates'
          type: HTTP_AGENT
          key: pan.pa440.certificate.get
          delay: 1h
          history: '0'
          value_type: TEXT
          authtype: BASIC
          username: '{$PAN.PA440.USER}'
          password: '{$PAN.PA440.PASSWORD}'
          description: 'Get the information about the certificates on the device.'
          preprocessing:
            - type: XML_TO_JSON
            - type: JAVASCRIPT
              parameters:
                - |
                  var certificates = JSON.parse(value),
                  	result = {
                  		response: {
                  			'@status': 'success',
                  			data: []
                  		}
                  	};
                  
                  if (certificates.response['@status'] !== 'success') {
                  	certificates.response.data = [];
                  	return JSON.stringify(certificates);
                  }
                  
                  if (certificates.response.result && certificates.response.result.certificate && certificates.response.result.certificate.entry) {
                  	result.response.data = Array.isArray(certificates.response.result.certificate.entry) ? certificates.response.result.certificate.entry : [certificates.response.result.certificate.entry];
                  
                  	return JSON.stringify(result);
                  }
                  
                  return JSON.stringify(result);
          timeout: '{$PAN.PA440.TIMEOUT}'
          url: '{$PAN.PA440.API.URL}'
          query_fields:
            - name: type
              value: config
            - name: action
              value: get
            - name: xpath
              value: /config/shared/certificate
          status_codes: ''
          http_proxy: '{$PAN.PA440.HTTP_PROXY}'
          tags:
            - tag: component
              value: raw
        - uuid: e0e93584fbfb46578bb8272aa6326f1c
          name: 'Get certificate check'
          type: DEPENDENT
          key: pan.pa440.certificate.get.check
          value_type: TEXT
          description: 'Data collection check. Check the latest values for details.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  const item_data = JSON.parse(value);
                  
                  var zbx_error_msg = '';
                  
                  if (item_data.response['@status'] !== 'success') {
                  	zbx_error_msg = 'Unknown error. Test the item manually and check the retrieved value.';
                  
                  	if (item_data.response.msg && item_data.response.msg.line) {
                  		zbx_error_msg = item_data.response.msg.line;
                  	}
                  
                  	if (item_data.response.result && item_data.response.result.msg) {
                  		zbx_error_msg = item_data.response.result.msg;
                  	}
                  }
                  
                  return zbx_error_msg;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          master_item:
            key: pan.pa440.certificate.get
          tags:
            - tag: component
              value: status
          triggers:
            - uuid: a323a25e3808440ab38b412b62e14300
              expression: 'length(last(/Palo Alto PA-440 by HTTP/pan.pa440.certificate.get.check))>0'
              name: 'PA-440: Failed to get certificate data from the API'
              priority: HIGH
              description: 'Failed to get data from the API. Check the latest values for details.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 4e4ddb2794524f2a889328609dd8ea8f
          name: 'CPU temperature'
          type: DEPENDENT
          key: pan.pa440.cpu.temp
          units: ℃
          description: 'The CPU temperature in degrees Celsius.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.response.result.thermal.Slot1.entry.DegreesC
          master_item:
            key: pan.pa440.environmentals.get
          tags:
            - tag: component
              value: cpu
            - tag: component
              value: environment
        - uuid: fb94a1c35199494b8750bdc7f3d87e06
          name: 'Data Plane: CPU utilization, in %'
          type: DEPENDENT
          key: pan.pa440.data_plane.cpu.util
          value_type: FLOAT
          units: '%'
          description: 'The average percentage of time over the last minute that this processor was not idle. Implementations may approximate this one-minute smoothing period if necessary.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.response.result
            - type: REGEX
              parameters:
                - '(?m)^sys\.monitor\.s1\.dp0\.exports:.*1minavg''?:\s*(\d+)'
                - \1
          master_item:
            key: pan.pa440.system_state.get
          tags:
            - tag: component
              value: cpu
        - uuid: d971daee3e2340a981b0c079adf3abdc
          name: 'Get system environmentals'
          type: HTTP_AGENT
          key: pan.pa440.environmentals.get
          history: '0'
          value_type: TEXT
          authtype: BASIC
          username: '{$PAN.PA440.USER}'
          password: '{$PAN.PA440.PASSWORD}'
          description: 'Get the system environment state information.'
          preprocessing:
            - type: XML_TO_JSON
          timeout: '{$PAN.PA440.TIMEOUT}'
          url: '{$PAN.PA440.API.URL}'
          query_fields:
            - name: type
              value: op
            - name: cmd
              value: '<show><system><environmentals></environmentals></system></show>'
          status_codes: ''
          http_proxy: '{$PAN.PA440.HTTP_PROXY}'
          tags:
            - tag: component
              value: raw
        - uuid: 16477bcf87d94ec89e7f6e8cb6f76612
          name: 'Get system environmental check'
          type: DEPENDENT
          key: pan.pa440.environmentals.get.check
          value_type: TEXT
          description: 'Data collection check. Check the latest values for details.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  const item_data = JSON.parse(value);
                  
                  var zbx_error_msg = '';
                  
                  if (item_data.response['@status'] !== 'success') {
                  	zbx_error_msg = 'Unknown error. Test the item manually and check the retrieved value.';
                  
                  	if (item_data.response.msg && item_data.response.msg.line) {
                  		zbx_error_msg = item_data.response.msg.line;
                  	}
                  
                  	if (item_data.response.result && item_data.response.result.msg) {
                  		zbx_error_msg = item_data.response.result.msg;
                  	}
                  }
                  
                  return zbx_error_msg;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          master_item:
            key: pan.pa440.environmentals.get
          tags:
            - tag: component
              value: status
          triggers:
            - uuid: c9ba92783cb74e64817790ff25e710d4
              expression: 'length(last(/Palo Alto PA-440 by HTTP/pan.pa440.environmentals.get.check))>0'
              name: 'PA-440: Failed to get environmental data from the API'
              priority: HIGH
              description: 'Failed to get data from the API. Check the latest values for details.'
              tags:
                - tag: scope
                  value: availability
        - uuid: f33d2dec35174826b41865bac4921704
          name: 'GlobalProtect client package version'
          type: DEPENDENT
          key: pan.pa440.gp.client.version
          value_type: CHAR
          description: 'Currently installed GlobalProtect client package version. If package is not installed, "0.0.0" is returned.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.response.result.system[''global-protect-client-package-version'']'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: pan.pa440.system_info.get
          tags:
            - tag: component
              value: global-protect
            - tag: component
              value: system
        - uuid: 81e26d3d45fb4cf9a085ecaf980dfc76
          name: 'Get HA info'
          type: HTTP_AGENT
          key: pan.pa440.ha.get
          history: '0'
          value_type: TEXT
          authtype: BASIC
          username: '{$PAN.PA440.USER}'
          password: '{$PAN.PA440.PASSWORD}'
          description: 'Get the high availability information.'
          preprocessing:
            - type: XML_TO_JSON
          timeout: '{$PAN.PA440.TIMEOUT}'
          url: '{$PAN.PA440.API.URL}'
          query_fields:
            - name: type
              value: op
            - name: cmd
              value: '<show><high-availability><all></all></high-availability></show>'
          status_codes: ''
          http_proxy: '{$PAN.PA440.HTTP_PROXY}'
          tags:
            - tag: component
              value: raw
        - uuid: dc15e5dad66c4e0eafb9426a9fe8f573
          name: 'Get HA info check'
          type: DEPENDENT
          key: pan.pa440.ha.get.check
          value_type: TEXT
          description: 'Data collection check. Check the latest values for details.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  const item_data = JSON.parse(value);
                  
                  var zbx_error_msg = '';
                  
                  if (item_data.response['@status'] !== 'success') {
                  	zbx_error_msg = 'Unknown error. Test the item manually and check the retrieved value.';
                  
                  	if (item_data.response.msg && item_data.response.msg.line) {
                  		zbx_error_msg = item_data.response.msg.line;
                  	}
                  
                  	if (item_data.response.result && item_data.response.result.msg) {
                  		zbx_error_msg = item_data.response.result.msg;
                  	}
                  }
                  
                  return zbx_error_msg;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          master_item:
            key: pan.pa440.ha.get
          tags:
            - tag: component
              value: status
          triggers:
            - uuid: ed84f048159a47dc8b839d00c339cfc3
              expression: 'length(last(/Palo Alto PA-440 by HTTP/pan.pa440.ha.get.check))>0'
              name: 'PA-440: Failed to get HA data from the API'
              priority: HIGH
              description: 'Failed to get data from the API. Check the latest values for details.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 105dc2a9c708468eaec05721bbf69a05
          name: 'Host name'
          type: DEPENDENT
          key: pan.pa440.hostname
          value_type: CHAR
          description: 'The host name of the system.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.response.result.system.hostname
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: pan.pa440.system_info.get
          tags:
            - tag: component
              value: system
        - uuid: 296fb66ceb8d45e0aa923bf7227711b5
          name: 'Get licenses'
          type: HTTP_AGENT
          key: pan.pa440.licenses.get
          delay: 1h
          history: '0'
          value_type: TEXT
          authtype: BASIC
          username: '{$PAN.PA440.USER}'
          password: '{$PAN.PA440.PASSWORD}'
          description: 'Get the information about installed licenses.'
          preprocessing:
            - type: XML_TO_JSON
            - type: JAVASCRIPT
              parameters:
                - |
                  function parseDate(date_string) {
                  	var parts = date_string.split(' '),
                  		months = {
                  			'January': 0, 'February': 1, 'March': 2, 'April': 3,
                  			'May': 4, 'June': 5, 'July': 6, 'August': 7,
                  			'September': 8, 'October': 9, 'November': 10, 'December': 11
                  		};
                  
                  	var month = months[parts[0]],
                  		day = parseInt(parts[1].replace(',', ''), 10),
                  		year = parseInt(parts[2], 10);
                  
                  	var date = new Date(year, month, day);
                  
                  	return Math.floor(date.getTime() / 1000);
                  }
                  
                  var licenses = JSON.parse(value),
                  	result = {
                  		response: {
                  			'@status': 'success',
                  			data: []
                  		}
                  	};
                  
                  if (licenses.response['@status'] !== 'success') {
                  	licenses.response.data = [];
                  	return JSON.stringify(licenses);
                  }
                  
                  if (licenses.response.result && licenses.response.result.licenses && licenses.response.result.licenses.entry) {
                  	result.response.data = Array.isArray(licenses.response.result.licenses.entry) ? licenses.response.result.licenses.entry : [licenses.response.result.licenses.entry];
                  
                  	for (var i in result.response.data) {
                  		if (result.response.data[i].expires !== 'Never') {
                  			result.response.data[i].expires = parseDate(result.response.data[i].expires);
                  		}
                  	}
                  
                  	return JSON.stringify(result);
                  }
                  
                  return JSON.stringify(result);
          timeout: '{$PAN.PA440.TIMEOUT}'
          url: '{$PAN.PA440.API.URL}'
          query_fields:
            - name: type
              value: op
            - name: cmd
              value: '<request><license><info></info></license></request>'
          status_codes: ''
          http_proxy: '{$PAN.PA440.HTTP_PROXY}'
          tags:
            - tag: component
              value: raw
        - uuid: 5d12d627046c48f3958ad75f7f1b544a
          name: 'Get license check'
          type: DEPENDENT
          key: pan.pa440.licenses.get.check
          value_type: TEXT
          description: 'Data collection check. Check the latest values for details.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  const item_data = JSON.parse(value);
                  
                  var zbx_error_msg = '';
                  
                  if (item_data.response['@status'] !== 'success') {
                  	zbx_error_msg = 'Unknown error. Test the item manually and check the retrieved value.';
                  
                  	if (item_data.response.msg && item_data.response.msg.line) {
                  		zbx_error_msg = item_data.response.msg.line;
                  	}
                  
                  	if (item_data.response.result && item_data.response.result.msg) {
                  		zbx_error_msg = item_data.response.result.msg;
                  	}
                  }
                  
                  return zbx_error_msg;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          master_item:
            key: pan.pa440.licenses.get
          tags:
            - tag: component
              value: status
          triggers:
            - uuid: 475e2a36b81840cd9f4c4eb1f9d12109
              expression: 'length(last(/Palo Alto PA-440 by HTTP/pan.pa440.licenses.get.check))>0'
              name: 'PA-440: Failed to get license data from the API'
              priority: HIGH
              description: 'Failed to get data from the API. Check the latest values for details.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 63f1642de18b48a889c6bd9110a53c9b
          name: 'Management Plane: CPU utilization, in %'
          type: DEPENDENT
          key: pan.pa440.management_plane.cpu.util
          value_type: FLOAT
          units: '%'
          description: 'The average percentage of time over the last minute that this processor was not idle. Implementations may approximate this one-minute smoothing period if necessary.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.response.result
            - type: REGEX
              parameters:
                - '(?m)^sys\.monitor\.s1\.mp\.exports:.*1minavg''?:\s*(\d+)'
                - \1
          master_item:
            key: pan.pa440.system_state.get
          tags:
            - tag: component
              value: cpu
        - uuid: eadbb5eb7839483fafa8ba2297787ae0
          name: 'PAN-OS version'
          type: DEPENDENT
          key: pan.pa440.os.version
          value_type: CHAR
          description: 'Full software version. The first two components of the full version are the major and minor versions. The third component indicates the maintenance release number.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.response.result.system[''sw-version'']'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: pan.pa440.system_info.get
          tags:
            - tag: component
              value: system
        - uuid: 2c88e39db8634c5baa03e9e6bd974e52
          name: 'Get OSPF neighbors'
          type: HTTP_AGENT
          key: pan.pa440.ospf.neighbors.get
          history: '0'
          value_type: TEXT
          authtype: BASIC
          username: '{$PAN.PA440.USER}'
          password: '{$PAN.PA440.PASSWORD}'
          description: 'Get the OSPF neighbor information.'
          preprocessing:
            - type: XML_TO_JSON
            - type: JAVASCRIPT
              parameters:
                - |
                  var ospf_neighbors = JSON.parse(value),
                  	result = {
                  		response: {
                  			'@status': 'success',
                  			data: []
                  		}
                  	};
                  
                  if (ospf_neighbors.response['@status'] !== 'success') {
                  	ospf_neighbors.response.data = [];
                  	return JSON.stringify(ospf_neighbors);
                  }
                  
                  if (ospf_neighbors.response.result.entry) {
                  	result.response.data = Array.isArray(ospf_neighbors.response.result.entry) ? ospf_neighbors.response.result.entry : [ospf_neighbors.response.result.entry];
                  
                  	return JSON.stringify(result);
                  }
                  
                  return JSON.stringify(result);
          timeout: '{$PAN.PA440.TIMEOUT}'
          url: '{$PAN.PA440.API.URL}'
          query_fields:
            - name: type
              value: op
            - name: cmd
              value: '<show><routing><protocol><ospf><neighbor></neighbor></ospf></protocol></routing></show>'
          status_codes: ''
          http_proxy: '{$PAN.PA440.HTTP_PROXY}'
          tags:
            - tag: component
              value: raw
        - uuid: 7810a8b930cd463080d020f41ef0db63
          name: 'Get OSPF neighbor check'
          type: DEPENDENT
          key: pan.pa440.ospf.neighbors.get.check
          value_type: TEXT
          description: 'Data collection check. Check the latest values for details.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  const item_data = JSON.parse(value);
                  
                  var zbx_error_msg = '';
                  
                  if (item_data.response['@status'] !== 'success') {
                  	zbx_error_msg = 'Unknown error. Test the item manually and check the retrieved value.';
                  
                  	if (item_data.response.msg && item_data.response.msg.line) {
                  		zbx_error_msg = item_data.response.msg.line;
                  	}
                  
                  	if (item_data.response.result && item_data.response.result.msg) {
                  		zbx_error_msg = item_data.response.result.msg;
                  	}
                  }
                  
                  return zbx_error_msg;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          master_item:
            key: pan.pa440.ospf.neighbors.get
          tags:
            - tag: component
              value: status
          triggers:
            - uuid: b828df38af09484c8ed6c9fd726f8757
              expression: 'length(last(/Palo Alto PA-440 by HTTP/pan.pa440.ospf.neighbors.get.check))>0'
              name: 'PA-440: Failed to get OSPF neighbor data from the API'
              priority: HIGH
              description: 'Failed to get data from the API. Check the latest values for details.'
              tags:
                - tag: scope
                  value: availability
        - uuid: b4dda8f48f734b9bae0a1c55bd2faf45
          name: 'Get OSPFv3 neighbors'
          type: HTTP_AGENT
          key: pan.pa440.ospfv3.neighbors.get
          history: '0'
          value_type: TEXT
          authtype: BASIC
          username: '{$PAN.PA440.USER}'
          password: '{$PAN.PA440.PASSWORD}'
          description: 'Get the OSPFv3 neighbor information.'
          preprocessing:
            - type: XML_TO_JSON
            - type: JAVASCRIPT
              parameters:
                - |
                  var ospfv3_neighbors = JSON.parse(value),
                  	result = {
                  		response: {
                  			'@status': 'success',
                  			data: []
                  		}
                  	};
                  
                  if (ospfv3_neighbors.response['@status'] !== 'success') {
                  	ospfv3_neighbors.response.data = [];
                  	return JSON.stringify(ospfv3_neighbors);
                  }
                  
                  if (ospfv3_neighbors.response.result.entry) {
                  	result.response.data = Array.isArray(ospfv3_neighbors.response.result.entry) ? ospfv3_neighbors.response.result.entry : [ospfv3_neighbors.response.result.entry];
                  
                  	return JSON.stringify(result);
                  }
                  
                  return JSON.stringify(result);
          timeout: '{$PAN.PA440.TIMEOUT}'
          url: '{$PAN.PA440.API.URL}'
          query_fields:
            - name: type
              value: op
            - name: cmd
              value: '<show><routing><protocol><ospfv3><neighbor></neighbor></ospfv3></protocol></routing></show>'
          status_codes: ''
          http_proxy: '{$PAN.PA440.HTTP_PROXY}'
          tags:
            - tag: component
              value: raw
        - uuid: b7fd9012cfb54266b7b89e7ff96f45a8
          name: 'Get OSPFv3 neighbor check'
          type: DEPENDENT
          key: pan.pa440.ospfv3.neighbors.get.check
          value_type: TEXT
          description: 'Data collection check. Check the latest values for details.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  const item_data = JSON.parse(value);
                  
                  var zbx_error_msg = '';
                  
                  if (item_data.response['@status'] !== 'success') {
                  	zbx_error_msg = 'Unknown error. Test the item manually and check the retrieved value.';
                  
                  	if (item_data.response.msg && item_data.response.msg.line) {
                  		zbx_error_msg = item_data.response.msg.line;
                  	}
                  
                  	if (item_data.response.result && item_data.response.result.msg) {
                  		zbx_error_msg = item_data.response.result.msg;
                  	}
                  }
                  
                  return zbx_error_msg;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          master_item:
            key: pan.pa440.ospfv3.neighbors.get
          tags:
            - tag: component
              value: status
          triggers:
            - uuid: c879700d2fc84426907962068eae225f
              expression: 'length(last(/Palo Alto PA-440 by HTTP/pan.pa440.ospfv3.neighbors.get.check))>0'
              name: 'PA-440: Failed to get OSPFv3 neighbor data from the API'
              priority: HIGH
              description: 'Failed to get data from the API. Check the latest values for details.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 9b651e03cb2648bbbcca396ad0d403b2
          name: 'Serial number'
          type: DEPENDENT
          key: pan.pa440.serial_number
          value_type: CHAR
          description: 'The serial number of the unit. If not available, an empty string is returned.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.response.result.system.serial
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: pan.pa440.system_info.get
          tags:
            - tag: component
              value: inventory
            - tag: component
              value: system
        - uuid: 62f42a97bd8249ef9a74a23198286816
          name: 'Sessions: Active, total'
          type: DEPENDENT
          key: pan.pa440.sessions.active.total
          description: 'Total number of active sessions.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.response.result[''num-active'']'
          master_item:
            key: pan.pa440.session_info.get
          tags:
            - tag: component
              value: session
        - uuid: cdb99f2e3ca84cada0273ad2649080c4
          name: 'Sessions: ICMP, active'
          type: DEPENDENT
          key: pan.pa440.sessions.icmp.active
          description: 'Total number of active ICMP sessions.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.response.result[''num-icmp'']'
          master_item:
            key: pan.pa440.session_info.get
          tags:
            - tag: component
              value: session
        - uuid: 28358716ad684d4588451bcf74ce8c1f
          name: 'Sessions: Supported, total'
          type: DEPENDENT
          key: pan.pa440.sessions.supported.total
          description: 'Total number of supported sessions.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.response.result[''num-max'']'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: pan.pa440.session_info.get
          tags:
            - tag: component
              value: session
        - uuid: 8af55240d4e34bfab3b04c128bb4f54a
          name: 'Sessions: Session table utilization, in %'
          type: DEPENDENT
          key: pan.pa440.sessions.table_util
          value_type: FLOAT
          units: '%'
          description: 'Session table utilization in percent.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  const session_data = JSON.parse(value);
                  
                  return session_data.response.result['num-active'] / session_data.response.result['num-max'] * 100;
          master_item:
            key: pan.pa440.session_info.get
          tags:
            - tag: component
              value: session
        - uuid: b70edca62b6c4a609d3c1dba707726ea
          name: 'Sessions: TCP, active'
          type: DEPENDENT
          key: pan.pa440.sessions.tcp.active
          description: 'Total number of active TCP sessions.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.response.result[''num-tcp'']'
          master_item:
            key: pan.pa440.session_info.get
          tags:
            - tag: component
              value: session
        - uuid: 1f48afa7b8cf4ab68497cb4b6a323a29
          name: 'Sessions: UDP, active'
          type: DEPENDENT
          key: pan.pa440.sessions.udp.active
          description: 'Total number of active UDP sessions.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.response.result[''num-udp'']'
          master_item:
            key: pan.pa440.session_info.get
          tags:
            - tag: component
              value: session
        - uuid: f3defb28d70a4a0f9ebd036d65e1fda2
          name: 'Get session info'
          type: HTTP_AGENT
          key: pan.pa440.session_info.get
          history: '0'
          value_type: TEXT
          authtype: BASIC
          username: '{$PAN.PA440.USER}'
          password: '{$PAN.PA440.PASSWORD}'
          description: 'Get the information about sessions.'
          preprocessing:
            - type: XML_TO_JSON
          timeout: '{$PAN.PA440.TIMEOUT}'
          url: '{$PAN.PA440.API.URL}'
          query_fields:
            - name: type
              value: op
            - name: cmd
              value: '<show><session><info></info></session></show>'
          status_codes: ''
          http_proxy: '{$PAN.PA440.HTTP_PROXY}'
          tags:
            - tag: component
              value: raw
        - uuid: 185bb269726f49ec9903dfea32c17c84
          name: 'Get session info check'
          type: DEPENDENT
          key: pan.pa440.session_info.get.check
          value_type: TEXT
          description: 'Data collection check. Check the latest values for details.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  const item_data = JSON.parse(value);
                  
                  var zbx_error_msg = '';
                  
                  if (item_data.response['@status'] !== 'success') {
                  	zbx_error_msg = 'Unknown error. Test the item manually and check the retrieved value.';
                  
                  	if (item_data.response.msg && item_data.response.msg.line) {
                  		zbx_error_msg = item_data.response.msg.line;
                  	}
                  
                  	if (item_data.response.result && item_data.response.result.msg) {
                  		zbx_error_msg = item_data.response.result.msg;
                  	}
                  }
                  
                  return zbx_error_msg;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          master_item:
            key: pan.pa440.session_info.get
          tags:
            - tag: component
              value: status
          triggers:
            - uuid: d7577936d64a4e7b9e62868dacce625d
              expression: 'length(last(/Palo Alto PA-440 by HTTP/pan.pa440.session_info.get.check))>0'
              name: 'PA-440: Failed to get session info data from the API'
              priority: HIGH
              description: 'Failed to get data from the API. Check the latest values for details.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 5133c9b5e7284141ba1da1d1d1c726f8
          name: 'Get system info'
          type: HTTP_AGENT
          key: pan.pa440.system_info.get
          history: '0'
          value_type: TEXT
          authtype: BASIC
          username: '{$PAN.PA440.USER}'
          password: '{$PAN.PA440.PASSWORD}'
          description: 'Get the general system information.'
          preprocessing:
            - type: XML_TO_JSON
          timeout: '{$PAN.PA440.TIMEOUT}'
          url: '{$PAN.PA440.API.URL}'
          query_fields:
            - name: type
              value: op
            - name: cmd
              value: '<show><system><info></info></system></show>'
          status_codes: ''
          http_proxy: '{$PAN.PA440.HTTP_PROXY}'
          tags:
            - tag: component
              value: raw
        - uuid: e864518eac5c412299cbe0561813bff3
          name: 'Get system info check'
          type: DEPENDENT
          key: pan.pa440.system_info.get.check
          value_type: TEXT
          description: 'Data collection check. Check the latest values for details.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  const item_data = JSON.parse(value);
                  
                  var zbx_error_msg = '';
                  
                  if (item_data.response['@status'] !== 'success') {
                  	zbx_error_msg = 'Unknown error. Test the item manually and check the retrieved value.';
                  
                  	if (item_data.response.msg && item_data.response.msg.line) {
                  		zbx_error_msg = item_data.response.msg.line;
                  	}
                  
                  	if (item_data.response.result && item_data.response.result.msg) {
                  		zbx_error_msg = item_data.response.result.msg;
                  	}
                  }
                  
                  return zbx_error_msg;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          master_item:
            key: pan.pa440.system_info.get
          tags:
            - tag: component
              value: status
          triggers:
            - uuid: 38cd1ff8e5494e93a40662b9306c0807
              expression: 'length(last(/Palo Alto PA-440 by HTTP/pan.pa440.system_info.get.check))>0'
              name: 'PA-440: Failed to get system info data from the API'
              priority: HIGH
              description: 'Failed to get data from the API. Check the latest values for details.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 7bbaec54328a472e99c47edca0aa13c0
          name: 'Get system state'
          type: HTTP_AGENT
          key: pan.pa440.system_state.get
          history: '0'
          value_type: TEXT
          authtype: BASIC
          username: '{$PAN.PA440.USER}'
          password: '{$PAN.PA440.PASSWORD}'
          description: 'Get the system state information. Used with a filter to retrieve CPU utilization metrics.'
          preprocessing:
            - type: XML_TO_JSON
          timeout: '{$PAN.PA440.TIMEOUT}'
          url: '{$PAN.PA440.API.URL}'
          query_fields:
            - name: type
              value: op
            - name: cmd
              value: '<show><system><state><filter>sys.monitor.s1.*.exports</filter></state></system></show>'
          status_codes: ''
          http_proxy: '{$PAN.PA440.HTTP_PROXY}'
          tags:
            - tag: component
              value: raw
        - uuid: 473dd3928ad945a2aa2c8ba31301c75d
          name: 'Get system state check'
          type: DEPENDENT
          key: pan.pa440.system_state.get.check
          value_type: TEXT
          description: 'Data collection check. Check the latest values for details.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  const item_data = JSON.parse(value);
                  
                  var zbx_error_msg = '';
                  
                  if (item_data.response['@status'] !== 'success') {
                  	zbx_error_msg = 'Unknown error. Test the item manually and check the retrieved value.';
                  
                  	if (item_data.response.msg && item_data.response.msg.line) {
                  		zbx_error_msg = item_data.response.msg.line;
                  	}
                  
                  	if (item_data.response.result && item_data.response.result.msg) {
                  		zbx_error_msg = item_data.response.result.msg;
                  	}
                  }
                  
                  return zbx_error_msg;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          master_item:
            key: pan.pa440.system_state.get
          tags:
            - tag: component
              value: status
          triggers:
            - uuid: 920dc027510941a38648816064d8bf18
              expression: 'length(last(/Palo Alto PA-440 by HTTP/pan.pa440.system_state.get.check))>0'
              name: 'PA-440: Failed to get system state data from the API'
              priority: HIGH
              description: 'Failed to get data from the API. Check the latest values for details.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 29af24fd3b23440e92a3d96fb96dad22
          name: 'Threat version'
          type: DEPENDENT
          key: pan.pa440.threat.version
          value_type: CHAR
          description: 'Currently installed threat definition version. If no threat definition is found, "0" is returned.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.response.result.system[''threat-version'']'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: pan.pa440.system_info.get
          tags:
            - tag: component
              value: system
            - tag: component
              value: threat
        - uuid: a833b2bc69eb41599d916825ac89f9d7
          name: Uptime
          type: DEPENDENT
          key: pan.pa440.uptime
          units: uptime
          description: 'The system uptime.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.response.result.system.uptime
            - type: JAVASCRIPT
              parameters:
                - |
                  const uptime_pattern = /(?:(\d+)\s+days?,\s+)?(\d+):(\d+):(\d+)/;
                  
                  const match = value.match(uptime_pattern);
                  
                  if (match) {
                  	const days = parseInt(match[1] || "0", 10),
                  		  hours = parseInt(match[2], 10),
                  		  minutes = parseInt(match[3], 10),
                  		  seconds = parseInt(match[4], 10);
                  
                  	return days * 86400 + hours * 3600 + minutes * 60 + seconds;
                  } else {
                  	throw 'Incorrect uptime string received: ' + value + '. Expected format: D days, HH:mm:ss';
                  }
          master_item:
            key: pan.pa440.system_info.get
          tags:
            - tag: component
              value: system
        - uuid: 09afd20686404eec944a8b3489b2c826
          name: 'URL filtering version'
          type: DEPENDENT
          key: pan.pa440.url_filtering.version
          value_type: CHAR
          description: 'Currently installed URL filtering version. If no URL filtering is installed, "0" is returned.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.response.result.system[''url-filtering-version'']'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          master_item:
            key: pan.pa440.system_info.get
          tags:
            - tag: component
              value: system
            - tag: component
              value: url-filtering
      discovery_rules:
        - uuid: 94f62f452c3947f688e99fcea7f07b04
          name: 'BGP peer discovery'
          type: HTTP_AGENT
          key: pan.pa440.bgp.peer.discovery
          delay: 1h
          authtype: BASIC
          username: '{$PAN.PA440.USER}'
          password: '{$PAN.PA440.PASSWORD}'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#PEER}'
                value: '{$PAN.PA440.BGP.PEER.NAME.MATCHES}'
              - macro: '{#PEER}'
                value: '{$PAN.PA440.BGP.PEER.NAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#PEERGROUP}'
                value: '{$PAN.PA440.BGP.PEER.GROUP.MATCHES}'
              - macro: '{#PEERGROUP}'
                value: '{$PAN.PA440.BGP.PEER.GROUP.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          description: 'Discovers BGP peers.'
          item_prototypes:
            - uuid: 8cb01b4d3dbe403bae338af458c38b7b
              name: 'BGP peer [{#PEER}]: Get data'
              type: HTTP_AGENT
              key: 'pan.pa440.bgp.peer.get[{#PEERGROUP}, {#PEERADDR}, {#PEER}]'
              history: '0'
              value_type: TEXT
              authtype: BASIC
              username: '{$PAN.PA440.USER}'
              password: '{$PAN.PA440.PASSWORD}'
              description: 'Get the information about the peer.'
              preprocessing:
                - type: XML_TO_JSON
              timeout: '{$PAN.PA440.TIMEOUT}'
              url: '{$PAN.PA440.API.URL}'
              query_fields:
                - name: type
                  value: op
                - name: cmd
                  value: '<show><routing><protocol><bgp><peer><peer-name>{#PEER}</peer-name></peer></bgp></protocol></routing></show>'
              status_codes: ''
              http_proxy: '{$PAN.PA440.HTTP_PROXY}'
              tags:
                - tag: component
                  value: bgp
                - tag: component
                  value: network
                - tag: component
                  value: raw
                - tag: peer
                  value: '{#PEER}'
                - tag: peer-address
                  value: '{#PEERADDR}'
                - tag: peer-group
                  value: '{#PEERGROUP}'
            - uuid: 2b24b1d15040412793116d2d5c59b307
              name: 'BGP peer [{#PEER}]: Status duration'
              type: DEPENDENT
              key: 'pan.pa440.bgp.peer.status.duration[{#PEERGROUP}, {#PEERADDR}, {#PEER}]'
              units: s
              description: 'The duration of the current state of the BGP peer.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.result.entry[''status-duration'']'
              master_item:
                key: 'pan.pa440.bgp.peer.get[{#PEERGROUP}, {#PEERADDR}, {#PEER}]'
              tags:
                - tag: component
                  value: bgp
                - tag: component
                  value: network
                - tag: peer
                  value: '{#PEER}'
                - tag: peer-address
                  value: '{#PEERADDR}'
                - tag: peer-group
                  value: '{#PEERGROUP}'
              trigger_prototypes:
                - uuid: 9aee65b49c89455e90e08a6d9c362a53
                  expression: '{$PAN.PA440.BGP.CONTROL:"{#PEER}"}=1 and last(/Palo Alto PA-440 by HTTP/pan.pa440.bgp.peer.status.duration[{#PEERGROUP}, {#PEERADDR}, {#PEER}])<10m'
                  name: 'PA-440: BGP peer [{#PEER}]: Session status duration has been reset'
                  opdata: 'State duration: {ITEM.LASTVALUE}'
                  priority: AVERAGE
                  description: 'The duration of the session status with the peer has been reset.'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 6549bd0d259947c3b18c2fdc2c0f7b2c
              name: 'BGP peer [{#PEER}]: Status'
              type: DEPENDENT
              key: 'pan.pa440.bgp.peer.status[{#PEERGROUP}, {#PEERADDR}, {#PEER}]'
              description: 'The current state of the BGP peer.'
              valuemap:
                name: 'BGP peer status'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.response.result.entry.status
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = [
                      	'Idle',
                      	'Connect',
                      	'Active',
                      	'OpenSent',
                      	'OpenConfirm',
                      	'Established'
                      ].indexOf(value);
                      
                      return idx !== -1 ? idx : 8;
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'pan.pa440.bgp.peer.get[{#PEERGROUP}, {#PEERADDR}, {#PEER}]'
              tags:
                - tag: component
                  value: bgp
                - tag: component
                  value: network
                - tag: peer
                  value: '{#PEER}'
                - tag: peer-address
                  value: '{#PEERADDR}'
                - tag: peer-group
                  value: '{#PEERGROUP}'
              trigger_prototypes:
                - uuid: 6d336040133543ada2e916338a6f77eb
                  expression: '{$PAN.PA440.BGP.CONTROL:"{#PEER}"}=1 and last(/Palo Alto PA-440 by HTTP/pan.pa440.bgp.peer.status[{#PEERGROUP}, {#PEERADDR}, {#PEER}])<>5 and last(/Palo Alto PA-440 by HTTP/pan.pa440.bgp.peer.status[{#PEERGROUP}, {#PEERADDR}, {#PEER}])<>0'
                  name: 'PA-440: BGP peer [{#PEER}]: Session is not Established or Idle'
                  opdata: 'Current status: {ITEM.LASTVALUE}'
                  priority: HIGH
                  description: 'The session with the peer is not "Established" or "Idle".'
                  tags:
                    - tag: scope
                      value: availability
          timeout: '{$PAN.PA440.TIMEOUT}'
          url: '{$PAN.PA440.API.URL}'
          query_fields:
            - name: type
              value: op
            - name: cmd
              value: '<show><routing><protocol><bgp><peer></peer></bgp></protocol></routing></show>'
          status_codes: ''
          http_proxy: '{$PAN.PA440.HTTP_PROXY}'
          preprocessing:
            - type: XML_TO_JSON
            - type: JAVASCRIPT
              parameters:
                - |
                  var bgp_peers = JSON.parse(value),
                  	result = [];
                  
                  if (bgp_peers.response.result && bgp_peers.response.result.entry) {
                  	var peers = Array.isArray(bgp_peers.response.result.entry) ? bgp_peers.response.result.entry : [bgp_peers.response.result.entry];
                  
                  	result = peers.map(function (peer) {
                  		return {
                  			'{#PEER}': peer['@peer'],
                  			'{#PEERGROUP}': peer['peer-group'],
                  			'{#PEERADDR}': peer['peer-address'].replace(/:\d+$/, '')
                  		}
                  	});
                  
                  	return JSON.stringify(result);
                  }
                  
                  return JSON.stringify(result);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
        - uuid: 72aa0f2e12cc48d7a11fcee0621e8450
          name: 'Device certificate discovery'
          type: DEPENDENT
          key: pan.pa440.certificate.device.discovery
          description: 'Discovers device certificate metrics. Note that superuser privileges are required to obtain the device certificate data.'
          item_prototypes:
            - uuid: 2c6a819bbab548d08ce78c9cb3a76be9
              name: 'Device certificate: Expires on'
              type: DEPENDENT
              key: 'pan.pa440.certificate.device.expires[{#SINGLETON}]'
              value_type: CHAR
              description: 'The expiration date of the device certificate.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.result[''device-certificate''][''not_valid_after'']'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
              master_item:
                key: pan.pa440.certificate.device.get
              tags:
                - tag: component
                  value: certificate
            - uuid: 0f0be52887fa400d8a278047c7340975
              name: 'Device certificate: Expires in'
              type: DEPENDENT
              key: 'pan.pa440.certificate.device.expires_in[{#SINGLETON}]'
              units: s
              description: 'The time in seconds until the device certificate expiration.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.result[''device-certificate''][''seconds-to-expire'']'
              master_item:
                key: pan.pa440.certificate.device.get
              tags:
                - tag: component
                  value: certificate
              trigger_prototypes:
                - uuid: 90156f312ddb48498f5475539317bfa3
                  expression: 'last(/Palo Alto PA-440 by HTTP/pan.pa440.certificate.device.expires_in[{#SINGLETON}])<{$PAN.PA440.CERT.DEVICE.EXPIRY.WARN}'
                  name: 'PA-440: Device certificate: Expires soon'
                  event_name: 'PA-440: Device certificate: Expires soon (less than {$PAN.PA440.CERT.DEVICE.EXPIRY.WARN} until it expires)'
                  opdata: 'Device certificate expires in: {ITEM.LASTVALUE}'
                  priority: WARNING
                  description: 'The device certificate will expire in less than `{$PAN.PA440.CERT.DEVICE.EXPIRY.WARN}`.'
                  tags:
                    - tag: scope
                      value: performance
          master_item:
            key: pan.pa440.certificate.device.get
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  const dev_certificate = JSON.parse(value);
                  
                  if (dev_certificate.response.result && dev_certificate.response.result['device-certificate'] && dev_certificate.response.result['device-certificate'].status === 'success') {
                  	return JSON.stringify([{'{#SINGLETON}': ''}]);
                  }
                  
                  return JSON.stringify([]);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
        - uuid: fbcd5fd8228045a5aebc41c3a1ee5d57
          name: 'Certificate discovery'
          type: DEPENDENT
          key: pan.pa440.certificates.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#CERTNAME}'
                value: '{$PAN.PA440.CERT.NAME.MATCHES}'
              - macro: '{#CERTNAME}'
                value: '{$PAN.PA440.CERT.NAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#EXPIRES}'
                value: Never
                operator: NOT_MATCHES_REGEX
          description: 'Discovers certificates on the device. Only the certificates with an expiration date are discovered.'
          item_prototypes:
            - uuid: 027e22db808c4d399758ca0c7dda8c30
              name: 'Certificate [{#CERTNAME}]: Expires on'
              type: DEPENDENT
              key: 'pan.pa440.certificate.expires[{#CERTNAME}]'
              units: unixtime
              description: 'The expiration date for the certificate.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.data[?(@[''@name''] == "{#CERTNAME}")][''expiry-epoch''].first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
              master_item:
                key: pan.pa440.certificate.get
              tags:
                - tag: component
                  value: certificate
              trigger_prototypes:
                - uuid: bb48cead5efb4979bfd7ae72131b56a3
                  expression: '(last(/Palo Alto PA-440 by HTTP/pan.pa440.certificate.expires[{#CERTNAME}]) - now())<{$PAN.PA440.CERT.EXPIRY.WARN:"{#CERTNAME}"}'
                  name: 'PA-440: Certificate [{#CERTNAME}]: Expires soon'
                  event_name: 'PA-440: Certificate [{#CERTNAME}]: Expires soon (less than {$PAN.PA440.CERT.EXPIRY.WARN} until it expires)'
                  opdata: 'Certificate expires on: {ITEM.LASTVALUE}'
                  priority: WARNING
                  description: 'The certificate will expire in less than `{$PAN.PA440.CERT.EXPIRY.WARN:"{#CERTNAME}"}`.'
                  dependencies:
                    - name: 'PA-440: Certificate [{#CERTNAME}]: Has expired'
                      expression: '(last(/Palo Alto PA-440 by HTTP/pan.pa440.certificate.expires[{#CERTNAME}]) - now())<0'
                  tags:
                    - tag: scope
                      value: availability
                - uuid: 8d546a0d064941439f5a603854e1f484
                  expression: '(last(/Palo Alto PA-440 by HTTP/pan.pa440.certificate.expires[{#CERTNAME}]) - now())<0'
                  name: 'PA-440: Certificate [{#CERTNAME}]: Has expired'
                  priority: HIGH
                  description: 'The certificate has expired.'
                  tags:
                    - tag: scope
                      value: availability
          master_item:
            key: pan.pa440.certificate.get
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var certificates = JSON.parse(value),
                  	result = [];
                  
                  result = certificates.response.data.map(function (certificate) {
                  	return {
                  		'{#CERTNAME}': certificate['@name'],
                  		'{#EXPIRES}': certificate['expiry-epoch'] ? certificate['expiry-epoch'] : 'Never'
                  	}
                  });
                  
                  return JSON.stringify(result);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
        - uuid: 252cc5be29874b32b7f3cc45699345df
          name: 'HA metric discovery'
          type: DEPENDENT
          key: pan.pa440.ha.discovery
          description: 'Discovers high availability metrics.'
          item_prototypes:
            - uuid: 1d681dfe12694efaa419dbb651a46341
              name: 'HA state reason'
              type: DEPENDENT
              key: 'pan.pa440.ha.local[state_reason{#SINGLETON}]'
              value_type: CHAR
              description: |
                The reason for the current state of high availability. May be absent in the master item data in some cases; set to an empty string if not found.
                
                Information about high availability states:
                https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/high-availability/ha-firewall-states
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.result.group[''local-info''][''state-reason'']'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: ' '
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: pan.pa440.ha.get
              tags:
                - tag: component
                  value: ha
                - tag: component
                  value: local-ha
            - uuid: 42a27d95b28e47949a1c19e9e4728622
              name: 'HA state'
              type: DEPENDENT
              key: 'pan.pa440.ha.local[state{#SINGLETON}]'
              description: |
                The current state of high availability.
                
                Information about high availability states:
                https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/high-availability/ha-firewall-states
              valuemap:
                name: 'HA state'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.result.group[''local-info''].state'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = [
                      	'initial',
                      	'active',
                      	'passive',
                      	'active-primary',
                      	'active-secondary',
                      	'tentative',
                      	'non-functional',
                      	'suspended'
                      ].indexOf(value);
                      
                      return idx !== -1 ? idx : 8;
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: pan.pa440.ha.get
              tags:
                - tag: component
                  value: ha
                - tag: component
                  value: local-ha
              trigger_prototypes:
                - uuid: abc088274f3f4eb996cd00832cb0bfa7
                  expression: |
                    (last(/Palo Alto PA-440 by HTTP/pan.pa440.ha.local[state{#SINGLETON}])=1 and last(/Palo Alto PA-440 by HTTP/pan.pa440.ha.local[state{#SINGLETON}],#2)=2) or
                    (last(/Palo Alto PA-440 by HTTP/pan.pa440.ha.local[state{#SINGLETON}])=2 and last(/Palo Alto PA-440 by HTTP/pan.pa440.ha.local[state{#SINGLETON}],#2)=1) or
                    (last(/Palo Alto PA-440 by HTTP/pan.pa440.ha.local[state{#SINGLETON}])=3 and last(/Palo Alto PA-440 by HTTP/pan.pa440.ha.local[state{#SINGLETON}],#2)=4) or
                    (last(/Palo Alto PA-440 by HTTP/pan.pa440.ha.local[state{#SINGLETON}])=4 and last(/Palo Alto PA-440 by HTTP/pan.pa440.ha.local[state{#SINGLETON}],#2)=3)
                  name: 'PA-440: HA state has been changed'
                  event_name: 'PA-440: HA state has been changed to "{ITEM.VALUE}"'
                  opdata: 'Current HA state: {ITEM.LASTVALUE}'
                  priority: HIGH
                  description: |
                    The high availability state has changed. The following state transitions are checked:
                    
                    1. Active-Passive HA mode:
                    - "passive" > "active"
                    - "active" > "passive"
                    
                    2. Active-Active HA mode:
                    - "active-secondary" > "active-primary"
                    - "active-primary" > "active-secondary"
                    
                    Information about high availability states:
                    https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/high-availability/ha-firewall-states
                  tags:
                    - tag: scope
                      value: availability
            - uuid: e23d3e505d7245c3948eeddf070ed186
              name: 'HA peer state'
              type: DEPENDENT
              key: 'pan.pa440.ha.peer[state{#SINGLETON}]'
              description: |
                The current peer state of high availability.
                
                Information about high availability states:
                https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/high-availability/ha-firewall-states
              valuemap:
                name: 'HA state'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.result.group[''peer-info''].state'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = [
                      	'initial',
                      	'active',
                      	'passive',
                      	'active-primary',
                      	'active-secondary',
                      	'tentative',
                      	'non-functional',
                      	'suspended'
                      ].indexOf(value);
                      
                      return idx !== -1 ? idx : 8;
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: pan.pa440.ha.get
              tags:
                - tag: component
                  value: ha
                - tag: component
                  value: peer-ha
            - uuid: cea682854ccf4d8b81c75db57c92bc38
              name: 'HA configuration synchronization status'
              type: DEPENDENT
              key: 'pan.pa440.ha[config_sync_status{#SINGLETON}]'
              value_type: CHAR
              description: 'The current state of the running configuration synchronization.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.result.group[''running-sync'']'
              master_item:
                key: pan.pa440.ha.get
              tags:
                - tag: component
                  value: ha
              trigger_prototypes:
                - uuid: 58498c3e502240239687ae446b3ff81f
                  expression: 'count(/Palo Alto PA-440 by HTTP/pan.pa440.ha[config_sync_status{#SINGLETON}],{$PAN.PA440.HA.CONFIG_SYNC.THRESH},"iregexp","^(?:synchronized|synchronization in progress)$")=0'
                  name: 'PA-440: Configuration is not synchronized with HA peer'
                  opdata: 'Current status: {ITEM.LASTVALUE}'
                  priority: HIGH
                  description: 'This trigger indicates that the configuration cannot be synchronized with the HA peer. Please debug this manually by checking the logs (Monitor > Logs > System).'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: f7f29f1d68234eebbfb10c11cacc51e1
              name: 'HA mode'
              type: DEPENDENT
              key: 'pan.pa440.ha[mode{#SINGLETON}]'
              description: |
                The current mode of high availability. Possible values:
                
                0 - Active-Passive
                1 - Active-Active
                2 - Unknown
              valuemap:
                name: 'HA mode'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.response.result.group.mode
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const idx = [
                      	'Active-Passive',
                      	'Active-Active',
                      ].indexOf(value);
                      
                      return idx !== -1 ? idx : 2;
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: pan.pa440.ha.get
              tags:
                - tag: component
                  value: ha
          trigger_prototypes:
            - uuid: eff0a2435b98474eab352f796ea4811f
              expression: 'last(/Palo Alto PA-440 by HTTP/pan.pa440.ha.local[state{#SINGLETON}])=6 and length(last(/Palo Alto PA-440 by HTTP/pan.pa440.ha.local[state_reason{#SINGLETON}]))>0'
              name: 'PA-440: HA is in "non-functional" state'
              opdata: 'Current HA state: {ITEM.LASTVALUE}. State reason: {ITEM.LASTVALUE2}'
              priority: HIGH
              description: |
                Error state due to a dataplane failure or a configuration mismatch such as: only one firewall configured for packet forwarding, VR sync, or QoS sync.
                
                In active/passive mode, all of the causes listed for the tentative state cause the non-functional state:
                - Failure of a firewall.
                - Failure of a monitored object (a link or path).
                - The firewall leaves the suspended or non-functional state.
                
                Information about high availability states:
                https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/high-availability/ha-firewall-states
              tags:
                - tag: scope
                  value: availability
            - uuid: 98000f629d564d1096d5e5763caf772c
              expression: 'last(/Palo Alto PA-440 by HTTP/pan.pa440.ha.local[state{#SINGLETON}])=7 and not (find(/Palo Alto PA-440 by HTTP/pan.pa440.ha.local[state_reason{#SINGLETON}],,"iregexp","^User requested$")=1 and {$PAN.PA440.HA.STATE.IGNORE_USER_SUSPENDED}=1)'
              name: 'PA-440: HA is in "suspended" state'
              opdata: 'Current HA state: {ITEM.LASTVALUE}. State reason: {ITEM.LASTVALUE2}'
              priority: AVERAGE
              description: |
                The device is disabled and won't pass data traffic; although HA communications still occur, the device doesn't participate in the HA election process. It can't move to a HA functional state without user intervention.
                
                The following case is excluded from the trigger's logic by default (can be changed by setting the `{$PAN.PA440.HA.STATE.IGNORE_USER_SUSPENDED}` macro value to "0"): the user suspends the device for HA manually.
                
                Information about high availability states:
                https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/high-availability/ha-firewall-states
              tags:
                - tag: scope
                  value: availability
            - uuid: dafe751acbb545ab8bb14358b7032a4e
              expression: 'last(/Palo Alto PA-440 by HTTP/pan.pa440.ha.local[state{#SINGLETON}])=5 and length(last(/Palo Alto PA-440 by HTTP/pan.pa440.ha.local[state_reason{#SINGLETON}]))>0'
              name: 'PA-440: HA is in "tentative" state'
              opdata: 'Current HA state: {ITEM.LASTVALUE}. State reason: {ITEM.LASTVALUE2}'
              priority: AVERAGE
              description: |
                State of a firewall (in an active/active configuration) caused by one of the following:
                - Failure of a firewall.
                - Failure of a monitored object (a link or path).
                - The firewall leaves the suspended or non-functional state.
                
                A firewall in the tentative state synchronizes sessions and configurations from the peer.
                
                Information about high availability states:
                https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/high-availability/ha-firewall-states
              tags:
                - tag: scope
                  value: availability
          master_item:
            key: pan.pa440.ha.get
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  const ha_data = JSON.parse(value);
                  
                  if (ha_data.response.result.enabled === 'yes') {
                  	return JSON.stringify([
                  		{
                  			'{#SINGLETON}': '',
                  			'{#HAMODE}': ha_data.response.result.group.mode
                  		}
                  	]);
                  }
                  
                  return JSON.stringify([]);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          overrides:
            - name: 'Do not create tentative state trigger for Active-Passive mode'
              step: '1'
              filter:
                conditions:
                  - macro: '{#HAMODE}'
                    value: ^Active-Passive$
              operations:
                - operationobject: TRIGGER_PROTOTYPE
                  value: 'HA is in "tentative" state'
                  discover: NO_DISCOVER
        - uuid: d234577c40cc49c1a8e4bda7f4a75741
          name: 'HA link discovery'
          type: DEPENDENT
          key: pan.pa440.ha.links.discovery
          description: |
            Discovers high availability link metrics.
            
            Information about high availability links:
            https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/high-availability/ha-concepts/ha-links-and-backup-links
          item_prototypes:
            - uuid: 2e4374dd561b4c018e4a90acd6f19d27
              name: 'HA link [{#HALINK}]: Status'
              type: DEPENDENT
              key: 'pan.pa440.ha.peer.link.state[{#HALINK}]'
              value_type: CHAR
              description: |
                The current state of the high availability link.
                
                Information about high availability links:
                https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/high-availability/ha-concepts/ha-links-and-backup-links
              valuemap:
                name: 'HA state'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.result.group[''peer-info''][''{#HALINK}''][''conn-status'']'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: pan.pa440.ha.get
              tags:
                - tag: component
                  value: ha
                - tag: component
                  value: ha-link
                - tag: component
                  value: peer-ha
                - tag: ha-link
                  value: '{#HALINK}'
              trigger_prototypes:
                - uuid: a70728ec16c14f528ddcfcefdb1b4c94
                  expression: 'last(/Palo Alto PA-440 by HTTP/pan.pa440.ha.peer.link.state[{#HALINK}])="down"'
                  name: 'PA-440: HA link [{#HALINK}]: Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE}'
                  priority: HIGH
                  description: 'The status of the high availability link is "down".'
                  tags:
                    - tag: scope
                      value: availability
          master_item:
            key: pan.pa440.ha.get
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var ha_data = JSON.parse(value),
                  	result = [];
                  
                  if (ha_data.response.result.group['peer-info']) {
                  	for (var link in ha_data.response.result.group['peer-info']) {
                  		if (/^conn-ha\d+(-backup)?$/.test(link)){
                  			result.push({'{#HALINK}': link});
                  		}
                  	}
                  }
                  
                  return JSON.stringify(result);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
        - uuid: 77eb005985d24e8bbe2ca56ea7c82f86
          name: 'Hardware network interface discovery'
          type: HTTP_AGENT
          key: pan.pa440.if.hw.discovery
          delay: 1h
          authtype: BASIC
          username: '{$PAN.PA440.USER}'
          password: '{$PAN.PA440.PASSWORD}'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFNAME}'
                value: '{$PAN.PA440.IF.HW.IFNAME.MATCHES}'
              - macro: '{#IFNAME}'
                value: '{$PAN.PA440.IF.HW.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          description: 'Discovers hardware network interfaces.'
          item_prototypes:
            - uuid: 521ba4a790d745f588d3a53dd7d93e72
              name: 'Interface [{#IFNAME}]: Bits received, per second'
              type: DEPENDENT
              key: 'pan.pa440.if.hw.bits.in.rate[{#IFNAME}]'
              units: bps
              description: 'The number of bits received per second by the interface.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.result.ifnet.counters.hw.entry.port[''rx-bytes'']'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'pan.pa440.if.hw.get[{#IFNAME}]'
              tags:
                - tag: component
                  value: interface
                - tag: component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
                - tag: interface-type
                  value: hardware
            - uuid: f399ad09d3a746b6a6650355e285bb3a
              name: 'Interface [{#IFNAME}]: Bits sent, per second'
              type: DEPENDENT
              key: 'pan.pa440.if.hw.bits.out.rate[{#IFNAME}]'
              units: bps
              description: 'The number of bits sent per second by the interface.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.result.ifnet.counters.hw.entry.port[''tx-bytes'']'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'pan.pa440.if.hw.get[{#IFNAME}]'
              tags:
                - tag: component
                  value: interface
                - tag: component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
                - tag: interface-type
                  value: hardware
            - uuid: 19bcb77f16e44adbae1abd384b7c8105
              name: 'Interface [{#IFNAME}]: Get data'
              type: HTTP_AGENT
              key: 'pan.pa440.if.hw.get[{#IFNAME}]'
              delay: 3m
              history: '0'
              value_type: TEXT
              authtype: BASIC
              username: '{$PAN.PA440.USER}'
              password: '{$PAN.PA440.PASSWORD}'
              description: 'Get the interface statistics.'
              preprocessing:
                - type: XML_TO_JSON
              timeout: '{$PAN.PA440.TIMEOUT}'
              url: '{$PAN.PA440.API.URL}'
              query_fields:
                - name: type
                  value: op
                - name: cmd
                  value: '<show><interface>{#IFNAME}</interface></show>'
              status_codes: ''
              http_proxy: '{$PAN.PA440.HTTP_PROXY}'
              tags:
                - tag: component
                  value: interface
                - tag: component
                  value: network
                - tag: component
                  value: raw
                - tag: interface
                  value: '{#IFNAME}'
                - tag: interface-type
                  value: hardware
            - uuid: bca68b06a8114e9da005c59afc32ef1e
              name: 'Interface [{#IFNAME}]: Inbound packets discarded, per second'
              type: DEPENDENT
              key: 'pan.pa440.if.hw.packets.in.discards.rate[{#IFNAME}]'
              description: 'The number of inbound packets per second which were chosen to be discarded even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.result.ifnet.counters.hw.entry.port[''rx-discards'']'
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'pan.pa440.if.hw.get[{#IFNAME}]'
              tags:
                - tag: component
                  value: interface
                - tag: component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
                - tag: interface-type
                  value: hardware
            - uuid: d80bddb621f94d7085e6dbc64f45de66
              name: 'Interface [{#IFNAME}]: Inbound packets with errors, per second'
              type: DEPENDENT
              key: 'pan.pa440.if.hw.packets.in.errors.rate[{#IFNAME}]'
              description: 'The number of inbound packets per second that contained errors preventing them from being deliverable to a higher-layer protocol.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.result.ifnet.counters.hw.entry.port[''rx-error'']'
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'pan.pa440.if.hw.get[{#IFNAME}]'
              tags:
                - tag: component
                  value: interface
                - tag: component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
                - tag: interface-type
                  value: hardware
            - uuid: 5e79436836ba4871af0d67cca08db379
              name: 'Interface [{#IFNAME}]: Outbound packets with errors, per second'
              type: DEPENDENT
              key: 'pan.pa440.if.hw.packets.out.errors.rate[{#IFNAME}]'
              description: 'The number of outbound packets per second that contained errors preventing them from being deliverable to a higher-layer protocol.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.result.ifnet.counters.hw.entry.port[''tx-error'']'
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'pan.pa440.if.hw.get[{#IFNAME}]'
              tags:
                - tag: component
                  value: interface
                - tag: component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
                - tag: interface-type
                  value: hardware
            - uuid: 6969f818f52c4349b16b543879e16195
              name: 'Interface [{#IFNAME}]: Speed'
              type: DEPENDENT
              key: 'pan.pa440.if.hw.speed[{#IFNAME}]'
              units: bps
              description: 'The current bandwidth of the interface. The item is created only for interfaces that report the actual speed in units of 1,000,000 bits.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.response.result.hw.speed
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'pan.pa440.if.hw.get[{#IFNAME}]'
              tags:
                - tag: component
                  value: interface
                - tag: component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
                - tag: interface-type
                  value: hardware
            - uuid: f74af7a4b22f448fa3cc0b0e3a19ff83
              name: 'Interface [{#IFNAME}]: Status'
              type: DEPENDENT
              key: 'pan.pa440.if.hw.status[{#IFNAME}]'
              value_type: CHAR
              description: 'The current state of the interface.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.response.result.hw.state
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'pan.pa440.if.hw.get[{#IFNAME}]'
              tags:
                - tag: component
                  value: interface
                - tag: component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
                - tag: interface-type
                  value: hardware
              trigger_prototypes:
                - uuid: a32d21255ee641329da2e64900862d83
                  expression: '{$PAN.PA440.IF.HW.CONTROL:"{#IFNAME}"}=1 and last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.status[{#IFNAME}])="down" and (last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.status[{#IFNAME}])<>last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.status[{#IFNAME}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.status[{#IFNAME}])<>"down" or {$PAN.PA440.IF.HW.CONTROL:"{#IFNAME}"}=0'
                  name: 'PA-440: Interface [{#IFNAME}]: Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. It can be triggered if the operational status is "down".
                    2. `{$PAN.PA440.IF.HW.CONTROL:"{#IFNAME}"}=1` - a user can redefine the context macro to "0", marking this interface as not important. No new trigger will be fired if this interface is down.
                    3. `last(/TEMPLATE_NAME/METRIC)<>last(/TEMPLATE_NAME/METRIC,#2)` - the trigger fires only if the operational status has changed to "down" from some other state (it does not fire for "eternal off" interfaces).
                    
                    WARNING: if closed manually - it will not fire again on the next poll because of `last(/TEMPLATE_NAME/METRIC)<>last(/TEMPLATE_NAME/METRIC,#2)`.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
          trigger_prototypes:
            - uuid: e4ae8d6b2c9b4962afdad9dfd93f2554
              expression: |
                (avg(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.bits.in.rate[{#IFNAME}],15m)>({$PAN.PA440.IF.HW.UTIL.MAX:"{#IFNAME}"}/100)*last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.speed[{#IFNAME}]) or
                avg(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.bits.out.rate[{#IFNAME}],15m)>({$PAN.PA440.IF.HW.UTIL.MAX:"{#IFNAME}"}/100)*last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.speed[{#IFNAME}])) and
                last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.speed[{#IFNAME}])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.bits.in.rate[{#IFNAME}],15m)<(({$PAN.PA440.IF.HW.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.speed[{#IFNAME}]) and
                avg(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.bits.out.rate[{#IFNAME}],15m)<(({$PAN.PA440.IF.HW.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.speed[{#IFNAME}])
              name: 'PA-440: Interface [{#IFNAME}]: High bandwidth usage'
              event_name: 'PA-440: Interface [{#IFNAME}]: High bandwidth usage (>{$PAN.PA440.IF.HW.UTIL.MAX:"{#IFNAME}"}%)'
              opdata: 'In: {ITEM.LASTVALUE}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'The utilization of the network interface is close to its estimated maximum bandwidth.'
              manual_close: 'YES'
              dependencies:
                - name: 'PA-440: Interface [{#IFNAME}]: Link down'
                  expression: '{$PAN.PA440.IF.HW.CONTROL:"{#IFNAME}"}=1 and last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.status[{#IFNAME}])="down" and (last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.status[{#IFNAME}])<>last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.status[{#IFNAME}],#2))'
                  recovery_expression: 'last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.status[{#IFNAME}])<>"down" or {$PAN.PA440.IF.HW.CONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: performance
            - uuid: 9056fb0e68c94a408a5c77d3d8de28fd
              expression: |
                min(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.packets.in.errors.rate[{#IFNAME}],5m)>{$PAN.PA440.IF.HW.ERRORS.WARN:"{#IFNAME}"}
                or min(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.packets.out.errors.rate[{#IFNAME}],5m)>{$PAN.PA440.IF.HW.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.packets.in.errors.rate[{#IFNAME}],5m)<{$PAN.PA440.IF.HW.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.packets.out.errors.rate[{#IFNAME}],5m)<{$PAN.PA440.IF.HW.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'PA-440: Interface [{#IFNAME}]: High error rate'
              event_name: 'PA-440: Interface [{#IFNAME}]: High error rate (>{$PAN.PA440.IF.HW.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'Errors in: {ITEM.LASTVALUE}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'It recovers when it is below 80% of the `{$PAN.PA440.IF.HW.ERRORS.WARN:"{#IFNAME}"}` threshold.'
              manual_close: 'YES'
              dependencies:
                - name: 'PA-440: Interface [{#IFNAME}]: Link down'
                  expression: '{$PAN.PA440.IF.HW.CONTROL:"{#IFNAME}"}=1 and last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.status[{#IFNAME}])="down" and (last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.status[{#IFNAME}])<>last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.status[{#IFNAME}],#2))'
                  recovery_expression: 'last(/Palo Alto PA-440 by HTTP/pan.pa440.if.hw.status[{#IFNAME}])<>"down" or {$PAN.PA440.IF.HW.CONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
          graph_prototypes:
            - uuid: 8b770f2163c747c1a5ce35586235d266
              name: 'Interface [{#IFNAME}]: Network traffic (bits, per second)'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'Palo Alto PA-440 by HTTP'
                    key: 'pan.pa440.if.hw.bits.in.rate[{#IFNAME}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'Palo Alto PA-440 by HTTP'
                    key: 'pan.pa440.if.hw.bits.out.rate[{#IFNAME}]'
            - uuid: 01523de30af74fe7bb11354c13ef01cd
              name: 'Interface [{#IFNAME}]: Network traffic (packets, per second)'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'Palo Alto PA-440 by HTTP'
                    key: 'pan.pa440.if.hw.packets.in.discards.rate[{#IFNAME}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'Palo Alto PA-440 by HTTP'
                    key: 'pan.pa440.if.hw.packets.in.errors.rate[{#IFNAME}]'
                - sortorder: '2'
                  color: 00611C
                  item:
                    host: 'Palo Alto PA-440 by HTTP'
                    key: 'pan.pa440.if.hw.packets.out.errors.rate[{#IFNAME}]'
          timeout: '{$PAN.PA440.TIMEOUT}'
          url: '{$PAN.PA440.API.URL}'
          query_fields:
            - name: type
              value: op
            - name: cmd
              value: '<show><interface>hardware</interface></show>'
          status_codes: ''
          http_proxy: '{$PAN.PA440.HTTP_PROXY}'
          preprocessing:
            - type: XML_TO_JSON
            - type: JAVASCRIPT
              parameters:
                - |
                  var interfaces = JSON.parse(value),
                  	result;
                  
                  if (Array.isArray(interfaces.response.result.hw.entry) && interfaces.response.result.hw.entry.length > 0) {
                  	result = interfaces.response.result.hw.entry.map(function (interface) {
                  		return {
                  			'{#IFNAME}': interface.name,
                  			'{#IFSPEED}': interface.speed
                  		};
                  	});
                  
                  	return JSON.stringify(result);
                  }
                  
                  return JSON.stringify([]);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          overrides:
            - name: 'Do not create speed item and trigger if not supported'
              step: '1'
              filter:
                conditions:
                  - macro: '{#IFSPEED}'
                    value: \d+
                    operator: NOT_MATCHES_REGEX
              operations:
                - operator: REGEXP
                  value: Speed
                  discover: NO_DISCOVER
                - operationobject: TRIGGER_PROTOTYPE
                  operator: REGEXP
                  value: 'High bandwidth usage'
                  discover: NO_DISCOVER
        - uuid: 0328c545f98e4e2e90648b5990d365c7
          name: 'Logical network interface discovery'
          type: HTTP_AGENT
          key: pan.pa440.if.sw.discovery
          delay: 1h
          authtype: BASIC
          username: '{$PAN.PA440.USER}'
          password: '{$PAN.PA440.PASSWORD}'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFNAME}'
                value: '{$PAN.PA440.IF.SW.IFNAME.MATCHES}'
              - macro: '{#IFNAME}'
                value: '{$PAN.PA440.IF.SW.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#IFZONE}'
                value: '{$PAN.PA440.IF.SW.IFZONE.MATCHES}'
              - macro: '{#IFZONE}'
                value: '{$PAN.PA440.IF.SW.IFZONE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#VSYS}'
                value: '{$PAN.PA440.IF.SW.VSYS.MATCHES}'
              - macro: '{#VSYS}'
                value: '{$PAN.PA440.IF.SW.VSYS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          description: 'Discovers logical network interfaces.'
          item_prototypes:
            - uuid: 72bf5045ffb1495bb4ac3c383d8ce4b7
              name: 'VSYS [{#VSYS}]: Interface [{#IFNAME}]: Bits received, per second'
              type: DEPENDENT
              key: 'pan.pa440.if.sw.bits.in.rate[{#VSYS}, {#IFNAME}]'
              units: bps
              description: 'The number of bits received per second by the interface.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.response.result.ifnet.counters.ifnet.entry.ibytes
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'pan.pa440.if.sw.get[{#VSYS}, {#IFNAME}]'
              tags:
                - tag: component
                  value: interface
                - tag: component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
                - tag: interface-type
                  value: logical
                - tag: vsys
                  value: '{#VSYS}'
            - uuid: 90351d2ad6f345908fec41a175971d12
              name: 'VSYS [{#VSYS}]: Interface [{#IFNAME}]: Bits sent, per second'
              type: DEPENDENT
              key: 'pan.pa440.if.sw.bits.out.rate[{#VSYS}, {#IFNAME}]'
              units: bps
              description: 'The number of bits sent by the interface.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.response.result.ifnet.counters.ifnet.entry.obytes
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'pan.pa440.if.sw.get[{#VSYS}, {#IFNAME}]'
              tags:
                - tag: component
                  value: interface
                - tag: component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
                - tag: interface-type
                  value: logical
                - tag: vsys
                  value: '{#VSYS}'
            - uuid: b7bc2017a9f240c793d526612738e0f8
              name: 'VSYS [{#VSYS}]: Interface [{#IFNAME}]: Get data'
              type: HTTP_AGENT
              key: 'pan.pa440.if.sw.get[{#VSYS}, {#IFNAME}]'
              delay: 3m
              history: '0'
              value_type: TEXT
              authtype: BASIC
              username: '{$PAN.PA440.USER}'
              password: '{$PAN.PA440.PASSWORD}'
              description: 'Get the interface statistics.'
              preprocessing:
                - type: XML_TO_JSON
              timeout: '{$PAN.PA440.TIMEOUT}'
              url: '{$PAN.PA440.API.URL}'
              query_fields:
                - name: type
                  value: op
                - name: cmd
                  value: '<show><interface>{#IFNAME}</interface></show>'
              status_codes: ''
              http_proxy: '{$PAN.PA440.HTTP_PROXY}'
              tags:
                - tag: component
                  value: interface
                - tag: component
                  value: network
                - tag: component
                  value: raw
                - tag: interface
                  value: '{#IFNAME}'
                - tag: interface-type
                  value: logical
                - tag: vsys
                  value: '{#VSYS}'
            - uuid: 78cda9d3e61e4862aefc617486145a88
              name: 'VSYS [{#VSYS}]: Interface [{#IFNAME}]: Inbound packets dropped, per second'
              type: DEPENDENT
              key: 'pan.pa440.if.sw.packets.in.drops.rate[{#VSYS}, {#IFNAME}]'
              description: 'The number of inbound packets per second which were chosen to be dropped even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.response.result.ifnet.counters.ifnet.entry.idrops
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'pan.pa440.if.sw.get[{#VSYS}, {#IFNAME}]'
              tags:
                - tag: component
                  value: interface
                - tag: component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
                - tag: interface-type
                  value: logical
                - tag: vsys
                  value: '{#VSYS}'
            - uuid: d18f406d5a02460881abcedc62ceab22
              name: 'VSYS [{#VSYS}]: Interface [{#IFNAME}]: Inbound packets with errors, per second'
              type: DEPENDENT
              key: 'pan.pa440.if.sw.packets.in.errors.rate[{#VSYS}, {#IFNAME}]'
              description: 'The number of inbound packets per second that contained errors preventing them from being deliverable to a higher-layer protocol.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.response.result.ifnet.counters.ifnet.entry.ierrors
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'pan.pa440.if.sw.get[{#VSYS}, {#IFNAME}]'
              tags:
                - tag: component
                  value: interface
                - tag: component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
                - tag: interface-type
                  value: logical
                - tag: vsys
                  value: '{#VSYS}'
              trigger_prototypes:
                - uuid: 0d56493b020a42e2b967c183384437ac
                  expression: 'min(/Palo Alto PA-440 by HTTP/pan.pa440.if.sw.packets.in.errors.rate[{#VSYS}, {#IFNAME}],5m)>{$PAN.PA440.IF.SW.ERRORS.WARN:"{#IFNAME}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/Palo Alto PA-440 by HTTP/pan.pa440.if.sw.packets.in.errors.rate[{#VSYS}, {#IFNAME}],5m)<{$PAN.PA440.IF.SW.ERRORS.WARN:"{#IFNAME}"}*0.8'
                  name: 'PA-440: VSYS [{#VSYS}]: Interface [{#IFNAME}]: High error rate'
                  event_name: 'PA-440: VSYS [{#VSYS}]: Interface [{#IFNAME}]: High error rate (>{$PAN.PA440.IF.SW.ERRORS.WARN:"{#IFNAME}"} for 5m)'
                  opdata: 'Errors in: {ITEM.LASTVALUE}'
                  priority: WARNING
                  description: 'It recovers when it is below 80% of the `{$PAN.PA440.IF.SW.ERRORS.WARN:"{#IFNAME}"}` threshold.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
          graph_prototypes:
            - uuid: 2f6b291347914c36b106b6365eb937e9
              name: 'VSYS [{#VSYS}]: Interface [{#IFNAME}]: Network traffic (bits, per second)'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'Palo Alto PA-440 by HTTP'
                    key: 'pan.pa440.if.sw.bits.in.rate[{#VSYS}, {#IFNAME}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'Palo Alto PA-440 by HTTP'
                    key: 'pan.pa440.if.sw.bits.out.rate[{#VSYS}, {#IFNAME}]'
            - uuid: ee8dff49f3174c7ab056dc7e4232c9ae
              name: 'VSYS [{#VSYS}]: Interface [{#IFNAME}]: Network traffic (packets, per second)'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'Palo Alto PA-440 by HTTP'
                    key: 'pan.pa440.if.sw.packets.in.drops.rate[{#VSYS}, {#IFNAME}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'Palo Alto PA-440 by HTTP'
                    key: 'pan.pa440.if.sw.packets.in.errors.rate[{#VSYS}, {#IFNAME}]'
          timeout: '{$PAN.PA440.TIMEOUT}'
          url: '{$PAN.PA440.API.URL}'
          query_fields:
            - name: type
              value: op
            - name: cmd
              value: '<show><interface>logical</interface></show>'
          status_codes: ''
          http_proxy: '{$PAN.PA440.HTTP_PROXY}'
          preprocessing:
            - type: XML_TO_JSON
            - type: JAVASCRIPT
              parameters:
                - |
                  var interfaces = JSON.parse(value),
                  	result;
                  
                  if (Array.isArray(interfaces.response.result.ifnet.entry) && interfaces.response.result.ifnet.entry.length > 0) {
                  	result = interfaces.response.result.ifnet.entry.map(function (interface) {
                  		return {
                  			'{#IFNAME}': interface.name,
                  			'{#VSYS}': interface.vsys,
                  			'{#IFZONE}': interface.zone !== null ? interface.zone : "null"
                  		};
                  	});
                  
                  	return JSON.stringify(result);
                  }
                  
                  return JSON.stringify([]);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
          overrides:
            - name: 'Add zone tag'
              step: '1'
              filter:
                conditions:
                  - macro: '{#IFZONE}'
                    value: ^null$
                    operator: NOT_MATCHES_REGEX
              operations:
                - operator: REGEXP
                  value: .+
                  tags:
                    - tag: zone
                      value: '{#IFZONE}'
        - uuid: 337aa791737645bfa8d5fcd5958651ab
          name: 'License discovery'
          type: DEPENDENT
          key: pan.pa440.licenses.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#DESCRIPTION}'
                value: '{$PAN.PA440.LICENSE.DESC.MATCHES}'
              - macro: '{#DESCRIPTION}'
                value: '{$PAN.PA440.LICENSE.DESC.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#EXPIRES}'
                value: Never
                operator: NOT_MATCHES_REGEX
              - macro: '{#FEATURE}'
                value: '{$PAN.PA440.LICENSE.FEATURE.MATCHES}'
              - macro: '{#FEATURE}'
                value: '{$PAN.PA440.LICENSE.FEATURE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          description: 'Discovers licenses installed on the device. Only the licenses with an expiration date are discovered.'
          item_prototypes:
            - uuid: 1ba835176e0d4adc8b7dc7b87926df3d
              name: 'License [{#FEATURE}]: Expired'
              type: DEPENDENT
              key: 'pan.pa440.license.expired[{#FEATURE}]'
              description: 'Indicates whether the license `{#DESCRIPTION}` has expired.'
              valuemap:
                name: Boolean
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.data[?(@.feature == "{#FEATURE}")].expired.first()'
                - type: BOOL_TO_DECIMAL
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
              master_item:
                key: pan.pa440.licenses.get
              tags:
                - tag: component
                  value: license
              trigger_prototypes:
                - uuid: 7afa85f66ba8421d89dde638c55ac051
                  expression: 'last(/Palo Alto PA-440 by HTTP/pan.pa440.license.expired[{#FEATURE}])=1'
                  name: 'PA-440: License [{#FEATURE}]: Has expired'
                  opdata: 'Current license state: {ITEM.LASTVALUE}'
                  priority: HIGH
                  description: 'The license `{#DESCRIPTION}` has expired.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 0ac5de4e64224f1a994690d2d6662a04
              name: 'License [{#FEATURE}]: Expires on'
              type: DEPENDENT
              key: 'pan.pa440.license.expires[{#FEATURE}]'
              units: unixtime
              description: 'The expiration date for the license `{#DESCRIPTION}`.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.data[?(@.feature == "{#FEATURE}")].expires.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
              master_item:
                key: pan.pa440.licenses.get
              tags:
                - tag: component
                  value: license
              trigger_prototypes:
                - uuid: 5613f1f1fa5943669eb07010e04dee80
                  expression: '(last(/Palo Alto PA-440 by HTTP/pan.pa440.license.expires[{#FEATURE}]) - now())<{$PAN.PA440.LICENSE.EXPIRY.WARN:"{#FEATURE}"}'
                  name: 'PA-440: License [{#FEATURE}]: Expires soon'
                  event_name: 'PA-440: License [{#FEATURE}]: Expires soon (less than {$PAN.PA440.LICENSE.EXPIRY.WARN:"{#FEATURE}"} until it expires)'
                  opdata: 'License expires on: {ITEM.LASTVALUE}'
                  priority: WARNING
                  description: 'The license will expire in less than `{$PAN.PA440.LICENSE.EXPIRY.WARN:"{#FEATURE}"}`.'
                  tags:
                    - tag: scope
                      value: availability
          master_item:
            key: pan.pa440.licenses.get
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var licenses = JSON.parse(value),
                  	result = [];
                  
                  result = licenses.response.data.map(function (license) {
                  	return {
                  		'{#FEATURE}': license.feature,
                  		'{#DESCRIPTION}': license.description,
                  		'{#EXPIRES}': license.expires
                  	}
                  });
                  
                  return JSON.stringify(result);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
        - uuid: ddce2171fab146b180616efe16884fc7
          name: 'OSPF neighbor discovery'
          type: DEPENDENT
          key: pan.pa440.ospf.neighbor.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#NEIGHBORADDR}'
                value: '{$PAN.PA440.OSPF.NEIGHBOR.ADDR.MATCHES}'
              - macro: '{#NEIGHBORADDR}'
                value: '{$PAN.PA440.OSPF.NEIGHBOR.ADDR.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#NEIGHBORAREA}'
                value: '{$PAN.PA440.OSPF.NEIGHBOR.AREA.MATCHES}'
              - macro: '{#NEIGHBORAREA}'
                value: '{$PAN.PA440.OSPF.NEIGHBOR.AREA.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Discovers OSPF neighbors.'
          item_prototypes:
            - uuid: 2d7fccc0df1141c28bf28a7c2553237e
              name: 'OSPF neighbor [{#NEIGHBORADDR}]: Status'
              type: DEPENDENT
              key: 'pan.pa440.ospf.neighbor.status[{#NEIGHBORAREA}, {#NEIGHBORADDR}]'
              value_type: CHAR
              description: 'The current state of the OSPF neighbor.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.data[?(@[''neighbor-address''] == "{#NEIGHBORADDR}")].status.first()'
              master_item:
                key: pan.pa440.ospf.neighbors.get
              tags:
                - tag: component
                  value: network
                - tag: component
                  value: ospf
                - tag: neighbor-address
                  value: '{#NEIGHBORADDR}'
                - tag: neighbor-area
                  value: '{#NEIGHBORAREA}'
              trigger_prototypes:
                - uuid: 25be340cf3f446dda2497627bb228e8b
                  expression: '{$PAN.PA440.OSPF.CONTROL:"{#NEIGHBORADDR}"}=1 and nodata(/Palo Alto PA-440 by HTTP/pan.pa440.ospf.neighbor.status[{#NEIGHBORAREA}, {#NEIGHBORADDR}],5m)=1'
                  name: 'PA-440: OSPF neighbor [{#NEIGHBORADDR}]: Neighbor is not found anymore'
                  priority: HIGH
                  description: 'The neighbor is not found anymore and the neighborship is gone. Please investigate if this is planned.'
                  tags:
                    - tag: scope
                      value: availability
                - uuid: b8b45278b4e8421b8c7289dfb54f331e
                  expression: '{$PAN.PA440.OSPF.CONTROL:"{#NEIGHBORADDR}"}=1 and last(/Palo Alto PA-440 by HTTP/pan.pa440.ospf.neighbor.status[{#NEIGHBORAREA}, {#NEIGHBORADDR}])<>"full" and last(/Palo Alto PA-440 by HTTP/pan.pa440.ospf.neighbor.status[{#NEIGHBORAREA}, {#NEIGHBORADDR}])<>"2way"'
                  name: 'PA-440: OSPF neighbor [{#NEIGHBORADDR}]: Status is not full or 2way'
                  opdata: 'Current status: {ITEM.LASTVALUE}'
                  priority: HIGH
                  description: 'The status of the neighbor is not "full" or "2way". This may indicate issues with the OSPF session.'
                  tags:
                    - tag: scope
                      value: availability
          master_item:
            key: pan.pa440.ospf.neighbors.get
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var ospf_neighbors = JSON.parse(value),
                  	result = [];
                  
                  result = ospf_neighbors.response.data.map(function (neighbor) {
                  	return {
                  		'{#NEIGHBORADDR}': neighbor['neighbor-address'],
                  		'{#NEIGHBORAREA}': neighbor['area-id']
                  	}
                  });
                  
                  return JSON.stringify(result);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
        - uuid: 3f466e987bb841b2a941feeaa6551f59
          name: 'OSPFv3 neighbor discovery'
          type: DEPENDENT
          key: pan.pa440.ospfv3.neighbor.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#NEIGHBORADDR}'
                value: '{$PAN.PA440.OSPFV3.NEIGHBOR.ADDR.MATCHES}'
              - macro: '{#NEIGHBORADDR}'
                value: '{$PAN.PA440.OSPFV3.NEIGHBOR.ADDR.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#NEIGHBORAREA}'
                value: '{$PAN.PA440.OSPFV3.NEIGHBOR.AREA.MATCHES}'
              - macro: '{#NEIGHBORAREA}'
                value: '{$PAN.PA440.OSPFV3.NEIGHBOR.AREA.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Discovers OSPFv3 neighbors.'
          item_prototypes:
            - uuid: 4a227a5e31d34affb5008d6018f711de
              name: 'OSPFv3 neighbor [{#NEIGHBORADDR}]: Status'
              type: DEPENDENT
              key: 'pan.pa440.ospfv3.neighbor.status[{#NEIGHBORAREA}, {#NEIGHBORADDR}]'
              value_type: CHAR
              description: 'The current status of the OSPFv3 neighbor.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.response.data[?(@[''neighbor-link-local''] == "{#NEIGHBORADDR}")].state.first()'
              master_item:
                key: pan.pa440.ospfv3.neighbors.get
              tags:
                - tag: component
                  value: network
                - tag: component
                  value: ospfv3
                - tag: neighbor-address
                  value: '{#NEIGHBORADDR}'
                - tag: neighbor-area
                  value: '{#NEIGHBORAREA}'
              trigger_prototypes:
                - uuid: d554fa457f5549d5ae8f991abc4841f4
                  expression: '{$PAN.PA440.OSPFV3.CONTROL:"{#NEIGHBORADDR}"}=1 and nodata(/Palo Alto PA-440 by HTTP/pan.pa440.ospfv3.neighbor.status[{#NEIGHBORAREA}, {#NEIGHBORADDR}],5m)=1'
                  name: 'PA-440: OSPFv3 neighbor [{#NEIGHBORADDR}]: Neighbor is not found anymore'
                  priority: HIGH
                  description: 'The neighbor is not found anymore and the neighborship is gone. Please investigate if this is planned.'
                  tags:
                    - tag: scope
                      value: availability
                - uuid: d05690d42a264dffa07f33983bc85f59
                  expression: '{$PAN.PA440.OSPFV3.CONTROL:"{#NEIGHBORADDR}"}=1 and last(/Palo Alto PA-440 by HTTP/pan.pa440.ospfv3.neighbor.status[{#NEIGHBORAREA}, {#NEIGHBORADDR}])<>"full" and last(/Palo Alto PA-440 by HTTP/pan.pa440.ospfv3.neighbor.status[{#NEIGHBORAREA}, {#NEIGHBORADDR}])<>"2way"'
                  name: 'PA-440: OSPFv3 neighbor [{#NEIGHBORADDR}]: Status is not full or 2way'
                  opdata: 'Current status: {ITEM.LASTVALUE}'
                  priority: HIGH
                  description: 'The status of the neighbor is not "full" or "2way". This may indicate issues with the OSPF session.'
                  tags:
                    - tag: scope
                      value: availability
          master_item:
            key: pan.pa440.ospfv3.neighbors.get
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var ospfv3_neighbors = JSON.parse(value),
                  	result = [];
                  
                  result = ospfv3_neighbors.response.data.map(function (neighbor) {
                  	return {
                  		'{#NEIGHBORADDR}': neighbor['neighbor-link-local'],
                  		'{#NEIGHBORAREA}': neighbor['area-id']
                  	}
                  });
                  
                  return JSON.stringify(result);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 3h
      tags:
        - tag: class
          value: network
        - tag: target
          value: pa-440
        - tag: target
          value: paloalto
      macros:
        - macro: '{$PAN.PA440.API.URL}'
          description: 'The firewall XML API endpoint in the format `<scheme>://<host>[:port]/api` (port is optional).'
        - macro: '{$PAN.PA440.BGP.CONTROL}'
          value: '1'
          description: 'The BGP session triggers will fire only for peers where the context macro equals "1".'
        - macro: '{$PAN.PA440.BGP.PEER.GROUP.MATCHES}'
          value: .+
          description: 'The BGP peer group regex filter to use in BGP peer discovery - for including.'
        - macro: '{$PAN.PA440.BGP.PEER.GROUP.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The BGP peer group regex filter to use in BGP peer discovery - for excluding.'
        - macro: '{$PAN.PA440.BGP.PEER.NAME.MATCHES}'
          value: .+
          description: 'The BGP peer name regex filter to use in BGP peer discovery - for including.'
        - macro: '{$PAN.PA440.BGP.PEER.NAME.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The BGP peer name regex filter to use in BGP peer discovery - for excluding.'
        - macro: '{$PAN.PA440.CERT.DEVICE.EXPIRY.WARN}'
          value: 7d
          description: 'The time threshold until the device certificate expires; used in the device certificate expiry trigger. Can be set to an evaluation period in seconds (time suffixes can be used).'
        - macro: '{$PAN.PA440.CERT.EXPIRY.WARN}'
          value: 7d
          description: 'The time threshold until the certificate expires; used in the certificate expiry trigger. Can be set to an evaluation period in seconds (time suffixes can be used). Can be used with the certificate name as context.'
        - macro: '{$PAN.PA440.CERT.NAME.MATCHES}'
          value: .+
          description: 'The certificate name regex filter to use in certificate discovery - for including.'
        - macro: '{$PAN.PA440.CERT.NAME.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The certificate name regex filter to use in certificate discovery - for excluding.'
        - macro: '{$PAN.PA440.HA.CONFIG_SYNC.THRESH}'
          value: '#1'
          description: 'The threshold for the configuration synchronization trigger. Can be set to an evaluation period in seconds (time suffixes can be used) or an evaluation range of the latest collected values (if preceded by a hash mark).'
        - macro: '{$PAN.PA440.HA.STATE.IGNORE_USER_SUSPENDED}'
          value: '1'
          description: 'Controls whether the HA "suspended" state trigger should fire if the state is caused by the user request. "1" - ignored, "0" - not ignored.'
        - macro: '{$PAN.PA440.HTTP_PROXY}'
          description: 'The HTTP proxy for HTTP agent items (set if needed). If the macro is empty, then no proxy is used.'
        - macro: '{$PAN.PA440.IF.HW.CONTROL}'
          value: '1'
          description: 'The link status triggers will fire only for hardware interfaces where the context macro equals "1".'
        - macro: '{$PAN.PA440.IF.HW.ERRORS.WARN}'
          value: '2'
          description: 'The warning threshold of the packet error rate for hardware interfaces. Can be used with the hardware interface name as context.'
        - macro: '{$PAN.PA440.IF.HW.IFNAME.MATCHES}'
          value: .+
          description: 'The interface name regex filter to use in hardware interface discovery - for including.'
        - macro: '{$PAN.PA440.IF.HW.IFNAME.NOT_MATCHES}'
          value: '^(?:tunnel|vlan|loopback)$'
          description: 'The interface name regex filter to use in hardware interface discovery - for excluding.'
        - macro: '{$PAN.PA440.IF.HW.UTIL.MAX}'
          value: '90'
          description: 'The threshold in the hardware interface utilization triggers.'
        - macro: '{$PAN.PA440.IF.SW.ERRORS.WARN}'
          value: '2'
          description: 'The warning threshold of the packet error rate for logical interfaces. Can be used with the logical interface name as context.'
        - macro: '{$PAN.PA440.IF.SW.IFNAME.MATCHES}'
          value: .+
          description: 'The interface name regex filter to use in logical interface discovery - for including.'
        - macro: '{$PAN.PA440.IF.SW.IFNAME.NOT_MATCHES}'
          value: '^(?:tunnel|vlan|loopback)$'
          description: 'The interface name regex filter to use in logical interface discovery - for excluding.'
        - macro: '{$PAN.PA440.IF.SW.IFZONE.MATCHES}'
          value: .+
          description: 'The interface zone name regex filter to use in logical interface discovery - for including.'
        - macro: '{$PAN.PA440.IF.SW.IFZONE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The interface zone name regex filter to use in logical interface discovery - for excluding.'
        - macro: '{$PAN.PA440.IF.SW.VSYS.MATCHES}'
          value: .+
          description: 'The interface virtual system name regex filter to use in logical interface discovery - for including.'
        - macro: '{$PAN.PA440.IF.SW.VSYS.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The interface virtual system name regex filter to use in logical interface discovery - for excluding.'
        - macro: '{$PAN.PA440.LICENSE.DESC.MATCHES}'
          value: .+
          description: 'The license feature description regex filter to use in license discovery - for including.'
        - macro: '{$PAN.PA440.LICENSE.DESC.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The license feature description regex filter to use in license discovery - for excluding.'
        - macro: '{$PAN.PA440.LICENSE.EXPIRY.WARN}'
          value: 7d
          description: 'The time threshold until the license expires; used in the license expiry trigger. Can be set to an evaluation period in seconds (time suffixes can be used). Can be used with the license feature name as context.'
        - macro: '{$PAN.PA440.LICENSE.FEATURE.MATCHES}'
          value: .+
          description: 'The license feature name regex filter to use in license discovery - for including.'
        - macro: '{$PAN.PA440.LICENSE.FEATURE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The license feature name regex filter to use in license discovery - for excluding.'
        - macro: '{$PAN.PA440.OSPF.CONTROL}'
          value: '1'
          description: 'The OSPF neighbor triggers will fire only for neighbors where the context macro equals "1".'
        - macro: '{$PAN.PA440.OSPF.NEIGHBOR.ADDR.MATCHES}'
          value: .+
          description: 'The OSPF neighbor address regex filter to use in OSPF neighbor discovery - for including.'
        - macro: '{$PAN.PA440.OSPF.NEIGHBOR.ADDR.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The OSPF neighbor address regex filter to use in OSPF neighbor discovery - for excluding.'
        - macro: '{$PAN.PA440.OSPF.NEIGHBOR.AREA.MATCHES}'
          value: .+
          description: 'The OSPF neighbor area regex filter to use in OSPF neighbor discovery - for including.'
        - macro: '{$PAN.PA440.OSPF.NEIGHBOR.AREA.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The OSPF neighbor area regex filter to use in OSPF neighbor discovery - for excluding.'
        - macro: '{$PAN.PA440.OSPFV3.CONTROL}'
          value: '1'
          description: 'The OSPFv3 neighbor triggers will fire only for neighbors where the context macro equals "1".'
        - macro: '{$PAN.PA440.OSPFV3.NEIGHBOR.ADDR.MATCHES}'
          value: .+
          description: 'The OSPFv3 neighbor address regex filter to use in OSPFv3 neighbor discovery - for including.'
        - macro: '{$PAN.PA440.OSPFV3.NEIGHBOR.ADDR.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The OSPFv3 neighbor address regex filter to use in OSPFv3 neighbor discovery - for excluding.'
        - macro: '{$PAN.PA440.OSPFV3.NEIGHBOR.AREA.MATCHES}'
          value: .+
          description: 'The OSPFv3 neighbor area regex filter to use in OSPFv3 neighbor discovery - for including.'
        - macro: '{$PAN.PA440.OSPFV3.NEIGHBOR.AREA.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'The OSPFv3 neighbor area regex filter to use in OSPFv3 neighbor discovery - for excluding.'
        - macro: '{$PAN.PA440.PASSWORD}'
          type: SECRET_TEXT
          description: 'The password of the user that is used for monitoring.'
        - macro: '{$PAN.PA440.TIMEOUT}'
          value: 15s
          description: 'The timeout threshold for the HTTP items that retrieve data from the API.'
        - macro: '{$PAN.PA440.USER}'
          value: zbx_monitor
          description: 'The name of the user that is used for monitoring.'
      dashboards:
        - uuid: e5df35b446eb4ad8a5b831595505ba82
          name: 'PA-440: Overview'
          auto_start: 'NO'
          pages:
            - name: 'PA-440: Overview'
              widgets:
                - type: item
                  name: 'Host name'
                  width: '18'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_size
                      value: '25'
                    - type: STRING
                      name: description
                      value: 'Host name'
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.hostname
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '25'
                - type: item
                  name: 'App-ID version'
                  'y': '3'
                  width: '18'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_size
                      value: '25'
                    - type: STRING
                      name: description
                      value: 'App-ID version'
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.app_id.version
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '25'
                - type: item
                  name: 'CPU temperature'
                  'y': '6'
                  width: '9'
                  height: '4'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_size
                      value: '25'
                    - type: STRING
                      name: description
                      value: 'CPU temperature'
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_size
                      value: '13'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.cpu.temp
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_size
                      value: '15'
                    - type: INTEGER
                      name: value_size
                      value: '25'
                - type: item
                  name: 'Management Plane: CPU utilization'
                  'y': '10'
                  width: '9'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: description
                      value: |
                        Management Plane:
                        CPU utilization
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.management_plane.cpu.util
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_size
                      value: '15'
                    - type: INTEGER
                      name: value_size
                      value: '35'
                - type: item
                  name: 'Data Plane: CPU utilization'
                  'y': '13'
                  width: '9'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: description
                      value: |
                        Data Plane:
                        CPU utilization
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.data_plane.cpu.util
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_size
                      value: '15'
                    - type: INTEGER
                      name: value_size
                      value: '35'
                - type: item
                  name: 'Session table utilization'
                  'y': '16'
                  width: '9'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: description
                      value: |
                        Session table
                        utilization
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.sessions.table_util
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_size
                      value: '15'
                    - type: INTEGER
                      name: value_size
                      value: '35'
                - type: svggraph
                  name: 'CPU temperature'
                  x: '9'
                  'y': '6'
                  width: '63'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color.0
                      value: 33CD35
                    - type: INTEGER
                      name: ds.0.dataset_type
                      value: '0'
                    - type: ITEM
                      name: ds.0.itemids.0
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.cpu.temp
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: CMATO
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: svggraph
                  name: 'CPU utilization'
                  x: '9'
                  'y': '10'
                  width: '63'
                  height: '6'
                  fields:
                    - type: STRING
                      name: ds.0.color.0
                      value: 33CD35
                    - type: STRING
                      name: ds.0.color.1
                      value: 1976D2
                    - type: INTEGER
                      name: ds.0.dataset_type
                      value: '0'
                    - type: ITEM
                      name: ds.0.itemids.0
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.data_plane.cpu.util
                    - type: ITEM
                      name: ds.0.itemids.1
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.management_plane.cpu.util
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: STRING
                      name: lefty_max
                      value: '100'
                    - type: STRING
                      name: lefty_min
                      value: '0'
                    - type: INTEGER
                      name: legend_lines
                      value: '2'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: UZDOW
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: svggraph
                  name: Sessions
                  x: '9'
                  'y': '16'
                  width: '63'
                  height: '6'
                  fields:
                    - type: STRING
                      name: ds.0.color.0
                      value: 33CD35
                    - type: STRING
                      name: ds.0.color.1
                      value: 1976D2
                    - type: STRING
                      name: ds.0.color.2
                      value: FF465C
                    - type: STRING
                      name: ds.0.color.3
                      value: B39DDB
                    - type: STRING
                      name: ds.0.color.4
                      value: 546E7A
                    - type: INTEGER
                      name: ds.0.dataset_type
                      value: '0'
                    - type: INTEGER
                      name: ds.0.fill
                      value: '0'
                    - type: ITEM
                      name: ds.0.itemids.0
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.sessions.active.total
                    - type: ITEM
                      name: ds.0.itemids.1
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.sessions.icmp.active
                    - type: ITEM
                      name: ds.0.itemids.2
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.sessions.supported.total
                    - type: ITEM
                      name: ds.0.itemids.3
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.sessions.tcp.active
                    - type: ITEM
                      name: ds.0.itemids.4
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.sessions.udp.active
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: STRING
                      name: lefty_max
                      value: '100'
                    - type: STRING
                      name: lefty_min
                      value: '0'
                    - type: INTEGER
                      name: legend_lines
                      value: '5'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: YBKLR
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: item
                  name: Uptime
                  x: '18'
                  width: '18'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_size
                      value: '25'
                    - type: STRING
                      name: description
                      value: Uptime
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.uptime
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '25'
                - type: item
                  name: 'Global Protect Client Package version'
                  x: '18'
                  'y': '3'
                  width: '18'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_size
                      value: '25'
                    - type: STRING
                      name: description
                      value: 'Global Protect Client Package version'
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.gp.client.version
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '25'
                - type: item
                  name: 'PAN-OS version'
                  x: '36'
                  width: '18'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_size
                      value: '25'
                    - type: STRING
                      name: description
                      value: 'PAN-OS version'
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.os.version
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '25'
                - type: item
                  name: 'Threat version'
                  x: '36'
                  'y': '3'
                  width: '18'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_size
                      value: '25'
                    - type: STRING
                      name: description
                      value: 'Threat version'
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.threat.version
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '25'
                - type: item
                  name: 'Serial number'
                  x: '54'
                  width: '18'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_size
                      value: '25'
                    - type: STRING
                      name: description
                      value: 'Serial number'
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.serial_number
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '25'
                - type: item
                  name: 'URL filtering version'
                  x: '54'
                  'y': '3'
                  width: '18'
                  height: '3'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: decimal_size
                      value: '25'
                    - type: STRING
                      name: description
                      value: 'URL filtering version'
                    - type: INTEGER
                      name: desc_bold
                      value: '1'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Palo Alto PA-440 by HTTP'
                        key: pan.pa440.url_filtering.version
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '25'
            - name: 'PA-440: High availability'
              widgets:
                - type: honeycomb
                  name: 'HA status'
                  width: '72'
                  height: '7'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'HA*'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '3'
                    - type: STRING
                      name: item_tags.0.tag
                      value: component
                    - type: STRING
                      name: item_tags.0.value
                      value: ha-link
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: INTEGER
                      name: primary_label_bold
                      value: '1'
                    - type: STRING
                      name: reference
                      value: LIIYW
                    - type: INTEGER
                      name: secondary_label_units_show
                      value: '0'
                - type: honeycomb
                  name: 'HA links status'
                  'y': '7'
                  width: '72'
                  height: '7'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'HA*'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: component
                    - type: STRING
                      name: item_tags.0.value
                      value: ha-link
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: INTEGER
                      name: primary_label_bold
                      value: '1'
                    - type: STRING
                      name: reference
                      value: UUYVO
                    - type: INTEGER
                      name: secondary_label_units_show
                      value: '0'
            - name: 'PA-440: Hardware interfaces'
              widgets:
                - type: honeycomb
                  name: 'Interface status'
                  width: '72'
                  height: '6'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Interface [*]: Status'
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: STRING
                      name: reference
                      value: XPPXE
                - type: svggraph
                  name: 'Incoming traffic, per second'
                  'y': '6'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: '006274'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Interface [*]: Bits received'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: INTEGER
                      name: legend_lines
                      value: '5'
                    - type: INTEGER
                      name: legend_lines_mode
                      value: '1'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: BKLSC
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: svggraph
                  name: 'Inbound packets discarded, per second'
                  'y': '11'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 9C640A
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Interface [*]: Inbound packets discarded, per second'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: INTEGER
                      name: legend_lines
                      value: '5'
                    - type: INTEGER
                      name: legend_lines_mode
                      value: '1'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: MCEQW
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: svggraph
                  name: 'Outbound packets with errors, per second'
                  'y': '16'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 33309A
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Interface [*]: Outbound packets with errors, per second'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: INTEGER
                      name: legend_lines
                      value: '5'
                    - type: INTEGER
                      name: legend_lines_mode
                      value: '1'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: JJHYR
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: svggraph
                  name: 'Outgoing traffic, per second'
                  x: '36'
                  'y': '6'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: B51B1B
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Interface [*]: Bits sent'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: INTEGER
                      name: legend_lines
                      value: '5'
                    - type: INTEGER
                      name: legend_lines_mode
                      value: '1'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: EZSOH
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: svggraph
                  name: 'Inbound packets with errors, per second'
                  x: '36'
                  'y': '11'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: D73DEB
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Interface [*]: Inbound packets with errors, per second'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: INTEGER
                      name: legend_lines
                      value: '5'
                    - type: INTEGER
                      name: legend_lines_mode
                      value: '1'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: IFNOL
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: working_time
                      value: '1'
            - name: 'PA-440: Logical interfaces'
              widgets:
                - type: svggraph
                  name: 'Incoming traffic, per second'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: '006274'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'VSYS [*]: Interface [*]: Bits received'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: INTEGER
                      name: legend_lines
                      value: '5'
                    - type: INTEGER
                      name: legend_lines_mode
                      value: '1'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: GMLGQ
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: svggraph
                  name: 'Inbound packets dropped, per second'
                  'y': '5'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 9C640A
                    - type: STRING
                      name: ds.0.items.0
                      value: 'VSYS [*]: Interface [*]: Inbound packets dropped, per second'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: INTEGER
                      name: legend_lines
                      value: '5'
                    - type: INTEGER
                      name: legend_lines_mode
                      value: '1'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: GFVBV
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: svggraph
                  name: 'Outgoing traffic, per second'
                  x: '36'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: B51B1B
                    - type: STRING
                      name: ds.0.items.0
                      value: 'VSYS [*]: Interface [*]: Bits sent'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: INTEGER
                      name: legend_lines
                      value: '5'
                    - type: INTEGER
                      name: legend_lines_mode
                      value: '1'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: OVKRL
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: svggraph
                  name: 'Inbound packets with errors, per second'
                  x: '36'
                  'y': '5'
                  width: '36'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: D73DEB
                    - type: STRING
                      name: ds.0.items.0
                      value: 'VSYS [*]: Interface [*]: Inbound packets with errors, per second'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: INTEGER
                      name: legend_lines
                      value: '5'
                    - type: INTEGER
                      name: legend_lines_mode
                      value: '1'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: JGICJ
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: working_time
                      value: '1'
            - name: 'PA-440: BGP peers'
              widgets:
                - type: honeycomb
                  name: 'BGP peer status'
                  width: '72'
                  height: '7'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'BGP peer [*]: Status'
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: STRING
                      name: reference
                      value: LCIXC
                    - type: INTEGER
                      name: secondary_label_units_show
                      value: '0'
            - name: 'PA-440: OSPF neighbors'
              widgets:
                - type: honeycomb
                  name: 'OSPF neighbor status'
                  width: '72'
                  height: '7'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'OSPF neighbor [*]: Status'
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: STRING
                      name: reference
                      value: QLHBH
                    - type: INTEGER
                      name: secondary_label_units_show
                      value: '0'
            - name: 'PA-440: OSPFv3 neighbors'
              widgets:
                - type: honeycomb
                  name: 'OSPFv3 neighbor status'
                  width: '72'
                  height: '7'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'OSPFv3 neighbor [*]: Status'
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: STRING
                      name: reference
                      value: QLHBJ
                    - type: INTEGER
                      name: secondary_label_units_show
                      value: '0'
      valuemaps:
        - uuid: 8f6bef0b83a440ec9e54676840809c47
          name: 'BGP peer status'
          mappings:
            - value: '0'
              newvalue: Idle
            - value: '1'
              newvalue: Connect
            - value: '2'
              newvalue: Active
            - value: '3'
              newvalue: OpenSent
            - value: '4'
              newvalue: OpenConfirm
            - value: '5'
              newvalue: Established
            - value: '6'
              newvalue: Unknown
        - uuid: 75f5d630b1b74c7c8233b44422bba5eb
          name: Boolean
          mappings:
            - value: '0'
              newvalue: 'false'
            - value: '1'
              newvalue: 'true'
        - uuid: 1ce2f4a43b274e719e9e44d24cb826bd
          name: 'HA mode'
          mappings:
            - value: '0'
              newvalue: Active-Passive
            - value: '1'
              newvalue: Active-Active
            - value: '2'
              newvalue: Unknown
        - uuid: 3148f488405c4c3a8ca055891550bda1
          name: 'HA state'
          mappings:
            - value: '0'
              newvalue: initial
            - value: '1'
              newvalue: active
            - value: '2'
              newvalue: passive
            - value: '3'
              newvalue: active-primary
            - value: '4'
              newvalue: active-secondary
            - value: '5'
              newvalue: tentative
            - value: '6'
              newvalue: non-functional
            - value: '7'
              newvalue: suspended
            - value: '8'
              newvalue: unknown
