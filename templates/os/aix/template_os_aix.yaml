zabbix_export:
  version: '7.4'
  template_groups:
    - uuid: 846977d1dfed4968bc5f8bdb363285bc
      name: 'Templates/Operating systems'
  templates:
    - uuid: 7e6bb0931a72459db9514aa924b420bc
      template: 'AIX by Zabbix agent'
      name: 'AIX by Zabbix agent'
      description: |
        This is an official AIX template. It requires Zabbix agent 7.4 or newer.
        
        Notes on filesystem (FS) discovery:
          - The ext4/3/2 FS reserves space for privileged usage, typically set at 5% by default.
          - BTRFS allocates a default of 10% of the volume for its own needs.
          - To mitigate potential disasters, FS usage triggers are based on the maximum available space.
            - Utilization formula: 'pused = 100 - 100 * (available / total - free + available)'
          - The FS utilization chart, derived from graph prototypes, reflects FS reserved space as the difference between used and available space from the total volume.
        
        You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/
        
        Generated by official Zabbix template tool "Templator"
      vendor:
        name: Zabbix
        version: 7.4-1
      groups:
        - name: 'Templates/Operating systems'
      items:
        - uuid: 4c80c15f5741464882aa238f27bec1bd
          name: 'Host name of Zabbix agent running'
          key: agent.hostname
          delay: 1h
          value_type: CHAR
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
        - uuid: 05849e0fb6504d339f2aebe159427bec
          name: 'Zabbix agent ping'
          key: agent.ping
          description: 'The agent always returns "1" for this item. May be used in combination with `nodata()` for the availability check.'
          valuemap:
            name: 'Zabbix agent ping status'
          tags:
            - tag: component
              value: system
        - uuid: fe4731720ba64eebbf125929e499209b
          name: 'Version of Zabbix agent running'
          key: agent.version
          delay: 1h
          value_type: CHAR
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: application
        - uuid: 2c2d08ab5833493ba45ebfe5154f04c1
          name: 'Number of running processes'
          key: 'proc.num[,,run]'
          description: 'Number of processes in a running state.'
          tags:
            - tag: component
              value: os
            - tag: component
              value: processes
          triggers:
            - uuid: 458180bc0f14468386429964f877cce7
              expression: 'avg(/AIX by Zabbix agent/proc.num[,,run],5m)>30'
              name: 'AIX: Too many processes running'
              priority: WARNING
              tags:
                - tag: scope
                  value: performance
        - uuid: 7c64480f840a4778bde5278e1c0a083f
          name: 'Number of processes'
          key: 'proc.num[]'
          description: 'Total number of processes in any state.'
          tags:
            - tag: component
              value: os
            - tag: component
              value: processes
          triggers:
            - uuid: 874ef8fe4a6445ff971800d2d9a50541
              expression: 'avg(/AIX by Zabbix agent/proc.num[],5m)>300'
              name: 'AIX: Too many processes'
              priority: WARNING
              tags:
                - tag: scope
                  value: performance
        - uuid: 4a15778222a24f129b8ae7c240a32ded
          name: 'Interrupts per second'
          key: system.cpu.intr
          units: ips
          description: 'Number of interrupts processed.'
          preprocessing:
            - type: CHANGE_PER_SECOND
          tags:
            - tag: component
              value: cpu
        - uuid: 4f8665f48aff4fa39e85639fed7b71c5
          name: 'Processor load (1 min average per core)'
          key: 'system.cpu.load[percpu,avg1]'
          value_type: FLOAT
          description: 'Calculated as the system CPU load divided by the number of CPU cores.'
          tags:
            - tag: component
              value: cpu
          triggers:
            - uuid: fdbedf15fe474fd18c045c62cf8cc7d6
              expression: 'avg(/AIX by Zabbix agent/system.cpu.load[percpu,avg1],5m)>5'
              name: 'AIX: Processor load is too high'
              priority: WARNING
              tags:
                - tag: scope
                  value: performance
        - uuid: 6fa2275f1f83456abfe786c8565c7a2d
          name: 'Processor load (5 min average per core)'
          key: 'system.cpu.load[percpu,avg5]'
          value_type: FLOAT
          description: 'Calculated as the system CPU load divided by the number of CPU cores.'
          tags:
            - tag: component
              value: cpu
        - uuid: 02210ac2faaa4f7bb74e995726706abc
          name: 'Processor load (15 min average per core)'
          key: 'system.cpu.load[percpu,avg15]'
          value_type: FLOAT
          description: 'Calculated as the system CPU load divided by the number of CPU cores.'
          tags:
            - tag: component
              value: cpu
        - uuid: 1ad486947da9428abdebcecb83ca3d8b
          name: 'Context switches per second'
          key: system.cpu.switches
          units: sps
          description: 'The combined rate at which all processors on the computer are switched from one thread to another.'
          preprocessing:
            - type: CHANGE_PER_SECOND
          tags:
            - tag: component
              value: cpu
        - uuid: f4d10d49fa3c4dababf03d2cb80f044c
          name: 'Host name'
          key: system.hostname
          delay: 1h
          value_type: CHAR
          description: 'The host name of the system.'
          inventory_link: NAME
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: os
          triggers:
            - uuid: d1e70b7f465447a3ab575b3fd28755a1
              expression: 'last(/AIX by Zabbix agent/system.hostname,#1)<>last(/AIX by Zabbix agent/system.hostname,#2)'
              name: 'AIX: Hostname was changed'
              priority: INFO
              tags:
                - tag: scope
                  value: notice
        - uuid: aebc5bb0264a4f55985c96445964dfc4
          name: 'Host local time'
          key: system.localtime
          units: unixtime
          description: 'The local system time of the host.'
          tags:
            - tag: component
              value: os
        - uuid: 081f8986446d43e7a3b72f7084576600
          name: 'CPU available physical processors in the shared pool'
          key: 'system.stat[cpu,app]'
          value_type: FLOAT
          units: '%'
          tags:
            - tag: component
              value: cpu
        - uuid: 6a97d56a6c2e45e1b10b97e2395ff30d
          name: 'CPU entitled capacity consumed'
          key: 'system.stat[cpu,ec]'
          value_type: FLOAT
          tags:
            - tag: component
              value: cpu
        - uuid: 142f33d7b2c3469c9664fedf4f053616
          name: 'CPU idle time'
          key: 'system.stat[cpu,id]'
          value_type: FLOAT
          units: '%'
          tags:
            - tag: component
              value: cpu
        - uuid: 752c952fb18e4a0e8e5e3415b107b9f1
          name: 'CPU logical processor utilization'
          key: 'system.stat[cpu,lbusy]'
          value_type: FLOAT
          units: '%'
          tags:
            - tag: component
              value: cpu
        - uuid: 748f1316a33b48658b11dca8f45cfcce
          name: 'CPU number of physical processors consumed'
          key: 'system.stat[cpu,pc]'
          value_type: FLOAT
          tags:
            - tag: component
              value: cpu
        - uuid: 2647132edb6647ca9ef43a00ca09ecbd
          name: 'CPU system time'
          key: 'system.stat[cpu,sy]'
          value_type: FLOAT
          units: '%'
          tags:
            - tag: component
              value: cpu
        - uuid: e990898ddbb74c7b9a8c1c67cb9544cf
          name: 'CPU user time'
          key: 'system.stat[cpu,us]'
          value_type: FLOAT
          units: '%'
          tags:
            - tag: component
              value: cpu
        - uuid: 2cd7a00570ad487d9cdf39fd198b2c0b
          name: 'CPU iowait time'
          key: 'system.stat[cpu,wa]'
          value_type: FLOAT
          units: '%'
          tags:
            - tag: component
              value: cpu
          triggers:
            - uuid: c030cc99975d4fe3911789e58bbd5050
              expression: 'avg(/AIX by Zabbix agent/system.stat[cpu,wa],5m)>20'
              name: 'AIX: Disk I/O is overloaded'
              priority: WARNING
              description: 'Extended OS wait times for I/O operations may signal potential performance issues with the storage system.'
              tags:
                - tag: scope
                  value: performance
        - uuid: 6748e4c87589472ca1474f3c7b729e0c
          name: 'Amount of data transferred'
          key: 'system.stat[disk,bps]'
          value_type: FLOAT
          units: B
          tags:
            - tag: component
              value: storage
        - uuid: bf0180d8f109451db616749990a113a6
          name: 'Number of transfers'
          key: 'system.stat[disk,tps]'
          value_type: FLOAT
          tags:
            - tag: component
              value: storage
        - uuid: 3e1af0261f6a421d8ca554f8eb222716
          name: 'Processor units is entitled to receive'
          key: 'system.stat[ent]'
          delay: 1h
          value_type: FLOAT
          tags:
            - tag: component
              value: cpu
        - uuid: 0fe71698a3c74c93a8cb3a937dc7226c
          name: 'Kernel thread context switches'
          key: 'system.stat[faults,cs]'
          value_type: FLOAT
          tags:
            - tag: component
              value: cpu
        - uuid: a1e13d2dbd8b4086974ea32a2cd743b1
          name: 'Device interrupts'
          key: 'system.stat[faults,in]'
          value_type: FLOAT
          tags:
            - tag: component
              value: cpu
        - uuid: 883c7a12b1d54f4d8189ca0d9cc43102
          name: 'System calls'
          key: 'system.stat[faults,sy]'
          value_type: FLOAT
          tags:
            - tag: component
              value: cpu
        - uuid: f027ed1c43464d4ab9a13d4b9f647e7e
          name: 'Length of the swap queue'
          key: 'system.stat[kthr,b]'
          value_type: FLOAT
          tags:
            - tag: component
              value: memory
        - uuid: 6795c2b6914d4303bf30c71c7405ff7d
          name: 'Length of the run queue'
          key: 'system.stat[kthr,r]'
          value_type: FLOAT
          tags:
            - tag: component
              value: cpu
        - uuid: 12142f133863448c9c937c671e183bbb
          name: 'Active virtual pages'
          key: 'system.stat[memory,avm]'
          tags:
            - tag: component
              value: memory
        - uuid: 3b4a5ff768654ff5a87b955684a0d7b5
          name: 'Free real memory'
          key: 'system.stat[memory,fre]'
          tags:
            - tag: component
              value: memory
        - uuid: bf890bf5cd1748a5af9528a111ba43c4
          name: 'File page-ins per second'
          key: 'system.stat[page,fi]'
          value_type: FLOAT
          tags:
            - tag: component
              value: memory
        - uuid: 19c4f7132b6c46aa9522bd46da3e8f03
          name: 'File page-outs per second'
          key: 'system.stat[page,fo]'
          value_type: FLOAT
          tags:
            - tag: component
              value: memory
        - uuid: 9ff3f7faa76c414aae7c5babb91fe065
          name: 'Pages freed (page replacement)'
          key: 'system.stat[page,fr]'
          value_type: FLOAT
          tags:
            - tag: component
              value: memory
        - uuid: 6009d8a0fc2f486db979b226eb975e78
          name: 'Pages paged in from paging space'
          key: 'system.stat[page,pi]'
          value_type: FLOAT
          tags:
            - tag: component
              value: memory
        - uuid: 26fb1471e08c4c46800e4887d8bccd80
          name: 'Pages paged out to paging space'
          key: 'system.stat[page,po]'
          value_type: FLOAT
          tags:
            - tag: component
              value: memory
        - uuid: 83b1456726d448d6a756e03c0ec02342
          name: 'Pages scanned by page-replacement algorithm'
          key: 'system.stat[page,sr]'
          value_type: FLOAT
          tags:
            - tag: component
              value: memory
        - uuid: d0ef675d313849269890d06c7e003c9e
          name: 'System information'
          key: system.uname
          delay: 1h
          value_type: CHAR
          description: 'Information as normally returned by `uname -a`.'
          inventory_link: OS
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: os
          triggers:
            - uuid: 3a736e64211744aea480a60b2c48a036
              expression: 'last(/AIX by Zabbix agent/system.uname,#1)<>last(/AIX by Zabbix agent/system.uname,#2)'
              name: 'AIX: Host information was changed'
              priority: INFO
              tags:
                - tag: scope
                  value: notice
        - uuid: 2e0ff86c992c4a098af8cb1bee0f0001
          name: 'System uptime'
          key: system.uptime
          delay: 10m
          units: uptime
          tags:
            - tag: component
              value: os
          triggers:
            - uuid: 03a2cd88b6a64d3ea4c9bb2abbc4ae2d
              expression: 'change(/AIX by Zabbix agent/system.uptime)<0'
              name: 'AIX: Server has just been restarted'
              priority: INFO
              tags:
                - tag: scope
                  value: notice
        - uuid: 980a59760ef9481298ed35322841f939
          name: 'Number of logged in users'
          key: system.users.num
          description: 'The number of users who are currently logged in.'
          tags:
            - tag: component
              value: os
        - uuid: 4771d6d33c2247d6843198152a7065a8
          name: 'Checksum of /etc/passwd'
          key: 'vfs.file.cksum[/etc/passwd,sha256]'
          delay: 15m
          value_type: CHAR
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            - tag: component
              value: security
          triggers:
            - uuid: c75ee957fd6c43b2aba9919d5e1af4a1
              expression: 'last(/AIX by Zabbix agent/vfs.file.cksum[/etc/passwd,sha256],#1)<>last(/AIX by Zabbix agent/vfs.file.cksum[/etc/passwd,sha256],#2)'
              name: 'AIX: /etc/passwd has been changed'
              priority: WARNING
              tags:
                - tag: scope
                  value: security
        - uuid: 95e14453e9ee4b6ea036fab09bf2b194
          name: 'Get filesystems'
          key: vfs.fs.get
          history: '0'
          value_type: TEXT
          description: 'The `vfs.fs.get` key acquires raw information set about the filesystems. Later to be extracted by preprocessing in dependent items.'
          tags:
            - tag: component
              value: raw
        - uuid: 6d4d9deab17b42f4a953c5210acac6f1
          name: 'Available memory'
          key: 'vm.memory.size[available]'
          units: B
          description: 'Defined as free + cached + buffers.'
          tags:
            - tag: component
              value: memory
          triggers:
            - uuid: 80b6406fb8474fa9801e9dffb2ccd368
              expression: 'last(/AIX by Zabbix agent/vm.memory.size[available])<20M'
              name: 'AIX: Lack of available memory on server'
              priority: AVERAGE
              tags:
                - tag: scope
                  value: capacity
                - tag: scope
                  value: performance
        - uuid: 57d30ccd5db64dc8b9498a36efe768e9
          name: 'Total memory'
          key: 'vm.memory.size[total]'
          delay: 1h
          units: B
          description: 'Total memory expressed in bytes.'
          tags:
            - tag: component
              value: memory
        - uuid: 304a3e9bb7594c83b027a32c34aeab28
          name: 'Zabbix agent availability'
          type: INTERNAL
          key: 'zabbix[host,agent,available]'
          description: 'Used for monitoring the availability status of the agent.'
          valuemap:
            name: zabbix.host.available
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: f0b9ecafede8476b94fd8dcab74cea87
              expression: 'max(/AIX by Zabbix agent/zabbix[host,agent,available],{$AGENT.TIMEOUT})=0'
              name: 'AIX: Zabbix agent is not available'
              event_name: 'AIX: Zabbix agent is not available (for {$AGENT.TIMEOUT})'
              priority: AVERAGE
              description: 'For passive checks only. The availability of the agent(s) and a host is used with `{$AGENT.TIMEOUT}` as the time threshold.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: availability
      discovery_rules:
        - uuid: 409cce8967b4494bbcc5193a26c69b06
          name: 'Network interface discovery'
          key: net.if.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#IFNAME}'
                value: '@Network interfaces for discovery'
          description: 'Used for the discovery of network interfaces.'
          item_prototypes:
            - uuid: df9710a48eaa4a72911de3971b37c596
              name: 'Interface {#IFNAME}: Incoming network traffic'
              key: 'net.if.in[{#IFNAME}]'
              units: bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 0704fb302aa94f73bedade3a998a0fa3
              name: 'Interface {#IFNAME}: Outgoing network traffic'
              key: 'net.if.out[{#IFNAME}]'
              units: bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
          graph_prototypes:
            - uuid: 366a988491344fd487561d02ed499fe0
              name: 'Interface {#IFNAME}: Network traffic'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'AIX by Zabbix agent'
                    key: 'net.if.in[{#IFNAME}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'AIX by Zabbix agent'
                    key: 'net.if.out[{#IFNAME}]'
        - uuid: 4a0b17decdf1449d9463cf00720a843d
          name: 'Mounted filesystem discovery'
          type: DEPENDENT
          key: vfs.fs.dependent.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.MATCHES}'
              - macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
              - macro: '{#FSTYPE}'
                value: '{$VFS.FS.FSTYPE.MATCHES}'
              - macro: '{#FSTYPE}'
                value: '{$VFS.FS.FSTYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
          description: 'The discovery of mounted filesystems with different types.'
          item_prototypes:
            - uuid: ee5ae5de6f7b40b4a9b064bdc733de91
              name: 'FS [{#FSNAME}]: Inodes: Free, in %'
              type: DEPENDENT
              key: 'vfs.fs.dependent.inode[{#FSNAME},pfree]'
              value_type: FLOAT
              units: '%'
              description: 'Free metadata space expressed in %.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.inodes.pfree
              master_item:
                key: 'vfs.fs.dependent[{#FSNAME},data]'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
                - tag: fstype
                  value: '{#FSTYPE}'
              trigger_prototypes:
                - uuid: 185959350a954c35a08ab6a9bf6c1d46
                  expression: 'min(/AIX by Zabbix agent/vfs.fs.dependent.inode[{#FSNAME},pfree],5m)<{$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}'
                  name: 'AIX: FS [{#FSNAME}]: Running out of free inodes'
                  event_name: 'AIX: {#FSNAME}: Running out of free inodes (free < {$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}%)'
                  opdata: 'Free inodes: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Disk writing may fail if index nodes are exhausted, leading to error messages like "No space left on device" or "Disk is full", despite available free space.'
                  tags:
                    - tag: scope
                      value: capacity
                    - tag: scope
                      value: performance
                - uuid: 6ce467d05e8745409a177799bed34bb3
                  expression: 'min(/AIX by Zabbix agent/vfs.fs.dependent.inode[{#FSNAME},pfree],5m)<{$VFS.FS.INODE.PFREE.MIN.WARN:"{#FSNAME}"}'
                  name: 'AIX: FS [{#FSNAME}]: Running out of free inodes'
                  event_name: 'AIX: FS [{#FSNAME}]: Running out of free inodes (free < {$VFS.FS.INODE.PFREE.MIN.WARN:"{#FSNAME}"}%)'
                  opdata: 'Free inodes: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Disk writing may fail if index nodes are exhausted, leading to error messages like "No space left on device" or "Disk is full", despite available free space.'
                  dependencies:
                    - name: 'AIX: FS [{#FSNAME}]: Running out of free inodes'
                      expression: 'min(/AIX by Zabbix agent/vfs.fs.dependent.inode[{#FSNAME},pfree],5m)<{$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}'
                  tags:
                    - tag: scope
                      value: capacity
                    - tag: scope
                      value: performance
            - uuid: 13e212598f744a7fa535c23731190c61
              name: 'FS [{#FSNAME}]: Space: Available'
              type: DEPENDENT
              key: 'vfs.fs.dependent.size[{#FSNAME},free]'
              units: B
              description: 'Available storage space expressed in bytes.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.bytes.free
              master_item:
                key: 'vfs.fs.dependent[{#FSNAME},data]'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
                - tag: fstype
                  value: '{#FSTYPE}'
            - uuid: 428b0314dd574df1970dd2cae7e8889b
              name: 'FS [{#FSNAME}]: Space: Available, in %'
              type: DEPENDENT
              key: 'vfs.fs.dependent.size[{#FSNAME},pfree]'
              value_type: FLOAT
              units: '%'
              description: |
                Deprecated metric.
                Space availability expressed as a percentage, calculated using the current and maximum available spaces.
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.bytes.pfree
              master_item:
                key: 'vfs.fs.dependent[{#FSNAME},data]'
              tags:
                - tag: component
                  value: storage
                - tag: deprecated
                - tag: filesystem
                  value: '{#FSNAME}'
                - tag: fstype
                  value: '{#FSTYPE}'
            - uuid: e0c53ff31b8145b5bb887bb61d077fc4
              name: 'FS [{#FSNAME}]: Space: Used, in %'
              type: DEPENDENT
              key: 'vfs.fs.dependent.size[{#FSNAME},pused]'
              value_type: FLOAT
              units: '%'
              description: 'Calculated as the percentage of currently used space compared to the maximum available space.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.bytes.pused
              master_item:
                key: 'vfs.fs.dependent[{#FSNAME},data]'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
                - tag: fstype
                  value: '{#FSTYPE}'
              trigger_prototypes:
                - uuid: 6b3a81f7c4a24307a099c07fb537a8ca
                  expression: 'min(/AIX by Zabbix agent/vfs.fs.dependent.size[{#FSNAME},pused],5m)>{$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}'
                  name: 'AIX: FS [{#FSNAME}]: Space is critically low'
                  event_name: 'AIX: FS [{#FSNAME}]: Space is critically low (used > {$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}%, total {{?last(//vfs.fs.dependent.size[{#FSNAME},total])/1024/1024/1024}.fmtnum(1)}GB)'
                  opdata: 'Space used: {{ITEM.LASTVALUE1}.fmtnum(1)}%'
                  priority: AVERAGE
                  description: |
                    The volume's space usage exceeds the `{$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}%` limit.
                    The trigger expression is based on the current used and maximum available spaces.
                    Event name represents the total volume space, which can differ from the maximum available space, depending on the filesystem type.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: capacity
                - uuid: 74a1fc62bfe24b7eabe4e244c70dc384
                  expression: 'min(/AIX by Zabbix agent/vfs.fs.dependent.size[{#FSNAME},pused],5m)>{$VFS.FS.PUSED.MAX.WARN:"{#FSNAME}"}'
                  name: 'AIX: FS [{#FSNAME}]: Space is low'
                  event_name: 'AIX: FS [{#FSNAME}]: Space is low (used > {$VFS.FS.PUSED.MAX.WARN:"{#FSNAME}"}%, total {{?last(//vfs.fs.dependent.size[{#FSNAME},total])/1024/1024/1024}.fmtnum(1)}GB)'
                  opdata: 'Space used: {{ITEM.LASTVALUE1}.fmtnum(1)}%'
                  priority: WARNING
                  description: |
                    The volume's space usage exceeds the `{$VFS.FS.PUSED.MAX.WARN:"{#FSNAME}"}%` limit.
                    The trigger expression is based on the current used and maximum available spaces.
                    Event name represents the total volume space, which can differ from the maximum available space, depending on the filesystem type.
                  manual_close: 'YES'
                  dependencies:
                    - name: 'AIX: FS [{#FSNAME}]: Space is critically low'
                      expression: 'min(/AIX by Zabbix agent/vfs.fs.dependent.size[{#FSNAME},pused],5m)>{$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: capacity
            - uuid: 6f6c92bc72014612b2efb92d12d8c425
              name: 'FS [{#FSNAME}]: Space: Total'
              type: DEPENDENT
              key: 'vfs.fs.dependent.size[{#FSNAME},total]'
              units: B
              description: 'Total space expressed in bytes.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.bytes.total
              master_item:
                key: 'vfs.fs.dependent[{#FSNAME},data]'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
                - tag: fstype
                  value: '{#FSTYPE}'
            - uuid: 915e72271f134684b2d10d05d4035962
              name: 'FS [{#FSNAME}]: Space: Used'
              type: DEPENDENT
              key: 'vfs.fs.dependent.size[{#FSNAME},used]'
              units: B
              description: 'Used storage expressed in bytes.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.bytes.used
              master_item:
                key: 'vfs.fs.dependent[{#FSNAME},data]'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
                - tag: fstype
                  value: '{#FSTYPE}'
            - uuid: 0c21ec9b14884057bdd2080b4871756e
              name: 'FS [{#FSNAME}]: Get data'
              type: DEPENDENT
              key: 'vfs.fs.dependent[{#FSNAME},data]'
              history: 1h
              value_type: TEXT
              description: 'Intermediate data of `{#FSNAME}` filesystem.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[?(@.fsname==''{#FSNAME}'')].first()'
              master_item:
                key: vfs.fs.get
              tags:
                - tag: component
                  value: raw
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
                - tag: fstype
                  value: '{#FSTYPE}'
            - uuid: cd96a2d7e708495cbc5d11a14ea9c876
              name: 'FS [{#FSNAME}]: Option: Read-only'
              type: DEPENDENT
              key: 'vfs.fs.dependent[{#FSNAME},readonly]'
              description: 'The filesystem is mounted as read-only. It is available only for Zabbix agents 6.4 and higher.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.options
                  error_handler: DISCARD_VALUE
                - type: REGEX
                  parameters:
                    - '(?:^|,)ro\b'
                    - '1'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'vfs.fs.dependent[{#FSNAME},data]'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
                - tag: fstype
                  value: '{#FSTYPE}'
              trigger_prototypes:
                - uuid: 05ec0e80333d4f7688b71a2865d0365e
                  expression: 'last(/AIX by Zabbix agent/vfs.fs.dependent[{#FSNAME},readonly],#2)=0 and last(/AIX by Zabbix agent/vfs.fs.dependent[{#FSNAME},readonly])=1'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/AIX by Zabbix agent/vfs.fs.dependent[{#FSNAME},readonly])=0'
                  name: 'AIX: FS [{#FSNAME}]: Filesystem has become read-only'
                  priority: AVERAGE
                  description: 'The filesystem has become read-only, possibly due to an I/O error. Available only for Zabbix agents 6.4 and higher.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
          graph_prototypes:
            - uuid: 6649ab6a9568418493be79dfb63b07b4
              name: 'FS [{#FSTYPE}({#FSNAME})]: Space usage graph, in % (relative to max available)'
              width: '600'
              height: '340'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - drawtype: FILLED_REGION
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'AIX by Zabbix agent'
                    key: 'vfs.fs.dependent.size[{#FSNAME},pused]'
            - uuid: cfd16b36331145a881249d88e105c731
              name: 'FS [{#FSTYPE}({#FSNAME})]: Space utilization chart (relative to total)'
              width: '600'
              height: '340'
              type: PIE
              show_3d: 'YES'
              graph_items:
                - color: '787878'
                  calc_fnc: LAST
                  type: GRAPH_SUM
                  item:
                    host: 'AIX by Zabbix agent'
                    key: 'vfs.fs.dependent.size[{#FSNAME},total]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: LAST
                  item:
                    host: 'AIX by Zabbix agent'
                    key: 'vfs.fs.dependent.size[{#FSNAME},used]'
                - sortorder: '2'
                  color: 199C09
                  calc_fnc: LAST
                  item:
                    host: 'AIX by Zabbix agent'
                    key: 'vfs.fs.dependent.size[{#FSNAME},free]'
          master_item:
            key: vfs.fs.get
          lld_macro_paths:
            - lld_macro: '{#FSNAME}'
              path: $.fsname
            - lld_macro: '{#FSTYPE}'
              path: $.fstype
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var filesystems = JSON.parse(value);
                  
                  result = filesystems.map(function (filesystem) {
                  	return {
                  		'fsname': filesystem.fsname,
                  		'fstype': filesystem.fstype
                  	};
                  });
                  
                  return JSON.stringify(result);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          overrides:
            - name: 'Skip metadata collection for dynamic FS'
              step: '1'
              filter:
                conditions:
                  - macro: '{#FSTYPE}'
                    value: ^(btrfs|zfs)$
              operations:
                - operator: LIKE
                  value: Inodes
                  discover: NO_DISCOVER
      tags:
        - tag: class
          value: os
        - tag: target
          value: aix
      macros:
        - macro: '{$AGENT.TIMEOUT}'
          value: 3m
          description: 'Timeout after which the agent is considered unavailable. Works only for agents reachable from Zabbix server/proxy (in passive mode).'
        - macro: '{$VFS.FS.FSNAME.MATCHES}'
          value: .+
          description: 'Used for filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.FSNAME.NOT_MATCHES}'
          value: ^(/dev|/sys|/run|/proc|.+/shm$)
          description: 'Used for filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.FSTYPE.MATCHES}'
          value: ^(btrfs|ext2|ext3|ext4|reiser|xfs|ffs|ufs|jfs|jfs2|vxfs|hfs|apfs|refs|ntfs|fat32|zfs)$
          description: 'Used for filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.FSTYPE.NOT_MATCHES}'
          value: ^\s$
          description: 'Used for filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.INODE.PFREE.MIN.CRIT}'
          value: '10'
          description: 'The critical threshold of the filesystem metadata utilization.'
        - macro: '{$VFS.FS.INODE.PFREE.MIN.WARN}'
          value: '20'
          description: 'The warning threshold of the filesystem metadata utilization.'
        - macro: '{$VFS.FS.PUSED.MAX.CRIT}'
          value: '90'
          description: 'The critical threshold of the filesystem utilization.'
        - macro: '{$VFS.FS.PUSED.MAX.WARN}'
          value: '80'
          description: 'The warning threshold of the filesystem utilization.'
      dashboards:
        - uuid: 5b5e04508ef3402a9432ec9f3d581179
          name: Filesystems
          pages:
            - name: Overview
              widgets:
                - type: graphprototype
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '3'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'AIX by Zabbix agent'
                        name: 'FS [{#FSTYPE}({#FSNAME})]: Space utilization chart (relative to total)'
                    - type: STRING
                      name: reference
                      value: AAAEB
                - type: graphprototype
                  'y': '5'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'AIX by Zabbix agent'
                        name: 'FS [{#FSTYPE}({#FSNAME})]: Space usage graph, in % (relative to max available)'
                    - type: STRING
                      name: reference
                      value: AAAEC
        - uuid: 873e38e16ef94f2b9b743a3251db0fbb
          name: 'System performance'
          pages:
            - widgets:
                - type: graph
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'AIX by Zabbix agent'
                        name: 'AIX: CPU load'
                    - type: STRING
                      name: reference
                      value: AAAAA
                - type: graph
                  'y': '5'
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'AIX by Zabbix agent'
                        name: 'AIX: CPU utilization'
                    - type: STRING
                      name: reference
                      value: AAAAC
                - type: graphprototype
                  'y': '10'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '3'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'AIX by Zabbix agent'
                        name: 'FS [{#FSTYPE}({#FSNAME})]: Space utilization chart (relative to total)'
                    - type: STRING
                      name: reference
                      value: AAAEA
                - type: graph
                  x: '36'
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'AIX by Zabbix agent'
                        name: 'AIX: CPU jumps'
                    - type: STRING
                      name: reference
                      value: AAAAB
                - type: graph
                  x: '36'
                  'y': '5'
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'AIX by Zabbix agent'
                        name: 'AIX: Memory usage'
                    - type: STRING
                      name: reference
                      value: AAAAD
      valuemaps:
        - uuid: 4a25a6b3d6e4482ab2a748c79cb55524
          name: zabbix.host.available
          mappings:
            - value: '0'
              newvalue: 'not available'
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: unknown
        - uuid: f2885fb5e52946f8bce8eb96a60f433a
          name: 'Zabbix agent ping status'
          mappings:
            - value: '1'
              newvalue: Up
  graphs:
    - uuid: a3a5bc3b07f34793bb1c8cfc688ba8a9
      name: 'AIX: CPU jumps'
      graph_items:
        - color: 199C0D
          item:
            host: 'AIX by Zabbix agent'
            key: system.cpu.switches
        - sortorder: '1'
          color: F63100
          item:
            host: 'AIX by Zabbix agent'
            key: system.cpu.intr
    - uuid: 260417d4613d405986406c272f54a5aa
      name: 'AIX: CPU load'
      graph_items:
        - color: 199C0D
          item:
            host: 'AIX by Zabbix agent'
            key: 'system.cpu.load[percpu,avg1]'
        - sortorder: '1'
          color: F63100
          item:
            host: 'AIX by Zabbix agent'
            key: 'system.cpu.load[percpu,avg5]'
        - sortorder: '2'
          color: 00611C
          item:
            host: 'AIX by Zabbix agent'
            key: 'system.cpu.load[percpu,avg15]'
    - uuid: a2eeb8269edf4de7ac13b7ceb1260b75
      name: 'AIX: CPU utilization'
      graph_items:
        - color: 199C0D
          item:
            host: 'AIX by Zabbix agent'
            key: 'system.stat[cpu,ec]'
        - sortorder: '1'
          color: F63100
          item:
            host: 'AIX by Zabbix agent'
            key: 'system.stat[cpu,pc]'
        - sortorder: '2'
          color: 00611C
          item:
            host: 'AIX by Zabbix agent'
            key: 'system.stat[cpu,wa]'
        - sortorder: '3'
          color: F7941D
          item:
            host: 'AIX by Zabbix agent'
            key: 'system.stat[cpu,sy]'
        - sortorder: '4'
          color: FC6EA3
          item:
            host: 'AIX by Zabbix agent'
            key: 'system.stat[cpu,us]'
        - sortorder: '5'
          color: 6C59DC
          item:
            host: 'AIX by Zabbix agent'
            key: 'system.stat[cpu,id]'
    - uuid: 2664343cd69444e0a16850083845838f
      name: 'AIX: Memory usage'
      graph_items:
        - color: 199C0D
          item:
            host: 'AIX by Zabbix agent'
            key: 'vm.memory.size[available]'
